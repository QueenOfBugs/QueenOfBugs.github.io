<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-08-24 Thu 09:08 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Excel 相关书籍的笔记</title>
<meta name="generator" content="Org mode" />
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Excel 相关书籍的笔记</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgdd00ff2">1. Excel 教科书(吉田拳 日)</a>
<ul>
<li><a href="#orge348fbd">1.1. Excel 必须掌握的7个要点</a>
<ul>
<li><a href="#org5c0e606">1.1.1. 常规操作瞬间完成</a></li>
<li><a href="#org9fd5381">1.1.2. 提升Excel技能的3个必需项</a></li>
<li><a href="#org3fabfc8">1.1.3. 数据只有4种类型</a></li>
<li><a href="#org6271d5d">1.1.4. 有效利用快捷键</a></li>
<li><a href="#orgb9891d6">1.1.5. 保存制作好的数据</a></li>
<li><a href="#org6edb9a6">1.1.6. 解除复杂功能,操作更简便</a></li>
<li><a href="#org037ebd9">1.1.7. 共享 Excel 文件时的注意点</a>
<ul>
<li><a href="#org63873ff">1.1.7.1. 文件的保存形式</a></li>
<li><a href="#org4e4a0c1">1.1.7.2. 保留1个新建工作簿的初期工作</a></li>
<li><a href="#orgc72802c">1.1.7.3. 确认"设置打印区域"</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgd038f4f">1.2. 如何在 Excel 中输入函数</a>
<ul>
<li><a href="#org635238f">1.2.1. 输入公式的操作步骤</a>
<ul>
<li><a href="#org18c18d3">1.2.1.1. 巧用函数,简化输入过程</a></li>
<li><a href="#orgecc471a">1.2.1.2. 输入函数的5个步骤</a></li>
<li><a href="#orgc0ee7df">1.2.1.3. 如何快速选择单元格范围</a></li>
</ul>
</li>
<li><a href="#org3973fc7">1.2.2. 熟练使用"引用",快速计算</a>
<ul>
<li><a href="#org9d496a1">1.2.2.1. 活用单元格中的原始数据</a></li>
<li><a href="#org6408925">1.2.2.2. 必须掌握的运算符</a></li>
<li><a href="#orga4b0d8c">1.2.2.3. 复制带公式单元格时的陷阱</a></li>
<li><a href="#orgcb01c9e">1.2.2.4. 利用 "F4" 和 "$" 高效运用 "绝对引用"</a></li>
<li><a href="#org3ad4eec">1.2.2.5. 无需记住错误值的种类和意义</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org6c43374">1.3. 需要事先掌握的6个函数</a>
<ul>
<li><a href="#orgd054d58">1.3.1. 根据条件改变答案&#x2013;IF 函数</a>
<ul>
<li><a href="#org8199e03">1.3.1.1. IF 函数的基础知识</a></li>
<li><a href="#org80b85df">1.3.1.2. 如何判断复数条件</a></li>
</ul>
</li>
<li><a href="#orgd53e781">1.3.2. 本月销售额&#x2013;SUM 函数</a>
<ul>
<li><a href="#org09af06e">1.3.2.1. SUM 函数的基础</a></li>
<li><a href="#org25e869b">1.3.2.2. 计算连续单元格范围内的总和&#x2013;ΣSUM</a></li>
<li><a href="#org09a2af5">1.3.2.3. 如何求多个分开的单元格的总和</a></li>
<li><a href="#org862af4b">1.3.2.4. 提高乘法运算,字符串混合输入的效率</a></li>
</ul>
</li>
<li><a href="#org41e818c">1.3.3. 计算客户名单的人数&#x2013;COUNTA 函数</a>
<ul>
<li><a href="#org8ed43ef">1.3.3.1. 与 COUNT 函数的区别</a></li>
</ul>
</li>
<li><a href="#orge1a2f13">1.3.4. 按照负责人分别计算销售情况&#x2013;SUMIF 函数</a>
<ul>
<li><a href="#org1851a16">1.3.4.1. SUMIF 函数的基础</a></li>
<li><a href="#org8ce51ac">1.3.4.2. 计算每个人的销售情况</a></li>
</ul>
</li>
<li><a href="#orgaf8f1ed">1.3.5. 参加名单中,有多少人出席&#x2013;COUNTIF 函数</a>
<ul>
<li><a href="#orgc44129a">1.3.5.1. COUNTIF 函数的基础</a></li>
<li><a href="#org9ad7765">1.3.5.2. 计算每名销售人员的销售数量</a></li>
</ul>
</li>
<li><a href="#orgc012073">1.3.6. 输入商品名,自动显示价格&#x2013;VLOOKUP 函数</a>
<ul>
<li><a href="#orge5981ec">1.3.6.1. VLOOKUP 函数的基础</a></li>
<li><a href="#org9a9b7a3">1.3.6.2. 用 "整列指定"</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orga30d9c1">1.4. 通过应用与组合,提升函数威力</a>
<ul>
<li><a href="#orgfc53d34">1.4.1. 判断单元格中是否包含特定的字符串</a>
<ul>
<li><a href="#org7380d3b">1.4.1.1. 就算特定地址区域的客户人数</a></li>
<li><a href="#org5d01a85">1.4.1.2. 如何搜索更多的特定区域</a></li>
</ul>
</li>
<li><a href="#org2cce456">1.4.2. 消除重复数据的方法</a>
<ul>
<li><a href="#orgcfb4a0c">1.4.2.1. 如何判断是否有重复</a></li>
<li><a href="#org4b6c5e2">1.4.2.2. 选中并删除重复的单元格</a></li>
</ul>
</li>
<li><a href="#orgbc239ae">1.4.3. 输入连续的数字</a></li>
<li><a href="#org8dc136d">1.4.4. 沿行方向输入大量 VLOOKUP 函数的方法</a></li>
<li><a href="#orgebcfff2">1.4.5. 如何用 VLOOKUP 函数应对检索范围中竖列顺序的变动情况</a></li>
<li><a href="#orgb9f1ffe">1.4.6. 在有多个相同检索值的工作表中使用 VLOOKUP 函数的技巧</a></li>
<li><a href="#orgdc4b751">1.4.7. 是否能用 VLOOKUP 函数获得检索列左侧的数值?</a></li>
<li><a href="#orgf1721a9">1.4.8. 不显示错误值的技巧</a></li>
<li><a href="#org9f46e8b">1.4.9. 用 SUMIF 函数统计多个条件的方法</a></li>
</ul>
</li>
<li><a href="#org57235c1">1.5. Excel 中的日期与时间设置</a></li>
</ul>
</li>
<li><a href="#orgc2e42ae">2. Excel函数与公事速查手册(第二版)</a>
<ul>
<li><a href="#orga998e7c">2.1. 逻辑函数(8)</a>
<ul>
<li><a href="#org0478e0b">2.1.1. AND 函数(检验是否都满足条件)</a></li>
<li><a href="#org9347bfb">2.1.2. OR 函数(检验是否有一个满足条件)</a></li>
<li><a href="#org9227af9">2.1.3. NOT 函数(对参数取反)</a></li>
<li><a href="#org3d90281">2.1.4. IF 函数(根据条件判断真假)</a></li>
<li><a href="#orgb525baa">2.1.5. TRUE 函数</a></li>
<li><a href="#orga0542fa">2.1.6. FALSE 函数</a></li>
<li><a href="#org78284f6">2.1.7. IFNA 函数</a></li>
<li><a href="#org335c2a7">2.1.8. IFERROR 函数</a></li>
</ul>
</li>
<li><a href="#orgb1664b6">2.2. 数学和三角函数(59)</a>
<ul>
<li><a href="#org1f03219">2.2.1. 求和函数</a>
<ul>
<li><a href="#org0c5b0b5">2.2.1.1. SUM 函数(求和运算)</a></li>
<li><a href="#org6f674f7">2.2.1.2. SUMIF 函数(按照指定条件求和)</a></li>
<li><a href="#org9d2c195">2.2.1.3. SUMIFS 函数(对满足多重条件的单元格求和)</a></li>
<li><a href="#org6259c0a">2.2.1.4. SUMPRODUCT 函数(将数组间对应的元素相乘,并返回乘积之和)</a></li>
<li><a href="#org06f4cc3">2.2.1.5. SUBTOTAL 函数 (返回分类汇总的值)</a></li>
</ul>
</li>
<li><a href="#org25d200e">2.2.2. 数学函数</a>
<ul>
<li><a href="#org34570af">2.2.2.1. ABS 函数(求绝对值)</a></li>
<li><a href="#org037a2eb">2.2.2.2. MOD 函数(求两个数值相除后的余数)</a></li>
<li><a href="#org35acc83">2.2.2.3. SUMSQ 函数</a></li>
<li><a href="#org6e8aed9">2.2.2.4. SUMXMY2 函数</a></li>
<li><a href="#orga9df4b2">2.2.2.5. SUMX2MY2 函数</a></li>
<li><a href="#orgc55bce4">2.2.2.6. SUMX2PY2 函数</a></li>
<li><a href="#orga6972cf">2.2.2.7. PRODUCRT 函数</a></li>
<li><a href="#orgd693087">2.2.2.8. MULTINOMIAL 函数</a></li>
<li><a href="#org73ead72">2.2.2.9. MDETERM 函数</a></li>
<li><a href="#orgf11a1dd">2.2.2.10. MINVERSE 函数</a></li>
<li><a href="#orgbff7b8d">2.2.2.11. MMULT 函数</a></li>
<li><a href="#orgbd1a37c">2.2.2.12. GCD 函数</a></li>
<li><a href="#orgcb036f6">2.2.2.13. LCM</a></li>
<li><a href="#org380defc">2.2.2.14. QUOTIENT 函数(返回商的整数部分)</a></li>
<li><a href="#orgae89c55">2.2.2.15. RAND 函数(返回大于或等于0 小于1 的随机数)</a></li>
<li><a href="#orgfdec4b8">2.2.2.16. RANDBETWEEN 函数(返回指定数值之间的随机数)</a></li>
<li><a href="#org1a6b4eb">2.2.2.17. SQRT 函数(返回参数的平方根)</a></li>
<li><a href="#org5422f07">2.2.2.18. SQRTPI 函数</a></li>
<li><a href="#org3bbfbf0">2.2.2.19. RADIANS 函数(将角度转为弧度)</a></li>
<li><a href="#org8d13be3">2.2.2.20. SIGN 函数</a></li>
<li><a href="#org8c54111">2.2.2.21. ROMAN 函数</a></li>
</ul>
</li>
<li><a href="#orgf9d7a10">2.2.3. 数据舍入函数</a>
<ul>
<li><a href="#org6aac50b">2.2.3.1. INT 函数(不考虑四舍五入直接对数字取整)</a></li>
<li><a href="#orgf0da228">2.2.3.2. ROUND 函数(对数据进行四舍五入)</a></li>
<li><a href="#org210bb3b">2.2.3.3. ROUNDUP 函数(向上舍入)</a></li>
<li><a href="#org1479a99">2.2.3.4. ROUNDDOWN 函数(向下舍入)</a></li>
<li><a href="#org784886f">2.2.3.5. CEILING 函数(向上取舍到最接近指定数字的某个值的倍数值)</a></li>
<li><a href="#org40b07fc">2.2.3.6. FLOOR 函数(向下舍入到最接近指定数字的某个值的倍数值)</a></li>
<li><a href="#orgec6e859">2.2.3.7. MROUND 函数(按指定倍数舍入)</a></li>
<li><a href="#org5567148">2.2.3.8. EVEN 函数</a></li>
<li><a href="#org7999696">2.2.3.9. ODD 函数</a></li>
<li><a href="#org9d8305c">2.2.3.10. TRUNC 函数(不考虑四舍五入直接对数字进行截断)</a></li>
</ul>
</li>
<li><a href="#orgb9f8a61">2.2.4. 三角函数</a>
<ul>
<li><a href="#orge5b005c">2.2.4.1. COS 函数</a></li>
<li><a href="#orgf855802">2.2.4.2. ACOS 函数</a></li>
<li><a href="#org1a37ae5">2.2.4.3. COSH 函数</a></li>
<li><a href="#org0f626bc">2.2.4.4. ACOSH 函数</a></li>
<li><a href="#org7a10d34">2.2.4.5. SIN 函数</a></li>
<li><a href="#org6642aeb">2.2.4.6. ASIN 函数</a></li>
<li><a href="#org191758b">2.2.4.7. SINH 函数</a></li>
<li><a href="#org7eb21c0">2.2.4.8. ASINH 函数</a></li>
<li><a href="#orgd18df04">2.2.4.9. TAN 函数</a></li>
<li><a href="#orgac94845">2.2.4.10. ATAN 函数</a></li>
<li><a href="#org9025d97">2.2.4.11. ATAN2 函数</a></li>
<li><a href="#org6839002">2.2.4.12. TANH 函数</a></li>
<li><a href="#orga0b0522">2.2.4.13. ATANH 函数</a></li>
<li><a href="#orgf1f78cb">2.2.4.14. DEGREES 函数</a></li>
<li><a href="#orge776799">2.2.4.15. PI 函数</a></li>
</ul>
</li>
<li><a href="#org6766d50">2.2.5. 对数,幂和阶乘函数</a>
<ul>
<li><a href="#orgad6634d">2.2.5.1. EXP 函数</a></li>
<li><a href="#orga4bcb60">2.2.5.2. POWER 函数</a></li>
<li><a href="#org9ce4d9d">2.2.5.3. LN 函数</a></li>
<li><a href="#orgbdb3408">2.2.5.4. LOG 函数</a></li>
<li><a href="#orgdd543e3">2.2.5.5. LOG10 函数</a></li>
<li><a href="#orge856f5c">2.2.5.6. SERIESSUM 函数</a></li>
<li><a href="#org9035e80">2.2.5.7. FACT 函数</a></li>
<li><a href="#orgb153198">2.2.5.8. FACTDOUBLE 函数</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org327e21d">2.3. 文本函数(27)</a>
<ul>
<li><a href="#org59c9d96">2.3.1. 文本查找,提取</a>
<ul>
<li><a href="#org9fa38cd">2.3.1.1. MID 函数(从任意位置提取指定数目的字符)</a></li>
<li><a href="#org764a12c">2.3.1.2. LEFT 函数(按指定字符数从最左侧提取字符串)</a></li>
<li><a href="#orgfb71229">2.3.1.3. RIGHT 函数(按指定字符数从最右侧提取字符串)</a></li>
<li><a href="#org578c2cd">2.3.1.4. SEARCH 函数(查找字符串的起始位置)</a></li>
</ul>
</li>
<li><a href="#orge79bfeb">2.3.2. 文本替换</a>
<ul>
<li><a href="#org92ad1af">2.3.2.1. REPLACE 函数(替换文本字符串的部分文本)</a></li>
<li><a href="#org2bc1e1f">2.3.2.2. SUBSTITUTE 函数(用新文本替换旧文本)</a></li>
</ul>
</li>
<li><a href="#orgc271710">2.3.3. 文本格式转换</a>
<ul>
<li><a href="#org5114a07">2.3.3.1. ASC 函数(将全角字符转换为半角字符)</a></li>
<li><a href="#org0c18ed2">2.3.3.2. WIDECHAR 函数(将半角字符转换为全角字符)</a></li>
<li><a href="#orgec178e3">2.3.3.3. LOWER 函数(将文本转为小写形式)</a></li>
<li><a href="#org80d3d54">2.3.3.4. UPPER 函数(将文本转为大写形式)</a></li>
<li><a href="#org8fa104d">2.3.3.5. PROPER(将文本字符串的首字母转为大写)</a></li>
<li><a href="#orgfcb5c66">2.3.3.6. DOLLAR 函数(四舍五入数值,并添加千分位符和 $ 符号)</a></li>
<li><a href="#org1365ec9">2.3.3.7. RMB 函数(四舍五入数值,并添加千分位符号和¥符号)</a></li>
<li><a href="#org51421e5">2.3.3.8. BAHTTEXT 函数(将数字转为泰铢)</a></li>
<li><a href="#orgdeb7c91">2.3.3.9. FIXED 函数(将数字显示千分位符样式并转为文本)</a></li>
<li><a href="#orgf49e673">2.3.3.10. TEXT 函数(设置数字格式并将其转为文本)</a></li>
<li><a href="#orgc52dd70">2.3.3.11. VALUE 函数(将文本数字转换成数值)</a></li>
<li><a href="#org9e23f3a">2.3.3.12. CHAR 函数</a></li>
<li><a href="#orgddb31bd">2.3.3.13. CODE 函数</a></li>
<li><a href="#orga8f31a3">2.3.3.14. UNICHAR 函数</a></li>
</ul>
</li>
<li><a href="#org7d43949">2.3.4. 其他文本函数</a>
<ul>
<li><a href="#org915b021">2.3.4.1. CONCATENATE 函数(合并多个文本字符串)</a></li>
<li><a href="#orgba7fe16">2.3.4.2. LEN 函数(返回文本字符串的字符数量)</a></li>
<li><a href="#org51fc219">2.3.4.3. EXACT 函数(比较两个字符串是否完全相同)</a></li>
<li><a href="#org73fc8d0">2.3.4.4. REPT 函数(按照指定次数重复文本)</a></li>
<li><a href="#org42c5d35">2.3.4.5. TRIM 函数</a></li>
<li><a href="#orga0fda48">2.3.4.6. CLEAN 函数(删除文本中不能打印的字符)</a></li>
<li><a href="#orgc538f7a">2.3.4.7. T 函数</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orge3bc068">2.4. 信息函数(20)</a>
<ul>
<li><a href="#org71a2016">2.4.1. 返回信息以及各类型的值</a>
<ul>
<li><a href="#org1aaeac4">2.4.1.1. CELL 函数(返回有关单元格格式,位置或内容的信息)</a></li>
<li><a href="#org3ed06d5">2.4.1.2. TYPE 函数(返回单元格内的数值类型)</a></li>
<li><a href="#org06752d7">2.4.1.3. N 函数(将数据转换成数值并返回)</a></li>
<li><a href="#orgc4bfb12">2.4.1.4. NA 函数(返回错误值 #N/A)</a></li>
<li><a href="#org953e7af">2.4.1.5. INFO 函数(返回当前操作环境的信息)</a></li>
<li><a href="#org9cc9e05">2.4.1.6. ERROR.TYPE 函数(返回错误值对应的数字)</a></li>
</ul>
</li>
<li><a href="#org67404fe">2.4.2. 各种 IS 函数</a>
<ul>
<li><a href="#org398928a">2.4.2.1. ISBLANK 函数(检测单元格是否为空)</a></li>
<li><a href="#org81c7815">2.4.2.2. ISNUMBER 函数(检测参数是否为数值)</a></li>
<li><a href="#org1a35cd5">2.4.2.3. ISTEXT 函数(检测参数是否为文本)</a></li>
<li><a href="#orgc6e338c">2.4.2.4. ISNONTEXT 函数(检测参数是否为非文本,结果与 ISTEXT 相反)</a></li>
<li><a href="#orge98af22">2.4.2.5. ISEVEN 函数(判断数字是否为偶数)</a></li>
<li><a href="#org060b610">2.4.2.6. ISODD 函数(判断数字是否为奇数)</a></li>
<li><a href="#org356da45">2.4.2.7. ISLOGICAL 函数(检测给定参数是否为逻辑值)</a></li>
<li><a href="#org1388e38">2.4.2.8. ISERROR 函数(检测参数是否为错误值)</a></li>
<li><a href="#org2e0b93f">2.4.2.9. ISNA 函数(检测参数是否为 #N/A 错误值)</a></li>
<li><a href="#org44f6019">2.4.2.10. ISERR 函数(检测参数是否为 #N/A 之外的错误值)</a></li>
<li><a href="#orgc199d93">2.4.2.11. ISREF 函数(检测参数是否为引用)</a></li>
<li><a href="#org8f5cc8c">2.4.2.12. ISFORMULA 函数(检测单元格内容是否为公式)</a></li>
<li><a href="#orgba4dc02">2.4.2.13. SHEET 函数(返回工作表编号)</a></li>
<li><a href="#orgf3a87d3">2.4.2.14. SHEETS 函数(工作簿中工作表数量)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org7d9803d">2.5. 日期和时间函数(23)</a>
<ul>
<li><a href="#org9e4f400">2.5.1. 返回日期和时间</a>
<ul>
<li><a href="#orgd88b9e5">2.5.1.1. NOW 函数(返回当前日期与时间)</a></li>
<li><a href="#org45878bd">2.5.1.2. TODAY 函数(返回当前日期)</a></li>
<li><a href="#org5a6dbc1">2.5.1.3. DATE 函数(构建一个标准日期)</a></li>
<li><a href="#org66f64d8">2.5.1.4. TIME 函数(构建标准时间)</a></li>
<li><a href="#org6891fee">2.5.1.5. YEAR 函数(返回日期对应的年份)</a></li>
<li><a href="#orgfc1a835">2.5.1.6. MONTH 函数(返回日期中的月份)</a></li>
<li><a href="#orgc5a31e1">2.5.1.7. DAY 函数(返回日期中的天数)</a></li>
<li><a href="#orgec387b6">2.5.1.8. WEEKDAY 函数(返回日期对应的星期数)</a></li>
<li><a href="#org2f91a21">2.5.1.9. WEEKNUM 函数(返回日期对应一年中的第几周)</a></li>
<li><a href="#org960c4c7">2.5.1.10. EOMONTH 函数(返回某日期到指定月数之前/后的最后一天的日期)</a></li>
<li><a href="#org7612e19">2.5.1.11. HOUR 函数(返回时间中的小时数)</a></li>
<li><a href="#orgbbdddd2">2.5.1.12. MINUTE 函数(返回时间中的分钟数)</a></li>
<li><a href="#org71b7b37">2.5.1.13. SECOND 函数(返回时间中的秒数)</a></li>
</ul>
</li>
<li><a href="#org0ac7b50">2.5.2. 日期计算</a>
<ul>
<li><a href="#org089ade2">2.5.2.1. DATEDIF 函数(计算两个日期之间的年数,月数和天数)</a></li>
<li><a href="#orgdcbd585">2.5.2.2. DAYS360 函数(按照一年 360 天的算法计算两个日期之间的天数差)</a></li>
<li><a href="#orge8e45c5">2.5.2.3. EDATE 函数(计算间隔指定月数后的日期)</a></li>
<li><a href="#org86b713f">2.5.2.4. WORKDAY 函数(获取间隔若干工作日后的日期)</a></li>
<li><a href="#org1e0174e">2.5.2.5. WORKDAY.INTL 函数</a></li>
<li><a href="#org6254f23">2.5.2.6. YEARFRAC 函数(从开始到结束经过的天数占全年总天数的比例)</a></li>
<li><a href="#org5f9e25e">2.5.2.7. NETWORKDAYS 函数(计算两个日期之间的工作日数量)</a></li>
<li><a href="#org94081ec">2.5.2.8. NETWORKDAYS.INTL 函数</a></li>
</ul>
</li>
<li><a href="#org13fd00e">2.5.3. 文本日期/时间的转换</a>
<ul>
<li><a href="#orge2dc71c">2.5.3.1. DATEVALUE 函数(将日期字符串转换成可以计算的数值/序列号)</a></li>
<li><a href="#org30df8f0">2.5.3.2. TIEMVALUE 函数(将时间字符串转换成可计算的小数值)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgceb2556">2.6. 统计函数(102)</a>
<ul>
<li><a href="#orgeb050c0">2.6.1. 平均值计算函数(7)</a>
<ul>
<li><a href="#org72e78cc">2.6.1.1. AVERAGE 函数(求平均值)</a></li>
<li><a href="#org9069415">2.6.1.2. AVERAGEA 函数(求包括文本和逻辑值的平均值)</a></li>
<li><a href="#orgd1b36d0">2.6.1.3. AVERAGEIF 函数(按条件求平均值)</a></li>
<li><a href="#org9bd0074">2.6.1.4. AVERAGEIFS 函数(按多个条件求平均值)</a></li>
<li><a href="#org59c3334">2.6.1.5. GEOMEAN 函数(返回几何平均值)</a></li>
<li><a href="#org9dd9705">2.6.1.6. HARMEAN 函数(返回数据集的调和平均值)</a></li>
<li><a href="#org25441fe">2.6.1.7. TRIMMEAN 函数(截头尾返回数据集的平均值)</a></li>
</ul>
</li>
<li><a href="#org0c0b967">2.6.2. 数目统计函数(5)</a>
<ul>
<li><a href="#org60fa7d9">2.6.2.1. COUNT 函数(统计含有数值的单元格个数)</a></li>
<li><a href="#orgeddc918">2.6.2.2. COUNTA 函数(统计非空单元格的个数)</a></li>
<li><a href="#org6ef4df3">2.6.2.3. COUNTIF 函数(统计满足条件的单元格个数)</a></li>
<li><a href="#org6c22404">2.6.2.4. COUNTIFS 函数(统计同时满足多个条件的单元格个数)</a></li>
<li><a href="#orgac4919a">2.6.2.5. COUNTBLANK 函数(统计空单元格个数)</a></li>
</ul>
</li>
<li><a href="#org620fb43">2.6.3. 最大值与最小值函数(6)</a>
<ul>
<li><a href="#org7180eae">2.6.3.1. MAX 函数(返回数值集的最大值)</a></li>
<li><a href="#orge858c20">2.6.3.2. MIN 函数(返回数值集的最小值)</a></li>
<li><a href="#org7def452">2.6.3.3. MAXA 函数(返回数据集(包括文本,逻辑值)的最大值)</a></li>
<li><a href="#org2200b6b">2.6.3.4. MINA 函数(返回数据集(包括逻辑值和文本)的最小值)</a></li>
<li><a href="#org901ef66">2.6.3.5. LARGE 函数(返回数据集的某个最大值)</a></li>
<li><a href="#org00ab712">2.6.3.6. SMALL 函数(返回数据集的某个最小值)</a></li>
</ul>
</li>
<li><a href="#org884a65b">2.6.4. 排位统计函数(5)</a>
<ul>
<li><a href="#orge24ff68">2.6.4.1. RANK.EQ 函数(返回数据的排位,相同值返回最高排序)</a></li>
<li><a href="#orgcd1def5">2.6.4.2. RANK.AVG 函数(返回数据的排位,相同值返回排序的平均值)</a></li>
<li><a href="#org4ad3788">2.6.4.3. QUARTILE.INC, QUARTILE.EXC 函数</a></li>
<li><a href="#org3b45422">2.6.4.4. PERCENTILE.INC, PERCENTILE.EXC 函数</a></li>
<li><a href="#orgf1d0808">2.6.4.5. PERCENTRANK.INC, PERCENTRANK.EXC 函数</a></li>
</ul>
</li>
<li><a href="#org3f7bd66">2.6.5. 方差,协方差与偏差函数(12)</a>
<ul>
<li><a href="#org43e8815">2.6.5.1. VAR.S 函数(计算基于样本的方差)</a></li>
<li><a href="#org6ac4823">2.6.5.2. VARA 函数(计算基于样本的方差, 文本和逻辑值也参与计算)</a></li>
<li><a href="#org42a37e1">2.6.5.3. VAR.P 函数(基于样本计算总体的方差)</a></li>
<li><a href="#orge632ae4">2.6.5.4. VARPA 函数(基于样本计算总体的方差,文本和逻辑值也参与计算)</a></li>
<li><a href="#orgf6bcd20">2.6.5.5. STDEV.S 函数(基于样本估算标准差)</a></li>
<li><a href="#org028b0f4">2.6.5.6. STDEVA 函数(基于样本估算标准偏差,文本和逻辑值也参与计算)</a></li>
<li><a href="#org260f458">2.6.5.7. STDEV.P 函数(基于样本估算总体的标准偏差)</a></li>
<li><a href="#orgec14528">2.6.5.8. STDEVPA 函数(基于样本估算总体的标准偏差,文本和逻辑值也参与计算)</a></li>
<li><a href="#org2f2f17c">2.6.5.9. VAR.S 函数(计算基于样本的方差)</a></li>
<li><a href="#orgc93cbb8">2.6.5.10. VAR.S 函数(计算基于样本的方差)</a></li>
<li><a href="#org0d5a953">2.6.5.11. VAR.S 函数(计算基于样本的方差)</a></li>
<li><a href="#orgb5f5cc4">2.6.5.12. VAR.S 函数(计算基于样本的方差)</a></li>
</ul>
</li>
<li><a href="#org2dc157e">2.6.6. 概率分布函数(44)</a></li>
<li><a href="#org8f8b2fd">2.6.7. 检验函数(4)</a></li>
<li><a href="#org12bd8f2">2.6.8. 回归分析函数(8)</a></li>
<li><a href="#org419f802">2.6.9. 相关系数分析(4)</a></li>
<li><a href="#org2c268ae">2.6.10. 其他统计函数(7)</a></li>
</ul>
</li>
<li><a href="#org9bb9be3">2.7. 财务函数(55)</a></li>
<li><a href="#org1c6f12d">2.8. 查找和引用函数(18)</a></li>
<li><a href="#org1539dcd">2.9. 数据库函数(12)</a></li>
<li><a href="#org0681593">2.10. 工程函数(54)</a></li>
<li><a href="#orgf0d87e6">2.11. 加载项和自动化函数(4)</a></li>
<li><a href="#org1b22d3f">2.12. 多维数据集函数(7)</a></li>
<li><a href="#org9189c00">2.13. 兼容性函数(38)</a></li>
<li><a href="#org6abdf64">2.14. Web函数(3)</a></li>
<li><a href="#org4603ccf">2.15. 名称的定义与使用</a></li>
</ul>
</li>
<li><a href="#orge584c69">3. <span class="todo TODO">TODO</span> 重要知识</a></li>
</ul>
</div>
</div>
<p>
Last modified:2023-07-25 15:12:57 kamisama
</p>

<div id="outline-container-orgdd00ff2" class="outline-2">
<h2 id="orgdd00ff2"><span class="section-number-2">1</span> Excel 教科书(吉田拳 日)</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orge348fbd" class="outline-3">
<h3 id="orge348fbd"><span class="section-number-3">1.1</span> Excel 必须掌握的7个要点</h3>
<div class="outline-text-3" id="text-1-1">
</div>
<div id="outline-container-org5c0e606" class="outline-4">
<h4 id="org5c0e606"><span class="section-number-4">1.1.1</span> 常规操作瞬间完成</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
知识量不足会导致时间和资金的浪费,比如如果不知道函数和各种Excel功能的使用,则每天/
月都会花费大量时间来统计各种数据, 使用函数或模板可以让重复的数据统计工作自动完成,而
所需只需要完成表格的设计时间,却省下了无数次重复劳动的时间.
</p>
</div>
</div>
<div id="outline-container-org9fd5381" class="outline-4">
<h4 id="org9fd5381"><span class="section-number-4">1.1.2</span> 提升Excel技能的3个必需项</h4>
<div class="outline-text-4" id="text-1-1-2">
<dl class="org-dl">
<dt>67个函数</dt><dd>excel 总计400 多个函数,就单个职业来说,一般30-50个就足够了,按一般情
况来讲,掌握67个函数就足够应对了.</dd>

<dt>Excel 必需了解的9个功能</dt><dd><ul class="org-ul">
<li>条件格式</li>

<li>数据验证</li>

<li>数据筛选</li>

<li>数据排序</li>

<li>数据查找和替换</li>

<li>数据透视表</li>

<li>自动输入(快速输入和快速填充 CTRL+ENTER/D/R, 以及鼠标拖拽)</li>

<li>保护工作表</li>

<li>定位条件</li>
</ul></dd>

<dt>组合使用函数和功能</dt><dd>掌握全部的 Excel 函数和功能没有任何意义,如何将其进行组合,并
组织其结构,减少重复的劳动才是有趣且重要的.</dd>
</dl>
</div>
</div>
<div id="outline-container-org3fabfc8" class="outline-4">
<h4 id="org3fabfc8"><span class="section-number-4">1.1.3</span> 数据只有4种类型</h4>
<div class="outline-text-4" id="text-1-1-3">
<p>
从使用 Excel 软件的角度来看,单元格内的数据大致可分为4种类型.
这是从单元格里存放的数据来看的,而不是从计算机科学角度看的,所以日期/时间与数值类
型区分开来了.
</p>
<ol class="org-ol">
<li>数值: 如0,1,2,3,4这样的数据</li>
<li>文本: 除了数值数据之外的汉字,数字以及其他符号</li>
<li>序列(日期/时间): 显示为时间或日期的数据,其本质是一种受到特殊处理的数值类型数据.</li>
<li>公式/函数:以 "=" 开头的数据</li>
</ol>
</div>
</div>
<div id="outline-container-org6271d5d" class="outline-4">
<h4 id="org6271d5d"><span class="section-number-4">1.1.4</span> 有效利用快捷键</h4>
<div class="outline-text-4" id="text-1-1-4">
<p>
使用鼠标时每项操作都需要逐个点击,但是快捷键将许多功能组合到一起,或是将特定功能绑
定到特定快捷键,使用时无需多次点击鼠标,只需按下相应快捷键便可以使用特定功能了,极
大节约了时间.
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 1:</span> 常用快捷键</caption>

<colgroup>
<col  class="org-center" />

<col  class="org-center" />
</colgroup>
<tbody>
<tr>
<td class="org-center">快捷键</td>
<td class="org-center">用途</td>
</tr>

<tr>
<td class="org-center">CTRL + 1</td>
<td class="org-center">设置单元格格式</td>
</tr>

<tr>
<td class="org-center">CTRL + S</td>
<td class="org-center">保存</td>
</tr>

<tr>
<td class="org-center">CTRL + Z</td>
<td class="org-center">撤销</td>
</tr>

<tr>
<td class="org-center">CTRL + F</td>
<td class="org-center">查找</td>
</tr>

<tr>
<td class="org-center">CTRL + H</td>
<td class="org-center">替换</td>
</tr>

<tr>
<td class="org-center">CTRL + ENTER</td>
<td class="org-center">快速输入</td>
</tr>

<tr>
<td class="org-center">CTRL + D</td>
<td class="org-center">快速复制上一个单元格内容</td>
</tr>

<tr>
<td class="org-center">CTRL + R</td>
<td class="org-center">快速复制左边单元格的内容</td>
</tr>

<tr>
<td class="org-center">F4</td>
<td class="org-center">调整公式的绝对引用</td>
</tr>

<tr>
<td class="org-center">CTRL + F2</td>
<td class="org-center">打印预览</td>
</tr>

<tr>
<td class="org-center">SHIFT + F11</td>
<td class="org-center">添加工作表</td>
</tr>

<tr>
<td class="org-center">ALT + =</td>
<td class="org-center">自动求和(快速使用SUM 函数)</td>
</tr>

<tr>
<td class="org-center">ALT + ENTER</td>
<td class="org-center">单元格里输入换行符</td>
</tr>

<tr>
<td class="org-center">CTRL + SPACE</td>
<td class="org-center">选中整列</td>
</tr>

<tr>
<td class="org-center">SHIFT + SPACE</td>
<td class="org-center">选中整行</td>
</tr>

<tr>
<td class="org-center">CTRL + -</td>
<td class="org-center">删除单元格,行,列</td>
</tr>

<tr>
<td class="org-center">SHIFT + CTRL + +</td>
<td class="org-center">插入单元格,行,列</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgb9891d6" class="outline-4">
<h4 id="orgb9891d6"><span class="section-number-4">1.1.5</span> 保存制作好的数据</h4>
<div class="outline-text-4" id="text-1-1-5">
<p>
电脑上编辑文档最重要的就是保存数据,因为一旦有断电或电脑故障,没有保存的数据就可能
会丢失.
</p>

<p>
<b>自动保存</b> &#x2013; 最小化损失
</p>

<p>
文档编辑软件一般都会有自动保存功能,可设置间隔多长时间自动保存编辑的文档.
</p>

<p>
Excel 里的自动保存功能位于 [文件] -&gt; [选项] -&gt; [保存] -&gt; [工作簿保存] -&gt; "保存自
动回复信息" ,保存间隔可设置为1分钟,这样每隔1分钟,Excel 软件就会自动保存编辑过的
数据,就算电脑死机了,也只会丢失这1分钟内编辑的数据,损失不大.
</p>

<p>
<b>撤销操作</b> &#x2013; 撤销错误的操作
</p>

<p>
CTRL + Z 的按键组合是撤销上一步操作的快捷键,许多文档编辑软件都有这个快捷键
</p>

<p>
<b>ESC</b> &#x2013; 退出操作
输入内容时想要暂停操作,可以按 ESC 键,就会退出输入了,因为如果按 ENTER 键就会将未
完成的内容输入到单元格,还需要按 DELETE 键删除该内容.
另外,打开了不想打开的窗口,除了用鼠标点击×图标外,还可以用 ESC 快速关闭窗口.
</p>
</div>
</div>
<div id="outline-container-org6edb9a6" class="outline-4">
<h4 id="org6edb9a6"><span class="section-number-4">1.1.6</span> 解除复杂功能,操作更简便</h4>
<div class="outline-text-4" id="text-1-1-6">
<p>
Excel 有许多高级/复杂功能,在不清楚其使用方法时会造成很多困扰,比如自动修正,首字母
大写,URL 数据自动转为超级链接等等.
</p>
<ul class="org-ul">
<li>取消修正文字: Excel 会将 hsi 自动修正为 his ,因为它认为你的拼写错误了,这在有时
候很有用,有时却很烦人,所以想要取消,可以在 [文件]-&gt;[选项]-&gt;[Excel的选项]-&gt;[校
对]-&gt;[自动更正选项] 里面取消[键入时自动替换]的勾选.</li>
<li>取消超级链接: [自动更正选项] 里取消勾选 [Internet 及网络路径替换为超链接] ,之
后Excel 就不会将输入的网址和URL 数据自动改为超链接形式了.</li>
<li>取消将数字变成日期形式: 在 Excel 单元格里输入 1-1, 1/4 这样格式的数据时,会自动
变成日期形式,如果想要正确输入,就需要在数据前面加上一个单引号: <code>'1-1</code> , <code>'1/4</code>,
或是在[设置单元格格式]里将要输入的数据形式设置为[文本],然后再输入数据.</li>
<li>工作表序号全部变成了数字: 在[Excel 的选项]里的[公式]选项卡[使用公式]里设置
[R1C1引用样式]会导致工作表的序号全部变成数字,因此当发现工作表序号全部变成数字
时可以检查这个选项.</li>
<li>消除单元格的错误提示: 单元格里的数据或公式出现问题时,单元格左上角会有带颜色的
三角形图标出现,表示单元格可能有错误,这个"错误" 有时就是我们的数据需要的样式,这
时就不需要 Excel 的自动纠错,这个功能其实很有用,但如果不想看到错误提示的标志,可
以在 [公式]里选中[错误检查],然后取消勾选[允许后台错误检查].</li>
<li>取消输入时记忆输入: 在连续输入整列数据时,如果输入了和上一个单元格相同的数据,那
么单元格会将下面的内容自动替换为相同文本,如果不需要这样的功能,可以在
[Excel的选项]里点击[高级],取消勾选[为单元格值启用记忆式键入].</li>
<li>避免"粘贴选项" 频繁出现 : 复制粘贴时会自动出现[粘贴选项],如果不经常使用这个功
能或觉得麻烦,可以在[Excel 的选项]-&gt;[高级]里点击[剪切,赋值,粘贴],取消勾选
[粘贴内容时显示粘贴选项内容]</li>
<li>工作表标签无故消失: 有时会出现工作表的标签完全不显示的情况,这时要检查
[Excel的选项]-&gt; [高级] -&gt; [此工作簿的显示选项] 勾选[显示工作表标签].</li>
<li>出现异常的3个原因: 用方向键移动单元格选中,选中的单元格没动,画面却在动;用键盘输
入文字,却变成了数字;想要改写已经输入的文字,却改写了后面的文字.这三种异常分别是
由于按下了"滚动锁定","数码锁定"和"插入键"导致的,它们分别对应键盘上的
[Scroll Lock] , [Number Lock] 和 [Insert]. 只要再分别按下这些按键,就可以解除对
应的异常了.</li>
</ul>


<blockquote>
<p>
除了这些设置之外, [Excel的选项] 里还有各种设定.在出现问题时可以在里面查看相关设
置.
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org037ebd9" class="outline-4">
<h4 id="org037ebd9"><span class="section-number-4">1.1.7</span> 共享 Excel 文件时的注意点</h4>
<div class="outline-text-4" id="text-1-1-7">
<p>
制作好的 Excel 通常会以附件形式发送给同事,顾客或客户,因此,为了能让对方顺利打开
Excel 文件,我们发送文件时也许要做好准备.
</p>
<blockquote>
<p>
Excel 有多个版本, Excel 各个版本支持的数据文件也有所不同,因此存在兼容性问题,这就
会导致一台电脑上的 Excel 数据文件在另一台电脑上可能会打不开.
</p>
</blockquote>
</div>

<div id="outline-container-org63873ff" class="outline-5">
<h5 id="org63873ff"><span class="section-number-5">1.1.7.1</span> 文件的保存形式</h5>
<div class="outline-text-5" id="text-1-1-7-1">
<p>
Excel 文件有几种保存形式.
</p>

<p>
Excel 2007 以后的版本默认以 ".xlsx" 为扩展名.因此 2007
之前的版本 Excel 2003 就无法打开 ".xlsx" 扩展名的文件. 尽管现在最新的 Excel 都到
了2019 和 365 了,但是仍然有企业在使用 Excel 2003,所以如果对方的软件为 2003 版本
的,就需要把文件转为 ".xls" ,在保存文件时将文件的保存形式设置为 "Excel 97-2003 文
件"就可以把文件保存为 ".xls" 了.
</p>

<p>
".xlsx" 扩展名的文件不能保存宏. Excel 的"宏"功能可以自动处理数据,理解为在 Excel
里的编程(应该就是集成的 VB 程序),直接保存的 ".xlsx" 文件不能保存宏,且会导致做好
的"宏"丢失,我们需要将它保存为 ".xls" 文件.
</p>

<p>
".xls" 文件不能处理超过 65536 行的数据. ".xls" 文件有大小限制,最多只能保存 65536
行的数据,因此超过该大小的数据需要用 ".xlsx" 文件,而如果又需要保存宏,则应该保存文
件为 ".xlsm" 类型(Excel 启用宏的工作表),这样就既可以处理超过 65536 行数据,也可以
保存宏了.
</p>
</div>
</div>

<div id="outline-container-org4e4a0c1" class="outline-5">
<h5 id="org4e4a0c1"><span class="section-number-5">1.1.7.2</span> 保留1个新建工作簿的初期工作</h5>
<div class="outline-text-5" id="text-1-1-7-2">
<p>
Excel 2013 版本之后,新建的 Excel 文件最初的工作表为1个,在 Excel 2013 之前,新建的
Excel 文件最初的工作表为3个. 如果使用 Excel 2013 之前的版本,在编辑了数据文件到一
个表中之后,将文件发送给对方,对方会疑惑怎么文件中会有三个表,并去逐一检查,却发现剩
下两个都是空白的&#x2026;尽管看起来没什么大事,但毕竟不是很完美,这也是需要注意的细节,这
个细节可以在 [文件]-&gt;[选项]-&gt;[常规]-&gt;[新建工作簿时]里点击[包含的工作表数]里设置
为1,这样就会在新建文件时只默认一个工作表了.
</p>

<p>
另外,有人说工作时工作表的数量很容易就超过三个了,那让它在一开始就是3个不行嘛?但如
果最后少于三个,岂不是还要特意去删除?而且就我的发现,删除必须要用鼠标点击,对于想要
尽可能少的操作鼠标的人来说就很麻烦了,还不如开始只有一个,需要时使用 <code>Shift F11</code>
快捷键来新增工作表.
</p>
</div>
</div>

<div id="outline-container-orgc72802c" class="outline-5">
<h5 id="orgc72802c"><span class="section-number-5">1.1.7.3</span> 确认"设置打印区域"</h5>
<div class="outline-text-5" id="text-1-1-7-3">
<p>
在发送文件之前,最好先确认一下打印区域,因为即使只有一张表,但打印区域可能会导致实
际打引出来的多于一张纸,比如,一个比较大的表格,想要完整打印在一张纸上,需要横向打印
在一张 A4 纸上,可以在 [页面布局]-&gt;[纸张方向]-&gt;[横向] 里设置然后在
[视图]-&gt; [分页预览] 里可以看到有线条表示打印时的分页,我们用鼠标拖动线条,可以将打
印页面调整为1张页面打印.
</p>

<p>
如果不确认上面的打印区域,自己只是偷了一下懒,但可能会给别人带来麻烦,也可能为自己
增加不必要的工作,所以一定要提前设置好打印的页面.
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-orgd038f4f" class="outline-3">
<h3 id="orgd038f4f"><span class="section-number-3">1.2</span> 如何在 Excel 中输入函数</h3>
<div class="outline-text-3" id="text-1-2">
</div>
<div id="outline-container-org635238f" class="outline-4">
<h4 id="org635238f"><span class="section-number-4">1.2.1</span> 输入公式的操作步骤</h4>
<div class="outline-text-4" id="text-1-2-1">
<p>
输入公式虽然简单,但不使用正确的方法还是会有效率上的缺失的.
</p>

<ol class="org-ol">
<li>切换半角模式: 公式必须以半角模式输入,全角的字符是不会被认为是公式处理的.</li>
<li>从 "=" 开始输入: 等号开头才会被识别成公式.</li>
<li>编辑公式: 用鼠标/光标选中要处理的单元格,或是直接键入要计算的单元格的引用,来输
入公式.</li>
<li>按回车键: 按下回车才能确认公式的输入,以及单元格的公式会计算出结果作为返回值显
示在单元格的数据里.</li>
</ol>


<p>
例如,A1 单元格中的数据为数值类型的1, 然后在某个单元格中输入 <code>=A1+1</code> 按回车后,该
单元格中会自动显示公式的计算结果 2. 这个操作里 <code>=A1+1</code> 就是公式, 显示的 2 就是返
回值.
</p>
</div>
<div id="outline-container-org18c18d3" class="outline-5">
<h5 id="org18c18d3"><span class="section-number-5">1.2.1.1</span> 巧用函数,简化输入过程</h5>
<div class="outline-text-5" id="text-1-2-1-1">
<p>
提到公式,就不得不提函数,函数是可以在公式里使用的特殊功能,它就像是在 Excel 里专门
处理数据的编程语言,只不过没有编程语言的语法等概念,它就只有一种用法,就是调用函数,
比如 SUM(arg1, agr2, &#x2026;) 函数就用来将参数里的所有数据求和,等价于
<code>arg1+arg2+...</code> 如果只有两个或三个数据需要求和,可以手动相加,但数量一旦多起来了,
必定要使用函数,不然求一千条数据之和总不能一个个写吧.
</p>

<p>
类似的处理数值或加工文本的函数还有很多,比如乘法 PRODUCT(A1:A5) 计算
A1,A2,A3,A4,A5 这5个单元格里的数据的乘积, SUM(A1:A5) 则是计算 A1 到 A5 的和.
</p>

<p>
由于EXCEL 中函数非常之多,所以没有必要全部记住,找出自己需要掌握的函数,并且熟练运
用才是最要紧的.
</p>

<blockquote>
<p>
另外,在我自己练习以及上网搜索的过程中,发现很多函数都有功能上的重叠,比如 SUMIF 和
SUMIFS 都是对符合条件的区域求和,前者只限制为一个条件,后者可以有多个条件,那么
SUMIFS 的功能完全可以替代 SUMIF ,这样掌握了 SUMIFS 就没有必要掌握 SUMIF 了.
</p>

<p>
遇到不会或忘记了用法的函数,可以使用 EXCEL 自带的帮助来查看函数的说明文档.只要在
单元格公式里输入函数名,就会弹出一个显示函数可选参数的窗口,点击该窗口就可以看到相
应函数的说明文档了.
</p>
</blockquote>
</div>
</div>
<div id="outline-container-orgecc471a" class="outline-5">
<h5 id="orgecc471a"><span class="section-number-5">1.2.1.2</span> 输入函数的5个步骤</h5>
<div class="outline-text-5" id="text-1-2-1-2">
<ol class="org-ol">
<li>半角等号: 函数只在公式里起作用,因此第一步就是要输入半角的等号,表示这是一个公
式类型的数据.</li>
<li>输入正确函数名: 在输入函数过程中会出现候选函数名单,可以用鼠标点击或键盘键入完
整的函数名或是使用 <code>TAB</code> 键选中函数,除了键入之外的两种方法都会自动键入一个左
括号,自己键入则需要自己输入左括号.</li>
<li>输入参数: 输入参数时一般会有提示,按照提示输入正确完整的参数.</li>
<li>输入右括号.</li>
<li>确认格式完整, 函数的结构即函数的格式,函数格式必须完整正确:
<code>=funcName(arg1,arg2,...)</code></li>
</ol>
</div>
</div>
<div id="outline-container-orgc0ee7df" class="outline-5">
<h5 id="orgc0ee7df"><span class="section-number-5">1.2.1.3</span> 如何快速选择单元格范围</h5>
<div class="outline-text-5" id="text-1-2-1-3">
<ul class="org-ul">
<li>选择单个单元格: 使用光标点击目标单元格或使用键盘的方向键选择单元格.</li>
<li>选择多个单元格的范围:
<ul class="org-ul">
<li>点击起始单元格,用鼠标拖拽到终止单元格,就可以选中整个矩形区域范围.</li>
<li>选中起始单元格,按下 <code>Shift</code> 键和方向键,可以扩大单元格的选择范围.</li>
</ul></li>
<li>选择数据连续的单元格范围: 在选择多个单元格范围的操作基础上,加上 <code>Ctrl</code> 键就能
快速选中连续的有数据的单元格范围.</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org3973fc7" class="outline-4">
<h4 id="org3973fc7"><span class="section-number-4">1.2.2</span> 熟练使用"引用",快速计算</h4>
<div class="outline-text-4" id="text-1-2-2">
</div>
<div id="outline-container-org9d496a1" class="outline-5">
<h5 id="org9d496a1"><span class="section-number-5">1.2.2.1</span> 活用单元格中的原始数据</h5>
<div class="outline-text-5" id="text-1-2-2-1">
<p>
Excel 的引用功能可以让我们不需要输入完整数据就可以使用单元格中的数据.
</p>

<p>
Excel 将表格按行和列进行索引,行数用数字表示,列数用大写字母表示,格式为列数在前,行
数在后,例如 A1, 表示第一列的第一行.
</p>

<p>
这种索引就叫做 "引用单元格", 可以理解为 "使用此单元格的数值", 选中公式所在的单元
格,按下 <code>F2</code> ,公式里引用的所有单元格都会被有色线框圈起.
</p>

<blockquote>
<p>
从属和引用单元格区分: Excel 公式里有个功能可以将公式里引用的单元格以箭头标识:
[追踪引用单元格] 以及 [追踪从属单元格],来表示从属关系,所谓引用和从属关系简单理解
就是谁使用了谁, 在 A1 单元格的公式里使用了 B1 这个单元格引用,那么就说 A1 的引用
单元格里有 B1(A1 引用了 B1), 而 B1 是被引用的对象,所以说 B1 是 A1 的从属单元格,
我的理解就是被引用的是发起引用的单元格的从属,追踪从属就是看该单元格被哪些其他单
元格引用了,那么反之,追踪引用就是看这个单元格里的公式引用了哪些单元格.
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org6408925" class="outline-5">
<h5 id="org6408925"><span class="section-number-5">1.2.2.2</span> 必须掌握的运算符</h5>
<div class="outline-text-5" id="text-1-2-2-2">
<ul class="org-ul">
<li>四则运算符: "+", "-", "*", "/" 分别代表四则运算加减乘除,在公式中使用它们进行算术
运算.</li>
<li>文本连接符: "&amp;" 可以连接文本.</li>
<li>比较运算符: "&gt;" 大于, "&lt;"小于 , "&gt;=" 大于等于, "&lt;=" 小于等于, "=" 等于, "&lt;&gt;"
不等于.</li>
<li>引用运算符: <code>:</code> 冒号作为区域运算符,生成一个对冒号两边的两个单元格之间的所有单
元格的引用, <code>,</code> 逗号作为联合运算符,将逗号两边的引用合并为一个引用, " " 空格作
为交集运算符,返回空格两边引用区域所共有的单元格的引用.</li>
</ul>

<blockquote>
<p>
包含数字数据的文本值,如 "1","2" 这样的值,也可以用四则运算符进行四则运算,四则运算
符会自动把它们都转为数值类型然后进行计算,但不要用 "a" 这样的文本值参与四则运算,
这回导致返回一个错误值.
</p>

<p>
文本连接符也可以连接数值类型数据,并且会自动将连接的数据转为文本类型后进行连接,如
公式值 <code>="text" &amp; 123</code> 的结果是文本值 <code>text123</code> .
</p>

<p>
比较运算符可以比较文本,数值,规则是 文本值&gt;数值,即任意的文本值都大于任意的数值.
</p>

<p>
引用运算符是使用函数时需要理解的运算符, <code>A1:C1</code> 就是生成一个表示 A1 到 C1 这个区
域所有单元格的引用,它等价于 <code>A1,B1,C1</code>, 需要注意的是联合运算符逗号与函数里分隔参
数的逗号,只有当逗号两边都是单元格引用时才可以视为该逗号是联合运算符,不然它就是参
数分隔符.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orga4b0d8c" class="outline-5">
<h5 id="orga4b0d8c"><span class="section-number-5">1.2.2.3</span> 复制带公式单元格时的陷阱</h5>
<div class="outline-text-5" id="text-1-2-2-3">
<p>
复制单元格就是之前提到的快捷键操作(Ctrl-D 或 Ctrl-R), 在使用它们复制带公式的单元
格时,会出现莫名的错误,因为复制单元格的操作会保持单元格中公式的相对位置,比如:
<code>=B1/B11</code> 这个除法公式,在使用 <code>Ctrl-D</code> 复制到下一个单元格时就会把单元格中的引用
整体向下移动一格,即: <code>=B2/B12</code>, 这种会变动的单元格引用叫做"相对引用".想要引用在
复制过程中保持不变就要看下面的 "绝对引用" 部分.
</p>

<blockquote>
<p>
相对引用的单元格引用适合需要变化的计算,如果需要不变的,例如,求数据在总数中的占比,
总数是需要保持不变的,那就需要绝对引用了.
</p>
</blockquote>
</div>
</div>
<div id="outline-container-orgcb01c9e" class="outline-5">
<h5 id="orgcb01c9e"><span class="section-number-5">1.2.2.4</span> 利用 "F4" 和 "$" 高效运用 "绝对引用"</h5>
<div class="outline-text-5" id="text-1-2-2-4">
<p>
绝对引用就是让单元格引用在操作过程中保持不变,而这个"绝对"可以分为"部分"绝对和"全
部"绝对,因为引用是由行和列构成的,所以只让行或列保持不变的是"部分"绝对,而行列全部
不变的就是"全部"绝对.而不变的标识就是 <code>$</code> 美元符号,该符号放在行/列数前面就表示该
引用的行/列固定不变,例如:
</p>
<pre class="example">
$A$1 固定行和列
A$1 固定行
$A1 固定列
A1 行列都不固定,是相对引用
</pre>

<p>
一个切换单元格引用"相对"/"绝对"状态的快捷键就是 <code>F4</code> ,在光标线位于一个引用中时,
多次按下 <code>F4</code> 就可以在上面例子的四种形式引用中循环切换.
</p>
</div>
</div>
<div id="outline-container-org3ad4eec" class="outline-5">
<h5 id="org3ad4eec"><span class="section-number-5">1.2.2.5</span> 无需记住错误值的种类和意义</h5>
<div class="outline-text-5" id="text-1-2-2-5">
<p>
在输入公式时经常会看到 "#DIV/0!", "#NAME?" , "#N/A" 这一类以 <code>#</code> 开头的值,它们就
是"错误值",是因为输入的公式有误,比如公式里的除数为0就会产生 "#DIV/0!" 的错误值.
</p>

<p>
错误值种类有很多,但不需要特意记住它们的含义,只要能判断下面三个就够了:
</p>
<ul class="org-ul">
<li><code>#N/A</code> : (VLOOKUP函数)的检索值不存在</li>
<li><code>#DIV/0!</code> : 被除数为0</li>
<li><code>#REF!</code> : 引用单元格已经被删除</li>
</ul>


<blockquote>
<p>
关于错误值处理的问题,重要是掌握不显示错误值的方法.参阅 <a href="#orgf1721a9">1.4.8</a>.
</p>
</blockquote>
</div>
</div>
</div>
</div>
<div id="outline-container-org6c43374" class="outline-3">
<h3 id="org6c43374"><span class="section-number-3">1.3</span> 需要事先掌握的6个函数</h3>
<div class="outline-text-3" id="text-1-3">
</div>
<div id="outline-container-orgd054d58" class="outline-4">
<h4 id="orgd054d58"><span class="section-number-4">1.3.1</span> 根据条件改变答案&#x2013;IF 函数</h4>
<div class="outline-text-4" id="text-1-3-1">
</div>
<div id="outline-container-org8199e03" class="outline-5">
<h5 id="org8199e03"><span class="section-number-5">1.3.1.1</span> IF 函数的基础知识</h5>
<div class="outline-text-5" id="text-1-3-1-1">
<p>
IF 函数的格式:
</p>

<p>
<code>=IF(条件表达式,条件为真时执行的语句,条件为假时执行的语句)</code>
</p>

<p>
这个函数的理解为: 如果 "条件表达式" 的结果为真,则执行 "条件为真时执行的语句", 否
则执行 "条件为假时执行的语句".
</p>

<p>
例如:公式 <code>=IF(B2&gt;80,"A","B")</code> ,如果 B2 大于80,则公式的返回值为文本值 <code>A</code>, 否则
是文本值 <code>B</code>.
</p>
</div>
</div>
<div id="outline-container-org80b85df" class="outline-5">
<h5 id="org80b85df"><span class="section-number-5">1.3.1.2</span> 如何判断复数条件</h5>
<div class="outline-text-5" id="text-1-3-1-2">
<p>
在判定复数条件时,可以让多个 IF 函数嵌套在一个公式里.比如,"B2 单元格的值大于等于
80为A, 大于等于50 为B, 49以下为 C", 就可以表达为下列公式:
</p>
<pre class="example">
=IF(B2&gt;=80,"A",IF(B2&gt;=50,"B","C"))
</pre>
<p>
这个公式初学者看起来可能很复杂,但其实它只是在重复 IF 函数的执行逻辑:
如果条件表达式 (B2&gt;=80) 为真,则返回第二个参数 (<code>A</code>), 否则,执行第三个参数的语句
(IF(B2&gt;=50,&#x2026;)).
</p>

<p>
这种 IF 函数里嵌套IF 的做法,叫做"多重条件函数", 在 Excel 2007 以后的版本里,最多
可以有 64 个 IF 函数嵌套在一起. 但是,嵌套的太多,会让自己都难以理解自己编写的公式.
</p>
</div>
</div>
</div>

<div id="outline-container-orgd53e781" class="outline-4">
<h4 id="orgd53e781"><span class="section-number-4">1.3.2</span> 本月销售额&#x2013;SUM 函数</h4>
<div class="outline-text-4" id="text-1-3-2">
</div>
<div id="outline-container-org09af06e" class="outline-5">
<h5 id="org09af06e"><span class="section-number-5">1.3.2.1</span> SUM 函数的基础</h5>
<div class="outline-text-5" id="text-1-3-2-1">
<p>
SUM 函数的格式:
</p>

<p>
<code>=SUM(Number1,Number2,...)</code>
</p>

<p>
它对函数内所有参数进行求和,它本质上就是进行加法运算,但是又和四则运算符 "<del>" 有所
不同, "</del>" 会尝试将其连接的所有类型数据转换为数值类型然后相加,例如,"1",A1 这种,其
中,单元格引用的数据如果也是可以转换为数值的文本值,那 "+" 也会进行转换, 但是 SUM
函数在这点有所不同,如果参数是 "1" 这种,SUM 会将其转换为数值,并参与求和计算,而如
果参数是一个引用,例如 A1 而A1 里存放的是文本值,它就直接将其视为0,而不管A1 里的文
本值是不是能转换为数值.
</p>

<p>
假设 A1 存放的数据为 <code>'23</code> 即一个文本类型的 <code>23</code> ,那么 <code>=SUM(A1,1)</code> 的返回值为1,
而 <code>=A1+1</code> 的返回值会是 24.
</p>

<blockquote>
<p>
另外,LibreOffice 里的 SUM 函数并不是和 Excel 的 SUM 一样, LibreOffice 的 SUM 不
能将 <code>"1"</code> 这种文本类型的字面值作为参数.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org25e869b" class="outline-5">
<h5 id="org25e869b"><span class="section-number-5">1.3.2.2</span> 计算连续单元格范围内的总和&#x2013;ΣSUM</h5>
<div class="outline-text-5" id="text-1-3-2-2">
<p>
ΣSUM 函数是 SUM 函数的一种,它能自动输入 SUM 函数和计算范围.可以在[开始]选项卡的
[编辑]部分里找到 Σ点击就可以使用 ΣSUM 了; 也可以使用快捷键 <code>Alt-=</code>. 该函数会自动
将选中单元格之上的所有连续单元格作为 SUM 函数的参数来进行求和并返回求和结果.
</p>
</div>
</div>

<div id="outline-container-org09a2af5" class="outline-5">
<h5 id="org09a2af5"><span class="section-number-5">1.3.2.3</span> 如何求多个分开的单元格的总和</h5>
<div class="outline-text-5" id="text-1-3-2-3">
<p>
按住 Ctrl 键的同时使用鼠标点击单元格就可以逐个选中分开的单元格,那么在输入 SUM 函
数时也可以用这种 Ctrl 加上鼠标点选的方式对分开的单元格求和,每点选一个单元格,SUM
函数就会自动生成一个该单元格引用的参数,选择完毕后,输入右括号,回车确认就可以了.
</p>

<p>
另外,也可以直接用键盘键入单元格的引用.
</p>
</div>
</div>

<div id="outline-container-org862af4b" class="outline-5">
<h5 id="org862af4b"><span class="section-number-5">1.3.2.4</span> 提高乘法运算,字符串混合输入的效率</h5>
<div class="outline-text-5" id="text-1-3-2-4">
<p>
四则运算符号的乘法符号 <code>*</code> 一次只能连接两个引用,想要多个引用相乘需要使用多个 <code>*</code>
号,但是和 <code>+</code> 有对应的 SUM 函数一样, <code>*</code> 也有对应的函数,就是 PRODUCT 函数:
</p>

<p>
<code>=PRODUCT(A1:E1)</code> 会计算 A1 到 E1 这个区域的所有单元格的乘积. 等价于:
<code>=A1*B1*C1*D1*E1</code>
</p>

<p>
除此之外,字符串连接符 "&amp;" 也有对应的函数: CONCATENATE 函数.
</p>

<p>
<code>=CONCATENATE(A1:E1)</code> 等价于 <code>=A1&amp;B1&amp;C1&amp;D1&amp;E1</code>
</p>

<p>
另外呢,由于除法不大可能会需要大量连续数据进行除法,所以 Excel 没有专用的除法函数,
使用除法运算符就够了,而且也可以使用 PRODUCT(A1,1/B1) 这种形式来表示 A1/B1 的除法.
同样也没有减法函数,但可以用 SUM(A1,-A2) 来表示 A1-A2 的减法.
</p>
</div>
</div>
</div>
<div id="outline-container-org41e818c" class="outline-4">
<h4 id="org41e818c"><span class="section-number-4">1.3.3</span> 计算客户名单的人数&#x2013;COUNTA 函数</h4>
<div class="outline-text-4" id="text-1-3-3">
<p>
COUNTA 函数用来统计非空单元格的个数:
</p>

<p>
<code>=COUNTA(arg1,arg2,...)</code>
</p>

<p>
它会统计参数里非空单元格的个数,即只要单元格内有数据,就会计入统计结果.
</p>
</div>
<div id="outline-container-org8ed43ef" class="outline-5">
<h5 id="org8ed43ef"><span class="section-number-5">1.3.3.1</span> 与 COUNT 函数的区别</h5>
<div class="outline-text-5" id="text-1-3-3-1">
<p>
一个与 COUNTA 非常相似的函数就是 COUNT 函数, COUNT 只会统计单元格为数值的个数.
即, COUNTA 的参数里只要有数据,不管是文本值,错误值,数值,只要有值就纳入统计范围,
而 COUNT 只统计数据为数值的单元格个数.
</p>
</div>
</div>
</div>

<div id="outline-container-orge1a2f13" class="outline-4">
<h4 id="orge1a2f13"><span class="section-number-4">1.3.4</span> 按照负责人分别计算销售情况&#x2013;SUMIF 函数</h4>
<div class="outline-text-4" id="text-1-3-4">
</div>
<div id="outline-container-org1851a16" class="outline-5">
<h5 id="org1851a16"><span class="section-number-5">1.3.4.1</span> SUMIF 函数的基础</h5>
<div class="outline-text-5" id="text-1-3-4-1">
<p>
<code>=SUMIF(判断区域, 判断条件[,求和区域])</code>
</p>

<p>
SUMIF 有三个参数,其中第三个是可选的,如果第三个省略,那么第一个参数就默认作为第三
个参数.
</p>

<p>
翻译过来就是, SUMIF 对 [判断区域] 里的所有单元格应用 [判断条件] 如果满足条件,则
将 [求和区域] 中对应的单元格纳入求和范围,不满足则不纳入求和范围,而如果[求和区域]
这个参数省略了,那么 [判断区域] 就自动作为求和区域,即如果[判断区域] 的某个单元格
满足了条件,就将该单元格纳入求和范围.
</p>
</div>
</div>

<div id="outline-container-org8ce51ac" class="outline-5">
<h5 id="org8ce51ac"><span class="section-number-5">1.3.4.2</span> 计算每个人的销售情况</h5>
<div class="outline-text-5" id="text-1-3-4-2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">A</td>
<td class="org-right">B</td>
<td class="org-left">C</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">负责人</td>
<td class="org-right">销售额</td>
<td class="org-left">商品代码</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">吉田</td>
<td class="org-right">9800</td>
<td class="org-left">A002</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">三缸</td>
<td class="org-right">8400</td>
<td class="org-left">A002</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-left">佐藤</td>
<td class="org-right">120</td>
<td class="org-left">A003</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left">吉田</td>
<td class="org-right">2700</td>
<td class="org-left">C001</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-right">6</td>
<td class="org-left">安达</td>
<td class="org-right">3600</td>
<td class="org-left">C002</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-right">&#x2026;</td>
<td class="org-left">&#x2026;</td>
<td class="org-right">&#x2026;</td>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#x2026;</td>
</tr>
</tbody>
</table>


<p>
现在我们要在下面的表格中统计每个人的销售情况:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">G</td>
<td class="org-left">H</td>
<td class="org-left">I</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">负责人</td>
<td class="org-left">销售额</td>
<td class="org-left">占比</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">吉田</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">三缸</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-left">佐藤</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left">安达</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">6</td>
<td class="org-left">合计</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
在H2 单元格,我们可以使用公式 <code>=SUMIF(A:A, G2, B:B)</code> ,使用快速复制(Ctrl-D)就可以
将剩下的公式全都填充完毕,填充完毕后将得出的数字进行比较,才更有意义,因此我们可以
用之前说的 "绝对引用" 来求销售额占比,在 I2 单元格使用公式 <code>=H2/$H$6</code> 然后快速复
制,就可以得出所有负责人的销售额占比了.
</p>
</div>
</div>
</div>

<div id="outline-container-orgaf8f1ed" class="outline-4">
<h4 id="orgaf8f1ed"><span class="section-number-4">1.3.5</span> 参加名单中,有多少人出席&#x2013;COUNTIF 函数</h4>
<div class="outline-text-4" id="text-1-3-5">
</div>
<div id="outline-container-orgc44129a" class="outline-5">
<h5 id="orgc44129a"><span class="section-number-5">1.3.5.1</span> COUNTIF 函数的基础</h5>
<div class="outline-text-5" id="text-1-3-5-1">
<p>
<code>=COUNTIF(统计范围, 判断条件)</code> :
在统计范围中的单元格符合判断条件的就纳入统计范围,否则不计数.
</p>

<p>
例如:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">A</td>
<td class="org-left">B</td>
<td class="org-left">C</td>
<td class="org-left">D</td>
<td class="org-left">E</td>
</tr>

<tr>
<td class="org-left">参加者</td>
<td class="org-left">是否参加</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">△</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">吉田</td>
<td class="org-left">△</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">○</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">山岗</td>
<td class="org-left">○</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">╳</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">佐藤</td>
<td class="org-left">╳</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">松田</td>
<td class="org-left">△</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
<p>
在 E1 单元格输入公式 <code>=COUNTIF(B:B, D1)</code> 就是统计 B 列中单元格数据与 D1 相同的单
元格个数. B 列中有两个三角形,所以公式的返回值为 2,用鼠标拖拽或 Ctrl+D 可将剩下的
E2,E3 里自动输入公式,它们的结果都会是 1,因为圆形和叉都只出现了一次.
</p>
</div>
</div>
<div id="outline-container-org9ad7765" class="outline-5">
<h5 id="org9ad7765"><span class="section-number-5">1.3.5.2</span> 计算每名销售人员的销售数量</h5>
<div class="outline-text-5" id="text-1-3-5-2">
<p>
在一个表格中,一条记录表示一个商品由谁卖出:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">A</td>
<td class="org-left">B</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-left">操作人员</td>
<td class="org-left">商品代码</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-left">张三</td>
<td class="org-left">A0001</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#x2026;</td>
</tr>
</tbody>
</table>

<p>
那么和上面判断出席人数一样,我们可以统计出每个人售出了多少件商品.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">E</td>
<td class="org-left">F</td>
</tr>

<tr>
<td class="org-left">人员</td>
<td class="org-left">售出商品总数</td>
</tr>

<tr>
<td class="org-left">张三</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">李四</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
在单元格 F2 中填入 <code>=COUNTIF(A:A, E2)</code> 就可以统计出所有由张三卖出的商品记录条数.同
理 <code>=COUNTIF(A:A, E3)</code> 可以统计出所有由李四卖出的商品记录条数.
</p>

<blockquote>
<p>
通过 COUNTIF 函数,我们还可以检查数据是否重复,确认指定数据是否存在,检查单元格中是
否包含指定文本等. 通常的使用思路就是只要统计出的结果大于1,就是出现重复/数据存在
等等.
</p>

<p>
想要验证某条数据是否重复而不仅仅检查单个单元格的数据是否重复,还可以使用 COUNTIFS
函数, 它可以看作是多个 COUNTIF 的组合,只有所有的条件满足了才会进行统计, COUNTIFS
的参数是成对出现的,第一个参数是判断范围,第二个是判断条件,第三个是判断范围,第四个
是判断条件&#x2026;
</p>

<p>
举个例子,判断 A1 到 C3 这三行记录里是否有一条记录与第二条记录(A2:C2)相同:
<code>=COUNTIFS(A1:A3,A2,B1:B3,B2,C1:C3,C2)</code>
</p>
</blockquote>
</div>
</div>
</div>
<div id="outline-container-orgc012073" class="outline-4">
<h4 id="orgc012073"><span class="section-number-4">1.3.6</span> 输入商品名,自动显示价格&#x2013;VLOOKUP 函数</h4>
<div class="outline-text-4" id="text-1-3-6">
</div>
<div id="outline-container-orge5981ec" class="outline-5">
<h5 id="orge5981ec"><span class="section-number-5">1.3.6.1</span> VLOOKUP 函数的基础</h5>
<div class="outline-text-5" id="text-1-3-6-1">
<p>
<code>=VLOOKUP(要查找的值, 函数作用区域, 需要的值在函数作用区域中的列数,[查找方式])</code>
</p>

<p>
<code>=VLOOKUP(lookup_value, table_array, col_index_num,[range_lookup])</code>
</p>

<p>
VLOOKUP 是按列查找(V 表示 vertical) 还有与之对应的 HLOOKUP 表示按行查找,以及按行
或列查找的 LOOKUP(不推荐使用了,因为有了改进的版本 VLOOKUP 和 HLOOKUP).
第一个参数是需要查找的值, 第二个参数是函数查找值和返回值的区域,该区域的第一列必
须是要查找的值的所在列,该区域也必须包含返回值所在的列,第三个参数是返回值所在的列
位于第二个参数区域里的列数,列数从1开始,第四个参数是查找方式,是一个可选的逻辑值,
可为 TRUE 或 FALSE, TRUE 是省略是的默认值,它假定表的第一列(要查找的值的所在列)是
按数字或字母从小到大排序好的,然后直接搜索最近的值(近似查找,如果没找到匹配的值,就
搜索与它最相近的值,所以才要求第一列排序好,这个最近不是说数值差值最小,而是按照从
小到大排序,应该在查找值之上的值), FALSE 则表示在第一列中精确查找. 
</p>

<blockquote>
<p>
对近似查找的运行逻辑猜想: 近似查找需要(假设)查找列已经按从小到大排序好了,这可能
因为它就是按照大小来查找的,这样就不用每次都查找整个列的数据了,在查找到比查找值大
的数据时还没有找到完全匹配的,就表示下面所有都不可能有完全匹配的了,它就会返回一个
查找列中比查找值小的最近的值. 例如近似查找 10, 数据里只有 1,3,11, 返回的是3 而不
是11,如果是按差值最小的"最近",那应该返回11,但实际返回的是3.所以上面的猜想有一定
的道理.
</p>
</blockquote>

<blockquote>
<p>
精确查找和近似查找的区别:
</p>

<p>
精确查找必须是单元格里的数据完全匹配时才认为是找到了结果,近似查找在找不到和查找
值一样的数据时,会转而查找与查找值最近的值.
</p>

<p>
近似查找在对由中文开头的值进行查找时是没有找不到时查找最相近的值的效果的,它只对
数字和字母开头的数据有效,想要查找中文内容,推荐使用精确查找和通配符(正则)相结合.
</p>

<p>
例如:单元格 A2 中的数据是 <code>张三丰</code> 使用近似查找来查找值 "张三"
(<code>=VLOOKUP("张三", A1:A10,1,TRUE)</code>),就不会找到A2 单元格,只会返回 <code>#N/A</code> 的错误值
(参见 <a href="#org3ad4eec">1.2.2.5</a>), 近似查找查找全中文内容,就需要输入完整的值,这
里的话就是 <code>=VLOOKUP("张三丰", A1:A10,1,TRUE)</code> (近似查找里是无法识别通配符的),使
用精确查找就可以使用通配符来实现模糊查找: <code>=VLOOKUP("张*",A1:A10,1,FALSE)</code> 则会
查找第一个数据以 "张" 开头的单元格,张三丰就在查找范围内.
</p>

<p>
只有中文在两种查找之间会有难懂的地方,对数字和英文就很好理解了,精确查找仍然是一样
要完全匹配或是与通配符一起实现模糊查找,近似查找就是想找数字 10 ,但查找列里没有,
只有3,7,11, 那公式就会返回7. 在 "A你", "B我", "C他" 中近似查找 "C", 结果会返回
"B我" 
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org9a9b7a3" class="outline-5">
<h5 id="org9a9b7a3"><span class="section-number-5">1.3.6.2</span> 用 "整列指定"</h5>
<div class="outline-text-5" id="text-1-3-6-2">
<p>
前面我们都用两个单元格引用加上区域运算符表示单元格区域,这样用很精确,如
<code>$F$1:$G$10</code> 但如果后续要在单元格区域的基础上新增数据,那么我们函数里对应的单元格
区域也需要修改,这样会很麻烦.
</p>

<p>
所以我们有一种指定整行或整列范围的单元格应用形式: <code>行号:行号</code> 或 <code>列号:列号</code> 这
样就可以指定整行或整列的范围,后续在该行/列里增加了数据也不需要去修改公式了.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orga30d9c1" class="outline-3">
<h3 id="orga30d9c1"><span class="section-number-3">1.4</span> 通过应用与组合,提升函数威力</h3>
<div class="outline-text-3" id="text-1-4">
<p>
即使掌握了所有的 Excel 函数,对实际生产力也没有多大帮助,重要的是要知道"如何组合使
用单个或多个函数".
</p>

<p>
比起掌握某种特定用法的技巧,学会如何 "构思" 才是更重要的.
</p>

<p>
我认为学习函数的路径就是掌握一般常用的函数用法,然后在具体需求实例中学习特定的使
用技巧,最后再根据这些使用技巧自己总结出如何利用函数特性来组合函数.
</p>

<blockquote>
<p>
到这里已经学了基础的函数用法了,这章开始作者就开始讲解实际的应用场景,根据这些案例
我们可以学到如何组合函数是最好的,学不到的话,记住特定的组合用法也能有很大帮助.
</p>
</blockquote>
</div>
<div id="outline-container-orgfc53d34" class="outline-4">
<h4 id="orgfc53d34"><span class="section-number-4">1.4.1</span> 判断单元格中是否包含特定的字符串</h4>
<div class="outline-text-4" id="text-1-4-1">
</div>
<div id="outline-container-org7380d3b" class="outline-5">
<h5 id="org7380d3b"><span class="section-number-5">1.4.1.1</span> 就算特定地址区域的客户人数</h5>
<div class="outline-text-5" id="text-1-4-1-1">
<p>
"想要从客户数据中筛选出太阳系地球村的客户人数"
</p>

<p>
想要实现上面的需求,有两个步骤就行,第一个是判断地址是否含有 "太阳系地球村" 这几个
字,第二个就是将包含"太阳系地球村"的单元格计数.
</p>

<p>
根据上面的思路,我们会发现与前面学的 COUNTIF 函数的逻辑非常相似,判断条件只有一个,
满足判断条件的就计数,反之就不计数,因此我们可以直接用该函数: 假设地址数据都在 C
列 <code>=COUNTIF(C:C,"*太阳系地球村*")</code> 这样就可以统计出地址里含有 "太阳系地球村" 的
单元格个数了.
</p>

<p>
也有不理解 COUNTIF 逻辑,只记得前面用 COUNTIF 判断过是否符合某个条件的例子的,他们
可能会想先用 COUNTIF 函数确定是否含有"太阳系地球村",含有的结果为1,不含的就结果为
0,那么就新建一列数据来存放对每个地址的单元格进行判断的结果,最后用 SUM 函数相加也
可以得出一样的结果.
</p>

<blockquote>
<p>
实际上书里这部分只讲了用 COUNTIF 和 SUM 的例子,没有只使用 COUNTIF 的例子,我是因
为在其他书里学习过 COUNTIF 函数,也在 Excel 的帮助里查看过它的文档,所以才知道
COUNTIF 的使用逻辑和用法,才会只用 COUNTIF 的用法的.如果其他函数也都能像 COUNTIF
这样运用,那我应该能说自己熟练使用 Excel 了吧.
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org5d01a85" class="outline-5">
<h5 id="org5d01a85"><span class="section-number-5">1.4.1.2</span> 如何搜索更多的特定区域</h5>
<div class="outline-text-5" id="text-1-4-1-2">
<p>
上面查找了 "太阳系地球村" 的客户人数,那如果需要查找 "火星村", "月亮村" 之类的地
址怎么办呢?
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#x2026;</td>
<td class="org-left">地址</td>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">太阳系火星村</td>
<td class="org-left">太阳系地球村</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#x2026;</td>
</tr>
</tbody>
</table>

<p>
这里就需要一定的辅助了,因为我们不知道到底有多少的"村"要去统计,所以不可能像之前一
样直接把 "某某村" 写死在公式里,那我们就可以借助单元格引用来替代要查找的值,这样,
一个公式就可以对多个查询使用了. 
</p>

<p>
前面讲过文本连接符 "&amp;" ,它可以将文本进行连接,这里我们就可以利用它将通配符和单元
格引用连接起来: <code>"*" &amp; E1 &amp; "*"</code> 就把单元格 E1 的值与两个通配符 "<b>" 连接起来了,
假设 E1 就是 "太阳系火星村" ,那么 ="</b>" &amp; E1 &amp; "<b>"= 在公式里就等价于
="*太阳系火星村</b>"<code>,同样的把 E1 换成 F1 就等价与 ="*太阳系地球村*"</code> 了.
</p>

<blockquote>
<p>
利用单元格引用而不把数据写死的一个好处就是,可以利用鼠标拖拽或 Ctrl+D 或 Ctrl+R
的快捷键来快速复制公式,且公式里的单元格引用会根据位置自动变化.
</p>
</blockquote>

<p>
比如上面的表格,接着刚才的假设,E1 是 "太阳系火星村",地址一列是 B 列 将
<code>=COUNTIF(B:B,"*"&amp; E1 &amp;"*")</code> 填入 E2, 然后选中E2 以及右边所有需要统计的单元格,按
Ctrl+R 就可以快速将所有的公式输入到单元格里了.
</p>

<blockquote>
<p>
另外,用 IF 函数无法处理上面的操作,因为只使用 IF 函数的条件判断只能用比较运算符,
而比较运算符里并不能使用通配符,而且使用 IF 函数只能一次判断一个数据,所以不能一步
到位,只能先判断,后求和统计;而如果要用通配符,则需要用 SEARCH 函数(FIND 函数不支持
通配符)
</p>
</blockquote>
</div>
</div>
</div>

<div id="outline-container-org2cce456" class="outline-4">
<h4 id="org2cce456"><span class="section-number-4">1.4.2</span> 消除重复数据的方法</h4>
<div class="outline-text-4" id="text-1-4-2">
</div>
<div id="outline-container-orgcfb4a0c" class="outline-5">
<h5 id="orgcfb4a0c"><span class="section-number-5">1.4.2.1</span> 如何判断是否有重复</h5>
<div class="outline-text-5" id="text-1-4-2-1">
<p>
前面的笔记里就提到过,使用 COUNTIF 可以判断是否有重复数据,统计结果大于1,就说明有
重复.
</p>

<p>
假设 A 列为每条数据的 ID 列,且ID 值可以唯一确定一条记录,那么,对 A 列中每个值进行
统计判断,就可以知道每个值是否有重复了.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">A</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-left">ID</td>
<td class="org-left">ID 是否重复</td>
</tr>

<tr>
<td class="org-left">A-194</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">A160</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
在上面表格的 B2 单元格中,可以填入: <code>=COUNTIF(A:A,A2)</code> 来查看 A 列中与 A2 的值相
同的单元格有几个,若没有重复的,那结果就返回1,反之就会大于1,表示有重复数据.
</p>

<blockquote>
<p>
这里有一个小技巧,就是如果要输入的单元格很多,需要翻页才能选中,那我们之前讲的用键
盘选中连续单元格的技巧就不能使用了,因为它需要非空白的连续单元格,而用鼠标加 Shift
键选中也需要翻页,所以我们可以将鼠标光标放置到 B2 单元格的右下角,会发现鼠标光标变
成了十字形,此时双击鼠标左键,就会发现公式会复制到 A 列数据对应的 B 列的最后一行.
</p>

<p>
像我这种能不动鼠标就不动鼠标的也想出来了一个不用鼠标的方法,因为 B 列数据是按照 A
列来的,所以数量上一定是一样的,我们可以用 Ctrl + 方向键(↓) 来选中 A 列连续数据的
最后一个单元格,然后按方向键右键(→) 选中 B 列对应的单元格,然后 Ctrl + Shift + 方
向键(↑)选中连续的空白单元格,直到有数据的 B2 单元格,然后按 Ctrl + D 自动将 B2 的
数据向下复制到所有选中单元格(D 表示 Down 向下复制, R 就表示 Right 像右复制)
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org4b6c5e2" class="outline-5">
<h5 id="org4b6c5e2"><span class="section-number-5">1.4.2.2</span> 选中并删除重复的单元格</h5>
<div class="outline-text-5" id="text-1-4-2-2">
<p>
前面只是知道了有哪些单元格重复,我们要将这些重复数据删除才能解决问题.但是前面的公
式 <code>=COUNTIF(A:A,A2)</code> 也有点问题,就是只要该单元格有重复,那就会得出大于1的结果,例
如有两个单元格与 A2 值相同,那结果会返回 3,且其余两个单元格对应 B 列的结果也是 3,
我们虽然找出来了,但无法将重复的删到只剩下一个值,因为无法将它们三个单元格区分.
</p>

<p>
所以我们需要修改一下公式 : <code>=COUNTIF($A$2:A2,A2)</code> 这样,每次计算的都是从 A2 到要
判断的单元格,保证了重复值中的第一个值计算出的结果会是1,而其他的重复值计算结果会
大于1,这样就区分开来了,例如 A2, 计算它时,只在 A2 到 A2 的范围,也就是 A2 单元格里
查找 A2 的值,当然会匹配,而且只有一个值,所以结果为 1,假设 A3 和 A2 值相同,计算 A3
时,查找范围是 A2 到 A3, 有两个值与 A3 的值相同(A3 和 A2) 所以统计结果会是 2, 剩
下一个与 A2 值相同的也是一样,不过计算结果就会是 3 了, 这样就把重复的值用大于 1
的值区分开来了,我们下面只需要选中 B 列值大于1 的单元格,然后删除该单元格对应的记
录就可以了.
</p>

<blockquote>
<p>
虽然 2007 之后的 Excel 版本里都添加了 "删除重复项" 的按钮,但实际使用过程中发生过
删除了没有重复的数据的实例. 上面是作者说的, 实际我在使用该功能的时候也遇到过没有
重复的数据都给删除了的情况,当时是一个练习的文档,删除的是第一行数据,练习过程中发
现不对才最后找到是删除重复项搞的事,可能是因为语言原因,也可能是因为选中的区域有部
分重复了,但是没选中的地方却没有重复,因此错误删除了数据,当然这就是操作问题了,按我
对程序的理解,只要该功能的实现逻辑及其代码没有问题,那一般都是没有掌握它的用法然后
瞎操作导致的误删数据,我之前遇到的应该也是,因为当时我刚刚开始学 Excel.
</p>
</blockquote>
</div>
</div>
</div>

<div id="outline-container-orgbc239ae" class="outline-4">
<h4 id="orgbc239ae"><span class="section-number-4">1.4.3</span> 输入连续的数字</h4>
<div class="outline-text-4" id="text-1-4-3">
<p>
在 Excel 中输入 1，2，3&#x2026; 这种连续的数字，有好几种方法。
<b>**</b>
</p>
</div>
</div>

<div id="outline-container-org8dc136d" class="outline-4">
<h4 id="org8dc136d"><span class="section-number-4">1.4.4</span> 沿行方向输入大量 VLOOKUP 函数的方法</h4>
</div>

<div id="outline-container-orgebcfff2" class="outline-4">
<h4 id="orgebcfff2"><span class="section-number-4">1.4.5</span> 如何用 VLOOKUP 函数应对检索范围中竖列顺序的变动情况</h4>
</div>

<div id="outline-container-orgb9f1ffe" class="outline-4">
<h4 id="orgb9f1ffe"><span class="section-number-4">1.4.6</span> 在有多个相同检索值的工作表中使用 VLOOKUP 函数的技巧</h4>
</div>

<div id="outline-container-orgdc4b751" class="outline-4">
<h4 id="orgdc4b751"><span class="section-number-4">1.4.7</span> 是否能用 VLOOKUP 函数获得检索列左侧的数值?</h4>
</div>

<div id="outline-container-orgf1721a9" class="outline-4">
<h4 id="orgf1721a9"><span class="section-number-4">1.4.8</span> 不显示错误值的技巧</h4>
</div>

<div id="outline-container-org9f46e8b" class="outline-4">
<h4 id="org9f46e8b"><span class="section-number-4">1.4.9</span> 用 SUMIF 函数统计多个条件的方法</h4>
</div>
</div>

<div id="outline-container-org57235c1" class="outline-3">
<h3 id="org57235c1"><span class="section-number-3">1.5</span> Excel 中的日期与时间设置</h3>
</div>
</div>


<div id="outline-container-orgc2e42ae" class="outline-2">
<h2 id="orgc2e42ae"><span class="section-number-2">2</span> Excel函数与公事速查手册(第二版)</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orga998e7c" class="outline-3">
<h3 id="orga998e7c"><span class="section-number-3">2.1</span> 逻辑函数(8)</h3>
<div class="outline-text-3" id="text-2-1">
</div>
<div id="outline-container-org0478e0b" class="outline-4">
<h4 id="org0478e0b"><span class="section-number-4">2.1.1</span> AND 函数(检验是否都满足条件)</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
\[
AND(logical1, [logical2], \cdots)
\]
</p>

<p>
logical1,logical2,&ctdot; 表示测试表达式,最多可以有30个表达式.
</p>

<p>
只有当 logical1,logical2, &ctdot; 所有这些表达式的值全为真时, AND 函数才返回
TRUE, 否则,就返回 FALSE.
</p>

<p>
使用示例:
</p>
<pre class="example">
=AND(B2&gt;60,C2&gt;60,D2&gt;60)      只有当B2,C2,D2 这三个单元格中所有值大于60 时才返回 TURE.
=AND(B2="合格",C2="合格",D2="合格",)    只有当 B2,C2,D2 全部为 合格 时才返回 TRUE.
</pre>
</div>
</div>

<div id="outline-container-org9347bfb" class="outline-4">
<h4 id="org9347bfb"><span class="section-number-4">2.1.2</span> OR 函数(检验是否有一个满足条件)</h4>
<div class="outline-text-4" id="text-2-1-2">
<p>
\[
OR(logical1, [logical2], \cdots)
\]
</p>

<p>
logical1, logical2, &ctdot; 表示测试表达式,最多可以有 255 个表达式.
</p>

<p>
只有当所有表达式的值全为假时, OR 函数才返回 FALSE, 否则, 只要有一个表达式为真,就
返回 TRUE.
</p>

<p>
使用示例:
</p>
<pre class="example">
=OR(C2&gt;30000, D2&gt;5)   只要C2&gt;30000 或 D2&gt;5 这两个表达式有一个为真,就返回 TRUE.
=OR(AND(B2&gt;=80, C2&gt;=80), D2&gt;=85) OR 和 AND 函数的组合使用,AND 表达式为真或 C2&gt;=80 为真就返回TRUE, 其中,AND 表达式为真需要 B2&gt;=80 与 C2&gt;=80 这两个表达式全为真.
</pre>
</div>
</div>

<div id="outline-container-org9227af9" class="outline-4">
<h4 id="org9227af9"><span class="section-number-4">2.1.3</span> NOT 函数(对参数取反)</h4>
<div class="outline-text-4" id="text-2-1-3">
<p>
\[
NOT(logical)
\]
</p>

<p>
logical 为一个计算结果可以为 TRUE 或 FALSE 的表达式.
</p>

<p>
返回与表达式相反的真值,即,若 logical 为真,则返回 FALSE, 若 logical 为假,则返回 TRUE.
</p>

<p>
使用示例:
</p>
<pre class="example">
=NOT(1&gt;2)   1&gt;2 表达式的结果为假,所以NOT 函数返回 TRUE.
</pre>
</div>
</div>

<div id="outline-container-org3d90281" class="outline-4">
<h4 id="org3d90281"><span class="section-number-4">2.1.4</span> IF 函数(根据条件判断真假)</h4>
<div class="outline-text-4" id="text-2-1-4">
<p>
\[
IF(logical_test, [value_if_true], [value_if_false])
\]
</p>

<ul class="org-ul">
<li>logical<sub>test</sub> 为计算结果可以为 TRUE 或 FALSE 的表达式(一般叫做逻辑判断表达式),</li>
<li>value<sub>if</sub><sub>true</sub> 为 logical<sub>test</sub> 计算结果为真时 IF 函数的返回值,可选,省略时默认返
回TRUE.</li>
<li>value<sub>if</sub><sub>false</sub> 为 logical<sub>test</sub> 计算结果为假时 IF 函数的返回值,可选,省略时默认
返回 FALSE.</li>
<li>IF 函数最多可以嵌套 7 层.</li>
</ul>


<p>
使用示例:
</p>
<pre class="example">
=IF(B2&gt;18,"成年","未成年")   如果 B2 中的值大于18 则返回 "成年", 否则返回 "未成年".
=IF(B2&lt;=50000,B2*0.03,IF(B2&lt;=80000,B2*0.05, B2*0.08))  根据业绩计算奖金,小于50000,3% 奖金,大于50000,小于80000,5%,大于80000,8%.
=IF(AND(B2&gt;=60,C2&gt;=60,D2&gt;=60), "合格", "不合格")   AND 函数的表达式计算结果为真,返回合格,否则返回不合格.
</pre>
<p>
一个使用数组的示例:
</p>
<pre class="example">
=SUM(IF(A2:A9={"A组", "C组"}, C2:C9))    编辑公式后按 Ctrl+Shift+Enter 即可计算出 A2:A9 中属于 A组和 C组对应的列C 中的值.

这是使用数组的公式,IF 函数中,在 A2:A9 区域依次判断是否为 "A组" 或 "C组",如果是,则返回 TRUE, 然后返回为 TRUE 的单元格对应在 C2:C9 区域的单元格值,若判断结果为 FALSE,
则IF函数返回 FALSE,
</pre>
</div>
</div>

<div id="outline-container-orgb525baa" class="outline-4">
<h4 id="orgb525baa"><span class="section-number-4">2.1.5</span> TRUE 函数</h4>
<div class="outline-text-4" id="text-2-1-5">
<p>
\[ TRUE() \]
</p>

<p>
TRUE 函数没有参数,仅用于返回一个逻辑值 TRUE.
</p>

<p>
TRUE 函数可以直接在单元格或公式中使用,一般配合其他函数使用.
</p>

<p>
使用示例:
</p>
<pre class="example">
这个函数一时还真想不到示例,因为一般表示真值直接用 TRUE 和 FALSE 也是一样的.

从后面函数那里回想到这里, TRUE 和 FALSE 值是特殊的数值类型,分别表示1和0,
那就可以有一个使用示例了:
=1+TRUE() 结果为2
=1+TRUE 结果也为2
</pre>
</div>
</div>

<div id="outline-container-orga0542fa" class="outline-4">
<h4 id="orga0542fa"><span class="section-number-4">2.1.6</span> FALSE 函数</h4>
<div class="outline-text-4" id="text-2-1-6">
<p>
\[ FALSE() \]
</p>

<p>
和 TRUE 函数一样,没有参数,仅用于返回一个逻辑值 FALSE.
</p>

<p>
用法也和 TRUE 函数类似.
</p>
</div>
</div>

<div id="outline-container-org78284f6" class="outline-4">
<h4 id="org78284f6"><span class="section-number-4">2.1.7</span> IFNA 函数</h4>
<div class="outline-text-4" id="text-2-1-7">
<p>
\[ IFNA(value, value_if_na) \]
</p>

<ul class="org-ul">
<li>value: 表示用于检查错误值 "#N/A" 的表达式,若计算结果不为错误值,则返回表达式的
计算结果.</li>
<li>value<sub>if</sub><sub>na</sub>: 当 value 表达式的计算结果为错误值 "#N/A" 时要返回的值.</li>
</ul>


<p>
当 value 表达式计算结果为错误值 "#N/A" 时,返回 value<sub>if</sub><sub>na</sub>, 否则返回 value 表达
式的计算结果.
</p>

<p>
使用示例:
</p>
<pre class="example">
=IFNA(VLOOKUP(A13,A1:C10,3,FALSE), "未找到结果,请检查查找对象")
VLOOKUP 公式在 A1:C10 范围内查找 A13 的值,找到则返回 A1:C10 范围内对应的第三列的内容,
未找到则会返回错误值 "#N/A", IFNA 函数就会返回 value_if_na 的值.
</pre>
</div>
</div>

<div id="outline-container-org335c2a7" class="outline-4">
<h4 id="org335c2a7"><span class="section-number-4">2.1.8</span> IFERROR 函数</h4>
<div class="outline-text-4" id="text-2-1-8">
<p>
\[ IFERROR(value, value_if_error) \]
</p>

<p>
用法和 IFNA 类似,不同之处在于它用来检查错误值.
</p>

<blockquote>
<p>
这里要注意的是,错误值有很多中, IFNA 是专门检查 #N/A 这一种的函数,而 IFERROR 是检
查多种类型的错误,例如, #N/A,#VALUE!,#REF!,#DIV/0!,#NUM!,#NAME? 和 #NULL!
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=IFERROR(3/0,"计算数据源有错误")
由于 3/0 这个表达式中0作为了分母,所以该表达式的计算结果会返回 #DIV/0 的错误值,
IFERROR 函数返回 "计算数据源有错误", 如果第一个参数的表达式计算结果没有错误,例如
=IFERROR(3/1,"计算数据源有错误")
那么 IFERROR 函数就会直接返回表达式 3/1 的计算结果 3.
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb1664b6" class="outline-3">
<h3 id="orgb1664b6"><span class="section-number-3">2.2</span> 数学和三角函数(59)</h3>
<div class="outline-text-3" id="text-2-2">
</div>
<div id="outline-container-org1f03219" class="outline-4">
<h4 id="org1f03219"><span class="section-number-4">2.2.1</span> 求和函数</h4>
<div class="outline-text-4" id="text-2-2-1">
</div>
<div id="outline-container-org0c5b0b5" class="outline-5">
<h5 id="org0c5b0b5"><span class="section-number-5">2.2.1.1</span> SUM 函数(求和运算)</h5>
<div class="outline-text-5" id="text-2-2-1-1">
<p>
\[ SUM(number1,[number2], \cdots) \]
</p>

<ul class="org-ul">
<li>number1,number2, \(cdots\) : 想要进行求和的参数,最多可有 255 个参数. 每个参数都
是计算结果为数值的表达式.</li>
</ul>


<blockquote>
<p>
SUM 函数的参数可以是以下几种类型:
</p>
<ul class="org-ul">
<li>数字字面值,如直接使用数字: <code>=SUM(1,2)</code> 结果为3.</li>
<li>可以通过 VALUE() 函数转为数字字面值的字符字面值,如 <code>=SUM(1,"1")</code>, 结果为2.</li>
<li>数据为数值类型的单元格引用,例如,A1 单元格的数据为数值1, <code>=SUM(1,A1)</code> 结果为2.</li>
<li>数据为字符类型的单元格引用,虽然这种类型可以作为参数,但与可转为数值字面值的字符
字面值不同,只要单元格中数据为字符类型,SUM 都会将这个单元格引用的参数视为0,例如
A1 单元格的数据为字符字面值 "1",但 <code>=SUM(A1,1)</code> 结果为1, 这一点和第二点是比较
特殊的.</li>
</ul>


<p>
其他类型的数据,放到SUM 的参数中会导致 SUM 返回错误值, 例如不能通过 VALUE() 函数
转为数值字面值的字符字面值,如 "a", 会导致 SUM 返回 #VALUE!.
</p>

<p>
一般都不会使用字面值来作为 SUM 的参数,毕竟函数就是为了批量快速处理数据,手动添加
字面值意义不大,需要求和的通常也是数值数据,只要注意当发现计算结果不对时,可能是因
为单元格的数据类型不正确导致的.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=SUM(B2:D8) 对 B2:D8 单元格区域的所有数据进行求和计算.
=SUM(B2:B9, table1!B2:B9) 对当前表格中的 B2:B9 区域以及 table1 表格中的 B2:B9 区域
中的所有数据进行求和.
</pre>
</div>
</div>

<div id="outline-container-org6f674f7" class="outline-5">
<h5 id="org6f674f7"><span class="section-number-5">2.2.1.2</span> SUMIF 函数(按照指定条件求和)</h5>
<div class="outline-text-5" id="text-2-2-1-2">
<p>
\[ SUMIF(range, criteria, [sum_range])\]
</p>

<ul class="org-ul">
<li>range: 条件判断应用的单元格区域.</li>
<li>criteria: 用于确定对哪些单元格求和的条件.</li>
<li>sum<sub>range</sub>: 根据条件判断结果要进行计算的对应单元格区域.如果该参数被省略,则使用
range 参数的单元格中符合条件的单元格进行求和.</li>
</ul>


<blockquote>
<p>
求和区域单元格数据的要求与 SUM 函数的要求类似.
单元格必需是数字,名称,数组或数字的引用. 空值和文本值会被忽略(也就是当作0处理).
判断区域单元格数据的要求与求和区域一致,因为它在求和参数省略时会被当作求和区域.
</p>

<p>
判断条件可以是任意有效表达式,其中,如果是文本或逻辑表达式,如 "abc", "销售部",
"&gt;1", "=a", "=abc", "=销售部", "=1", 则必需用双引号,其他的如数值,单元格引用或有
返回值的函数,例如, 1, A2, SUM(1,2) 等不带双引号.
</p>
</blockquote>

<p>
SUMIF 函数对区域中符合指定条件的值求和.就是先进行条件判断,然后只对满足条件的数据
进行求和.
</p>

<p>
使用示例:
</p>
<pre class="example">
=SUMIF(B2:B8, "财务部", C2:C8)
从 B2:B8 中选出值为"财务部"的对应 C2:C8 的单元格进行求和.
=SUMIF($C$2:C$11, F2, $D$2:$D$11)
在C2:C11 这个固定区域里选择值等于 F2 的对应 D2:D11 固定区域的单元格求和.
=SUMIF(A2:A12, "&lt;=18-10-15", C2:C11)
从 A2:A12 中选择出小于等于 18年10月15日的日期对应的 C2:C11 单元格进行求和.
</pre>
</div>
</div>

<div id="outline-container-org9d2c195" class="outline-5">
<h5 id="org9d2c195"><span class="section-number-5">2.2.1.3</span> SUMIFS 函数(对满足多重条件的单元格求和)</h5>
<div class="outline-text-5" id="text-2-2-1-3">
<p>
\[ SUMIFS(sum_range, criteria_range1, criteria1, [criteria_range2,
criteria2], \cdots) \]
</p>

<ul class="org-ul">
<li>sum<sub>range</sub> : 求和区域.区域内单元格数据要求和 SUM 参数要求一致.</li>
<li>criteria<sub>range1</sub> , criteria1 : 条件判断的区域和判断的条件.判断区域和判断条件和
SUMIF 的判断区域和判断条件用法一致.</li>
<li>$[criteria<sub>range2</sub>, criteria2], &ctdot; $: 其他的条件区域和条件对,最多有 127 对.</li>
</ul>

<p>
SUMIF 函数对区域中满足多个条件的单元格求和. 就是依次判断给定的多个条件,然后只对
满足条件的数据进行求和.
</p>

<p>
使用示例:
</p>
<pre class="example">
=SUMIFS(D1:D10, B1:B10, "男", C1:C10, "&gt;18")
B 列为性别,C 列为年龄, D 列为分数, 这个公式会选择大于18岁的男性的所有分数进行求和.
</pre>
</div>
</div>

<div id="outline-container-org6259c0a" class="outline-5">
<h5 id="org6259c0a"><span class="section-number-5">2.2.1.4</span> SUMPRODUCT 函数(将数组间对应的元素相乘,并返回乘积之和)</h5>
<div class="outline-text-5" id="text-2-2-1-4">
<p>
\[ SUMPRODUCT(array1, [array2], \cdots)\]
</p>

<ul class="org-ul">
<li>array1: 一维数组,需要相乘并求和的第一个数组参数.</li>
<li>\(array2, \cdots\): 其他一维数组,最多有总共 255 个数组.</li>
</ul>


<p>
SUMPRODUCT 是在给定的几组数组中,将数组中对应的元素相乘,并返回乘积之和.
</p>

<blockquote>
<p>
虽然 SUMPRODUCT 用法有数组,有乘法,加法,但跟数学中的数组乘法加法有区别,这里是表示
对各个数组中每个元素执行同样的操作.理解这个函数的用法这一点很重要.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=SUMPRODUCT(A2:A4,B2:B4,C2:C4)
实际执行的运算是 A2*B2*C2+A3*B3*C3+A4*B4*C4
</pre>

<p>
<b>SUMPRODUCT 的高级用法</b>
SUMPRODUCT 最基本的用法就是上面的数学函数,效果为相乘后求和.
而 SUMPRODUCT 最重要的功能是可以按条件计数以及按条件求和.
</p>

<p>
也就是说 SUMPRODUCT 可以代替 SUMIF 和 SUMIFS 函数进行按条件求和,也可以代替
COUNTIF 和 COUNTIFS 进行计数.
</p>

<blockquote>
<p>
SUMPRODUCT 和 SUMIFS 可以达到相同的统计目的,但SUMIFS 在2010 之前是没有出现的,而
且 SUMIFS 只能对单元格区域进行求和,但 SUMPRODUCT 可以以公式的返回值为参数,这点
SUMPRODUCT 更加灵活.
</p>
</blockquote>

<p>
这种高级用法只需讲基础用法中用来分隔数组的逗号修改为四则运算符号,而数组可以是表
达式的返回值.
</p>

<p>
\[ SUMPRODUCT((条件1表达式)*(条件2表达式)*\cdots) \]
</p>

<blockquote>
<p>
这里的表达式是可以返回数组的表达式,例如 A2:A4="张三" 实际上是对 A2:A4 中所有元素
进行逻辑判断,等于 "张三" 的返回 TRUE, 否则返回 FALSE, 在 Excel 数值计算中, TRUE
等价于 1, FALSE 等价于0, 若只有 A3 为张三,那么这个表达式返回的结果为 [0 1 0] 这
样一个数组;
这里的乘号可以替换为其他四则运算符号.
</p>

<p>
所以,这个高级用法的理解就是,根据四则运算符号对每个数组中每个元素进行相应运算.这
种高级用法可以说是将 SUMPRODUCT 变成了一个对数组的快捷运算的函数.
</p>

<p>
在没有使用逻辑表达式时加减乘除直接按四则运算理解,在用了逻辑表达式时,例如
A1:A100&lt;0 则可以理解为离散数学与或非(除法一般不会应用与逻辑表达式),所以可以用作
条件判断.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=SUMPRODUCT((A1:A100="内部")*(C1:C100&gt;0)*(D1:D100))
A1:A100="内部" 返回的是 (0,1,0,0,...) 的数组, C1:C100&gt;0 返回的也是 (1, 0, 1, ...) 的数组
D1:D100 就是 D1:D100 的原数组, 这样就进行了多条件判断的求和操作.

=SUMPRODUCT((A1:A100="销售部")*(C1:C100="女"))
统计出销售部中女性人数. 这样可以完成 COUNTIFS 的功能.

=SUMPRODUCT((C2:C100&gt;=DATE(2006,9,1))*(C2:C100&lt;=DATE(2007,9,1))*(D2:D100="女"))
统计2006年9月1日到 2007年9月1日出生的女性人数.
</pre>
</div>
</div>

<div id="outline-container-org06f4cc3" class="outline-5">
<h5 id="org06f4cc3"><span class="section-number-5">2.2.1.5</span> SUBTOTAL 函数 (返回分类汇总的值)</h5>
<div class="outline-text-5" id="text-2-2-1-5">
<p>
\[ SUBTOTAL(function_num, ref1, [ref2], \cdots) \]
</p>

<ul class="org-ul">
<li>function<sub>num</sub>: 统计函数的编号, 1-11 为包含隐藏值的函数, 101-111 为忽略隐藏值的
函数.编号对应的函数在下面表格中.</li>
<li>ref1: 表示要进行分类汇总的第一个区域</li>
<li>\(ref2,\cdots\): 表示要进行分类汇总的其他区域,最多 254 个区域.</li>
</ul>


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 2:</span> 编号/函数表</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right">function<sub>num</sub>(包含隐藏值)</td>
<td class="org-right">function<sub>num</sub>(忽略隐藏值)</td>
<td class="org-left">函数</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">101</td>
<td class="org-left">AVERAGE</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">102</td>
<td class="org-left">COUNT</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">103</td>
<td class="org-left">COUNTA</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-right">104</td>
<td class="org-left">MAX</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-right">105</td>
<td class="org-left">MIN</td>
</tr>

<tr>
<td class="org-right">6</td>
<td class="org-right">106</td>
<td class="org-left">PRODUCT</td>
</tr>

<tr>
<td class="org-right">7</td>
<td class="org-right">107</td>
<td class="org-left">STDEV</td>
</tr>

<tr>
<td class="org-right">8</td>
<td class="org-right">108</td>
<td class="org-left">STDEVP</td>
</tr>

<tr>
<td class="org-right">9</td>
<td class="org-right">109</td>
<td class="org-left">SUM</td>
</tr>

<tr>
<td class="org-right">10</td>
<td class="org-right">110</td>
<td class="org-left">VAR</td>
</tr>

<tr>
<td class="org-right">11</td>
<td class="org-right">111</td>
<td class="org-left">VARP</td>
</tr>
</tbody>
</table>


<blockquote>
<p>
SUBTOTAL 实际上是只对可见的数据进行处理,1-11 和 101-111 的区别是手动隐藏(隐藏行
命令)和筛选/分类汇总方式隐藏数据的区别,对于手动隐藏的数据, subtotal() 使用1-11
对应的函数与普通函数一样,即不管是否被手动隐藏都会纳入计算范围,而 101-111 是不管
通过隐藏命令还是筛选/分类汇总命令,只要是看不见的数据,就不会纳入计算范围.
</p>
</blockquote>
</div>
</div>
</div>

<div id="outline-container-org25d200e" class="outline-4">
<h4 id="org25d200e"><span class="section-number-4">2.2.2</span> 数学函数</h4>
<div class="outline-text-4" id="text-2-2-2">
</div>
<div id="outline-container-org34570af" class="outline-5">
<h5 id="org34570af"><span class="section-number-5">2.2.2.1</span> ABS 函数(求绝对值)</h5>
<div class="outline-text-5" id="text-2-2-2-1">
<p>
\[ ABS(number) \]
</p>

<ul class="org-ul">
<li>number: 返回需要计算绝对值的数值的表达式.</li>
</ul>


<p>
ABS 函数返回数值的绝对值,绝对值没有符号.
</p>

<p>
使用示例:
</p>
<pre class="example">
=ABS(A1-C2)
返回 A1-C2 计算结果的绝对值.

=IF(C2&gt;B2, "提高", "下降") &amp; ABS(C2-B2) &amp; "元"
比较销售额是下降还是升高了.
</pre>
</div>
</div>

<div id="outline-container-org037a2eb" class="outline-5">
<h5 id="org037a2eb"><span class="section-number-5">2.2.2.2</span> MOD 函数(求两个数值相除后的余数)</h5>
<div class="outline-text-5" id="text-2-2-2-2">
<p>
\[ MOD(number, divisor) \]
</p>

<ul class="org-ul">
<li>number: 被除数.</li>
<li>divisor: 除数.</li>
</ul>


<p>
MOD 函数用于返回两数相除的余数,结果的正负号与除数相同.
</p>

<p>
使用示例:
</p>
<pre class="example">
=SUMPRODUCT((MOD(ROW(2:13), 2)) * (C2:C13))
汇总统计奇数行. MOD(ROW(2:13), 2) 返回的是一个奇数行为1,
偶数为0的数组,2-13行即(0,1,0,1...)
=SUMPRODUCT((MOD(ROW(2:13)+1, 2)) * (C2:C13))
汇总统计偶数行. 2-13行 MOD(ROW(2:13)+1, 2) 返回 (1,0,1,0,...) 的数组.
</pre>
</div>
</div>

<div id="outline-container-org35acc83" class="outline-5">
<h5 id="org35acc83"><span class="section-number-5">2.2.2.3</span> SUMSQ 函数</h5>
<div class="outline-text-5" id="text-2-2-2-3">
<p>
\[ SUMSQ(number1, [number2], \cdots)\]
</p>

<ul class="org-ul">
<li>\(number1,number2,\cdots\): 用于计算平方和的参数,最多255 个,最少1个.</li>
</ul>


<p>
SUMSQ 函数用于返回参数的平方和.
</p>

<p>
使用示例:
</p>
<pre class="example">
=SUMSQ(A2,B2)
=SUMSQ(A1:C5)
</pre>
</div>
</div>

<div id="outline-container-org6e8aed9" class="outline-5">
<h5 id="org6e8aed9"><span class="section-number-5">2.2.2.4</span> SUMXMY2 函数</h5>
<div class="outline-text-5" id="text-2-2-2-4">
<p>
\[ SUMXMY2(array_x, array_y) \]
</p>

<ul class="org-ul">
<li>array<sub>x</sub>: 第一个数组或数值区域.</li>
<li>array<sub>y</sub>: 第二个数组或数值区域.</li>
</ul>


<p>
SUMXMY2 函数用于返回两个数组中对应数值之差的平方和.
</p>

<p>
使用示例:
</p>
<pre class="example">
=SUMXMY2(A2:A5, B2:B5)
等价于 =(A2-B2)^2+(A3-B3)^2+(A4-B4)^2+(A5-B5)^2
</pre>

<blockquote>
<p>
XMY2 就是 \(\sum (X-Y)^2\) 数值差的平方和
</p>
</blockquote>
</div>
</div>
<div id="outline-container-orga9df4b2" class="outline-5">
<h5 id="orga9df4b2"><span class="section-number-5">2.2.2.5</span> SUMX2MY2 函数</h5>
<div class="outline-text-5" id="text-2-2-2-5">
<p>
\[ SUMX2MY2(array_x, array_y) \]
</p>

<ul class="org-ul">
<li>array<sub>x</sub>: 第一个数组或数值区域.</li>
<li>array<sub>y</sub>: 第二个数组或数值区域.</li>
</ul>


<p>
SUMX2MY2 函数用于返回两个数组中对应数值的平方和之差.
</p>

<p>
使用示例:
</p>
<pre class="example">
=SUMX2MY2(A2:A5, B2:B5)
等价于 =(A2^2+A3^2+A4^2+A5^2)-(B2^2+B3^2+B4^2+B5^2)
</pre>

<blockquote>
<p>
X2MY2 就是 \(\sum X^2 -\sum Y^2\) 第一个数组所有数值的平方和减去第二个数组所有数值的平方和.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orgc55bce4" class="outline-5">
<h5 id="orgc55bce4"><span class="section-number-5">2.2.2.6</span> SUMX2PY2 函数</h5>
<div class="outline-text-5" id="text-2-2-2-6">
<p>
\[ SUMX2PY2(array_x, array_y) \]
</p>

<ul class="org-ul">
<li>array<sub>x</sub>: 第一个数组或数值区域.</li>
<li>array<sub>y</sub>: 第二个数组或数值区域.</li>
</ul>


<p>
SUMX2PY2 函数用于返回两个数组中对应数值的平方和之和, 平方和之和在统计计算中经常
使用.
</p>

<p>
使用示例:
</p>
<pre class="example">
=SUMX2PY2(A2:A5, B2:B5)
等价于 =(A2^2+A3^2+A4^2+A5^2)+(B2^2+B3^2+B4^2+B5^2)
</pre>

<blockquote>
<p>
X2PY2 就是 \(\sum X^2 + \sum Y^2\) 两个数组中对应数值的平方和之和.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orga6972cf" class="outline-5">
<h5 id="orga6972cf"><span class="section-number-5">2.2.2.7</span> PRODUCRT 函数</h5>
<div class="outline-text-5" id="text-2-2-2-7">
<p>
\[ PRODUCRT(number1, [number2], \cdots) \]
</p>

<ul class="org-ul">
<li>number1: 表示要相乘的第一个数字或区域(工作表上的两个或多个单元格,可以相邻或不
相邻)</li>
<li>\(number2, \cdots\): 要相乘的其他数字或单元格,总共最多有 255 个参数.</li>
</ul>


<p>
PRODUCRT 函数可以计算参数中所有数字的乘积.
</p>

<p>
使用示例:
</p>
<pre class="example">
=PRODUCT(A2, B2, C2)
等价于 =A2*B2*C2
=PRODUCT(A2, A2)
等价于 =A2*A2
</pre>
</div>
</div>

<div id="outline-container-orgd693087" class="outline-5">
<h5 id="orgd693087"><span class="section-number-5">2.2.2.8</span> MULTINOMIAL 函数</h5>
<div class="outline-text-5" id="text-2-2-2-8">
<p>
\[ MULTINOMIAL(number1, [number2], \cdots) \]
</p>

<ul class="org-ul">
<li>number1 : 必选,用于计算的第一个参数.</li>
<li>\(number2,\cdots\): 可选,用于计算的其他参数,总共最多 255 个参数.</li>
</ul>


<p>
返回所有参数和的阶乘与各个参数阶乘乘积的比值.
</p>

<p>
使用示例:
</p>
<pre class="example">
=MULTINOMIAL(1, 5)
</pre>
<p>
计算的是 \(\frac{(1+5)!}{1! \times 5!} = \frac{6!}{5!} = 6\)
</p>

<p>
=MULTINOMIAL(5,1,3)
</p>

<p>
计算的是 \(\frac{(5+1+3)!}{5! \times 1! \times 3!} = \frac{9!}{5! \times 3!}= 504\)
</p>
</div>
</div>

<div id="outline-container-org73ead72" class="outline-5">
<h5 id="org73ead72"><span class="section-number-5">2.2.2.9</span> MDETERM 函数</h5>
<div class="outline-text-5" id="text-2-2-2-9">
<p>
\[ MDETERM(array) \]
</p>

<ul class="org-ul">
<li>array: 一个行数和列数相等的数值数组.</li>
</ul>


<p>
计算矩阵行列式的值.
</p>

<p>
使用示例:
</p>
<pre class="example">
=MDETERM(A2:D5)
计算 A2:D5 这个矩形的行列式值.
</pre>

<blockquote>
<p>
矩阵 Matrix 行列式 determinant
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orgf11a1dd" class="outline-5">
<h5 id="orgf11a1dd"><span class="section-number-5">2.2.2.10</span> MINVERSE 函数</h5>
<div class="outline-text-5" id="text-2-2-2-10">
<p>
\[ MINVERSE(array) \]
</p>

<ul class="org-ul">
<li>array: 行数和列数相等的数值数组.</li>
</ul>


<p>
用于返回数组中矩阵的逆矩阵.
</p>
<blockquote>
<p>
Matrix 数组, inverse 反转的
</p>
</blockquote>

<blockquote>
<p>
矩阵(数组)计算需要使用特殊的组合快捷键 Ctrl+Shift+Enter 而不是普通的 Enter 来计
算公式.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=MINVERSE(A2:C4)
输入公式后按 Ctrl+Shift+Enter 可计算出矩阵对应的逆矩阵.
</pre>
</div>
</div>

<div id="outline-container-orgbff7b8d" class="outline-5">
<h5 id="orgbff7b8d"><span class="section-number-5">2.2.2.11</span> MMULT 函数</h5>
<div class="outline-text-5" id="text-2-2-2-11">
<p>
\[ MMULT(array1,array2) \]
</p>

<ul class="org-ul">
<li>array1, array2: 进行矩阵乘法运算的两个数组.</li>
</ul>


<p>
MMULT 函数用于返回两个数组的矩阵乘积.
</p>
<blockquote>
<p>
Matrix Multiply 矩阵乘法,这个矩阵乘法符合数学的矩阵乘法规律.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=MMULT(A2:B4, D2:F3)
A2:B4 为 $3 \times 2$ D2:F3 为 $2 \times 3$ 按 Ctrl+Shift+Enter 就可以计算出矩阵的乘积.
</pre>
</div>
</div>

<div id="outline-container-orgbd1a37c" class="outline-5">
<h5 id="orgbd1a37c"><span class="section-number-5">2.2.2.12</span> GCD 函数</h5>
<div class="outline-text-5" id="text-2-2-2-12">
<p>
\[ GCD(number1, [number2], \cdots)\]
</p>

<ul class="org-ul">
<li>\(number1,number2,\cdots\): 第一个参数是必需的,后续数值是可选的. 数值的个数总共
最大为 255 个.如果任意一个数值为非整数, 则截尾取整.</li>
</ul>


<p>
GCD 函数用于返回两个或多个整数的最大公约数, 最大公约数是能同时整数 number1 和
number2 的最大整数.
</p>
<blockquote>
<p>
Great Common Divisor
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=GCD(33,88,55,66)
33,88,55,66 的最大公约数为 11.
</pre>
</div>
</div>

<div id="outline-container-orgcb036f6" class="outline-5">
<h5 id="orgcb036f6"><span class="section-number-5">2.2.2.13</span> LCM</h5>
<div class="outline-text-5" id="text-2-2-2-13">
<p>
\[ LCM(number1, [number2], \cdots) \]
</p>

<ul class="org-ul">
<li>\(number1, number2, \cdots\) : 最多可有 255 个参数,如果参数值不是整数,则截尾取整.</li>
</ul>


<p>
LCM 函数用于求两个或多个整数的最小公倍数. 最小公倍数是所有参数的最小整数倍数.
LCM 函数可以将分母不同的分数相加.(这个功能找不到用例,搞不懂)
</p>

<blockquote>
<p>
Lowest Common Multiple 最小公倍数.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=LCM(5,7,6)
5,6,7 的最小公倍数为 210.
</pre>
<p>
说明中 LCM 函数可以将分母不同的分数相加应该指得是计算分数时得出公共分母的操作,这
是从 Excel 帮助文档中的翻译内容,可能与实际有差别.
</p>
</div>
</div>

<div id="outline-container-org380defc" class="outline-5">
<h5 id="org380defc"><span class="section-number-5">2.2.2.14</span> QUOTIENT 函数(返回商的整数部分)</h5>
<div class="outline-text-5" id="text-2-2-2-14">
<p>
\[ QUOTIENT(numerator, denominator)\]
</p>

<ul class="org-ul">
<li>numberator: 被除数.</li>
<li>denominator: 除数.</li>
</ul>


<p>
QUOTIENT 函数返回商的整数部分,该函数会舍掉商的小数部分.
</p>

<p>
使用示例:
</p>
<pre class="example">
=QUOTIENT(5,2)
返回 5/2=2.5 的整数部分 2
</pre>
</div>
</div>

<div id="outline-container-orgae89c55" class="outline-5">
<h5 id="orgae89c55"><span class="section-number-5">2.2.2.15</span> RAND 函数(返回大于或等于0 小于1 的随机数)</h5>
<div class="outline-text-5" id="text-2-2-2-15">
<p>
\[ RAND() \]
</p>

<p>
RAND() 函数没有参数,和 TRUE() ,FALSE() 函数一样.
</p>


<p>
使用示例:
</p>
<pre class="example">
=ROUND(RAND()*99+1, 0)
随机生成 1-100 的整数.
=INT(RAND()*10)
随机生成1-9 的整数.
</pre>

<blockquote>
<p>
ROUND 函数按照指定位数进行四舍五入;INT 函数将参数向下取整为最接近的整数;
F9 可以重新计算公式,所以按 F9 可以重新生成随机数.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orgfdec4b8" class="outline-5">
<h5 id="orgfdec4b8"><span class="section-number-5">2.2.2.16</span> RANDBETWEEN 函数(返回指定数值之间的随机数)</h5>
<div class="outline-text-5" id="text-2-2-2-16">
<p>
\[ RANDBETWEEN(bottom, top) \]
</p>

<ul class="org-ul">
<li>bottom: 函数返回的最小整数.</li>
<li>top: 函数返回的最大整数.</li>
</ul>


<p>
用于返回两个数之间(不含最大和最小数)的一个随机整数,每次计算时都会返回一个新的随
机数.
</p>
<blockquote>
<p>
这等于是上面 RAND 函数用法的组合用法,例如 ROUND(RAND()*99+1,0) 随机生成1-100 的
整数.但也有不同, RAND 函数包含最小指,不包含最大值, RANDTWEEN 函数则包含最大值与
最小值.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=RANDBETWEEN(100,1000)
用于返回三位随机数(101-999).
</pre>
</div>
</div>

<div id="outline-container-org1a6b4eb" class="outline-5">
<h5 id="org1a6b4eb"><span class="section-number-5">2.2.2.17</span> SQRT 函数(返回参数的平方根)</h5>
<div class="outline-text-5" id="text-2-2-2-17">
<p>
\[ SQRT(number) \]
</p>

<ul class="org-ul">
<li>number : 计算平方根的数</li>
</ul>


<p>
使用示例:
</p>
<pre class="example">
=SQRT(144)
返回 144 的平方根 12
</pre>
</div>
</div>

<div id="outline-container-org5422f07" class="outline-5">
<h5 id="org5422f07"><span class="section-number-5">2.2.2.18</span> SQRTPI 函数</h5>
<div class="outline-text-5" id="text-2-2-2-18">
<p>
\[ SQRTPI(number) \]
</p>

<ul class="org-ul">
<li>number: 用来与 \(\pi\) 相乘的正实数.</li>
</ul>


<p>
SQRTPI 函数用于返回指定正数值与 \(\pi\) 的乘积的平方根.
</p>

<p>
使用示例:
</p>
<pre class="example">
=SQRTPI(4)
返回 4乘π 的平方根.
</pre>
</div>
</div>

<div id="outline-container-org3bbfbf0" class="outline-5">
<h5 id="org3bbfbf0"><span class="section-number-5">2.2.2.19</span> RADIANS 函数(将角度转为弧度)</h5>
<div class="outline-text-5" id="text-2-2-2-19">
<p>
\[ RADIANS(angle) \]
</p>

<ul class="org-ul">
<li>angle: 角度值.</li>
</ul>


<p>
RADIANS 函数用于将角度转换为弧度.
</p>

<p>
使用示例:
</p>
<pre class="example">
=RANDIANS(180)
返回 180 度的弧度值 π 的数值 $3.141592654$
=RANDIANS(90)
返回二分之一 π 的值 1.57...
</pre>
</div>
</div>

<div id="outline-container-org8d13be3" class="outline-5">
<h5 id="org8d13be3"><span class="section-number-5">2.2.2.20</span> SIGN 函数</h5>
<div class="outline-text-5" id="text-2-2-2-20">
<p>
\[ SIGN(number) \]
</p>

<ul class="org-ul">
<li>number: 计算结果为数字的表达式.</li>
</ul>


<p>
SIGN 函数用于返回数字,计算结果或列中指的符号, 正数返回1,数字为零返回0,负数返回 -1.
</p>

<p>
使用示例:
</p>
<pre class="example">
=SIGN(0)
结果为 0
=SIGN(-5)
结果为 -1
=SIGN(5)
结果为 1
</pre>
</div>
</div>

<div id="outline-container-org8c54111" class="outline-5">
<h5 id="org8c54111"><span class="section-number-5">2.2.2.21</span> ROMAN 函数</h5>
<div class="outline-text-5" id="text-2-2-2-21">
<p>
\[ ROMAN(number, [form]) \]
</p>

<ul class="org-ul">
<li>number: 阿拉伯数字.</li>
<li>form: 指定罗马数字类型.罗马数字样式表在下面.</li>
</ul>


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 3:</span> form 与罗马数字类型</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right">form</td>
<td class="org-left">类型</td>
</tr>

<tr>
<td class="org-right">0或省略</td>
<td class="org-left">经典</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">更简化</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">比1更简化</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">比2更简化</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-left">最简化</td>
</tr>

<tr>
<td class="org-right">TRUE</td>
<td class="org-left">经典</td>
</tr>

<tr>
<td class="org-right">FALSE</td>
<td class="org-left">最简化</td>
</tr>
</tbody>
</table>

<p>
ROAMN 用于将阿拉伯数字转换为 <b>文本式</b> 的罗马数字.
</p>

<p>
使用示例:
</p>
<pre class="example">
=ROMAN(599,2)
结果为 DIC
=ROMAN(599,0)
结果为 DXCIX
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf9d7a10" class="outline-4">
<h4 id="orgf9d7a10"><span class="section-number-4">2.2.3</span> 数据舍入函数</h4>
<div class="outline-text-4" id="text-2-2-3">
</div>
<div id="outline-container-org6aac50b" class="outline-5">
<h5 id="org6aac50b"><span class="section-number-5">2.2.3.1</span> INT 函数(不考虑四舍五入直接对数字取整)</h5>
<div class="outline-text-5" id="text-2-2-3-1">
<p>
\[ INT(number) \]
</p>

<ul class="org-ul">
<li>number: 需要进行向下取整的实数.</li>
</ul>


<p>
INT 函数将数字向下舍入到最近的整数.
</p>

<p>
使用示例:
</p>
<pre class="example">
=INT(SUM(E2:E8)/7)
计算出平均值并向下取整.
</pre>
</div>
</div>

<div id="outline-container-orgf0da228" class="outline-5">
<h5 id="orgf0da228"><span class="section-number-5">2.2.3.2</span> ROUND 函数(对数据进行四舍五入)</h5>
<div class="outline-text-5" id="text-2-2-3-2">
<p>
\[ ROUND(number, num_digits) \]
</p>

<ul class="org-ul">
<li>number: 需要四舍五入的数字.</li>
<li>num<sub>digits</sub>: 表示四舍五入的位数.</li>
</ul>


<p>
ROUND 函数将数字四舍五入为指定的位数.
</p>

<p>
使用示例:
</p>
<pre class="example">
=ROUND(10.249, 0)
将 10.249 按0位小数四舍五入,结果为 10
=ROUND(10.249, 2)
按2位小数四舍五入,结果为 10.25
</pre>
</div>
</div>

<div id="outline-container-org210bb3b" class="outline-5">
<h5 id="org210bb3b"><span class="section-number-5">2.2.3.3</span> ROUNDUP 函数(向上舍入)</h5>
<div class="outline-text-5" id="text-2-2-3-3">
<p>
\[ ROUNDUP(number, num_digits) \]
</p>

<ul class="org-ul">
<li>number: 需要舍入的数字.</li>
<li>num<sub>digits</sub>: 表示舍入的位数.</li>
</ul>


<p>
ROUNDUP 函数是远离零值,向上舍入数字.(向绝对值增加的方向)
</p>
<blockquote>
<p>
ROUNDUP 和 ROUNDDOWN 在正数时与数学中的向上向下舍入一致,但对于负数是按绝对值增加
和减少的规则舍入.例如,对 -1.1 向上取舍, 用 roundup(-1.1,0) 结果为 -2, 按数学的
ceil(-1.1) 取舍则为-1; 对记忆来说,Excel 的向上/下取舍函数更容易记忆,只需要按绝对
值增加/减少的方向取舍就行了.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=ROUNDUP(20.246,0)
向上舍入到最接近的整数即 21
=ROUNDUP(20.246,2)
向上舍入到指定的小数, 即 20.25
=ROUNDUP(-20.246,1)
向上舍入到指定的小数, 即 -20.3
</pre>
</div>
</div>

<div id="outline-container-org1479a99" class="outline-5">
<h5 id="org1479a99"><span class="section-number-5">2.2.3.4</span> ROUNDDOWN 函数(向下舍入)</h5>
<div class="outline-text-5" id="text-2-2-3-4">
<p>
\[ ROUNDDOWN(number, num_digits) \]
</p>

<ul class="org-ul">
<li>number: 需要舍入的数字.</li>
<li>num<sub>digits</sub>: 表示舍入的位数.</li>
</ul>


<p>
ROUNDDOWN 函数向下舍入数字(向绝对值减小的方向).
</p>

<p>
使用示例:
</p>
<pre class="example">
=ROUNDDOWN(20.246,0)
结果为 20
=ROUNDDOWN(20.246,1)
结果为 20.2
=ROUNDDOWN(-20.246,1)
结果为 -20.2
</pre>
</div>
</div>

<div id="outline-container-org784886f" class="outline-5">
<h5 id="org784886f"><span class="section-number-5">2.2.3.5</span> CEILING 函数(向上取舍到最接近指定数字的某个值的倍数值)</h5>
<div class="outline-text-5" id="text-2-2-3-5">
<p>
\[ CEILING(number, significance) \]
</p>

<ul class="org-ul">
<li>number : 需要舍入的值.</li>
<li>significance: 要舍入到的倍数.</li>
</ul>


<p>
将参数值向上舍入(绝对值增大的方向)为最接近指定数值的倍数.
</p>

<blockquote>
<p>
number 为负数时,若 significance 为正数,则与数学的向上舍入一致.
</p>

<p>
EXCEL 的CEILING ,FLOOR 等函数不是真正意义上数学中的向上/下舍入,只有在正数时表现
一致.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=CEILING(5, 2)
向上将 5 舍入为最接近 2 的倍数的数值,2 的倍数为 2, 4, 6, 因为是向上,所以舍入到 6.
=CEILIING(5, 3)
5 向上舍入到 6.
=CEILIING(5.4, 3)
5.4 向上舍入到 6.
=CEILIING(-6.8, 2)
-6.8为负数,2 为整数,则向靠近零的方向舍入 -8, -6, -4, 舍入到 -6.
</pre>

<blockquote>
<p>
根据 Excel 版本不同, CEILING 函数用法相同的还有 CEILING.PRECISE 和 CEILING.MATH
这三个函数都可以达到相同的计算结果.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org40b07fc" class="outline-5">
<h5 id="org40b07fc"><span class="section-number-5">2.2.3.6</span> FLOOR 函数(向下舍入到最接近指定数字的某个值的倍数值)</h5>
<div class="outline-text-5" id="text-2-2-3-6">
<p>
\[ FLOOR(number, significance) \]
</p>

<ul class="org-ul">
<li>number : 需要舍入的值.</li>
<li>significance: 要舍入到的倍数.</li>
</ul>


<p>
FLOOR 函数将数值向下舍入(向0的方向)到最接近指定数值的倍数.
</p>

<blockquote>
<p>
floor 和 rounddown 都向下舍入,但二者不同.
rounddown 对数据按指定位数舍入,不考虑四舍五入,直接截取小数位.
floor 时将输入舍入到绝对值减小的最接近 significance 的倍数.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=FLOOR(5,2)
舍入到 4
=FLOOR(5.4, 1)
舍入到 5
=FLOOR(-2.5, 1)
舍入到-3,和 CEILING 一样,number 为负数, significance 为整数时表现与数学的向下舍入一致.
</pre>
</div>
</div>

<div id="outline-container-orgec6e859" class="outline-5">
<h5 id="orgec6e859"><span class="section-number-5">2.2.3.7</span> MROUND 函数(按指定倍数舍入)</h5>
<div class="outline-text-5" id="text-2-2-3-7">
<p>
\[ MROUND(number, multiple) \]
</p>

<ul class="org-ul">
<li>number : 需要舍入的值.</li>
<li>multiple: 需要将数值 number 舍入到的倍数.</li>
</ul>


<p>
MROUND 返回参数按指定倍数舍入后的数值.
</p>

<blockquote>
<p>
除了纯数学运算,一般数学应用的计算都只有在不足半数取消,多余半数算数的情况下使用.
例如, 计算货物需要装车多少,最后不足半车就不发车,多余半车则发一车.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=MROUDN(10,3)
返回 10 最接近 3 的倍数的值, 3,6,9,12 最接近为 9 即返回9
=MROUDN(13.25,3)
返回 13.25 最接近 3 的倍数的值, 3,6,9,12,15 最接近为 12 即返回12
</pre>
</div>
</div>

<div id="outline-container-org5567148" class="outline-5">
<h5 id="org5567148"><span class="section-number-5">2.2.3.8</span> EVEN 函数</h5>
<div class="outline-text-5" id="text-2-2-3-8">
<p>
\[ EVEN(number) \]
</p>

<ul class="org-ul">
<li>number: 必需, 表示需要舍入的值</li>
</ul>


<p>
EVEN 函数返回沿着绝对值增大方向取整的最接近的偶数.
</p>

<p>
使用示例:
</p>
<pre class="example">
=EVEN(-2)
-2 最接近的偶数 -2
=EVEN(-3)
-3 最接近的偶数(绝对值增大的方向) -4
=EVEN(3)
返回 4
</pre>
</div>
</div>

<div id="outline-container-org7999696" class="outline-5">
<h5 id="org7999696"><span class="section-number-5">2.2.3.9</span> ODD 函数</h5>
<div class="outline-text-5" id="text-2-2-3-9">
<p>
\[ ODD(number) \]
</p>

<ul class="org-ul">
<li>number: 必需, 表示需要舍入的值</li>
</ul>


<p>
ODD 函数返回沿着绝对值增大方向取整的最接近的奇数.
</p>

<p>
使用示例:
</p>
<pre class="example">
=ODD(-2)
-2 最接近的奇数 -3
=ODD(-3)
-3 最接近的奇数(绝对值增大的方向) -3
=ODD(2)
返回 3
</pre>
</div>
</div>

<div id="outline-container-org9d8305c" class="outline-5">
<h5 id="org9d8305c"><span class="section-number-5">2.2.3.10</span> TRUNC 函数(不考虑四舍五入直接对数字进行截断)</h5>
<div class="outline-text-5" id="text-2-2-3-10">
<p>
\[ TRUNC(number, [num_digits]) \]
</p>

<ul class="org-ul">
<li>number: 需要截尾取整的数字.</li>
<li>num<sub>digits</sub>: 可选,用于指定精度的数字. num<sub>digits</sub> 默认/省略时为0</li>
</ul>


<p>
TRUNC 函数用于将数字的小数部分截取,返回整数
</p>

<p>
使用示例:
</p>
<pre class="example">
=TRUNC(1.999)
结果为 1
=TRUNC(1.999, 1)
结果为 1.9
</pre>

<blockquote>
<p>
TRUNC 函数与 INT 函数类似,都是截断取整在对正数取整时,两个函数表现一致,
对负数取整时, TRUNC 仍然直接截取小数部分,而 INT 是去掉小数后加 -1, 因为 INT 是要
舍入的,而 TRUNC 是直接截断.
</p>
</blockquote>
</div>
</div>
</div>

<div id="outline-container-orgb9f8a61" class="outline-4">
<h4 id="orgb9f8a61"><span class="section-number-4">2.2.4</span> 三角函数</h4>
<div class="outline-text-4" id="text-2-2-4">
<p>
三角函数的使用与数学中的三角函数使用方法一致,使用示例也一致,并不需要很大功夫理解,只
有函数命名以及少数几个函数需要记忆.
</p>
</div>
<div id="outline-container-orge5b005c" class="outline-5">
<h5 id="orge5b005c"><span class="section-number-5">2.2.4.1</span> COS 函数</h5>
<div class="outline-text-5" id="text-2-2-4-1">
<p>
\[ COS(number) \]
</p>

<ul class="org-ul">
<li>number: 表示要求余弦的角度,以弧度表示.如果角度数据是以角度表示的,可以将角度乘
以 PI()/180 或使用 RADIANS 函数转为弧度值.</li>
</ul>


<p>
COS 函数返回给定角度的余弦值.
</p>

<p>
使用示例:
</p>
<pre class="example">
=COS(RADIANS(60))
60度角的余弦值为 0.5
=COS(RADIANS(120))
120度角的余弦值为 -0.5
</pre>
</div>
</div>

<div id="outline-container-orgf855802" class="outline-5">
<h5 id="orgf855802"><span class="section-number-5">2.2.4.2</span> ACOS 函数</h5>
<div class="outline-text-5" id="text-2-2-4-2">
<p>
\[ ACOS(number) \]
</p>

<ul class="org-ul">
<li>number: 表示余弦值,介于 -1 到 1.</li>
</ul>


<p>
返回数字的反余弦值. 反余弦值为角度,余弦值为数字,返回的值用弧度表示. 结果范围是 0-π
</p>

<p>
使用示例:
</p>
<pre class="example">
=ACOS(1)
余弦值1的反余弦值为0
=ACOS(-1)
余弦值-1 的反余弦值为 π,即 3.1415....
</pre>
</div>
</div>

<div id="outline-container-org1a37ae5" class="outline-5">
<h5 id="org1a37ae5"><span class="section-number-5">2.2.4.3</span> COSH 函数</h5>
<div class="outline-text-5" id="text-2-2-4-3">
<p>
\[ COSH(number) \]
</p>

<ul class="org-ul">
<li>number: 表示要求的双曲余弦的任意实数</li>
</ul>


<p>
COSH 函数返回数字的双曲余弦值.
</p>

<p>
使用示例:
</p>
<pre class="example">
=COSH(0)
0 的双曲余弦值为 1
</pre>
</div>
</div>

<div id="outline-container-org0f626bc" class="outline-5">
<h5 id="org0f626bc"><span class="section-number-5">2.2.4.4</span> ACOSH 函数</h5>
<div class="outline-text-5" id="text-2-2-4-4">
<p>
\[ ACOSH(number) \]
</p>

<ul class="org-ul">
<li>number: 表示大于或等于1的任意实数.</li>
</ul>


<p>
ACOSH 函数返回参数的反双曲余弦值,参数必需大于或等于1,反双曲余弦值的双曲余弦即为
元参数,因此 \(ACOSH(COSH(number))\) 等于 number
</p>

<p>
使用示例:
</p>
<pre class="example">
=ACOSH(1)
1 的反双曲余弦值为 0
</pre>
</div>
</div>

<div id="outline-container-org7a10d34" class="outline-5">
<h5 id="org7a10d34"><span class="section-number-5">2.2.4.5</span> SIN 函数</h5>
<div class="outline-text-5" id="text-2-2-4-5">
<p>
\[ SIN(number) \]
</p>

<ul class="org-ul">
<li>number: 表示要求正弦的角度,以弧度表示.如果角度数据是以角度表示的,可以将角度乘
以 PI()/180 或使用 RADIANS 函数转为弧度值.</li>
</ul>


<p>
SIN 函数返回给定角度的正弦值.
</p>

<p>
使用示例:
</p>
<pre class="example">
=SIN(RADIANS(30))
30度角的正弦值为 0.5
</pre>
</div>
</div>

<div id="outline-container-org6642aeb" class="outline-5">
<h5 id="org6642aeb"><span class="section-number-5">2.2.4.6</span> ASIN 函数</h5>
<div class="outline-text-5" id="text-2-2-4-6">
<p>
\[ ASIN(number) \]
</p>

<ul class="org-ul">
<li>number: 表示所需角度的正弦值,范围是 -1~1.</li>
</ul>


<p>
ASIN 函数返回参数的反正弦值.返回的角度值用弧度表示.
</p>

<p>
使用示例:
</p>
<pre class="example">
=ASIN(0.5)
30度角的正弦值为 0.5 ,因此返回 30*π/180 的值 0.52359...
</pre>
</div>
</div>

<div id="outline-container-org191758b" class="outline-5">
<h5 id="org191758b"><span class="section-number-5">2.2.4.7</span> SINH 函数</h5>
<div class="outline-text-5" id="text-2-2-4-7">
<p>
\[ SINH(number) \]
</p>

<ul class="org-ul">
<li>number: 表示要求的双曲正弦的任意实数</li>
</ul>


<p>
SINH 函数用于返回某一个数字的双曲正弦值.
</p>

<p>
使用示例:
</p>
<pre class="example">
=SINH(0)
0的双曲正弦值为0
</pre>
</div>
</div>

<div id="outline-container-org7eb21c0" class="outline-5">
<h5 id="org7eb21c0"><span class="section-number-5">2.2.4.8</span> ASINH 函数</h5>
<div class="outline-text-5" id="text-2-2-4-8">
<p>
\[ ASINH(number) \]
</p>

<ul class="org-ul">
<li>number: 任意实数.</li>
</ul>


<p>
ASINH 函数返回参数的反双曲正弦值. ASINH(SINH(number)) 等于 number.
</p>

<p>
使用示例:
</p>
<pre class="example">
=ASINH(1)
1 的反双曲正弦值为 0.88137...
</pre>
</div>
</div>

<div id="outline-container-orgd18df04" class="outline-5">
<h5 id="orgd18df04"><span class="section-number-5">2.2.4.9</span> TAN 函数</h5>
<div class="outline-text-5" id="text-2-2-4-9">
<p>
\[ TAN(number) \]
</p>

<ul class="org-ul">
<li>number: 要求的正切的角度,以弧度表示. 如果参数的单位是角度,可以乘 PI()/180 或
RADIANS 函数转为弧度.</li>
</ul>


<p>
TAN 函数用于返回给定角度的正切值.
</p>

<p>
使用示例:
</p>
<pre class="example">
=TAN(RADIANS(45))
45度角的正切值为 1.
</pre>
</div>
</div>


<div id="outline-container-orgac94845" class="outline-5">
<h5 id="orgac94845"><span class="section-number-5">2.2.4.10</span> ATAN 函数</h5>
<div class="outline-text-5" id="text-2-2-4-10">
<p>
\[ ATAN(number) \]
</p>

<ul class="org-ul">
<li>number: 所求角度的正切值.</li>
</ul>


<p>
ATAN 函数用于返回反正切值. 反正切值为角度,参数为正切值,返回的角度用弧度表示.
</p>

<p>
使用示例:
</p>
<pre class="example">
=ATAN(-1)
-45 度角的反正切值为 -1 ,所以ATAN(-1) 返回 -45度角的弧度值.
</pre>
</div>
</div>

<div id="outline-container-org9025d97" class="outline-5">
<h5 id="org9025d97"><span class="section-number-5">2.2.4.11</span> ATAN2 函数</h5>
<div class="outline-text-5" id="text-2-2-4-11">
<p>
\[ ATAN2(x_num, y_num) \]
</p>

<ul class="org-ul">
<li>x<sub>num</sub>: 点的 x 座标</li>
<li>y<sub>num</sub>: 点的 y 座标</li>
</ul>


<p>
ATAN2 函数用于返回给定的 x 以及 y 坐标的反正切值.
</p>
<blockquote>
<p>
就是返回原点与(x,y)点的直线与 X 轴的夹角.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=ATAN2(1,1)
原点(0,0) 到点(1,1) 的直线与 x 轴夹角为 45 度,返回的是 45 度角的弧度值.
</pre>
</div>
</div>

<div id="outline-container-org6839002" class="outline-5">
<h5 id="org6839002"><span class="section-number-5">2.2.4.12</span> TANH 函数</h5>
<div class="outline-text-5" id="text-2-2-4-12">
<p>
\[ TANH(number) \]
</p>

<ul class="org-ul">
<li>number: 任意实数.</li>
</ul>


<p>
TANH 函数用于返回某一函数的双曲正切值.
</p>

<p>
使用示例:
</p>
<pre class="example">
=TANH(0)
0 的双曲正切值为0
</pre>
</div>
</div>


<div id="outline-container-orga0b0522" class="outline-5">
<h5 id="orga0b0522"><span class="section-number-5">2.2.4.13</span> ATANH 函数</h5>
<div class="outline-text-5" id="text-2-2-4-13">
<p>
\[ ATANH(number) \]
</p>

<ul class="org-ul">
<li>number: -1~1 的任意实数.</li>
</ul>

<p>
ATANH 函数返回参数的反双曲正切值.
</p>

<p>
使用示例:
</p>
<pre class="example">
=ATANH(0)
0度角的反双曲正切值为0 返回值为 0度角的弧度值0.
</pre>
</div>
</div>

<div id="outline-container-orgf1f78cb" class="outline-5">
<h5 id="orgf1f78cb"><span class="section-number-5">2.2.4.14</span> DEGREES 函数</h5>
<div class="outline-text-5" id="text-2-2-4-14">
<p>
\[ DEGREES(angle) \]
</p>

<ul class="org-ul">
<li>angle: 以弧度表示的角度值.</li>
</ul>


<p>
DEGREES 用于将弧度转换为角度.
</p>

<p>
使用示例:
</p>
<pre class="example">
=DEGREES(ACOS(-1))
180 度角的余弦值为 -1 因此 ACOS 返回 180 角的弧度值, DEGREES 将该弧度值转为角度值180.
</pre>
</div>
</div>

<div id="outline-container-orge776799" class="outline-5">
<h5 id="orge776799"><span class="section-number-5">2.2.4.15</span> PI 函数</h5>
<div class="outline-text-5" id="text-2-2-4-15">
<p>
\[ PI() \]
</p>

<blockquote>
<p>
PI 函数没有参数,和 FALSE, TRUE, RAND 等参数一样.
</p>
</blockquote>

<p>
PI 函数用于返回数学常量 π, 精确到小数后 14 位.
</p>

<p>
使用示例:
</p>
<pre class="example">
=45*PI()/180
将 45 度角转为弧度值.
</pre>
</div>
</div>
</div>

<div id="outline-container-org6766d50" class="outline-4">
<h4 id="org6766d50"><span class="section-number-4">2.2.5</span> 对数,幂和阶乘函数</h4>
<div class="outline-text-4" id="text-2-2-5">
</div>
<div id="outline-container-orgad6634d" class="outline-5">
<h5 id="orgad6634d"><span class="section-number-5">2.2.5.1</span> EXP 函数</h5>
<div class="outline-text-5" id="text-2-2-5-1">
<p>
\[ EXP(number) \]
</p>

<ul class="org-ul">
<li>number: 应用于底数 e 的指数.</li>
</ul>


<p>
EXP 函数用于返回 e 的 number 次幂. 常数 e 是自然对数的底数.
</p>

<p>
使用示例:
</p>
<pre class="example">
=EXP(0)
e 的 0 次幂为 1
</pre>
</div>
</div>

<div id="outline-container-orga4bcb60" class="outline-5">
<h5 id="orga4bcb60"><span class="section-number-5">2.2.5.2</span> POWER 函数</h5>
<div class="outline-text-5" id="text-2-2-5-2">
<p>
\[ POWER(number, power) \]
</p>

<ul class="org-ul">
<li>number: 底数,可以为任意实数.</li>
<li>power: 指数,底数按指数次幂乘方</li>
</ul>

<p>
POWER 函数用于返回给定数字的乘幂.
</p>

<p>
使用示例:
</p>
<pre class="example">
=POWER(0.5, 2)
0.5 的平方,结果为 0.25
=POWER(4, 0.5)
4 的 0.5 次方,结果为 2
</pre>
</div>
</div>

<div id="outline-container-org9ce4d9d" class="outline-5">
<h5 id="org9ce4d9d"><span class="section-number-5">2.2.5.3</span> LN 函数</h5>
<div class="outline-text-5" id="text-2-2-5-3">
<p>
\[ LN(number) \]
</p>

<ul class="org-ul">
<li>number: 想要计算其自然对数的正实数.</li>
</ul>


<p>
LN 函数返回一个数的自然对数,自然对数以常数 e 为底.
</p>
<blockquote>
<p>
LN(1) 就是 \(\ln_e^1\)
</p>
</blockquote>
<p>
使用示例:
</p>
<pre class="example">
=LN(1)
e 的 0 次方为 1,所以结果为 0
</pre>
</div>
</div>

<div id="outline-container-orgbdb3408" class="outline-5">
<h5 id="orgbdb3408"><span class="section-number-5">2.2.5.4</span> LOG 函数</h5>
<div class="outline-text-5" id="text-2-2-5-4">
<p>
\[ LOG(number, [base]) \]
</p>

<ul class="org-ul">
<li>number: 要计算其对数的正实数.</li>
<li>base: 对数的底数,省略底数则默认值为 10.</li>
</ul>


<p>
LOG 函数按指定的底数返回数的对数.
</p>

<p>
使用示例:
</p>
<pre class="example">
=LOG(2,2)
2 的 1 次幂为 2, 所以返回结果为 1
=LOG(1, EXP(1))
等价于 =LN(1) 返回结果 0
</pre>
</div>
</div>

<div id="outline-container-orgdd543e3" class="outline-5">
<h5 id="orgdd543e3"><span class="section-number-5">2.2.5.5</span> LOG10 函数</h5>
<div class="outline-text-5" id="text-2-2-5-5">
<p>
\[ LOG10(number) \]
</p>

<ul class="org-ul">
<li>number: 要计算其常用对数的正实数,即真数.</li>
</ul>


<p>
LOG10 函数用于返回以 10 为底的对数.
</p>

<p>
使用示例:
</p>
<pre class="example">
=LOG10(100)
10 的 2 次幂为 100 所以返回结果值为 2
=LOG10(10)
结果值为 1
</pre>
</div>
</div>

<div id="outline-container-orge856f5c" class="outline-5">
<h5 id="orge856f5c"><span class="section-number-5">2.2.5.6</span> SERIESSUM 函数</h5>
<div class="outline-text-5" id="text-2-2-5-6">
<p>
\[ SERIESSUM(x, n, m, coefficients) \]
</p>

<ul class="org-ul">
<li>x: 幂级数的输入值.</li>
<li>n: x 的首项乘幂.</li>
<li>m: 级数中每一项的乘幂 n 的步长增加值.</li>
<li>coefficients: 一系列与 x 各级乘幂相乘的系数. coefficients 值的数目决定了幂级数
的项数.例如, coefficients 有 3 各值,则幂级数有 3 项.</li>
</ul>


<p>
SERIESSUM 函数返回基于公式的幂级数的和.
</p>

<p>
使用示例:
</p>
<pre class="example">
=SERIESSUM(1,1,0.5,{1,0.5,3})
</pre>
<p>
\(1*1^1 + 0.5*1^1.5 + 3*1^2 = 1+0.5+3 = 4.5\)
</p>
</div>
</div>

<div id="outline-container-org9035e80" class="outline-5">
<h5 id="org9035e80"><span class="section-number-5">2.2.5.7</span> FACT 函数</h5>
<div class="outline-text-5" id="text-2-2-5-7">
<p>
\[ FACT(number) \]
</p>

<ul class="org-ul">
<li>number: 要计算其阶乘的非负数. 如果 number 不是整数,则截尾取整.</li>
</ul>


<p>
FACT 函数用于返回数字的阶乘.
</p>

<p>
\[ n! = 1 \times 2 \times 3 \cdots n\]
</p>

<p>
使用示例:
</p>
<pre class="example">
=FACT(5)
1*2*3*4*5=120
</pre>
</div>
</div>

<div id="outline-container-orgb153198" class="outline-5">
<h5 id="orgb153198"><span class="section-number-5">2.2.5.8</span> FACTDOUBLE 函数</h5>
<div class="outline-text-5" id="text-2-2-5-8">
<p>
\[ FACTDOUBLE(number) \]
</p>

<ul class="org-ul">
<li>number: 要计算其双倍阶乘的数值.</li>
</ul>


<p>
FACTDOUBLE 函数用于返回数字的双倍阶乘.
如果 number 为偶数则
\[ n!! = n(n-2)(n-4)\cdots(4)(2)\]
如果 number 为奇数则
\[ n!! = n(n-2)(n-4)\cdots(3)(1)\]
</p>

<p>
使用示例:
</p>
<pre class="example">
=FACTDOUBLE(3)
3!!=3*1=3
=FACTDOUBLE(1.5)
1.5 非整数,直接截断为 1, 1!!=1
</pre>

<blockquote>
<p>
如果 FACTDOUBLE 参数为非数值类型, 返回错误值 "#VALUE!" ,如果参数为负数,则返回错
误值 "#NUM!"
</p>
</blockquote>
</div>
</div>
</div>
</div>

<div id="outline-container-org327e21d" class="outline-3">
<h3 id="org327e21d"><span class="section-number-3">2.3</span> 文本函数(27)</h3>
<div class="outline-text-3" id="text-2-3">
</div>
<div id="outline-container-org59c9d96" class="outline-4">
<h4 id="org59c9d96"><span class="section-number-4">2.3.1</span> 文本查找,提取</h4>
<div class="outline-text-4" id="text-2-3-1">
</div>
<div id="outline-container-org9fa38cd" class="outline-5">
<h5 id="org9fa38cd"><span class="section-number-5">2.3.1.1</span> MID 函数(从任意位置提取指定数目的字符)</h5>
<div class="outline-text-5" id="text-2-3-1-1">
<p>
\[ MID(text,start_num,num_chars) \]
</p>

<ul class="org-ul">
<li>text: 要提取字符的文本字符串.</li>
<li>start<sub>num</sub>: 要提取的第一个字符的位置, text 中第一个字符为 1,依次类推.</li>
<li>num<sub>chars</sub>: 指定希望 MID 从文本中返回字符的个数.</li>
</ul>


<p>
MID 函数用于返回文本字符串中从指定位置开始的特定数目的字符.
</p>

<blockquote>
<p>
理解为从 text 中 start<sub>num</sub> 位置开始提取 num<sub>chars</sub> 个字符.
</p>
</blockquote>
<p>
使用示例:
</p>
<pre class="example">
=VALUE(MID("LPE-W12-2.2cm", 9, 3))
MID 提取 2.2cm 中的 2.2 文本值, VALUE 将 "2.2" 转换成数值 2.2
=MID(A2,17,1)
假设 A2 为身份证号,提取第17位值, 该位表示性别,奇数为男,偶数为女
=IF(MOD(VALUE(A2,17,1),2)=1, "男", "女")
提取出的身份证第17位为奇数,则返回男,否则返回女.
</pre>
</div>
</div>

<div id="outline-container-org764a12c" class="outline-5">
<h5 id="org764a12c"><span class="section-number-5">2.3.1.2</span> LEFT 函数(按指定字符数从最左侧提取字符串)</h5>
<div class="outline-text-5" id="text-2-3-1-2">
<p>
\[ LEFT(text, [num_chars]) \]
</p>

<ul class="org-ul">
<li>text: 包含要提取的字符串的文本字符串.</li>
<li>num<sub>chars</sub>: 要提取的字符数量.</li>
</ul>


<p>
LEFT 函数用于从文本左侧开始提取指定个数的字符.
</p>

<p>
使用示例:
</p>
<pre class="example">
=LEFT("湖北-景泰广业",2)
从左侧提取字符串的前两个字符,这里返回 "湖北"
=IF(LEFT(A2,3)="打印机", C2+200，C2+100)
假设 A 列数据为"打印机H530","传真机HL40" 等数据,
C 列为售价,上面的公式会把打印机售价调高200,其他机器调高100
</pre>

<blockquote>
<p>
与 LEFT 类似的还有 LEFTB 函数,只不过 LEFTB 是以字节数计算的.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orgfb71229" class="outline-5">
<h5 id="orgfb71229"><span class="section-number-5">2.3.1.3</span> RIGHT 函数(按指定字符数从最右侧提取字符串)</h5>
<div class="outline-text-5" id="text-2-3-1-3">
<p>
\[ RIGHT(text, [num_chars]) \]
</p>

<ul class="org-ul">
<li>text: 包含要提取的字符串的文本字符串.</li>
<li>num<sub>chars</sub>: 要提取的字符数量.</li>
</ul>


<p>
RIGHT 函数用于从文本右侧开始提取指定个数的字符.
</p>

<p>
使用示例:
</p>

<pre class="example">
=RIGHT("紫檀(印度)",4)
从最右侧开始提取 4 各字符,即 (印度)
</pre>

<blockquote>
<p>

</p>

<p>
与 RIGHT 类似的还有 RIGHTB 函数,只不过 RIGHTB 是以字节数计算的.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org578c2cd" class="outline-5">
<h5 id="org578c2cd"><span class="section-number-5">2.3.1.4</span> SEARCH 函数(查找字符串的起始位置)</h5>
<div class="outline-text-5" id="text-2-3-1-4">
<p>
\[ SEARCH(find_text, within_test, [start_num]) \]
</p>

<ul class="org-ul">
<li>find<sub>text</sub> : 要查找的文本.</li>
<li>within<sub>text</sub>: 要在其中搜索 find<sub>text</sub> 的文本.</li>
<li>start<sub>num</sub>: 从 within<sub>text</sub> 中开始搜索的字符编号.</li>
</ul>


<p>
SEARCH 函数在第二个参数 within<sub>text</sub> 中从 start<sub>num</sub> 开始查找 find<sub>text</sub> 字符串,然
后返回 find<sub>text</sub> 字符串的第一个字符位于 within<sub>text</sub> 中的位置.
</p>

<blockquote>
<p>
SEARCH 函数支持通配符.且不区分大小写.
和 SEARCH 函数类似的是 FIND 函数,但 FIND 不支持通配符,且区分大小写.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=SEARCH("VO?", "12Voabc", 2)
从 "12Voabc" 的第二个字符开始查找以 VO 开头的三个字符组成的字符串,这里会找到 Voa,
因为 SEARCH 不区分大小写,然后返回其在 "12VOabc" 中的起始位置,即3,所以返回结果为3.
</pre>

<blockquote>
<p>
与 SEARCH 函数类似的还有 SEARCHB 函数,但 SEARCHB 是按照字节计算的,按字节计算对于
非中文的字符串而言与 SEARCH 没有区别,因为数字/字母在字符串中一个字符只占一个字节,但
是中文字符在字符串中一个字符占用两个字节.
以上面的例子为例:
=SEARCH("VO?", "12Voabc", 2) 结果为3
=SEARCHB("VO?", "12Voabc", 2) 结果也为3
=SEARCH("VO?", "你Voabc", 1) 结果为2
=SEARCHB("VO?", "你Voabc", 1) 结果为3,因为 "你"这一个字符占 2 各字节.
</p>
</blockquote>
</div>
</div>
</div>


<div id="outline-container-orge79bfeb" class="outline-4">
<h4 id="orge79bfeb"><span class="section-number-4">2.3.2</span> 文本替换</h4>
<div class="outline-text-4" id="text-2-3-2">
</div>
<div id="outline-container-org92ad1af" class="outline-5">
<h5 id="org92ad1af"><span class="section-number-5">2.3.2.1</span> REPLACE 函数(替换文本字符串的部分文本)</h5>
<div class="outline-text-5" id="text-2-3-2-1">
<p>
\[ REPLACE(old_text, start_num, num_chars, new_text) \]
</p>

<ul class="org-ul">
<li>old<sub>text</sub>: 要替换其部分字符的文本.</li>
<li>start<sub>num</sub>: 要用 new<sub>text</sub> 替换的字符位于 old<sub>text</sub> 中的位置.</li>
<li>num<sub>chars</sub>: 希望用 new<sub>text</sub> 替换 old<sub>text</sub> 中的字符的个数.</li>
<li>new<sub>text</sub>: 表示将用于替换 old<sub>text</sub> 中的文本.</li>
</ul>

<blockquote>
<p>
理解就是将 old<sub>text</sub> 中第 start<sub>num</sub> 个字符开始的 num<sub>chars</sub> 个字符用 new<sub>text</sub> 替换.
</p>
</blockquote>
<p>
REPLACE 使用其他文本字符串并根据所指定的字符数替换文本字符串中的部分文本.
</p>

<blockquote>
<p>
无论是什么语言, REPLACE 函数始终将每个字符按 1 计数,就是对于 replace 函数来说
"ab" 计数为 2, "一二" 的计数也为2,尽管中文字符占2各字节.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=REPLACE("12345678901", 8, 4, "****")
将 "12345678901" 第8个字符开始的4个字符用 "****" 替换.即将 "8901" 用 "****" 替换.
结果为 1234567****
=REPLACE("1300_780便携14寸",5,1,"*")
将 "1300_780便携14寸" 中的 "_" 替换成 "*"
</pre>
</div>
</div>

<div id="outline-container-org2bc1e1f" class="outline-5">
<h5 id="org2bc1e1f"><span class="section-number-5">2.3.2.2</span> SUBSTITUTE 函数(用新文本替换旧文本)</h5>
<div class="outline-text-5" id="text-2-3-2-2">
<p>
\[ SUBSTITUTE(text, old_text, new_text, instance_num) \]
</p>

<ul class="org-ul">
<li>text: 需要替换其中文本的字符串或是含有文本的单元格引用.</li>
<li>old<sub>text</sub>: 要替换的旧文本.</li>
<li>new<sub>text</sub>: 用于替换 old<sub>text</sub> 的新文本.</li>
<li>instance<sub>num</sub>: 指定 new<sub>text</sub> 替换 old<sub>text</sub> 出现在 text 中的次数,如果指定了该参
数,则只替换符合条件的 old<sub>text</sub>, 没指定则替换所有 old<sub>text</sub>.</li>
</ul>


<p>
SUBSTITUTE 函数用于在文本字符串中用新文本替代旧文本.
</p>

<p>
使用示例:
</p>
<pre class="example">
=SUBSTITUTE("不  得 无   故 矿工"," ","")
旧文本为空格字符串,新文本为空内容,这个公式作用为删除 text 中的空格.
=LEN("a,b,c,d")-LEN(SUBSTITUTE("a,b,c,d", ",", ""))
通过将字符串中的逗号删除,然后通过前后字符串的长度差来得出逗号在字符串中出现的个数.
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc271710" class="outline-4">
<h4 id="orgc271710"><span class="section-number-4">2.3.3</span> 文本格式转换</h4>
<div class="outline-text-4" id="text-2-3-3">
</div>
<div id="outline-container-org5114a07" class="outline-5">
<h5 id="org5114a07"><span class="section-number-5">2.3.3.1</span> ASC 函数(将全角字符转换为半角字符)</h5>
<div class="outline-text-5" id="text-2-3-3-1">
<p>
\[ ASC(text) \]
</p>

<ul class="org-ul">
<li>text : 文本或包含文本的单元格引用,如果数据中不包含任何全角字符,则不会有任何改
变.</li>
</ul>


<p>
ASC 函数将全角(双字节)字符转换成半角(单字节)字符
</p>

<p>
使用示例:
</p>
<pre class="example">
=ASC("中文句号。")
"。" 是全角字符,"." 是半角字符,结果为 "中文句号." 仅仅转换了标点
</pre>
</div>
</div>

<div id="outline-container-org0c18ed2" class="outline-5">
<h5 id="org0c18ed2"><span class="section-number-5">2.3.3.2</span> WIDECHAR 函数(将半角字符转换为全角字符)</h5>
<div class="outline-text-5" id="text-2-3-3-2">
<p>
\[ WIDECHAR(text) \]
</p>

<ul class="org-ul">
<li>text : 文本或包含文本的单元格引用,如果数据中不包含任何半角字符,则不会有任何改
变.</li>
</ul>


<p>
WIDECHAR 函数将半角(单字节)字符转换成全角(双字节)字符
</p>


<p>
使用示例:
</p>
<pre class="example">
=WIDECHAR("中文句号.")
"。" 是全角字符,"." 是半角字符,结果为 "中文句号。" 仅仅转换了标点
</pre>
</div>
</div>

<div id="outline-container-orgec178e3" class="outline-5">
<h5 id="orgec178e3"><span class="section-number-5">2.3.3.3</span> LOWER 函数(将文本转为小写形式)</h5>
<div class="outline-text-5" id="text-2-3-3-3">
<p>
\[ LOWER(text) \]
</p>

<ul class="org-ul">
<li>text: 表示要转换成小写字母的文本, LOWER 函数不会改变文本中的非字母的字符.</li>
</ul>


<p>
LOWER 函数将一个文本字符串中的所有大写字母转换为小写字母.
</p>

<p>
使用示例:
</p>
<pre class="example">
=LOWER("Chinese:中文")
结果返回 chinese:中文
</pre>
</div>
</div>

<div id="outline-container-org80d3d54" class="outline-5">
<h5 id="org80d3d54"><span class="section-number-5">2.3.3.4</span> UPPER 函数(将文本转为大写形式)</h5>
<div class="outline-text-5" id="text-2-3-3-4">
<p>
\[ UPPER(text) \]
</p>

<ul class="org-ul">
<li>text: 表示要转换成大写字母的文本, UPPER 函数不会改变文本中的非字母的字符.</li>
</ul>


<p>
UPPER 函数将一个文本字符串中的所有小写字母转换为大写字母.
</p>

<p>
使用示例:
</p>
<pre class="example">
=UPPER("Chinese:中文")
结果返回 CHINESE:中文
</pre>
</div>
</div>

<div id="outline-container-org8fa104d" class="outline-5">
<h5 id="org8fa104d"><span class="section-number-5">2.3.3.5</span> PROPER(将文本字符串的首字母转为大写)</h5>
<div class="outline-text-5" id="text-2-3-3-5">
<p>
\[ PROPER(text) \]
</p>

<ul class="org-ul">
<li>text : 要将首字母大写的文本</li>
</ul>


<p>
PROPER  函数将文本字符串的首字母大写
</p>

<p>
使用示例:
</p>
<pre class="example">
=PROPER("chinese")
返回 Chinese
</pre>
</div>
</div>

<div id="outline-container-orgfcb5c66" class="outline-5">
<h5 id="orgfcb5c66"><span class="section-number-5">2.3.3.6</span> DOLLAR 函数(四舍五入数值,并添加千分位符和 $ 符号)</h5>
<div class="outline-text-5" id="text-2-3-3-6">
<p>
\[ DOLLAR(number, [decimals]) \]
</p>

<ul class="org-ul">
<li>number: 数值.</li>
<li>decimals: 十进制小数位数. 如果 decimals 为负数,则 number 在小数点左侧进行舍入,
如果省略 decimals, 则默认为 2.</li>
</ul>


<p>
DOLLAR 函数按照货币格式,将小数四舍五入到指定位数并转换成美元货币格式的文本,使用
的格式为 "(\(#,##0.00_);(\)#,##0.00)"
</p>

<blockquote>
<p>
根据 DOLLOR 函数的格式可以用 TEXT 函数实现相同功能,例如
TEXT(10000.123, "$#,##0.00")  与 DOLLOR(10000.123) 效果一样.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=DOLLOR(4598)
返回文本值 "$4,598.00"
</pre>
</div>
</div>

<div id="outline-container-org1365ec9" class="outline-5">
<h5 id="org1365ec9"><span class="section-number-5">2.3.3.7</span> RMB 函数(四舍五入数值,并添加千分位符号和¥符号)</h5>
<div class="outline-text-5" id="text-2-3-3-7">
<p>
\[ RMB(number, [decimals]) \]
</p>

<ul class="org-ul">
<li>number: 数值.</li>
<li>decimals: 十进制小数位数. 如果 decimals 为负数,则 number 在小数点左侧进行舍入,
如果省略 decimals, 则默认为 2.</li>
</ul>


<p>
RMB 函数按照货币格式将小数四舍五入到指定位数并转换成文本. 使用的格式为
"(¥#,##0.00_);(¥#,##0.00)"
</p>

<blockquote>
<p>
RMB 函数也可以根据其格式用相应的 TEXT 函数实现 TEXT(123,"¥#,##0.00")
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=RMB(9000)
等价于 =TEXT(9000,"¥#,##0.00") 结果为 "¥9,000.00"
</pre>
</div>
</div>

<div id="outline-container-org51421e5" class="outline-5">
<h5 id="org51421e5"><span class="section-number-5">2.3.3.8</span> BAHTTEXT 函数(将数字转为泰铢)</h5>
<div class="outline-text-5" id="text-2-3-3-8">
<p>
\[ BAHTTEXT(number) \]
</p>

<ul class="org-ul">
<li>number: 数值.</li>
</ul>


<p>
BAHTTEXT 函数将数字转换为泰语文本并添加后缀"泰铢"(泰语形式)
</p>

<p>
使用示例:
</p>
<pre class="example">
=BAHTTEXT(1000)
我不懂泰语,直接把运行结果粘贴: "หนึ่งพันบาทถ้วน"
</pre>
</div>
</div>

<div id="outline-container-orgdeb7c91" class="outline-5">
<h5 id="orgdeb7c91"><span class="section-number-5">2.3.3.9</span> FIXED 函数(将数字显示千分位符样式并转为文本)</h5>
<div class="outline-text-5" id="text-2-3-3-9">
<p>
\[ FIXED(number, decimals, no_commas) \]
</p>

<ul class="org-ul">
<li>number: 数值.</li>
<li>decimals: 十进制数的小数位数.</li>
<li>no<sub>commas</sub>: 一个逻辑值(TRUE/FALSE) 如果为 TRUE, 则禁止 FIXED 返回的文本中包含逗
号.</li>
</ul>


<p>
FIXED 函数将数字按照指定的小数位数进行舍入,利用句号和逗号,以小数格式对该数值进行
格式设置,以文本格式返回结果.
</p>

<p>
使用示例:
</p>
<pre class="example">
=FIXED(1000,2,1)
保留两位小数,不使用逗号那么转换的结果为 1000.00
=FIXED(1000,2)
保留两位小数,使用逗号那么转换的结果为 1,000.00
</pre>

<blockquote>
<p>
这里和作者书中的内容不一致,因为在我的 Excel 2016 里面,省略 no<sub>commas</sub> 则默认该值
为 FALSE, 结果会带上逗号, 但是作者书中也省略了,结果却没有逗号.可能是版本不同,也
可能是有错误,真实使用以实际为主.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orgf49e673" class="outline-5">
<h5 id="orgf49e673"><span class="section-number-5">2.3.3.10</span> TEXT 函数(设置数字格式并将其转为文本)</h5>
<div class="outline-text-5" id="text-2-3-3-10">
<p>
\[ TEXT(value,format_text) \]
</p>

<ul class="org-ul">
<li>value: 数值.</li>
<li>format<sub>text</sub>: 字符串表示的数字格式. 通过 "设置单元格"-"数字"-"类别" 中的众多选
项可以查看各种数字格式的格式字符串样式.</li>
</ul>


<p>
TEXT 函数将数值转换乘按照指定格式表示的文本.
</p>

<p>
使用示例:
</p>
<pre class="example">
=TEXT(10000.123, "$#,##0.00")
等价于 =DOLLAR(10000.123)
=TEXT(9000,"¥#,##0.00")
等价于 =RMB(9000)
=TEXT(101,"000000")
将数值按固定位数显示,不足用0补齐,结果为 "000101"
</pre>

<blockquote>
<p>
格式字符串中, 0和#都表示占位符,不同的是0表示位数不足用0补齐,而 # 则是位数不够就
不用管了.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orgc52dd70" class="outline-5">
<h5 id="orgc52dd70"><span class="section-number-5">2.3.3.11</span> VALUE 函数(将文本数字转换成数值)</h5>
<div class="outline-text-5" id="text-2-3-3-11">
<p>
\[ VALUE(text) \]
</p>

<ul class="org-ul">
<li>text: 文本值,文本内容需要是能转换乘数值的内容,如 "123" 否则,就会返回错误值
"#VALUE!" ,例如 VALUE("a").</li>
</ul>


<p>
VALUE 函数将代表数字的文本字符串转换成数值.
</p>

<p>
使用示例:
</p>
<pre class="example">
=VALUE("23450")
结果为 23450
</pre>
</div>
</div>

<div id="outline-container-org9e23f3a" class="outline-5">
<h5 id="org9e23f3a"><span class="section-number-5">2.3.3.12</span> CHAR 函数</h5>
<div class="outline-text-5" id="text-2-3-3-12">
<p>
\[ CHAR(number) \]
</p>

<ul class="org-ul">
<li>number: 必需,表示1-255 用于指定所需字符的数字. 字符是计算机所用字符集中的字符.</li>
</ul>


<p>
CHAR 函数用于返回对应于数字代码的字符. CHAR 可以将其他类型的计算机文件中的代码转
换成字符.
</p>

<p>
使用示例:
</p>
<pre class="example">
=CHAR(100)
在我自己计算机上返回的是字母 "d",
</pre>
</div>
</div>

<div id="outline-container-orgddb31bd" class="outline-5">
<h5 id="orgddb31bd"><span class="section-number-5">2.3.3.13</span> CODE 函数</h5>
<div class="outline-text-5" id="text-2-3-3-13">
<p>
\[ CODE(text) \]
</p>

<ul class="org-ul">
<li>text: 必需,表示需要得到其第一个字符代码的文本.</li>
</ul>


<p>
CODE 函数用于返回文本字符串中第一个字符的数字代码,返回的代码对应计算机当前使用的
字符集.
</p>
<blockquote>
<p>
CODE 函数和 CHAR 函数是相反的过程,一个根据字符得到数字代码,一个根据数字代码得到
字符.
</p>
</blockquote>
<p>
使用示例:
</p>
<pre class="example">
=CODE("d")
返回数字代码 100
</pre>
</div>
</div>

<div id="outline-container-orga8f31a3" class="outline-5">
<h5 id="orga8f31a3"><span class="section-number-5">2.3.3.14</span> UNICHAR 函数</h5>
<div class="outline-text-5" id="text-2-3-3-14">
<p>
\[UNICHAR(number)\]
</p>

<ul class="org-ul">
<li>number: 必需, 表示代表字符的 Unicode 数字. 当 Unicode 数字为部分代理项且数据类
型无效时, UNICHAR 返回错误值 "#N/A" 当数字的数值超过允许范围或数字为0 时,
UNICHAR 返回错误值 "#VALUE!"</li>
</ul>


<p>
UNICHAR 函数用于返回给定数值对应的 Unicode 字符. 返回的 Unicode 字符可以是一个字
符串,如以 UTF-8 或 UTF-16 编码的字符串.
</p>

<blockquote>
<p>
CODE 和 CHAR 都是返回执行函数的计算机本机上面的字符与数字代码的对应结果,而
UNICHAR 则是返回一个统一标准的 Unicode 的数字代码与字符的对应结果.也就是说, CODE
和 CHAR 在不同计算机上得出的结果可能不同,但是 Unicode 的计算结果一定相同.
</p>

<p>
Unicode 还可以表示表情之类的特殊字符,这种字符是不被 EXCEL 支持的,所以是无效类型.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=UNICHAR(100)
返回 Unicode 字符集中 100 对应的字符,结果为 "d"
</pre>
</div>
</div>
</div>

<div id="outline-container-org7d43949" class="outline-4">
<h4 id="org7d43949"><span class="section-number-4">2.3.4</span> 其他文本函数</h4>
<div class="outline-text-4" id="text-2-3-4">
</div>
<div id="outline-container-org915b021" class="outline-5">
<h5 id="org915b021"><span class="section-number-5">2.3.4.1</span> CONCATENATE 函数(合并多个文本字符串)</h5>
<div class="outline-text-5" id="text-2-3-4-1">
<p>
*
*\[ CONCATENATE(text1,[text2],\codts) \]
</p>
<p>
*
*+ text1 : 要合并的第一个文本值.
*+ \(text2,\dots\) : 要合并的剩余文本值,总共最多为 255 项.
</p>
<p>
*
</p>
<p>
*
*CONCATENATE 函数可将最多 255 各文本字符串连接成一个文本字符串,连接项可以是文本,
*数值,单元格引用.
</p>
<p>
*
*#+begin<sub>quote</sub>
*CONCATENATE 函数会自动将其他类型数据转为文本类型,并进行合并,其作用和文本连接符号
*"&amp;" 的作用是一样的.
*#+end<sub>quote</sub>
</p>
<p>
*
*使用示例:
*#+begin<sub>example</sub>
*=CONCATENATE("销售","1组")
*等价于 ="销售"&amp;"1组" 结果为 "销售1组"
*#+end<sub>example</sub>
</p>
<p>
*
</p>
</div>
</div>
<div id="outline-container-orgba7fe16" class="outline-5">
<h5 id="orgba7fe16"><span class="section-number-5">2.3.4.2</span> LEN 函数(返回文本字符串的字符数量)</h5>
<div class="outline-text-5" id="text-2-3-4-2">
<p>
*
*\[LEN(text)\]
</p>
<p>
*
*+ text: 需要查找长度的文本.
</p>
<p>
*
</p>
<p>
*
*LEN 函数用于返回文本字符串中字符的数量
</p>
<p>
*
*使用示例:
*#+begin<sub>example</sub>
*=IF(LEN("123123123123")=11,"","ERROR")
*检查字符是否是 11 位的.类似还可以检查身份证号码是否为 18位的.
*#+end<sub>example</sub>
</p>
<p>
*
</p>
</div>
</div>
<div id="outline-container-org51fc219" class="outline-5">
<h5 id="org51fc219"><span class="section-number-5">2.3.4.3</span> EXACT 函数(比较两个字符串是否完全相同)</h5>
<div class="outline-text-5" id="text-2-3-4-3">
<p>
*
*\[EXACT(text1,text2)\]
</p>
<p>
*
*+ text1: 第一个文本字符串.
*+ text2: 第二个文本字符串.
</p>
<p>
*
</p>
<p>
*
*EXACT 函数用于比较两个字符串,如果完全相同,则返回 TRUE, 否则返回 FALSE. EXACT 区
*分大小写,但是忽略格式上的差异.
</p>
<p>
*
*#+begin<sub>quote</sub>
*对于非文本类型的参数,会自动转换成文本类型. 格式上的差异指得应该是显示上的差异,例
*如文本颜色,字体之类的.
</p>
<p>
*
*大概等价于 =text1=text2, 考虑到数据类型转化的问题,应该是等价于
*=TEXT(text1,format)=TEXT(text2,format) ,其中的 format 应该为固定格式.
*#+end<sub>quote</sub>
</p>
<p>
*
*使用示例:
*#+begin<sub>example</sub>
*=EXACT(1,1)
*返回 TRUE
*=EXACT(125,"125")
*返回 TRUE
*#+end<sub>example</sub>
</p>
<p>
*
</p>
</div>
</div>
<div id="outline-container-org73fc8d0" class="outline-5">
<h5 id="org73fc8d0"><span class="section-number-5">2.3.4.4</span> REPT 函数(按照指定次数重复文本)</h5>
<div class="outline-text-5" id="text-2-3-4-4">
<p>
*
*\[ REPT(text, number_times) \]
</p>
<p>
*
*+ text: 要重复的文本.
*+ number<sub>times</sub>: 要重复的次数.
</p>
<p>
*
</p>
<p>
*
*REPT 函数返回文本按照给定的次数重复后的文本.
</p>
<p>
*
*使用示例:
*#+begin<sub>example</sub>
*=REPT("□",18)
*用于将方框重复 18 次,便于身份证号的填写.
*#+end<sub>example</sub>
</p>
<p>
*
</p>
</div>
</div>
<div id="outline-container-org42c5d35" class="outline-5">
<h5 id="org42c5d35"><span class="section-number-5">2.3.4.5</span> TRIM 函数</h5>
<div class="outline-text-5" id="text-2-3-4-5">
<p>
*
*\[TRIM(text)\]
</p>
<p>
*
*+ text: 需要删除空格的文本.
</p>
<p>
*
</p>
<p>
*
*TRIM 函数用来删除字符串前后的空格,中间的空格也会删除,但是会保留一个空格作为连接/
*分隔用途.
</p>
<p>
*
*使用示例:
*#+begin<sub>example</sub>
*=TRIM("   123   123  1   ")
*文本前后的空格会都被删除,中间的空格会保留一个,所以结果是 "123 123 1"
*#+end<sub>example</sub>
</p>
<p>
*
</p>
</div>
</div>
<div id="outline-container-orga0fda48" class="outline-5">
<h5 id="orga0fda48"><span class="section-number-5">2.3.4.6</span> CLEAN 函数(删除文本中不能打印的字符)</h5>
<div class="outline-text-5" id="text-2-3-4-6">
<p>
*
*\[CLEAN(text)\]
*+ text: 表示要删除非打印字符的任何工作表信息.
</p>
<p>
*
</p>
<p>
*
*CLEAN 函数用于删除文本中不能打印的字符. 对于从其他程序中输入的文本数据,可以使用
*CLEAN 函数删除其中含有的当前操作系统无法打印的字符.
</p>
<p>
*
*#+begin<sub>quote</sub>
*&lt;30天精学EXCEL&gt; 书中就有一个案例是这种的,从 ERP/数据库 软件中导入的数据有部分是
*EXCEL 无法显示的,所以表现为空格,但这个空格不是真的空格,是无法显示所以表现的和空
*格一样,当时的做法是复制该特殊字符,用数据分列的方式将其删除的.
*#+end<sub>quote</sub>
</p>
<p>
*
*使用示例:
*#+begin<sub>example</sub>
*=CLEAN("12
*123")
*会删除文本中的换行符号,得到结果 "12123"
*#+end<sub>example</sub>
</p>
<p>
*
</p>
</div>
</div>
<div id="outline-container-orgc538f7a" class="outline-5">
<h5 id="orgc538f7a"><span class="section-number-5">2.3.4.7</span> T 函数</h5>
<div class="outline-text-5" id="text-2-3-4-7">
<p>
*
*\[ T(value) \]
</p>
<p>
*
*+ value: 有返回值的表达式.
</p>
<p>
*
</p>
<p>
*
*T 函数检测参数值是否为文本,如果是则原样返回,不是则返回空文本("").
</p>
<p>
*
*使用示例:
*#+begin<sub>example</sub>
*=IF(T(123)="","不是文本","是文本")
*如果 T(123) 等于空文本,则返回 "不是文本",否则返回 "是文本", 因为 123 不是文本数据,所以
*T(123) 返回空文本,所以整个表达式返回 "不是文本".
*#+end<sub>example</sub>
</p>
</div>
</div>
</div>
</div>


<div id="outline-container-orge3bc068" class="outline-3">
<h3 id="orge3bc068"><span class="section-number-3">2.4</span> 信息函数(20)</h3>
<div class="outline-text-3" id="text-2-4">
</div>
<div id="outline-container-org71a2016" class="outline-4">
<h4 id="org71a2016"><span class="section-number-4">2.4.1</span> 返回信息以及各类型的值</h4>
<div class="outline-text-4" id="text-2-4-1">
</div>
<div id="outline-container-org1aaeac4" class="outline-5">
<h5 id="org1aaeac4"><span class="section-number-5">2.4.1.1</span> CELL 函数(返回有关单元格格式,位置或内容的信息)</h5>
<div class="outline-text-5" id="text-2-4-1-1">
<p>
\[ CELL(info_type, [reference]) \]
</p>

<ul class="org-ul">
<li>info<sub>type</sub>: 表示一个文本值,指定要返回的单元格信息类型.</li>
<li>reference: 表示需要其相关信息的单元格.</li>
</ul>


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 4:</span> info<sub>type</sub> 参数对应的信息类型</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">“address”</td>
<td class="org-left">引用中第一个单元格的引用，文本类型。</td>
</tr>

<tr>
<td class="org-left">“col”</td>
<td class="org-left">引用中单元格的列标。</td>
</tr>

<tr>
<td class="org-left">“color”</td>
<td class="org-left">如果单元格中的负值以不同颜色显示，则为值 1；否则，返回 0（零）。</td>
</tr>

<tr>
<td class="org-left">"contents"</td>
<td class="org-left">引用中左上角单元格的值：不是公式。</td>
</tr>

<tr>
<td class="org-left">"filename"</td>
<td class="org-left">包含引用的文件名（包括全部路径），文本类型。 如果包含目标引用的工作表尚未保存，则返回空文本 ("")。</td>
</tr>

<tr>
<td class="org-left">“format”</td>
<td class="org-left">对应于单元格数字格式的文本值。 下表显示了各种格式的文本值。 如果单元格为负值设置颜色格式，则返回文本值末尾的"-"。 如果单元格 () 正值或所有值的括号，则返回文本值末尾的" () "。</td>
</tr>

<tr>
<td class="org-left">“parentheses”</td>
<td class="org-left">如果单元格中为正值或所有单元格均加括号，则为值 1；否则返回 0。</td>
</tr>

<tr>
<td class="org-left">“prefix”</td>
<td class="org-left">与单元格中的“前置标签”相对应的文本值。 如果单元格文本左对齐，则返回单引号 (')；如果单元格文本右对齐，则返回双引号 (")；如果单元格文本居中，则返回插入字符 (^)；如果单元格文本两端对齐，则返回反斜线 (\)；如果是其他情况，则返回空文本 ("")。</td>
</tr>

<tr>
<td class="org-left">“protect”</td>
<td class="org-left">如果单元格没有锁定，则为值 0；如果单元格锁定，则返回 1。</td>
</tr>

<tr>
<td class="org-left">“row”</td>
<td class="org-left">引用中单元格的行号。</td>
</tr>

<tr>
<td class="org-left">“type”</td>
<td class="org-left">对应于单元格中数据类型的文本值。 如果单元格为空，则返回"b"表示空白;如果单元格包含文本常量，则返回"l"表示标签;如果单元格包含任何其他内容，则返回"v"作为值。</td>
</tr>

<tr>
<td class="org-left">“width”</td>
<td class="org-left">返回包含 2 个项的数组。 数组的第一项是单元格的列宽，四舍五入为整数。 列宽以默认字号的一个字符的宽度为单位。 数组的第二项是布尔值，如果列宽为默认值，则值为 TRUE;如果用户显式设置了宽度，则值为 FALSE。</td>
</tr>
</tbody>
</table>

<p>
当 info<sub>type</sub> 为 format ,且引用内容为内置数字格式的单元格时,函数 CELL 返回的文本
值:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">如果 Excel 的格式为</td>
<td class="org-left">CELL 函数返回值</td>
</tr>

<tr>
<td class="org-left">常规</td>
<td class="org-left">“G”</td>
</tr>

<tr>
<td class="org-left">0</td>
<td class="org-left">“F0”</td>
</tr>

<tr>
<td class="org-left">#,##0</td>
<td class="org-left">“,0”</td>
</tr>

<tr>
<td class="org-left">0.00</td>
<td class="org-left">“F2”</td>
</tr>

<tr>
<td class="org-left">#,##0.00</td>
<td class="org-left">“,2”</td>
</tr>

<tr>
<td class="org-left">\(#,##0_);(\)#,##0)</td>
<td class="org-left">“C0”</td>
</tr>

<tr>
<td class="org-left">\(#,##0_);[Red](\)#,##0)</td>
<td class="org-left">“C0-”</td>
</tr>

<tr>
<td class="org-left">\(#,##0.00_);(\)#,##0.00)</td>
<td class="org-left">“C2”</td>
</tr>

<tr>
<td class="org-left">\(#,##0.00_);[Red](\)#,##0.00)</td>
<td class="org-left">“C2-”</td>
</tr>

<tr>
<td class="org-left">0%</td>
<td class="org-left">“P0”</td>
</tr>

<tr>
<td class="org-left">0.00%</td>
<td class="org-left">“P2”</td>
</tr>

<tr>
<td class="org-left">0.00E+00</td>
<td class="org-left">“S2”</td>
</tr>

<tr>
<td class="org-left"># ?/? 或 # ??/??</td>
<td class="org-left">“G”</td>
</tr>

<tr>
<td class="org-left">yy-m-d 或 yy-m-d h:mm 或 dd-mm-yy</td>
<td class="org-left">“D4”</td>
</tr>

<tr>
<td class="org-left">d-mmm-yy 或 dd-mmm-yy</td>
<td class="org-left">“D1”</td>
</tr>

<tr>
<td class="org-left">d-mmm 或 dd-mmm</td>
<td class="org-left">“D2”</td>
</tr>

<tr>
<td class="org-left">mmm-yy</td>
<td class="org-left">“D3”</td>
</tr>

<tr>
<td class="org-left">mm/dd</td>
<td class="org-left">“D5”</td>
</tr>

<tr>
<td class="org-left">h:mm AM/PM</td>
<td class="org-left">“D7”</td>
</tr>

<tr>
<td class="org-left">h:mm:ss AM/PM</td>
<td class="org-left">“D6”</td>
</tr>

<tr>
<td class="org-left">h:mm</td>
<td class="org-left">“D9”</td>
</tr>

<tr>
<td class="org-left">h:mm:ss</td>
<td class="org-left">“D8”</td>
</tr>
</tbody>
</table>

<p>
使用示例:
</p>
<pre class="example">
=CELL("filename")
返回工作簿的完整路径
=IF(CELL("width",A1)=15,"标准宽度","非标准宽度")
</pre>
</div>
</div>
<div id="outline-container-org3ed06d5" class="outline-5">
<h5 id="org3ed06d5"><span class="section-number-5">2.4.1.2</span> TYPE 函数(返回单元格内的数值类型)</h5>
<div class="outline-text-5" id="text-2-4-1-2">
<p>
\[ TYPE(value) \]
</p>

<ul class="org-ul">
<li>value: ,任意 Excel 支持的值.</li>
</ul>


<p>
TYPE 函数用于返回数值的类型.返回的是数据类型的数字代号
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 5:</span> 数据类型对应的数值代号</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">value 类型</td>
<td class="org-right">类型数值代号</td>
</tr>

<tr>
<td class="org-left">数值</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-left">文本</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-left">逻辑值</td>
<td class="org-right">4</td>
</tr>

<tr>
<td class="org-left">误差值(错误值)</td>
<td class="org-right">16</td>
</tr>

<tr>
<td class="org-left">数组</td>
<td class="org-right">64</td>
</tr>
</tbody>
</table>

<p>
使用示例:
</p>
<pre class="example">
=TYPE(1)
返回代号1
=TYPE("ab")
返回代号2
</pre>
</div>
</div>

<div id="outline-container-org06752d7" class="outline-5">
<h5 id="org06752d7"><span class="section-number-5">2.4.1.3</span> N 函数(将数据转换成数值并返回)</h5>
<div class="outline-text-5" id="text-2-4-1-3">
<p>
\[ N(value) \]
</p>

<ul class="org-ul">
<li>value: 可以是任意 Excel 支持的值.</li>
</ul>

<p>
N 函数用于返回转换为数值后的值
</p>

<blockquote>
<p>
N 函数主要用途是将不是数值形式的(数)值转换成数值形式,例如逻辑值 TRUE 和 FALSE 就
是特殊的数值,日期/时间也是特殊的数值.
</p>

<p>
而文本值会被转换成数值 0.这一点与 VALUE 函数不一样, VALUE 会将数字形式的文本值转
换成对应数字.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=N("")
转换文本值,返回数值 0.
=N("无")
转换文本值,返回数值 0.
=N(B2)
B2 为日期 2023/7/22 转为对应数值 45129
</pre>
</div>
</div>

<div id="outline-container-orgc4bfb12" class="outline-5">
<h5 id="orgc4bfb12"><span class="section-number-5">2.4.1.4</span> NA 函数(返回错误值 #N/A)</h5>
<div class="outline-text-5" id="text-2-4-1-4">
<p>
\[ NA() \]
</p>

<p>
NA 函数没有参数,只要用公式 =NA() 就返回错误值 "#N/A", "#N/A" 表示没有有效值.
</p>

<p>
使用示例:
</p>
<pre class="example">
=NA()
结果为 #N/A
</pre>
</div>
</div>

<div id="outline-container-org953e7af" class="outline-5">
<h5 id="org953e7af"><span class="section-number-5">2.4.1.5</span> INFO 函数(返回当前操作环境的信息)</h5>
<div class="outline-text-5" id="text-2-4-1-5">
<p>
\[ INFO(type_text) \]
</p>

<ul class="org-ul">
<li>type<sub>text</sub> : 表示用于指定要返回的信息类型的文本.</li>
</ul>


<p>
INFO 函数用于返回有关当前操作环境的信息
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 6:</span> type<sub>text</sub> 信息类型对应的信息</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">type<sub>text</sub></td>
<td class="org-left">信息</td>
</tr>

<tr>
<td class="org-left">"directory"</td>
<td class="org-left">当前目录或文件夹的路径</td>
</tr>

<tr>
<td class="org-left">"numfile"</td>
<td class="org-left">打开的工作簿中活动工作表的数目</td>
</tr>

<tr>
<td class="org-left">"origin"</td>
<td class="org-left">以当前位置为基准,返回窗口中可见的左上角单元格的绝对单元格引用,如 "$A:$A$84"</td>
</tr>

<tr>
<td class="org-left">"osversion"</td>
<td class="org-left">当前操作系统的版本号,(文本值)</td>
</tr>

<tr>
<td class="org-left">"recalc"</td>
<td class="org-left">当前的重新计算模式,返回 "手动" 或 "自动"</td>
</tr>

<tr>
<td class="org-left">"release"</td>
<td class="org-left">Excel 的版本号(文本值)</td>
</tr>

<tr>
<td class="org-left">"system"</td>
<td class="org-left">返回操作系统的名称,mac 表示 Macintosh 操作系统, pcdos 表示 windows 操作系统</td>
</tr>
</tbody>
</table>


<p>
使用示例:
</p>
<pre class="example">
=INFO("system")
我使用的是 windows10 所以返回 "pcdos"
=INFO("release")
我使用的是 2016, 返回的是 "16.0"
</pre>
</div>
</div>

<div id="outline-container-org9cc9e05" class="outline-5">
<h5 id="org9cc9e05"><span class="section-number-5">2.4.1.6</span> ERROR.TYPE 函数(返回错误值对应的数字)</h5>
<div class="outline-text-5" id="text-2-4-1-6">
<p>
\[ ERROR.TYPE(error_val) \]
</p>

<ul class="org-ul">
<li>error<sub>val</sub>: 表示要查找其标号的一个错误值.</li>
</ul>


<p>
ERROR.TYPE 函数用于返回对应于 EXCEL 某一错误值的标号,如果没有错误则返回 #N/A
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 7:</span> 错误值与ERROR.TYPE 返回值</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">error<sub>val</sub></td>
<td class="org-right">ERROR.TYPE 返回值</td>
</tr>

<tr>
<td class="org-left">#NULL!</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-left">#DIV/0!</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-left">#VALUE!</td>
<td class="org-right">3</td>
</tr>

<tr>
<td class="org-left">#REF!</td>
<td class="org-right">4</td>
</tr>

<tr>
<td class="org-left">#NAME?</td>
<td class="org-right">5</td>
</tr>

<tr>
<td class="org-left">#NUM!</td>
<td class="org-right">6</td>
</tr>

<tr>
<td class="org-left">#N/A</td>
<td class="org-right">7</td>
</tr>

<tr>
<td class="org-left">#GETTING<sub>DATA</sub></td>
<td class="org-right">8</td>
</tr>

<tr>
<td class="org-left">其他值</td>
<td class="org-right">#N/A</td>
</tr>
</tbody>
</table>


<p>
使用示例:
</p>
<pre class="example">
=ERROR.TYPE(2/0)
2/0 0做了分母,所以会返回 #DIV/0! 错误值,那么对应的 ERROR.TYPE 就会返回2.
</pre>
</div>
</div>
</div>

<div id="outline-container-org67404fe" class="outline-4">
<h4 id="org67404fe"><span class="section-number-4">2.4.2</span> 各种 IS 函数</h4>
<div class="outline-text-4" id="text-2-4-2">
<p>
IS 函数可以和其他函数结合来帮助组成复杂语句,例如 FIND 函数在找到目标字符时返回目
标字符在查找字符串中的起始位置,但如果没有找到会返回 #VALUE! 错误值,我们可以用
ISNUMBER 来进行判断,如果返回的是数字,则接受数据进行其他操作,如果不是也就是返回了
错误值,那就不进行相应操作.
</p>
</div>

<div id="outline-container-org398928a" class="outline-5">
<h5 id="org398928a"><span class="section-number-5">2.4.2.1</span> ISBLANK 函数(检测单元格是否为空)</h5>
<div class="outline-text-5" id="text-2-4-2-1">
<p>
\[ ISBLANK(value) \]
</p>

<ul class="org-ul">
<li>value: 要检验的值,可以是单元格的引用,也可以是任意值的名称引用,也可以直接是任意
值.</li>
</ul>


<p>
ISBLANK 函数用于判断指定单元格是否为空值.
</p>
<blockquote>
<p>
虽然也可以直接对值判断,但只要有值,就必定不是空值,空值在这里说的是没有任何数据,而
即使是空字符串,也算是有值,只不过这个字符串没有内容,而空值的意思是什么都没有,
</p>

<p>
所以这个函数有意义的用法只是用来判断单元格是否为空.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=IF(ISBLANK(B2),"缺考","")
可以用来检测学生是否缺考(没有分数就是缺考了)
=SUMPRODUCT(ISBLANK(B2:B14)*1)
可以用来统计空单元格个数. 因为 SUMPRODUCT 可以直接进行"向量运算",所以直接使用,
SUM 函数不能直接进行 "向量运算",需要加上 Ctrl+Shift+Enter:
=SUM(ISBLANK(B2:B14)*1)  然后按 Ctrl+Shift+Enter 可以得到和上面公式一样的效果.
</pre>
</div>
</div>

<div id="outline-container-org81c7815" class="outline-5">
<h5 id="org81c7815"><span class="section-number-5">2.4.2.2</span> ISNUMBER 函数(检测参数是否为数值)</h5>
<div class="outline-text-5" id="text-2-4-2-2">
<p>
\[ ISNUMBER(value) \]
</p>

<ul class="org-ul">
<li>value: 要检测的值.</li>
</ul>


<p>
ISNUMBER 函数用于判断参数是否为数值.
</p>

<p>
使用示例:
</p>
<pre class="example">
=ISNUMBER(B2)
可以用来判断数据是否为数值类型数据,用来判断数据有效性.
可以用来判断数据是否为数值类型数据,用来判断数据有效性.
=ISNUMBER(B2:B4) 按 Ctrl+Shift+Enter
可以得到一个 3 个值的数组,通过鼠标点击向下填充可以获得完整数组数据.
</pre>
</div>
</div>

<div id="outline-container-org1a35cd5" class="outline-5">
<h5 id="org1a35cd5"><span class="section-number-5">2.4.2.3</span> ISTEXT 函数(检测参数是否为文本)</h5>
<div class="outline-text-5" id="text-2-4-2-3">
<p>
\[ ISTEXT(value) \]
</p>

<ul class="org-ul">
<li>value: 要检测的值.</li>
</ul>


<p>
ISTEXT 函数用于判断指定参数是否为文本
</p>

<p>
使用示例:
</p>
<pre class="example">
=SUMPRODUCT(ISTEXT(B2:B12)*1)
如果缺考人员的成绩用 "缺考" 等类似文本填充,则可以用这种方式来统计缺考人数(未缺考的成绩为数值类型)
</pre>
</div>
</div>

<div id="outline-container-orgc6e338c" class="outline-5">
<h5 id="orgc6e338c"><span class="section-number-5">2.4.2.4</span> ISNONTEXT 函数(检测参数是否为非文本,结果与 ISTEXT 相反)</h5>
<div class="outline-text-5" id="text-2-4-2-4">
<p>
\[ ISTEXT(value) \]
</p>

<ul class="org-ul">
<li>value: 要检测的值.</li>
</ul>


<p>
ISNONTEXT 函数是用于判断参数是否为 "非文本",即一切非文本类型的数据都会返回 TRUE,
刚好和 ISTEXT 是相反的.
</p>

<p>
使用示例:
</p>
<pre class="example">
=SUMPRODUCT(ISNONTEXT(B2:B12)*1)
和 ISTEXT 一样的例子,不过这次就是判断实际参加考核的人数.
</pre>
</div>
</div>

<div id="outline-container-orge98af22" class="outline-5">
<h5 id="orge98af22"><span class="section-number-5">2.4.2.5</span> ISEVEN 函数(判断数字是否为偶数)</h5>
<div class="outline-text-5" id="text-2-4-2-5">
<p>
\[ ISEVEN(number) \]
</p>

<ul class="org-ul">
<li>number: 要判断的数值,也可以是文本形式的数字数据.</li>
</ul>


<p>
ISEVEN 函数用于判断参数是否为偶数.
</p>

<p>
使用示例:
</p>
<pre class="example">
=ISEVEN(2)
2 是偶数,返回 TRUE
</pre>
</div>
</div>

<div id="outline-container-org060b610" class="outline-5">
<h5 id="org060b610"><span class="section-number-5">2.4.2.6</span> ISODD 函数(判断数字是否为奇数)</h5>
<div class="outline-text-5" id="text-2-4-2-6">
<p>
\[ ISODD(number) \]
</p>

<ul class="org-ul">
<li>number: 要判断的数值,也可以是文本形式的数字数据.</li>
</ul>


<p>
ISODD 函数用于判断参数是否为奇数.
</p>

<p>
使用示例:
</p>
<pre class="example">
=ISODD(MID(B2,17,1))
判断 B2 的第17位字符是否为奇数. 这是前面用过的判断身份证第17 位是否为奇数/偶数的例子
</pre>
</div>
</div>

<div id="outline-container-org356da45" class="outline-5">
<h5 id="org356da45"><span class="section-number-5">2.4.2.7</span> ISLOGICAL 函数(检测给定参数是否为逻辑值)</h5>
<div class="outline-text-5" id="text-2-4-2-7">
<p>
\[ ISLOGICAL(value) \]
</p>

<ul class="org-ul">
<li>value: 要判断的值.</li>
</ul>


<p>
ISLOGICAL 函数用来检验参数是否为逻辑值.
</p>

<blockquote>
<p>
虽然计算机领域一般都认为 1 表示 TRUE,0 表示 FALSE, 但只有运行数学运算时才这样使
用.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=ISLOGICAL(1)
虽然数学运算时 TRUE 当作数值1,但数值1 不是逻辑值 TRUE. 所以返回结果 FALSE.
=ISLOGICAL(1=2)
1=2 是一个表达式,计算结果为逻辑值 FALSE, 因此 ISLOGICAL 的判断结果为 TRUE.
</pre>
</div>
</div>

<div id="outline-container-org1388e38" class="outline-5">
<h5 id="org1388e38"><span class="section-number-5">2.4.2.8</span> ISERROR 函数(检测参数是否为错误值)</h5>
<div class="outline-text-5" id="text-2-4-2-8">
<p>
\[ ISERROR(value) \]
</p>

<ul class="org-ul">
<li>value: 要检验的值.</li>
</ul>


<p>
ISERROR 函数用于判断参数是否为错误值.
</p>

<p>
使用示例:
</p>
<pre class="example">
=SUM(IF(ISERROR(C2:C10), 0, C2:C10))
这是一个数组公式,按 Ctrl+Shift+Enter 即可忽略错误值进行统计.
</pre>
</div>
</div>

<div id="outline-container-org2e0b93f" class="outline-5">
<h5 id="org2e0b93f"><span class="section-number-5">2.4.2.9</span> ISNA 函数(检测参数是否为 #N/A 错误值)</h5>
<div class="outline-text-5" id="text-2-4-2-9">
<p>
\[ ISNA(value) \]
</p>

<ul class="org-ul">
<li>value: 要检验的值.</li>
</ul>


<p>
ISNA 函数用于判断数据是否为错误值 "#N/A"
</p>

<p>
使用示例:
</p>
<pre class="example">
=IF(ISNA(VLOOKUP("Windows",A2:C2,3,FALSE)), "未找到结果", VLOOKUP("Windows",A2:C2,3,FALSE))
这样可以避免 VLOOKUP 返回错误值.
</pre>
</div>
</div>

<div id="outline-container-org44f6019" class="outline-5">
<h5 id="org44f6019"><span class="section-number-5">2.4.2.10</span> ISERR 函数(检测参数是否为 #N/A 之外的错误值)</h5>
<div class="outline-text-5" id="text-2-4-2-10">
<p>
\[ ISERR(value) \]
</p>

<ul class="org-ul">
<li>value: 要检验的值.</li>
</ul>


<p>
ISERR 函数用来判断参数是否为 #N/A 之外的错误值.
</p>

<p>
使用示例:
</p>
<pre class="example">
=ISERR(NA())
NA() 函数返回错误值 #N/A, 所以 ISERR 结果为 FALSE.
=ISERR(VALUE("a"))
字符 "a" 不能转为数值,因此会返回错误值 #VALUE!, 所以 ISERR 结果为 TRUE.
</pre>
</div>
</div>

<div id="outline-container-orgc199d93" class="outline-5">
<h5 id="orgc199d93"><span class="section-number-5">2.4.2.11</span> ISREF 函数(检测参数是否为引用)</h5>
<div class="outline-text-5" id="text-2-4-2-11">
<p>
\[ ISREF(value) \]
</p>

<ul class="org-ul">
<li>value: 要检验的值.</li>
</ul>


<p>
ISREF 函数用来检查数据是否为引用.
</p>
<blockquote>
<p>
只有真的单元格引用才是引用,只要使用了公式/计算的表达式全部为值
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=ISREF(A2)
A2 是引用结果为 TRUE.
=ISREF(A2*1)
A2*1 是表达式了,表达式求值为 1乘A2 中数据的计算结果值. 所以结果为 FALSE.
</pre>
</div>
</div>

<div id="outline-container-org8f5cc8c" class="outline-5">
<h5 id="org8f5cc8c"><span class="section-number-5">2.4.2.12</span> ISFORMULA 函数(检测单元格内容是否为公式)</h5>
<div class="outline-text-5" id="text-2-4-2-12">
<p>
\[ ISFORMULA(REF) \]
</p>

<ul class="org-ul">
<li>REF: 引用,表示要检测的单元格的引用.</li>
</ul>


<p>
ISFORMULA 函数检测单元格中的内容是否为公式.
</p>

<blockquote>
<p>
我自己理解的 Excel 中的值分为两种, 公式值和字面值,字面值就是直接输入到单元格中的
值,如 1,"你好" 等, 而公式值是公式的计算结果,如 =1, ="你好", 虽然在表格中看到的1
和 "你好" 没有不同,但是它们的生成方式是不一样的.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=ISFOMULA(A2)
检测 A2 单元格内容是否为公式.
</pre>
</div>
</div>

<div id="outline-container-orgba4dc02" class="outline-5">
<h5 id="orgba4dc02"><span class="section-number-5">2.4.2.13</span> SHEET 函数(返回工作表编号)</h5>
<div class="outline-text-5" id="text-2-4-2-13">
<p>
\[ SHEET(value) \]
</p>

<ul class="org-ul">
<li>value: 工作表或引用的名称,如果省略,则返回该函数位于的工作表的编号.</li>
</ul>


<p>
SHEET 函数返回工作表编号.
</p>

<blockquote>
<p>
工作表编号指的是工作表是第几个工作表.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orgf3a87d3" class="outline-5">
<h5 id="orgf3a87d3"><span class="section-number-5">2.4.2.14</span> SHEETS 函数(工作簿中工作表数量)</h5>
<div class="outline-text-5" id="text-2-4-2-14">
<p>
\[ SHEETS(REF) \]
</p>

<ul class="org-ul">
<li>REF: 引用,指向工作簿, 如果省略,则返回当前工作簿的所有工作表数量.</li>
</ul>


<p>
SHEETS 函数用于返回引用的工作簿中的工作表数量.
</p>

<p>
使用示例:
</p>
<pre class="example">
=SHEETS()
返回当前工作簿的工作表数目.
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org7d9803d" class="outline-3">
<h3 id="org7d9803d"><span class="section-number-3">2.5</span> 日期和时间函数(23)</h3>
<div class="outline-text-3" id="text-2-5">
</div>
<div id="outline-container-org9e4f400" class="outline-4">
<h4 id="org9e4f400"><span class="section-number-4">2.5.1</span> 返回日期和时间</h4>
<div class="outline-text-4" id="text-2-5-1">
</div>
<div id="outline-container-orgd88b9e5" class="outline-5">
<h5 id="orgd88b9e5"><span class="section-number-5">2.5.1.1</span> NOW 函数(返回当前日期与时间)</h5>
<div class="outline-text-5" id="text-2-5-1-1">
<p>
\[ NOW() \]
</p>

<p>
NOW() 函数表示返回当前的日期和时间.
</p>

<blockquote>
<p>
Excel 中的时间和日期是特殊的数值,整数部分表示日期,小数部分表示时间. 0.5 表示中午
12:00; 整数部分表示从1900年1月0日到今天的天数.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=TEXT(B1-NOW(), "h:mm:ss")
假设 B1 是一个未来的日期, 这个公式可以计算到 B1 这个日期还有多长时间.
</pre>
</div>
</div>

<div id="outline-container-org45878bd" class="outline-5">
<h5 id="org45878bd"><span class="section-number-5">2.5.1.2</span> TODAY 函数(返回当前日期)</h5>
<div class="outline-text-5" id="text-2-5-1-2">
<p>
\[ TODAY() \]
</p>

<p>
TODAY() 函数表示返回当前的日期.
</p>

<p>
使用示例:
</p>
<pre class="example">
=TEXT(TODAY()-B1, "0")
B1 是一个今天之前的日期, 计算今天到 B1 这个日期的天数.
=IF((TODAY()-B1)&gt;60, "到期","未到期")
借阅时间超过 60 天就到期了.
</pre>
</div>
</div>

<div id="outline-container-org5a6dbc1" class="outline-5">
<h5 id="org5a6dbc1"><span class="section-number-5">2.5.1.3</span> DATE 函数(构建一个标准日期)</h5>
<div class="outline-text-5" id="text-2-5-1-3">
<p>
\[ DATE(year, month, day) \]
</p>

<ul class="org-ul">
<li>year: 1到4为数字的年份值.</li>
<li>month: -12到12 的月份值, 负数为倒数第几个月.</li>
<li>day: -31到31 的天数, 负数为倒数第几天.</li>
</ul>


<p>
DATE 函数用于返回特定日期的序列号.
</p>

<p>
使用示例:
</p>
<pre class="example">
=DATE(MID("20181004",1,4),MID("20181004",5,2),MID("20181004",7,2))
将 "20181004" 转换成日期.
</pre>
</div>
</div>

<div id="outline-container-org66f64d8" class="outline-5">
<h5 id="org66f64d8"><span class="section-number-5">2.5.1.4</span> TIME 函数(构建标准时间)</h5>
<div class="outline-text-5" id="text-2-5-1-4">
<p>
\[ TIME(hour, minute, second) \]
</p>

<ul class="org-ul">
<li>hour: 小时数, 0-32767</li>
<li>minute: 分钟数, 0-32767</li>
<li>second: 秒数, 0-32767</li>
</ul>


<p>
TIME 函数表示返回某个特定时间的小数值.
</p>

<p>
使用示例:
</p>
<pre class="example">
=0.5 + TIME(3, 30, 0)
0.5 表示中午12点,加上3个半小时,就是下午3点半.
</pre>
</div>
</div>

<div id="outline-container-org6891fee" class="outline-5">
<h5 id="org6891fee"><span class="section-number-5">2.5.1.5</span> YEAR 函数(返回日期对应的年份)</h5>
<div class="outline-text-5" id="text-2-5-1-5">
<p>
\[ YEAR(serial_number) \]
</p>

<ul class="org-ul">
<li>serial<sub>number</sub>: 表示一个日期值.</li>
</ul>


<p>
YEAR 函数用于返回某个日期对应的年份,结果为 1900 - 9999 之间的整数.
</p>

<p>
使用示例:
</p>
<pre class="example">
=YEAR(TODAY()) - YEAR(DATE(1998,11,20))
计算1998年11月20 日出生的人今天多少岁了.
</pre>
</div>
</div>

<div id="outline-container-orgfc1a835" class="outline-5">
<h5 id="orgfc1a835"><span class="section-number-5">2.5.1.6</span> MONTH 函数(返回日期中的月份)</h5>
<div class="outline-text-5" id="text-2-5-1-6">
<p>
\[ MONTH(serial_number) \]
</p>

<ul class="org-ul">
<li>serial<sub>number</sub>: 表示一个日期值.</li>
</ul>


<p>
MONTH 函数能够返回日期中的月份.
</p>

<p>
使用示例:
</p>
<pre class="example">
=IF(MONTH(DATE(1998,11,20)=MONTH(TODAY())), "本月", "")
计算某个月份是否为本月.
</pre>
</div>
</div>

<div id="outline-container-orgc5a31e1" class="outline-5">
<h5 id="orgc5a31e1"><span class="section-number-5">2.5.1.7</span> DAY 函数(返回日期中的天数)</h5>
<div class="outline-text-5" id="text-2-5-1-7">
<p>
\[ DAY(serial_number) \]
</p>

<ul class="org-ul">
<li>serial<sub>number</sub>: 表示一个日期值.</li>
</ul>


<p>
DAY 函数能够返回日期中的天数.
</p>

<p>
使用示例:
</p>
<pre class="example">
=IF(AND(MONTH(DATE(1998,11,20)=MONTH(TODAY())), DAY(DATE(1998,11,20))=DAY(TODAY())), "今天生日", "")
结合上面 MONTH 函数的示例,判断当前是不是某人的生日.
</pre>
</div>
</div>

<div id="outline-container-orgec387b6" class="outline-5">
<h5 id="orgec387b6"><span class="section-number-5">2.5.1.8</span> WEEKDAY 函数(返回日期对应的星期数)</h5>
<div class="outline-text-5" id="text-2-5-1-8">
<p>
\[ WEEKDAY(serial_number, [return_type]) \]
</p>

<ul class="org-ul">
<li>serial<sub>number</sub>: 表示一个日期值.</li>
<li>return<sub>type</sub>: 可选参数,用于确定返回值类型的数字.</li>
</ul>


<p>
WEEKDAY 函数能够返回日期对应的星期数,值为1-7 的整数.
</p>
<blockquote>
<p>
return<sub>type</sub> 为 1或省略, 则返回 1-7 代表星期天到星期六; 为 2,则 1-7 代表星期一到
星期天; 为 3 则返回 0-6 代表星期一到星期天.
</p>
</blockquote>

<p>
使用示例:
</p>

<pre class="example">
=IF(OR(WEEKDAY(A2,2)=6, WEEKDAY(A2,2)=6), "周末加班", "平常加班")
判断 A2 这天加班是周末加班还是平常加班.
</pre>
</div>
</div>

<div id="outline-container-org2f91a21" class="outline-5">
<h5 id="org2f91a21"><span class="section-number-5">2.5.1.9</span> WEEKNUM 函数(返回日期对应一年中的第几周)</h5>
<div class="outline-text-5" id="text-2-5-1-9">
<p>
\[ WEEKNUM(serial_number, [return_type]) \]
</p>

<ul class="org-ul">
<li>serial<sub>number</sub>: 表示一个日期值.</li>
<li>return<sub>type</sub>: 可选参数,用于确定返回值类型的数字.</li>
</ul>


<blockquote>
<p>
这个函数有两种机制:
</p>
<ul class="org-ul">
<li>包含1月1日的周为第一周.</li>
<li>包含该年第一个星期四的周为第一周</li>
</ul>

<p>
决定这种机制的是 return<sub>type</sub> 的值,只有当 return<sub>type</sub> 为 21 时,表示将星期一作为一
周的第一天,且使用第二种机制,其他的 return<sub>type</sub> 都是使用第一种机制.
</p>

<p>
return<sub>type</sub> 默认值为 1,表示星期日作为一周的第一天, 2 表示星期一作为一周的第一天.剩
下的可以查看该函数的帮助文档,因为其他的一般用不到.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
="第" &amp; WEEKNUM(DATE(2023, 10, 1), 2) &amp; "周"
以星期一为一周的第一天,查看2023年的10月1号是当年的第几周.
</pre>
</div>
</div>

<div id="outline-container-org960c4c7" class="outline-5">
<h5 id="org960c4c7"><span class="section-number-5">2.5.1.10</span> EOMONTH 函数(返回某日期到指定月数之前/后的最后一天的日期)</h5>
<div class="outline-text-5" id="text-2-5-1-10">
<p>
\[ EOMONTH(start_date, months) \]
</p>

<ul class="org-ul">
<li>start<sub>date</sub>: 表示一个开始的日期.</li>
<li>months: 表示月数,正值为未来的月数,负值为过去的月数.</li>
</ul>


<p>
EOMONTH 用于返回指定日期到某个月份最后一天的日期.
</p>
<blockquote>
<p>
通俗理解, EOMONTH 返回的是 start<sub>date</sub> 之前/后的 months 个月的最后一天的日期,例如,
10月1日前一个月的最后一天的日期,就是 9月30号 =EOMONTH(DATE(2023,10,1),-1) 结果为 2023/09/30
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=EOMONTH(TODAY(),0) - TODAY()
今天到本月最后一天还有多少天.
</pre>
</div>
</div>

<div id="outline-container-org7612e19" class="outline-5">
<h5 id="org7612e19"><span class="section-number-5">2.5.1.11</span> HOUR 函数(返回时间中的小时数)</h5>
<div class="outline-text-5" id="text-2-5-1-11">
<p>
\[HOUR(serial_number)\]
</p>

<ul class="org-ul">
<li>serial<sub>number</sub>: 表示一个时间值.</li>
</ul>


<blockquote>
<p>
日期值其实是有小数的，不过小数为0, 但时间值则没有整数部分,只有小数部分,所以
HOUR(TODAY()) 返回的是0。
</p>
</blockquote>

<p>
HOUR 函数用于返回时间值中的小时数.
</p>

<p>
使用示例:
</p>
<pre class="example">
=HOUR(NOW())
返回当前时间在一天当中的第几个小时.
</pre>
</div>
</div>

<div id="outline-container-orgbbdddd2" class="outline-5">
<h5 id="orgbbdddd2"><span class="section-number-5">2.5.1.12</span> MINUTE 函数(返回时间中的分钟数)</h5>
<div class="outline-text-5" id="text-2-5-1-12">
<p>
\[MINUTE(serial_number)\]
</p>

<ul class="org-ul">
<li>serial<sub>number</sub>: 表示一个时间值.</li>
</ul>


<p>
MINUTE 函数用于返回时间值中的分钟数.
</p>
<blockquote>
<p>
MINUTE 和 HOUR 返回的都是时间中的小时和分钟数,例如 1:30 小时数就是1, 分钟数就是
</p>
<ol class="org-ol">
<li>要计算某段时间长短,需要提取开始时间和结束时间的小时和分钟数来计算.</li>
</ol>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=MINUTE(NOW())
返回当前时间的分钟数.
=HOUR(C2)*60 + MINUTE(C2) - HOUR(B2)*60 - MINUTE(B2)
计算 B2 到 C2 这个时间段有多少分钟(B2, 和 C2 是同一天.)
</pre>
</div>
</div>

<div id="outline-container-org71b7b37" class="outline-5">
<h5 id="org71b7b37"><span class="section-number-5">2.5.1.13</span> SECOND 函数(返回时间中的秒数)</h5>
<div class="outline-text-5" id="text-2-5-1-13">
<p>
\[SECOND(serial_number)\]
</p>

<ul class="org-ul">
<li>serial<sub>number</sub>: 表示一个时间值.</li>
</ul>


<p>
SECOND 函数用于返回时间值中的秒数.
</p>

<blockquote>
<p>
SECOND , MINUTE, HOUR 的用法都是类似的.
</p>
</blockquote>
<p>
使用示例:
</p>
<pre class="example">
=HOUR(C2-B2)*60*60 + MINUTE(C2-B2)*60 + SECOND(C2-B2)
计算从 B2 到 C2 时间段有多少秒.
</pre>
</div>
</div>
</div>


<div id="outline-container-org0ac7b50" class="outline-4">
<h4 id="org0ac7b50"><span class="section-number-4">2.5.2</span> 日期计算</h4>
<div class="outline-text-4" id="text-2-5-2">
</div>
<div id="outline-container-org089ade2" class="outline-5">
<h5 id="org089ade2"><span class="section-number-5">2.5.2.1</span> DATEDIF 函数(计算两个日期之间的年数,月数和天数)</h5>
<div class="outline-text-5" id="text-2-5-2-1">
<p>
\[ DATEDIF(date1, date2, code) \]
</p>

<ul class="org-ul">
<li>date1: 起始日期.</li>
<li>date2: 结束日期.</li>
<li>code: 返回值的代码</li>
</ul>


<p>
DATEDIF 函数返回两个日期之间的差(DIFFERENCE)
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 8:</span> code 参数与返回值</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">code</td>
<td class="org-left">DATEDIF 返回值</td>
</tr>

<tr>
<td class="org-left">"y"</td>
<td class="org-left">返回日期的年数</td>
</tr>

<tr>
<td class="org-left">"m"</td>
<td class="org-left">返回日期的月数</td>
</tr>

<tr>
<td class="org-left">"d"</td>
<td class="org-left">返回日期的天数</td>
</tr>

<tr>
<td class="org-left">"ym"</td>
<td class="org-left">忽略年数和天数,返回月数</td>
</tr>

<tr>
<td class="org-left">"yd"</td>
<td class="org-left">忽略年数和月数,返回天数</td>
</tr>

<tr>
<td class="org-left">"md"</td>
<td class="org-left">忽略月数和年数,返回天数</td>
</tr>
</tbody>
</table>

<blockquote>
<p>
官方文档并不推荐使用 "md" code ,因为会导致结果出现无效的值.
事实上这个函数都好像不推荐使用了.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=DATEDIF(C2,TODAY(), "m")
返回日期 C2 与今天的月份差
</pre>
</div>
</div>

<div id="outline-container-orgdcbd585" class="outline-5">
<h5 id="orgdcbd585"><span class="section-number-5">2.5.2.2</span> DAYS360 函数(按照一年 360 天的算法计算两个日期之间的天数差)</h5>
<div class="outline-text-5" id="text-2-5-2-2">
<p>
\[DAYS360(start_date, end_date, [method])\]
</p>

<ul class="org-ul">
<li>start<sub>date</sub>: 起始日期.</li>
<li>end<sub>date</sub>: 结束日期.</li>
<li>method: 逻辑值,指定计算中采用欧洲方法还是美国方法.</li>
</ul>


<p>
DAYS360 函数按照一年 360 天计算两个日期之间相差的天数.一些会计计算中会用到.
</p>
<blockquote>
<p>
与 DAYS360 的区别在于 DAYS360 无论当月是 31 天还是 28 天都全按照 30 天计算. 而
DATEIF 函数则是按照实际天数计算的. 另外,计算天数差是 "算尾不算头" ,即起始日当天
不算1天,终止日算作1天.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
DAYS360(TODAY(),C2+D2)
C2 表示借款日期, D2 表示还款账期.
</pre>
</div>
</div>

<div id="outline-container-orge8e45c5" class="outline-5">
<h5 id="orge8e45c5"><span class="section-number-5">2.5.2.3</span> EDATE 函数(计算间隔指定月数后的日期)</h5>
<div class="outline-text-5" id="text-2-5-2-3">
<p>
\[ EDATE(start_date, months) \]
</p>

<ul class="org-ul">
<li>start<sub>date</sub>: 起始日期.</li>
<li>months: 间隔月份,负数表示向过去的方向间隔的日期,正数表示向未来的方向间隔的日期.</li>
</ul>


<p>
EDATE 函数返回 start<sub>date</sub> 间隔了 months 个月之后的日期.
</p>

<p>
使用示例:
</p>
<pre class="example">
=EDATE(B2,12)
可用来计算保质期,B2 为生产日期, 12个月的保质期.
</pre>
</div>
</div>

<div id="outline-container-org86b713f" class="outline-5">
<h5 id="org86b713f"><span class="section-number-5">2.5.2.4</span> WORKDAY 函数(获取间隔若干工作日后的日期)</h5>
<div class="outline-text-5" id="text-2-5-2-4">
<p>
\[WORKDAY(start_date, days, [holidays])\]
</p>

<ul class="org-ul">
<li>start<sub>date</sub>: 起始日期.</li>
<li>days: start<sub>date</sub> 之后/前不包含周末以及假日的天数.</li>
<li>holidays: 可选,一个可选列表,其中包含需要从日历中排除的一个或多个日期.是指定除
了周末之外的不计算在内的日期.</li>
</ul>


<p>
WORKDAY 函数返回 start<sub>date</sub> 之后/前与该日期间隔了 days 个工作日的某一个日期.
工作日指周末和假日以及holidays 之外的日子.
</p>

<p>
使用示例:
</p>
<pre class="example">
=WORKDAY(B2,13,$F$2:$F$4)
B2 为开始休假的日期, $F$2:$F$4 为假期,可以计算从开始休假到13天假期结束的日期,
13天假期是不包括周末和节假日在内的.
</pre>
</div>
</div>

<div id="outline-container-org1e0174e" class="outline-5">
<h5 id="org1e0174e"><span class="section-number-5">2.5.2.5</span> WORKDAY.INTL 函数</h5>
<div class="outline-text-5" id="text-2-5-2-5">
<p>
\[ WORKDAY.INTL(start_date, days, [weekend], [holidays]) \]
</p>

<ul class="org-ul">
<li>start<sub>date</sub>: 起始日期.</li>
<li>days: 工作日天数.</li>
<li>weekend: 可选,一周中属于周末和不作为工作日的日子,是一个指定周末日的字符串.</li>
<li>holidays: 可选, 要从工作日中排除的日期.</li>
</ul>


<p>
WORKDAY.INTL 函数用于返回 start<sub>date</sub> 前/后 days 个工作日的日期,但可以自定义周末
参数,周末参数用来确定周末有几天以及是哪几天.
</p>

<p>
使用示例:
</p>
<pre class="example">
=WORKDAY.INTL(TODAY(), 3 ,"0000001")
从今天开始休假,假期3天, 每周的周末只有星期天.
</pre>
</div>
</div>

<div id="outline-container-org6254f23" class="outline-5">
<h5 id="org6254f23"><span class="section-number-5">2.5.2.6</span> YEARFRAC 函数(从开始到结束经过的天数占全年总天数的比例)</h5>
<div class="outline-text-5" id="text-2-5-2-6">
<p>
\[ YEARFRAC(start_date, end_date, [basis]) \]
</p>

<ul class="org-ul">
<li>start<sub>date</sub>: 开始日期.</li>
<li>end<sub>date</sub>: 结束日期.</li>
<li>basis: 可选,使用的计数基准类型.</li>
</ul>

<p>
YEARFRAC 函数返回开始日期到结束日期的天数占全年天数的百分比.
</p>
<blockquote>
<p>
basis 默认是按照一年 360 天,每月 30 天计算的. 数值为1 则表示按照一年的实际天数计
算, 数值为3, 则按照一年 365 天,每月按实际天数计算.其他的类型在需要时查阅文档即可.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=YEARFRAC(B2,TODAY(),3)
计算 B2 到今天的天数,然后除以 365 即可得到百分比.
</pre>
</div>
</div>

<div id="outline-container-org5f9e25e" class="outline-5">
<h5 id="org5f9e25e"><span class="section-number-5">2.5.2.7</span> NETWORKDAYS 函数(计算两个日期之间的工作日数量)</h5>
<div class="outline-text-5" id="text-2-5-2-7">
<p>
\[NETWORKDAYS(start_date, end_date, [holidays])\]
</p>

<ul class="org-ul">
<li>start<sub>date</sub>: 起始日期.</li>
<li>end<sub>date</sub>: 结束日期.</li>
<li>holidays: 可选,一个可选列表,其中包含需要从日历中排除的一个或多个日期.是指定除
了周末之外的不计算在内的日期.</li>
</ul>

<p>
NETWORKDAYS 函数返回开始日期到结束日期之间的完整工作日数值.
</p>

<blockquote>
<p>
可以用来计算特殊时间段的工作天数.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=NETWORKDAYS(B2,C2,$F$2)
计算 B2 到 C2 之间除了 F2 外的工作日.
</pre>
</div>
</div>

<div id="outline-container-org94081ec" class="outline-5">
<h5 id="org94081ec"><span class="section-number-5">2.5.2.8</span> NETWORKDAYS.INTL 函数</h5>
<div class="outline-text-5" id="text-2-5-2-8">
<p>
\[ WORKDAY.INTL(start_date, end_date , [weekend], [holidays]) \]
</p>


<ul class="org-ul">
<li>start<sub>date</sub>: 起始日期.</li>
<li>end<sub>date</sub>: 结束日期.</li>
<li>weekend: 可选,一周中属于周末和不作为工作日的日子,是一个指定周末日的字符串.</li>
<li>holidays: 可选, 要从工作日中排除的日期.</li>
</ul>


<p>
NETWORKDAYS.INTL 函数返回两个日期之间的所有工作日数量. 可以指定哪天是周末,以及有
多少天是周末.
</p>

<p>
使用示例:
</p>
<pre class="example">
=WORKDAY.INTL(B2,C2,"0000000")
在全年午休的作息中 B2 到 C2 间多少工作日.
</pre>
</div>
</div>
</div>


<div id="outline-container-org13fd00e" class="outline-4">
<h4 id="org13fd00e"><span class="section-number-4">2.5.3</span> 文本日期/时间的转换</h4>
<div class="outline-text-4" id="text-2-5-3">
</div>
<div id="outline-container-orge2dc71c" class="outline-5">
<h5 id="orge2dc71c"><span class="section-number-5">2.5.3.1</span> DATEVALUE 函数(将日期字符串转换成可以计算的数值/序列号)</h5>
<div class="outline-text-5" id="text-2-5-3-1">
<p>
\[DATEVALUE(date_text)\]
</p>

<ul class="org-ul">
<li>date<sub>text</sub>: 表示 Excel 日期格式的日期的文本.</li>
</ul>


<p>
DATEVALUE 函数将储存为文本类型的日期转换成 Excel 识别的日期的序列号.
</p>
<blockquote>
<p>
一般从其他软件导入的日期数据是文本类型的,可以通过这个函数转为 Excel 的日期/序列
号类型.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=DATEVALUE("2018-12-31")
=DATEVALUE("2018/12/31")
</pre>
</div>
</div>

<div id="outline-container-org30df8f0" class="outline-5">
<h5 id="org30df8f0"><span class="section-number-5">2.5.3.2</span> TIEMVALUE 函数(将时间字符串转换成可计算的小数值)</h5>
<div class="outline-text-5" id="text-2-5-3-2">
<p>
\[TIMEVALUE(time_text)\]
</p>

<ul class="org-ul">
<li>time<sub>text</sub>: Excel 支持的时间格式的字符串.</li>
</ul>


<p>
TIMEVALUE 函数用于返回由文本字符串所表示的小数值.
</p>

<p>
使用示例:
</p>
<pre class="example">
=TIMEVALUE("12:30")
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgceb2556" class="outline-3">
<h3 id="orgceb2556"><span class="section-number-3">2.6</span> 统计函数(102)</h3>
<div class="outline-text-3" id="text-2-6">
</div>
<div id="outline-container-orgeb050c0" class="outline-4">
<h4 id="orgeb050c0"><span class="section-number-4">2.6.1</span> 平均值计算函数(7)</h4>
<div class="outline-text-4" id="text-2-6-1">
</div>
<div id="outline-container-org72e78cc" class="outline-5">
<h5 id="org72e78cc"><span class="section-number-5">2.6.1.1</span> AVERAGE 函数(求平均值)</h5>
<div class="outline-text-5" id="text-2-6-1-1">
<p>
\[ AVERAGE(number1, number2, \cdots) \]
</p>

<ul class="org-ul">
<li>\(number1,\cdots\): 要计算平均值的1-255 个参数.</li>
</ul>


<p>
AVERAGE 函数用于计算所有参数的算术平均值:
\[ \frac{\sum_{number1}^{numberN}}{N} \]
</p>

<p>
使用示例:
</p>
<pre class="example">
=AVERAGE(A2:A14)
</pre>
</div>
</div>

<div id="outline-container-org9069415" class="outline-5">
<h5 id="org9069415"><span class="section-number-5">2.6.1.2</span> AVERAGEA 函数(求包括文本和逻辑值的平均值)</h5>
<div class="outline-text-5" id="text-2-6-1-2">
<p>
\[ AVERAGEA(value1, value2, \cdots) \]
</p>

<ul class="org-ul">
<li>\(value1, value2, \cdots\) : 需要计算的1-30 个数据.</li>
</ul>


<p>
AVERAGEA 函数返回给定参数(包括文本和逻辑值)的平均值.
</p>
<blockquote>
<p>
AVERAGE 对于非数值类型的参数是不纳入统计范围的,AVERAGEA 则会将文本和逻辑值纳入统
计范围,逻辑值 TRUE 视为1 FALSE 视为0, 文本值的处理逻辑与 SUM 函数一样,可转换成数
值的字符字面值转换为数值后计算,只要是文本值的单元格引用一律视为0,不可转为数值的
字符字面值会导致返回错误值.
</p>
</blockquote>
<p>
使用示例:
</p>
<pre class="example">
=AVERAGEA(1,"1")
结果为1.
=AVERAGEA(1,A1)
A1 为文本类型的数据 "1" 结果为0.5, 因为文本数据的单元格引用直接视为 0.
</pre>
</div>
</div>

<div id="outline-container-orgd1b36d0" class="outline-5">
<h5 id="orgd1b36d0"><span class="section-number-5">2.6.1.3</span> AVERAGEIF 函数(按条件求平均值)</h5>
<div class="outline-text-5" id="text-2-6-1-3">
<p>
\[ AVERAGEIF(range, criteria, average\_range) \]
</p>

<ul class="org-ul">
<li>range: 条件应用的区域,average<sub>range</sub> 省略的情况下, 也是要计算平均值的范围.</li>
<li>criteria: 判断条件.</li>
<li>average<sub>range</sub>: 要计算平均值的实际单元格,如果省略则默认使用 range 为计算平均值
的范围.</li>
</ul>


<p>
AVERAGEIF 函数可以计算 range 区域内满足 criteria 条件的所有单元格或是与 range 区
域中满足 criteria 条件的单元格对应的所有 average<sub>range</sub> 区域中的单元格的算术平均值.
</p>

<p>
使用示例:
</p>
<pre class="example">
=AVERAGEIF($A$2:$A$14, "=一班", $C$2:$C$14 )
将 A2:A14 中值为 "一班" 的单元格在 C2:C14 中对应的单元格里的数据计算得出算术平均值.
=AVERAGEIF(C2:C14,"&gt;60")
计算C2:C14 中及格的分数的算术平均值.
</pre>
</div>
</div>

<div id="outline-container-org9bd0074" class="outline-5">
<h5 id="org9bd0074"><span class="section-number-5">2.6.1.4</span> AVERAGEIFS 函数(按多个条件求平均值)</h5>
<div class="outline-text-5" id="text-2-6-1-4">
<p>
\[ AVERAGEIFS(average\_range, criteria\_range1, criteria1, criteria\_range2,
criteria2, \cdots) \]
</p>

<ul class="org-ul">
<li>average<sub>range</sub>: 要求平均值的区域范围.</li>
<li>criteria<sub>range1</sub>, &#x2026;: 条件应用的区域以及对应的判断条件.</li>
</ul>


<p>
AVERAGEIFS 函数用于返回满足多重条件的所有单元格的算术平均值.
</p>

<p>
使用示例:
</p>
<pre class="example">
=AVERAGEIFS(D2:D14, B2:B14, "女", C2:C14, "一车间")
计算一车间女职员的平均工资.
</pre>
</div>
</div>

<div id="outline-container-org59c3334" class="outline-5">
<h5 id="org59c3334"><span class="section-number-5">2.6.1.5</span> GEOMEAN 函数(返回几何平均值)</h5>
<div class="outline-text-5" id="text-2-6-1-5">
<p>
\[ GEOMEAN(number1,number2,\cdots) \]
</p>

<ul class="org-ul">
<li>number1, number2, &#x2026; : 需要计算平均值的1-30 个参数.</li>
</ul>


<p>
GEOMEAN 函数用来返回正数数组或数据区域的几何平均值.
</p>

<blockquote>
<p>
几何平均值:
\[ GEOMEAN = \sqrt[N]{number1 \times number2 \times number3 \times \cdots \times numberN}\]
几何平均值表示的是数据的稳定性,例如 1 和 100 的几何平均值为 10, 50 和 50 的几何
平均值为 50 虽然值相差1,但几何平均值相差了 40 ,从这个结果上可以看出几何平均值越
大,数据越稳定.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=GEOMEAN(1,4,16)
1,4,16相乘再开三次方,得4
=GEOMEAN(5,5,5)
5,5,5 相乘再开三次方,得5
虽然 1+4+16=21 大于 5+5+5=15, 但 5,5,5 的组合数据更稳定.
</pre>
</div>
</div>

<div id="outline-container-org9dd9705" class="outline-5">
<h5 id="org9dd9705"><span class="section-number-5">2.6.1.6</span> HARMEAN 函数(返回数据集的调和平均值)</h5>
<div class="outline-text-5" id="text-2-6-1-6">
<p>
\[ HARMEAN(numner1,number2,\cdots) \]
</p>

<ul class="org-ul">
<li>number1, &#x2026;: 需要计算平均值的1-30 个参数</li>
</ul>


<p>
HARMEAN 函数用于返回数据集合的调和平均值(调和平均值与倒数的算术平均值互为倒数)
</p>
<blockquote>
<p>
调和平均值是将所有数值取倒数后求算术平均值然后对算术平均值求倒数得到的:
\[HARMEAN = \frac{N}{\frac{1}{number1} + \frac{1}{number2} +\cdots + \frac{1}{numberN}}\]
调和平均值要求所有数据都要大于0, 调和平均值容易收到极小值的影响.
调和平均值一般用在求取平均速率时用到.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
求5名学生1小时内的平均解题数.
=HARMEAN(B2:B6)
B2:B6 是每个学生的解题数.
</pre>
</div>
</div>

<div id="outline-container-org25441fe" class="outline-5">
<h5 id="org25441fe"><span class="section-number-5">2.6.1.7</span> TRIMMEAN 函数(截头尾返回数据集的平均值)</h5>
<div class="outline-text-5" id="text-2-6-1-7">
<p>
\[ TRIMMEAN(array, percent) \]
</p>

<ul class="org-ul">
<li>array: 要求取平均值的区域.</li>
<li>percent: 表示要截取的数据的比例, 当 percent = 0.2 时, 10 个数据中去除两个数
据,20个数据中去除 4 个.</li>
</ul>


<p>
TRIMMEAN 函数用于从数据集的头部和尾部去掉一定百分比的数据点后,再求数据集的算术平
均值.
</p>
<blockquote>
<p>
该函数会将截取的点数向下舍入到最近的 2 的倍数,例如 10 个数据,percent 为 0.1 则向
下舍入为 0, 一个都不删除, 30 个数据, percent 为 0.1 则向下舍入为 2, 因为要对称的
删除最大和最小的数据.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=TRIMMEAN({1,2,3,4},0.25)
4*0.25 = 1 向下舍入到 2 的倍数 0, 所以一个都不删除,然后计算算术平均值, 10/4=2.5
=TRIMMEAN({1,2,2,4},0.75)
4*0.75 = 3, 向下舍入到 2, 删除最小的1 和最大的4, 计算算术平均值 4/2=2
</pre>
</div>
</div>
</div>


<div id="outline-container-org0c0b967" class="outline-4">
<h4 id="org0c0b967"><span class="section-number-4">2.6.2</span> 数目统计函数(5)</h4>
<div class="outline-text-4" id="text-2-6-2">
</div>
<div id="outline-container-org60fa7d9" class="outline-5">
<h5 id="org60fa7d9"><span class="section-number-5">2.6.2.1</span> COUNT 函数(统计含有数值的单元格个数)</h5>
<div class="outline-text-5" id="text-2-6-2-1">
<p>
\[ COUNT(value1, value2, \cdots) \]
</p>

<ul class="org-ul">
<li>value1, &#x2026; : 要统计的1-255 个参数,只有数值类型数据会被统计.</li>
</ul>

<p>
COUNT 函数用于统计参数中数值类型的参数个数.
</p>

<p>
使用示例:
</p>
<pre class="example">
=COUNT(1,2,3,"1")
"1" 为文本类型,不纳入统计范围,结果为 3
</pre>
</div>
</div>

<div id="outline-container-orgeddc918" class="outline-5">
<h5 id="orgeddc918"><span class="section-number-5">2.6.2.2</span> COUNTA 函数(统计非空单元格的个数)</h5>
<div class="outline-text-5" id="text-2-6-2-2">
<p>
\[ COUNTA(value1, value2, \cdots) \]
</p>

<ul class="org-ul">
<li>value1, &#x2026; : 要统计的 1-255 个参数, 只要是非空单元格就会纳入统计范围.</li>
</ul>

<p>
COUNTA 用于统计非空单元格的个数.
</p>

<p>
使用示例:
</p>
<pre class="example">
=COUNTA("")
"" 即使是空字符串也是有值,只不过这个字符串值的内容为空,所以结果为1.
=COUNTA("",,)
结果为3
=COUNTA("",,B2)
B2 为空单元格,结果为2. 查看这个例子和上面一个例子的执行过程,发现如果参数空置,则
该函数将该位置的参数视为0,如果参数为空字符串 "",则视为一个错误值#VALUE!(错误值也是值)
</pre>
</div>
</div>
<div id="outline-container-org6ef4df3" class="outline-5">
<h5 id="org6ef4df3"><span class="section-number-5">2.6.2.3</span> COUNTIF 函数(统计满足条件的单元格个数)</h5>
<div class="outline-text-5" id="text-2-6-2-3">
<p>
\[ COUNTIF(range, criteria) \]
</p>

<ul class="org-ul">
<li>range : 需要统计的单元格区域.</li>
<li>criteria: 判断条件.</li>
</ul>


<p>
COUNTIF 函数用于统计区域内满足给定条件的单元格个数.
</p>

<p>
使用示例:
</p>
<pre class="example">
=COUNTIF(A2:A12, "&gt;=18")
统计 A2:A12 中大于等于18 的单元格个数.
注意, EXCEL 中文本类型数据永远大于数值类型数据.
</pre>
</div>
</div>

<div id="outline-container-org6c22404" class="outline-5">
<h5 id="org6c22404"><span class="section-number-5">2.6.2.4</span> COUNTIFS 函数(统计同时满足多个条件的单元格个数)</h5>
<div class="outline-text-5" id="text-2-6-2-4">
<p>
\[ COUNTIFS(range1, criteria1, range2, criteria2, \cdots) \]
</p>

<ul class="org-ul">
<li>range1, range2, &#x2026; : 要判断的区域,区域的规模必需一致.</li>
<li>criteria1, criteria2, &#x2026;: 判断条件.</li>
</ul>


<p>
COUNTIFS 函数用于统计同时满足多个条件的单元格个数.
</p>
<blockquote>
<p>
这里理解应该是同时满足多个条件的数据条数.一条数据由多个单元格组成,多个条件就是判
断的一条数据中的多个单元格是否满足对应条件.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
COUNTIFS(C2:C12,"女", D2:D12, "第一车间")
统计第一车间的女性人数.
</pre>
</div>
</div>
<div id="outline-container-orgac4919a" class="outline-5">
<h5 id="orgac4919a"><span class="section-number-5">2.6.2.5</span> COUNTBLANK 函数(统计空单元格个数)</h5>
<div class="outline-text-5" id="text-2-6-2-5">
<p>
\[ COUNTBLANK(range) \]
</p>

<ul class="org-ul">
<li>range : 需要统计空单元格的区域.</li>
</ul>


<p>
COUNTBLANK 函数用于统计区域内的空单元格个数.
</p>
<blockquote>
<p>
COUNTBLANK 与 COUNTA 的作用刚好相反,一个统计非空单元格,一个统计空单元格; COUNTA
可以接收单元格区域之外的参数, COUNTBLANK 只能接收单元格区域作为参数.
</p>
</blockquote>
<p>
使用示例:
</p>
<pre class="example">
=COUNTBLANK(D2:D12) &amp; "人"
D 列为成绩列,缺考没有分数,所以可以用来统计缺考人数.
</pre>
</div>
</div>
</div>

<div id="outline-container-org620fb43" class="outline-4">
<h4 id="org620fb43"><span class="section-number-4">2.6.3</span> 最大值与最小值函数(6)</h4>
<div class="outline-text-4" id="text-2-6-3">
</div>
<div id="outline-container-org7180eae" class="outline-5">
<h5 id="org7180eae"><span class="section-number-5">2.6.3.1</span> MAX 函数(返回数值集的最大值)</h5>
<div class="outline-text-5" id="text-2-6-3-1">
<p>
\[ MAX(number1, number2, \cdots) \]
</p>

<ul class="org-ul">
<li>number1,number2, &#x2026; : 用于查找最大值的一组 1-255 个数据.</li>
</ul>


<p>
MAX 函数用于返回数据集中的最大数值.
</p>
<blockquote>
<p>
对于非数值类型的数据(引用或字面值) ,MAX 参数的处理规则和 SUM 参数类似,不同的是
SUM 将文本值的单元格引用视为0, MAX 则直接忽略, 但原则都是让它们不影响计算结果.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=MAX(1,2,"3")
最大值为3
=MAX(1,2,A2)
A2 的内容为文本值 "3",但对于非数值类型的单元格引用,会和 SUM 函数一样直接
忽视, 所以最大值为2
</pre>
</div>
</div>

<div id="outline-container-orge858c20" class="outline-5">
<h5 id="orge858c20"><span class="section-number-5">2.6.3.2</span> MIN 函数(返回数值集的最小值)</h5>
<div class="outline-text-5" id="text-2-6-3-2">
<p>
\[ MIN(number1, number2, \cdots) \]
</p>

<ul class="org-ul">
<li>number1,number2, &#x2026; : 用于查找最小值的一组 1-255 个数据.</li>
</ul>

<p>
MAX 函数用于返回数据集中的最小数值.
</p>

<p>
使用示例:
</p>
<pre class="example">
=MIN(IF(C2:C12&lt;&gt;0,C2:C12))
这是一个数组公式,需要按 Ctrl+Shift+Enter 得出结果, 主要是为了让 IF 函数
返回一个数组结果. 这个公式是忽略 0 值找出最小值.
</pre>
</div>
</div>
<div id="outline-container-org7def452" class="outline-5">
<h5 id="org7def452"><span class="section-number-5">2.6.3.3</span> MAXA 函数(返回数据集(包括文本,逻辑值)的最大值)</h5>
<div class="outline-text-5" id="text-2-6-3-3">
<p>
\[ MAXA(value1, value2, \cdots) \]
</p>

<ul class="org-ul">
<li>value1, &#x2026;: 要查找最大值的1-255 个参数.</li>
</ul>

<p>
MAXA 函数用于查找参数中的最大值,与 MAX 不同的是 MAXA 不会忽略逻辑值,以及逻辑值的
引用, 文本值 和 MAX 函数的处理也不同, MAXA 对文本值的处理就和 SUM 一致了, 字面值
当作数值, "1" 会当作数值1 统计, 文本值的引用当作0, B2 为 "100", =MAXA(B2,-1) 结
果为0.
</p>

<p>
使用示例:
</p>
<pre class="example">
=MAXA(1,"2")
结果为 2
=MAXA(1,B3)
B3 为 "2", 结果为 1
=MAXA(TRUE,"0")
=MAXA(B2,"0")
B2 为逻辑值 TRUE, 结果为1
</pre>
</div>
</div>

<div id="outline-container-org2200b6b" class="outline-5">
<h5 id="org2200b6b"><span class="section-number-5">2.6.3.4</span> MINA 函数(返回数据集(包括逻辑值和文本)的最小值)</h5>
<div class="outline-text-5" id="text-2-6-3-4">
<p>
\[ MINA(value1, value2, \cdots) \]
</p>

<ul class="org-ul">
<li>value1, &#x2026;: 要查找最小值的1-255 个参数.</li>
</ul>


<p>
MINA 函数用法和 MAXA 函数类似,只不过是查找最小值.
</p>

<p>
使用示例:
</p>
<pre class="example">
=MINA(B2,1)
B2 为文本类型数据 "111111" ,但 MINA 视文本值的引用为0,因此返回结果 0.
</pre>
</div>
</div>
<div id="outline-container-org901ef66" class="outline-5">
<h5 id="org901ef66"><span class="section-number-5">2.6.3.5</span> LARGE 函数(返回数据集的某个最大值)</h5>
<div class="outline-text-5" id="text-2-6-3-5">
<p>
\[ LARGE(array, k) \]
</p>

<ul class="org-ul">
<li>array: 需要查找的区域.</li>
<li>k: 要查找的最大值的排名.如 k 为2,则返回数组中第二大的值.</li>
</ul>

<p>
LARGE 函数用于返回 array 中第 k 大的值.
</p>

<p>
使用示例:
</p>
<pre class="example">
=LARGE({1,2,3,4,5}, 2)
1,2,3,4,5 中第二大的值为 4
</pre>
</div>
</div>
<div id="outline-container-org00ab712" class="outline-5">
<h5 id="org00ab712"><span class="section-number-5">2.6.3.6</span> SMALL 函数(返回数据集的某个最小值)</h5>
<div class="outline-text-5" id="text-2-6-3-6">
<p>
\[ SMALL(array, k) \]
</p>

<ul class="org-ul">
<li>array: 需要查找的区域.</li>
<li>k: 要查找的最小值的排名.如 k 为2,则返回数组中第二小的值.</li>
</ul>

<p>
SMALL 函数用于返回 array 中第 k 小的值.
</p>

<p>
使用示例:
</p>
<pre class="example">
=SMALL({1,2,3,4,5}, 4)
1,2,3,4,5 中第4 小的值为 4
=SMALL({1,2,3,4,5}, {1,2})
这是一个数组公式, 按 Ctrl+Shift+Enter, 然后填充单元格可以得到第一和第二小的值 1 和 2
=AVERAGE(SMALL(B2:B12), {1,2,3,4,5})
从 B2:B12 中选出分数最低的 5 个分数,然后计算平均分.
</pre>
</div>
</div>
</div>


<div id="outline-container-org884a65b" class="outline-4">
<h4 id="org884a65b"><span class="section-number-4">2.6.4</span> 排位统计函数(5)</h4>
<div class="outline-text-4" id="text-2-6-4">
<blockquote>
<p>
rank,quartile,percentile,percentrank 都是最早版本的函数,与 EXCEL 2007 以及更早的
excel 版本兼容.它们在新版本中被替换为了一个或多个精确度更高的函数.
</p>
</blockquote>
</div>
<div id="outline-container-orge24ff68" class="outline-5">
<h5 id="orge24ff68"><span class="section-number-5">2.6.4.1</span> RANK.EQ 函数(返回数据的排位,相同值返回最高排序)</h5>
<div class="outline-text-5" id="text-2-6-4-1">
<p>
\[ RANK.EQ(number,ref,[order]) \]
</p>

<ul class="org-ul">
<li>number: 要查找排位的数.</li>
<li>ref: 数字数组.</li>
<li>order: 排位方式,0 表示降序, 1 表示升序. 省略则默认为降序排序.</li>
</ul>


<p>
RANK.EQ 函数用于返回 number 在 ref 这组数据中的排序位置, 其中, ref 这组数据必需
包含 number 否则会返回 #N/A 错误. 多个相同的 number 值则返回 number 的最高排序.
</p>


<p>
使用示例:
</p>
<pre class="example">
=RANK.EQ(D2,D2:D14)
假设D 列为成绩列,这个公式可以返回每个人的成绩排名第几.
</pre>
</div>
</div>
<div id="outline-container-orgcd1def5" class="outline-5">
<h5 id="orgcd1def5"><span class="section-number-5">2.6.4.2</span> RANK.AVG 函数(返回数据的排位,相同值返回排序的平均值)</h5>
<div class="outline-text-5" id="text-2-6-4-2">
<p>
\[ RANK.AVG(number,ref,[order]) \]
</p>

<ul class="org-ul">
<li>number: 要查找排位的数.</li>
<li>ref: 数字数组.</li>
<li>order: 排位方式,0 表示降序, 1 表示升序. 省略则默认为降序排序.</li>
</ul>


<p>
RANK.AVG 函数与 RANK.EQ 的基本功能没有区别,只有当出现相同排序,即 ref 中有多个
number 值时有所不同, RANK.AVG 会返回排名的均值,而 RANK.EQ 会返回最高的排名,例
如,1,在 1,1,3 中有两个, RANK.EQ 对1 的排序是 2 和 3, 返回最高排序2, RANK.AVG 则
返回 (2+3)/2= 2.5
</p>


<p>
使用示例:
</p>
<pre class="example">
=RANK.AVG(2,B2:B5)
B2:B5 为 1,2,2,3 ,2 在其中排名第2,3位,rank.avg 返回 2.5, rank.eq 返回 2.
</pre>
</div>
</div>

<div id="outline-container-org4ad3788" class="outline-5">
<h5 id="org4ad3788"><span class="section-number-5">2.6.4.3</span> QUARTILE.INC, QUARTILE.EXC 函数</h5>
<div class="outline-text-5" id="text-2-6-4-3">
<p>
\[ QUARTILE.INC(array, quart) \]
</p>

<ul class="org-ul">
<li>array: 表示要求得四分位数值的区域.</li>
<li>quart: 决定返回哪一个四分位值.</li>
</ul>


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 9:</span> quart 可选值</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">quart</td>
<td class="org-left">含义</td>
</tr>

<tr>
<td class="org-left">"0"</td>
<td class="org-left">最小值</td>
</tr>

<tr>
<td class="org-left">"1"</td>
<td class="org-left">第一个四分位值(25%处的值)</td>
</tr>

<tr>
<td class="org-left">"2"</td>
<td class="org-left">第二个四分位值(50%处的值)</td>
</tr>

<tr>
<td class="org-left">"3"</td>
<td class="org-left">第三个四分位值(75%处的值)</td>
</tr>

<tr>
<td class="org-left">"4"</td>
<td class="org-left">最大值</td>
</tr>
</tbody>
</table>

<p>
QUARTILE.INC 函数用于根据0-1 的百分点值(含0和1)返回数据集的四分位值.
QUARTILE.EXC 函数用于根据0-1 的百分点值(不含0和1) 返回数据集的四分位值.
</p>

<blockquote>
<p>
QUARTILE 函数在 EXCEL 2010 之后分成了两个版本, QUARTILE.INC (include) 可以返回最
大最小值, 和 QUARTILE.EXC (exclude) 不含最大值最小值.
因此需要获取最小/大值,就使用 INC 版本,不然就可以使用 EXC 版本,在我看来只用记忆
QUARTILE.INC 就可以了.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=QUARTILE.INC({1,3,4},0)
返回最小值 1, 这种用法其实完全可以替代最大/小值函数.
</pre>
</div>
</div>

<div id="outline-container-org3b45422" class="outline-5">
<h5 id="org3b45422"><span class="section-number-5">2.6.4.4</span> PERCENTILE.INC, PERCENTILE.EXC 函数</h5>
<div class="outline-text-5" id="text-2-6-4-4">
<p>
\[ PERCENTILE.INC(array,k) \]
</p>

<ul class="org-ul">
<li>array: 表示要获取百分比位值的区域.</li>
<li>k: 0-1 的百分点值,包含0和1.</li>
</ul>


<blockquote>
<p>
如果 k 不是 1/(n-1) 的倍数,则使用插值法确定第 k 个百分点的值. 例如, 1,2,3,4 取
k=0.5 ,不是 1/3 的倍数,则使用插值法确定 k 个百分比的值. 插值法以多个离散点为基础,为
了取得一个原数据集没有的,但近似符合原数据规律的值.
</p>
</blockquote>
<p>
PERCENTILE.INC 函数用于返回区域中数值的第 k 个百分点的值, k 为0-1 的百分点,包含0
和1.
PERCENTILE.EXC 函数用于返回区域中数值的第 k 个百分点的值, k 为0-1 的百分点,不含0
和1
</p>


<p>
使用示例:
</p>
<pre class="example">
=PERCENTILE.INC({1,3,4},1)
返回位于 100% 的值,也就是最大的值
=PERCENTILE.INC({1,2,3},0.25)
0.25 不是 1/2 的倍数,因此使用插值法取得的近似值作为返回值. 如果是线性插值法,这个 (1,1),(2,2),(3,3) 的
数据集很容易得出是一条 y=x 的直线上的点,因此取百分比就是 0.25 了.
</pre>
</div>
</div>
<div id="outline-container-orgf1d0808" class="outline-5">
<h5 id="orgf1d0808"><span class="section-number-5">2.6.4.5</span> PERCENTRANK.INC, PERCENTRANK.EXC 函数</h5>
<div class="outline-text-5" id="text-2-6-4-5">
<p>
\[ PERCENTRANK.INC(array, x, [significance]) \]
</p>

<ul class="org-ul">
<li>array: 要定位相对位置的区域.</li>
<li>x: 要在 array 中找到排位的值.</li>
<li>significance: 返回的百分数值的有效位数.默认为保留3为小数</li>
</ul>


<p>
PERCENTRANK.INC 函数用于返回特定数值 x 在 array 区域中的百分比排名,包含0和1.
PERCENTRANK.EXC 函数用于返回特定数值 x 在 array 区域中的百分比排名,不含0和1.
</p>

<p>
使用示例:
</p>
<pre class="example">
=PERCENTRANK.INC({1,2,3}, 3)
3 位于 1,2,3 中的 100% ,也就是最大处.
=PERCENTRANK.EXC({1,2,3}, 3)
因为不含 100% 和 0, 所以3 位于 1,2,3 中的 75% 处.
</pre>
</div>
</div>
</div>

<div id="outline-container-org3f7bd66" class="outline-4">
<h4 id="org3f7bd66"><span class="section-number-4">2.6.5</span> 方差,协方差与偏差函数(12)</h4>
<div class="outline-text-4" id="text-2-6-5">
<blockquote>
<p>
方差:
\[ \sigma^2 = \frac{\sum_{i=1}^{N}(x_i-\overline{x})^2}{N}, N 为样本个数\]
总体方差:
对整个总体数据运用方差算法计算的结果.
样本方差:
对样本数据运用&#x2026;.
</p>

<p>
.S 函数都是基于样本计算样本的方差,标准差等
.P 函数都是基于样本估算总体的方差,标准差等.
A 函数是将文本和逻辑值纳入计算范围计算方差,标准差等.
</p>
</blockquote>
</div>

<div id="outline-container-org43e8815" class="outline-5">
<h5 id="org43e8815"><span class="section-number-5">2.6.5.1</span> VAR.S 函数(计算基于样本的方差)</h5>
<div class="outline-text-5" id="text-2-6-5-1">
<p>
\[ VAR.S(number1, [number2], \cdots) \]
</p>

<ul class="org-ul">
<li>number1, &#x2026; : 样本总体的1-255 个参数.</li>
</ul>


<p>
VARS.S 函数用于估算基于样本的方差(忽略逻辑值和文本值), 方差越小,表示数据越稳定,
就是数据间的差别越小.
</p>
<blockquote>
<p>
方差越大,算术平均值越不能表示数据的一般水平.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example">
=VAR.S(A2:A12)
A2:A12 为某个产品的质量指数,计算处的方差越小,表示这批产品的品控越好.
</pre>
</div>
</div>

<div id="outline-container-org6ac4823" class="outline-5">
<h5 id="org6ac4823"><span class="section-number-5">2.6.5.2</span> VARA 函数(计算基于样本的方差, 文本和逻辑值也参与计算)</h5>
<div class="outline-text-5" id="text-2-6-5-2">
<p>
\[ VARA(number1, [number2], \cdots) \]
</p>

<ul class="org-ul">
<li>number1,&#x2026; : 样本总体的1-255 个参数.</li>
</ul>


<p>
VARA 函数用于估算给定样本的方差,与 VAR.S 的区别在于文本值和逻辑值也参与计算, 文
本值和 FALSE 视为0, TRUE 视为 1.
</p>

<p>
使用示例:
</p>
<pre class="example">
=VARA(A2:A12)
</pre>
</div>
</div>

<div id="outline-container-org42a37e1" class="outline-5">
<h5 id="org42a37e1"><span class="section-number-5">2.6.5.3</span> VAR.P 函数(基于样本计算总体的方差)</h5>
<div class="outline-text-5" id="text-2-6-5-3">
<p>
\[ VAR.P(number1,[number2], \cdots) \]
</p>

<ul class="org-ul">
<li>number1, number2,&#x2026; : 样本的1-255 个参数.</li>
</ul>


<p>
VAR.P 函数基于 number1 到 numbern 这 n 个样本来估算总体的方差.
</p>

<p>
使用示例:
</p>
<pre class="example">
=VAR.P(A2:A12)
这个结果会与 VAR.S 不同,因为一个是估算以样本为总体的方差(VAR.S), 一个是基于样本,
估算总体的方差(VAR.P)
</pre>
</div>
</div>

<div id="outline-container-orge632ae4" class="outline-5">
<h5 id="orge632ae4"><span class="section-number-5">2.6.5.4</span> VARPA 函数(基于样本计算总体的方差,文本和逻辑值也参与计算)</h5>
<div class="outline-text-5" id="text-2-6-5-4">
<p>
\[ VARPA(value1, value2, \cdots) \]
</p>

<ul class="org-ul">
<li>value1, &#x2026; : 样本的 1-255 个参数.</li>
</ul>


<p>
VARPA 函数基于 value1 到 value n 这 n 个样本来估算总体方差, 文本值和 FALSE 视为
0, TRUE 视为 1.
</p>

<p>
使用示例:
</p>
<pre class="example">
=VARPA(A2:A15)
</pre>
</div>
</div>

<div id="outline-container-orgf6bcd20" class="outline-5">
<h5 id="orgf6bcd20"><span class="section-number-5">2.6.5.5</span> STDEV.S 函数(基于样本估算标准差)</h5>
<div class="outline-text-5" id="text-2-6-5-5">
<p>
\[ STDEV.S(number1, [number2], \cdots) \]
</p>

<ul class="org-ul">
<li>number1, &#x2026; : 样本的 1-255 个参数.</li>
</ul>


<p>
STDEV.S 函数基于样本估算标准偏差(忽略逻辑和文本值).
标准偏差反映数值相对于平均值的离散程度.
</p>

<p>
使用示例:
</p>
<pre class="example">
=STDEV.S(A2:A15)
</pre>
</div>
</div>

<div id="outline-container-org028b0f4" class="outline-5">
<h5 id="org028b0f4"><span class="section-number-5">2.6.5.6</span> STDEVA 函数(基于样本估算标准偏差,文本和逻辑值也参与计算)</h5>
<div class="outline-text-5" id="text-2-6-5-6">
<p>
\[ STDEVA(value1, value2, ...) \]
</p>

<ul class="org-ul">
<li>value1, &#x2026; : 样本的 1-255 个参数.</li>
</ul>


<p>
STDEVA 函数基于样本估计标准偏差(文本和 FALSE 视为0,TRUE 视为1).
</p>
<blockquote>
<p>
包含文本或逻辑值的标准偏差一般用于样本包含 "无效数据" 的情况下估算样本的标准偏差.
</p>
</blockquote>
<p>
使用示例:
</p>
<pre class="example">
=STDEVA(A2:A15)
</pre>
</div>
</div>
<div id="outline-container-org260f458" class="outline-5">
<h5 id="org260f458"><span class="section-number-5">2.6.5.7</span> STDEV.P 函数(基于样本估算总体的标准偏差)</h5>
<div class="outline-text-5" id="text-2-6-5-7">
<p>
\[ STDEV.P(number1, [number2], \cdots) \]
</p>

<ul class="org-ul">
<li>number1, &#x2026; : 样本的1-255 个参数.</li>
</ul>


<p>
STDEV.P 函数用于根据样本估算总体的标准偏差.
</p>

<p>
使用示例:
</p>
<pre class="example">
=STDEV.P(A2:A12)
</pre>
</div>
</div>
<div id="outline-container-orgec14528" class="outline-5">
<h5 id="orgec14528"><span class="section-number-5">2.6.5.8</span> STDEVPA 函数(基于样本估算总体的标准偏差,文本和逻辑值也参与计算)</h5>
<div class="outline-text-5" id="text-2-6-5-8">
<p>
\[ STDEVPA(value1, value2, \cdots) \]
</p>

<ul class="org-ul">
<li>_ :</li>
</ul>


<p>
VARS.S 函数用于
</p>

<p>
使用示例:
</p>
<pre class="example">

</pre>
</div>
</div>
<div id="outline-container-org2f2f17c" class="outline-5">
<h5 id="org2f2f17c"><span class="section-number-5">2.6.5.9</span> VAR.S 函数(计算基于样本的方差)</h5>
<div class="outline-text-5" id="text-2-6-5-9">
<p>
\[ _ \]
</p>

<ul class="org-ul">
<li>_ :</li>
</ul>


<p>
VARS.S 函数用于
</p>

<p>
使用示例:
</p>
<pre class="example">

</pre>
</div>
</div>
<div id="outline-container-orgc93cbb8" class="outline-5">
<h5 id="orgc93cbb8"><span class="section-number-5">2.6.5.10</span> VAR.S 函数(计算基于样本的方差)</h5>
<div class="outline-text-5" id="text-2-6-5-10">
<p>
\[ _ \]
</p>

<ul class="org-ul">
<li>_ :</li>
</ul>


<p>
VARS.S 函数用于
</p>

<p>
使用示例:
</p>
<pre class="example">

</pre>
</div>
</div>
<div id="outline-container-org0d5a953" class="outline-5">
<h5 id="org0d5a953"><span class="section-number-5">2.6.5.11</span> VAR.S 函数(计算基于样本的方差)</h5>
<div class="outline-text-5" id="text-2-6-5-11">
<p>
\[ _ \]
</p>

<ul class="org-ul">
<li>_ :</li>
</ul>


<p>
VARS.S 函数用于
</p>

<p>
使用示例:
</p>
<pre class="example">

</pre>
</div>
</div>
<div id="outline-container-orgb5f5cc4" class="outline-5">
<h5 id="orgb5f5cc4"><span class="section-number-5">2.6.5.12</span> VAR.S 函数(计算基于样本的方差)</h5>
<div class="outline-text-5" id="text-2-6-5-12">
<p>
\[ _ \]
</p>

<ul class="org-ul">
<li>_ :</li>
</ul>


<p>
VARS.S 函数用于
</p>

<p>
使用示例:
</p>
<pre class="example">

</pre>
</div>
</div>
</div>

<div id="outline-container-org2dc157e" class="outline-4">
<h4 id="org2dc157e"><span class="section-number-4">2.6.6</span> 概率分布函数(44)</h4>
</div>
<div id="outline-container-org8f8b2fd" class="outline-4">
<h4 id="org8f8b2fd"><span class="section-number-4">2.6.7</span> 检验函数(4)</h4>
</div>
<div id="outline-container-org12bd8f2" class="outline-4">
<h4 id="org12bd8f2"><span class="section-number-4">2.6.8</span> 回归分析函数(8)</h4>
</div>
<div id="outline-container-org419f802" class="outline-4">
<h4 id="org419f802"><span class="section-number-4">2.6.9</span> 相关系数分析(4)</h4>
</div>
<div id="outline-container-org2c268ae" class="outline-4">
<h4 id="org2c268ae"><span class="section-number-4">2.6.10</span> 其他统计函数(7)</h4>
</div>
</div>

<div id="outline-container-org9bb9be3" class="outline-3">
<h3 id="org9bb9be3"><span class="section-number-3">2.7</span> 财务函数(55)</h3>
</div>

<div id="outline-container-org1c6f12d" class="outline-3">
<h3 id="org1c6f12d"><span class="section-number-3">2.8</span> 查找和引用函数(18)</h3>
</div>

<div id="outline-container-org1539dcd" class="outline-3">
<h3 id="org1539dcd"><span class="section-number-3">2.9</span> 数据库函数(12)</h3>
</div>

<div id="outline-container-org0681593" class="outline-3">
<h3 id="org0681593"><span class="section-number-3">2.10</span> 工程函数(54)</h3>
</div>

<div id="outline-container-orgf0d87e6" class="outline-3">
<h3 id="orgf0d87e6"><span class="section-number-3">2.11</span> 加载项和自动化函数(4)</h3>
</div>

<div id="outline-container-org1b22d3f" class="outline-3">
<h3 id="org1b22d3f"><span class="section-number-3">2.12</span> 多维数据集函数(7)</h3>
</div>

<div id="outline-container-org9189c00" class="outline-3">
<h3 id="org9189c00"><span class="section-number-3">2.13</span> 兼容性函数(38)</h3>
</div>

<div id="outline-container-org6abdf64" class="outline-3">
<h3 id="org6abdf64"><span class="section-number-3">2.14</span> Web函数(3)</h3>
</div>

<div id="outline-container-org4603ccf" class="outline-3">
<h3 id="org4603ccf"><span class="section-number-3">2.15</span> 名称的定义与使用</h3>
</div>
</div>
<div id="outline-container-orge584c69" class="outline-2">
<h2 id="orge584c69"><span class="section-number-2">3</span> <span class="todo TODO">TODO</span> 重要知识</h2>
<div class="outline-text-2" id="text-3">
<p>
这本书里有很多使用了数组运算的地方,在阅读时尽量都记录了书签,最后准备对区域运算,
数组运算这些很多书没有详细讲,但又总在使用,只能看用法去理解的内容做一些额外学习.
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2023-08-24 Thu 09:08</p>
</div>
</body>
</html>
