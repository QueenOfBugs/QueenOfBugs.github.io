<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2024-02-16 Fri 14:29 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Excel 相关书籍的笔记</title>
<meta name="author" content="kamisama" />
<meta name="generator" content="Org Mode" />
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Excel 相关书籍的笔记</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org9ceff93">1. <span class="todo TODO">TODO</span> Excel 教科书(吉田拳 日)</a>
<ul>
<li><a href="#orgd2f4b24">1.1. Excel 必须掌握的7个要点</a>
<ul>
<li><a href="#org6ace0c7">1.1.1. 常规操作瞬间完成</a></li>
<li><a href="#orged570f1">1.1.2. 提升Excel技能的3个必需项</a></li>
<li><a href="#org75646fe">1.1.3. 数据只有4种类型</a></li>
<li><a href="#org6378d18">1.1.4. 有效利用快捷键</a></li>
<li><a href="#orgfd30212">1.1.5. 保存制作好的数据</a></li>
<li><a href="#orgd2fb65e">1.1.6. 解除复杂功能,操作更简便</a></li>
<li><a href="#orge0d3637">1.1.7. 共享 Excel 文件时的注意点</a>
<ul>
<li><a href="#org3ce9afe">1.1.7.1. 文件的保存形式</a></li>
<li><a href="#orge58339d">1.1.7.2. 保留1个新建工作簿的初期工作</a></li>
<li><a href="#org3a73417">1.1.7.3. 确认"设置打印区域"</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org165dc06">1.2. 如何在 Excel 中输入函数</a>
<ul>
<li><a href="#org9f5c242">1.2.1. 输入公式的操作步骤</a>
<ul>
<li><a href="#orga99bba6">1.2.1.1. 巧用函数,简化输入过程</a></li>
<li><a href="#org4e7d5c5">1.2.1.2. 输入函数的5个步骤</a></li>
<li><a href="#org44c6627">1.2.1.3. 如何快速选择单元格范围</a></li>
</ul>
</li>
<li><a href="#orgd45416e">1.2.2. 熟练使用"引用",快速计算</a>
<ul>
<li><a href="#orgad449f4">1.2.2.1. 活用单元格中的原始数据</a></li>
<li><a href="#org3810e3d">1.2.2.2. 必须掌握的运算符</a></li>
<li><a href="#org66c71ff">1.2.2.3. 复制带公式单元格时的陷阱</a></li>
<li><a href="#orge79bc09">1.2.2.4. 利用 "F4" 和 "$" 高效运用 "绝对引用"</a></li>
<li><a href="#orgdcc5414">1.2.2.5. 无需记住错误值的种类和意义</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orge75daa2">1.3. 需要事先掌握的6个函数</a>
<ul>
<li><a href="#org2678b7e">1.3.1. 根据条件改变答案&#x2013;IF 函数</a>
<ul>
<li><a href="#org6e5bf62">1.3.1.1. IF 函数的基础知识</a></li>
<li><a href="#org92b8c9e">1.3.1.2. 如何判断复数条件</a></li>
</ul>
</li>
<li><a href="#orgcb75d9b">1.3.2. 本月销售额&#x2013;SUM 函数</a>
<ul>
<li><a href="#orgcd0b024">1.3.2.1. SUM 函数的基础</a></li>
<li><a href="#org53ab4f1">1.3.2.2. 计算连续单元格范围内的总和&#x2013;ΣSUM</a></li>
<li><a href="#org878ef4f">1.3.2.3. 如何求多个分开的单元格的总和</a></li>
<li><a href="#orgc4774d8">1.3.2.4. 提高乘法运算,字符串混合输入的效率</a></li>
</ul>
</li>
<li><a href="#orgabcea78">1.3.3. 计算客户名单的人数&#x2013;COUNTA 函数</a>
<ul>
<li><a href="#org4181be2">1.3.3.1. 与 COUNT 函数的区别</a></li>
</ul>
</li>
<li><a href="#orgce99daf">1.3.4. 按照负责人分别计算销售情况&#x2013;SUMIF 函数</a>
<ul>
<li><a href="#orgc7939b0">1.3.4.1. SUMIF 函数的基础</a></li>
<li><a href="#org750c186">1.3.4.2. 计算每个人的销售情况</a></li>
</ul>
</li>
<li><a href="#org00b2081">1.3.5. 参加名单中,有多少人出席&#x2013;COUNTIF 函数</a>
<ul>
<li><a href="#orgcbac5d6">1.3.5.1. COUNTIF 函数的基础</a></li>
<li><a href="#orgf165ed4">1.3.5.2. 计算每名销售人员的销售数量</a></li>
</ul>
</li>
<li><a href="#org76b947e">1.3.6. 输入商品名,自动显示价格&#x2013;VLOOKUP 函数</a>
<ul>
<li><a href="#orged4a578">1.3.6.1. VLOOKUP 函数的基础</a></li>
<li><a href="#org123cf07">1.3.6.2. 用 "整列指定"</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgce80568">1.4. 通过应用与组合,提升函数威力</a>
<ul>
<li><a href="#org7ee0b42">1.4.1. 判断单元格中是否包含特定的字符串</a>
<ul>
<li><a href="#orgedf631b">1.4.1.1. 就算特定地址区域的客户人数</a></li>
<li><a href="#org7ca057e">1.4.1.2. 如何搜索更多的特定区域</a></li>
</ul>
</li>
<li><a href="#orgcdf7389">1.4.2. 消除重复数据的方法</a>
<ul>
<li><a href="#orgf729496">1.4.2.1. 如何判断是否有重复</a></li>
<li><a href="#orgd0b4879">1.4.2.2. 选中并删除重复的单元格</a></li>
</ul>
</li>
<li><a href="#orgad52cd4">1.4.3. 输入连续的数字</a></li>
<li><a href="#org7ef11b5">1.4.4. 沿行方向输入大量 VLOOKUP 函数的方法</a></li>
<li><a href="#org22f10ad">1.4.5. 如何用 VLOOKUP 函数应对检索范围中竖列顺序的变动情况</a></li>
<li><a href="#org383ca78">1.4.6. 在有多个相同检索值的工作表中使用 VLOOKUP 函数的技巧</a></li>
<li><a href="#orgc942557">1.4.7. 是否能用 VLOOKUP 函数获得检索列左侧的数值?</a></li>
<li><a href="#org4c8ed17">1.4.8. 不显示错误值的技巧</a></li>
<li><a href="#orgd35d390">1.4.9. 用 SUMIF 函数统计多个条件的方法</a></li>
</ul>
</li>
<li><a href="#orge1d7c1c">1.5. Excel 中的日期与时间设置</a></li>
</ul>
</li>
<li><a href="#orgdb7ebc8">2. <span class="todo TODO">TODO</span> Excel函数与公事速查手册(第二版)</a>
<ul>
<li><a href="#orgb04334e">2.1. 逻辑函数(8)</a>
<ul>
<li><a href="#orgef39e2a">2.1.1. AND 函数(检验是否都满足条件)</a></li>
<li><a href="#orgef04207">2.1.2. OR 函数(检验是否有一个满足条件)</a></li>
<li><a href="#org4f34aa1">2.1.3. NOT 函数(对参数取反)</a></li>
<li><a href="#orgd92f6a7">2.1.4. IF 函数(根据条件判断真假)</a></li>
<li><a href="#org9634fc4">2.1.5. TRUE 函数</a></li>
<li><a href="#org194ef7a">2.1.6. FALSE 函数</a></li>
<li><a href="#org0242124">2.1.7. IFNA 函数</a></li>
<li><a href="#org7b63cf1">2.1.8. IFERROR 函数</a></li>
</ul>
</li>
<li><a href="#orgdbfb732">2.2. 数学和三角函数(59)</a>
<ul>
<li><a href="#org52dcd7d">2.2.1. 求和函数</a>
<ul>
<li><a href="#orgdb3619d">2.2.1.1. SUM 函数(求和运算)</a></li>
<li><a href="#org2140a5c">2.2.1.2. SUMIF 函数(按照指定条件求和)</a></li>
<li><a href="#orgd1a2a38">2.2.1.3. SUMIFS 函数(对满足多重条件的单元格求和)</a></li>
<li><a href="#org5be83e7">2.2.1.4. SUMPRODUCT 函数(将数组间对应的元素相乘,并返回乘积之和)</a></li>
<li><a href="#org5ed985e">2.2.1.5. SUBTOTAL 函数 (返回分类汇总的值)</a></li>
</ul>
</li>
<li><a href="#org9d85f8e">2.2.2. 数学函数</a>
<ul>
<li><a href="#orgd8ea862">2.2.2.1. ABS 函数(求绝对值)</a></li>
<li><a href="#orgfe98c62">2.2.2.2. MOD 函数(求两个数值相除后的余数)</a></li>
<li><a href="#org94360a6">2.2.2.3. SUMSQ 函数</a></li>
<li><a href="#orga5f15a2">2.2.2.4. SUMXMY2 函数</a></li>
<li><a href="#org2c0ee63">2.2.2.5. SUMX2MY2 函数</a></li>
<li><a href="#org117aa22">2.2.2.6. SUMX2PY2 函数</a></li>
<li><a href="#org368765a">2.2.2.7. PRODUCRT 函数</a></li>
<li><a href="#org39217cc">2.2.2.8. MULTINOMIAL 函数</a></li>
<li><a href="#orgf143d7f">2.2.2.9. MDETERM 函数</a></li>
<li><a href="#org4a2c10a">2.2.2.10. MINVERSE 函数</a></li>
<li><a href="#org7d32158">2.2.2.11. MMULT 函数</a></li>
<li><a href="#org3d2b02e">2.2.2.12. GCD 函数</a></li>
<li><a href="#org9668e76">2.2.2.13. LCM</a></li>
<li><a href="#org710a62e">2.2.2.14. QUOTIENT 函数(返回商的整数部分)</a></li>
<li><a href="#org7c7ecf1">2.2.2.15. RAND 函数(返回大于或等于0 小于1 的随机数)</a></li>
<li><a href="#org1c4864a">2.2.2.16. RANDBETWEEN 函数(返回指定数值之间的随机数)</a></li>
<li><a href="#orgfc3ed6e">2.2.2.17. SQRT 函数(返回参数的平方根)</a></li>
<li><a href="#orgb9f4af2">2.2.2.18. SQRTPI 函数</a></li>
<li><a href="#org526cee5">2.2.2.19. RADIANS 函数(将角度转为弧度)</a></li>
<li><a href="#org99c408e">2.2.2.20. SIGN 函数</a></li>
<li><a href="#orgb0dd24d">2.2.2.21. ROMAN 函数</a></li>
</ul>
</li>
<li><a href="#org7f5b3e8">2.2.3. 数据舍入函数</a>
<ul>
<li><a href="#org606c84b">2.2.3.1. INT 函数(不考虑四舍五入直接对数字取整)</a></li>
<li><a href="#org07b055e">2.2.3.2. ROUND 函数(对数据进行四舍五入)</a></li>
<li><a href="#org7594553">2.2.3.3. ROUNDUP 函数(向上舍入)</a></li>
<li><a href="#org0ded9d7">2.2.3.4. ROUNDDOWN 函数(向下舍入)</a></li>
<li><a href="#orgb5ce8e4">2.2.3.5. CEILING 函数(向上取舍到最接近指定数字的某个值的倍数值)</a></li>
<li><a href="#org6f055cb">2.2.3.6. FLOOR 函数(向下舍入到最接近指定数字的某个值的倍数值)</a></li>
<li><a href="#orgd7835c1">2.2.3.7. MROUND 函数(按指定倍数舍入)</a></li>
<li><a href="#orgf2aede1">2.2.3.8. EVEN 函数</a></li>
<li><a href="#orgaf3d3c5">2.2.3.9. ODD 函数</a></li>
<li><a href="#org2463198">2.2.3.10. TRUNC 函数(不考虑四舍五入直接对数字进行截断)</a></li>
</ul>
</li>
<li><a href="#orgd0ff640">2.2.4. 三角函数</a>
<ul>
<li><a href="#orgc464977">2.2.4.1. COS 函数</a></li>
<li><a href="#org8f953cf">2.2.4.2. ACOS 函数</a></li>
<li><a href="#orgd205797">2.2.4.3. COSH 函数</a></li>
<li><a href="#org939c2c3">2.2.4.4. ACOSH 函数</a></li>
<li><a href="#org702fc71">2.2.4.5. SIN 函数</a></li>
<li><a href="#orga78396a">2.2.4.6. ASIN 函数</a></li>
<li><a href="#org5f532b5">2.2.4.7. SINH 函数</a></li>
<li><a href="#org2e626e3">2.2.4.8. ASINH 函数</a></li>
<li><a href="#org0b8dd71">2.2.4.9. TAN 函数</a></li>
<li><a href="#org7f60c5c">2.2.4.10. ATAN 函数</a></li>
<li><a href="#org01715b4">2.2.4.11. ATAN2 函数</a></li>
<li><a href="#org56c490c">2.2.4.12. TANH 函数</a></li>
<li><a href="#org3a7c72a">2.2.4.13. ATANH 函数</a></li>
<li><a href="#org1138c92">2.2.4.14. DEGREES 函数</a></li>
<li><a href="#org7041ec2">2.2.4.15. PI 函数</a></li>
</ul>
</li>
<li><a href="#org5c493f4">2.2.5. 对数,幂和阶乘函数</a>
<ul>
<li><a href="#orgf3e88fc">2.2.5.1. EXP 函数</a></li>
<li><a href="#org7b336a2">2.2.5.2. POWER 函数</a></li>
<li><a href="#orgbdadbea">2.2.5.3. LN 函数</a></li>
<li><a href="#org112eb70">2.2.5.4. LOG 函数</a></li>
<li><a href="#orgef808ec">2.2.5.5. LOG10 函数</a></li>
<li><a href="#orgacb0e3f">2.2.5.6. SERIESSUM 函数</a></li>
<li><a href="#org1bf4513">2.2.5.7. FACT 函数</a></li>
<li><a href="#orgb87197d">2.2.5.8. FACTDOUBLE 函数</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orge534f32">2.3. 文本函数(27)</a>
<ul>
<li><a href="#orgba5273b">2.3.1. 文本查找,提取</a>
<ul>
<li><a href="#orga3f9e41">2.3.1.1. MID 函数(从任意位置提取指定数目的字符)</a></li>
<li><a href="#orgbcd0186">2.3.1.2. LEFT 函数(按指定字符数从最左侧提取字符串)</a></li>
<li><a href="#org3c0fedb">2.3.1.3. RIGHT 函数(按指定字符数从最右侧提取字符串)</a></li>
<li><a href="#org5518f0c">2.3.1.4. SEARCH 函数(查找字符串的起始位置)</a></li>
</ul>
</li>
<li><a href="#org624e497">2.3.2. 文本替换</a>
<ul>
<li><a href="#orgff942d2">2.3.2.1. REPLACE 函数(替换文本字符串的部分文本)</a></li>
<li><a href="#orga5a75e3">2.3.2.2. SUBSTITUTE 函数(用新文本替换旧文本)</a></li>
</ul>
</li>
<li><a href="#orgfa1a366">2.3.3. 文本格式转换</a>
<ul>
<li><a href="#org59782c9">2.3.3.1. ASC 函数(将全角字符转换为半角字符)</a></li>
<li><a href="#org978becf">2.3.3.2. WIDECHAR 函数(将半角字符转换为全角字符)</a></li>
<li><a href="#org9c87d39">2.3.3.3. LOWER 函数(将文本转为小写形式)</a></li>
<li><a href="#org25e71aa">2.3.3.4. UPPER 函数(将文本转为大写形式)</a></li>
<li><a href="#orgc7a977f">2.3.3.5. PROPER(将文本字符串的首字母转为大写)</a></li>
<li><a href="#orga0f95f8">2.3.3.6. DOLLAR 函数(四舍五入数值,并添加千分位符和 $ 符号)</a></li>
<li><a href="#org68a6076">2.3.3.7. RMB 函数(四舍五入数值,并添加千分位符号和¥符号)</a></li>
<li><a href="#org65a3d33">2.3.3.8. BAHTTEXT 函数(将数字转为泰铢)</a></li>
<li><a href="#orgd51b152">2.3.3.9. FIXED 函数(将数字显示千分位符样式并转为文本)</a></li>
<li><a href="#org4d64d7b">2.3.3.10. TEXT 函数(设置数字格式并将其转为文本)</a></li>
<li><a href="#orgcaa4791">2.3.3.11. VALUE 函数(将文本数字转换成数值)</a></li>
<li><a href="#org7bfcafc">2.3.3.12. CHAR 函数</a></li>
<li><a href="#org060e6b5">2.3.3.13. CODE 函数</a></li>
<li><a href="#org52c7bd0">2.3.3.14. UNICHAR 函数</a></li>
</ul>
</li>
<li><a href="#org49d591f">2.3.4. 其他文本函数</a>
<ul>
<li><a href="#orgff0277f">2.3.4.1. CONCATENATE 函数(合并多个文本字符串)</a></li>
<li><a href="#org87c3d87">2.3.4.2. LEN 函数(返回文本字符串的字符数量)</a></li>
<li><a href="#org37ffb4d">2.3.4.3. EXACT 函数(比较两个字符串是否完全相同)</a></li>
<li><a href="#org43129ff">2.3.4.4. REPT 函数(按照指定次数重复文本)</a></li>
<li><a href="#orgb480394">2.3.4.5. TRIM 函数</a></li>
<li><a href="#org0545eda">2.3.4.6. CLEAN 函数(删除文本中不能打印的字符)</a></li>
<li><a href="#orgcf4ba3e">2.3.4.7. T 函数</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org028c096">2.4. 信息函数(20)</a>
<ul>
<li><a href="#org3e64dd8">2.4.1. 返回信息以及各类型的值</a>
<ul>
<li><a href="#org5fc6ecb">2.4.1.1. CELL 函数(返回有关单元格格式,位置或内容的信息)</a></li>
<li><a href="#org979c7da">2.4.1.2. TYPE 函数(返回单元格内的数值类型)</a></li>
<li><a href="#orge75dba0">2.4.1.3. N 函数(将数据转换成数值并返回)</a></li>
<li><a href="#org68d6fd5">2.4.1.4. NA 函数(返回错误值 #N/A)</a></li>
<li><a href="#orgb2006c6">2.4.1.5. INFO 函数(返回当前操作环境的信息)</a></li>
<li><a href="#org0af5fd6">2.4.1.6. ERROR.TYPE 函数(返回错误值对应的数字)</a></li>
</ul>
</li>
<li><a href="#orgba64607">2.4.2. 各种 IS 函数</a>
<ul>
<li><a href="#orgc6e8117">2.4.2.1. ISBLANK 函数(检测单元格是否为空)</a></li>
<li><a href="#org195aff3">2.4.2.2. ISNUMBER 函数(检测参数是否为数值)</a></li>
<li><a href="#org91679e7">2.4.2.3. ISTEXT 函数(检测参数是否为文本)</a></li>
<li><a href="#org0cd86e7">2.4.2.4. ISNONTEXT 函数(检测参数是否为非文本,结果与 ISTEXT 相反)</a></li>
<li><a href="#orgf8584f7">2.4.2.5. ISEVEN 函数(判断数字是否为偶数)</a></li>
<li><a href="#org5d51e97">2.4.2.6. ISODD 函数(判断数字是否为奇数)</a></li>
<li><a href="#orga28bcba">2.4.2.7. ISLOGICAL 函数(检测给定参数是否为逻辑值)</a></li>
<li><a href="#org060e944">2.4.2.8. ISERROR 函数(检测参数是否为错误值)</a></li>
<li><a href="#orgd187250">2.4.2.9. ISNA 函数(检测参数是否为 #N/A 错误值)</a></li>
<li><a href="#org28baff7">2.4.2.10. ISERR 函数(检测参数是否为 #N/A 之外的错误值)</a></li>
<li><a href="#org9690aa1">2.4.2.11. ISREF 函数(检测参数是否为引用)</a></li>
<li><a href="#org5b3c590">2.4.2.12. ISFORMULA 函数(检测单元格内容是否为公式)</a></li>
<li><a href="#org4aae7fb">2.4.2.13. SHEET 函数(返回工作表编号)</a></li>
<li><a href="#org1fe1f38">2.4.2.14. SHEETS 函数(工作簿中工作表数量)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orga5e43a0">2.5. 日期和时间函数(23)</a>
<ul>
<li><a href="#org1f64490">2.5.1. 返回日期和时间</a>
<ul>
<li><a href="#orga116103">2.5.1.1. NOW 函数(返回当前日期与时间)</a></li>
<li><a href="#orge8c9371">2.5.1.2. TODAY 函数(返回当前日期)</a></li>
<li><a href="#org4538eb1">2.5.1.3. DATE 函数(构建一个标准日期)</a></li>
<li><a href="#org2a76b25">2.5.1.4. TIME 函数(构建标准时间)</a></li>
<li><a href="#orgc3e6336">2.5.1.5. YEAR 函数(返回日期对应的年份)</a></li>
<li><a href="#org5614be1">2.5.1.6. MONTH 函数(返回日期中的月份)</a></li>
<li><a href="#orgb78ef2f">2.5.1.7. DAY 函数(返回日期中的天数)</a></li>
<li><a href="#orgbce40ed">2.5.1.8. WEEKDAY 函数(返回日期对应的星期数)</a></li>
<li><a href="#orgcd04140">2.5.1.9. WEEKNUM 函数(返回日期对应一年中的第几周)</a></li>
<li><a href="#org88d4893">2.5.1.10. EOMONTH 函数(返回某日期到指定月数之前/后的最后一天的日期)</a></li>
<li><a href="#org4a5b1b8">2.5.1.11. HOUR 函数(返回时间中的小时数)</a></li>
<li><a href="#orgd8dab7c">2.5.1.12. MINUTE 函数(返回时间中的分钟数)</a></li>
<li><a href="#org2f5221b">2.5.1.13. SECOND 函数(返回时间中的秒数)</a></li>
</ul>
</li>
<li><a href="#org8864298">2.5.2. 日期计算</a>
<ul>
<li><a href="#org909c161">2.5.2.1. DATEDIF 函数(计算两个日期之间的年数,月数和天数)</a></li>
<li><a href="#org737cc46">2.5.2.2. DAYS360 函数(按照一年 360 天的算法计算两个日期之间的天数差)</a></li>
<li><a href="#org1fd9fee">2.5.2.3. EDATE 函数(计算间隔指定月数后的日期)</a></li>
<li><a href="#orgd41803a">2.5.2.4. WORKDAY 函数(获取间隔若干工作日后的日期)</a></li>
<li><a href="#org4a2b21f">2.5.2.5. WORKDAY.INTL 函数</a></li>
<li><a href="#org2133fc6">2.5.2.6. YEARFRAC 函数(从开始到结束经过的天数占全年总天数的比例)</a></li>
<li><a href="#org34c094e">2.5.2.7. NETWORKDAYS 函数(计算两个日期之间的工作日数量)</a></li>
<li><a href="#orge76743e">2.5.2.8. NETWORKDAYS.INTL 函数</a></li>
</ul>
</li>
<li><a href="#orgef32495">2.5.3. 文本日期/时间的转换</a>
<ul>
<li><a href="#orge33c464">2.5.3.1. DATEVALUE 函数(将日期字符串转换成可以计算的数值/序列号)</a></li>
<li><a href="#orgf5f7efb">2.5.3.2. TIEMVALUE 函数(将时间字符串转换成可计算的小数值)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org0ff3da9">2.6. 统计函数(102)</a>
<ul>
<li><a href="#orga256755">2.6.1. 平均值计算函数(7)</a>
<ul>
<li><a href="#orga18a481">2.6.1.1. AVERAGE 函数(求平均值)</a></li>
<li><a href="#org17b0e75">2.6.1.2. AVERAGEA 函数(求包括文本和逻辑值的平均值)</a></li>
<li><a href="#org00b7a10">2.6.1.3. AVERAGEIF 函数(按条件求平均值)</a></li>
<li><a href="#orgfd8b109">2.6.1.4. AVERAGEIFS 函数(按多个条件求平均值)</a></li>
<li><a href="#orga1165ea">2.6.1.5. GEOMEAN 函数(返回几何平均值)</a></li>
<li><a href="#org852ba4c">2.6.1.6. HARMEAN 函数(返回数据集的调和平均值)</a></li>
<li><a href="#org88c31af">2.6.1.7. TRIMMEAN 函数(截头尾返回数据集的平均值)</a></li>
</ul>
</li>
<li><a href="#org568cd70">2.6.2. 数目统计函数(5)</a>
<ul>
<li><a href="#org48f2959">2.6.2.1. COUNT 函数(统计含有数值的单元格个数)</a></li>
<li><a href="#org70461b5">2.6.2.2. COUNTA 函数(统计非空单元格的个数)</a></li>
<li><a href="#org90958a4">2.6.2.3. COUNTIF 函数(统计满足条件的单元格个数)</a></li>
<li><a href="#org15112d7">2.6.2.4. COUNTIFS 函数(统计同时满足多个条件的单元格个数)</a></li>
<li><a href="#orgb83caba">2.6.2.5. COUNTBLANK 函数(统计空单元格个数)</a></li>
</ul>
</li>
<li><a href="#org7318a59">2.6.3. 最大值与最小值函数(6)</a>
<ul>
<li><a href="#org8ac89c8">2.6.3.1. MAX 函数(返回数值集的最大值)</a></li>
<li><a href="#orgcb98ad3">2.6.3.2. MIN 函数(返回数值集的最小值)</a></li>
<li><a href="#orga6c3a22">2.6.3.3. MAXA 函数(返回数据集(包括文本,逻辑值)的最大值)</a></li>
<li><a href="#org9880997">2.6.3.4. MINA 函数(返回数据集(包括逻辑值和文本)的最小值)</a></li>
<li><a href="#org8725961">2.6.3.5. LARGE 函数(返回数据集的某个最大值)</a></li>
<li><a href="#org246faad">2.6.3.6. SMALL 函数(返回数据集的某个最小值)</a></li>
</ul>
</li>
<li><a href="#orge84396f">2.6.4. 排位统计函数(5)</a>
<ul>
<li><a href="#orgc985a6a">2.6.4.1. RANK.EQ 函数(返回数据的排位,相同值返回最高排序)</a></li>
<li><a href="#org45393ca">2.6.4.2. RANK.AVG 函数(返回数据的排位,相同值返回排序的平均值)</a></li>
<li><a href="#orgf4c0fa5">2.6.4.3. QUARTILE.INC, QUARTILE.EXC 函数</a></li>
<li><a href="#org039cb77">2.6.4.4. PERCENTILE.INC, PERCENTILE.EXC 函数</a></li>
<li><a href="#orgb06d25d">2.6.4.5. PERCENTRANK.INC, PERCENTRANK.EXC 函数</a></li>
</ul>
</li>
<li><a href="#org13509fd">2.6.5. 方差,协方差与偏差函数(12)</a>
<ul>
<li><a href="#orgd1f008e">2.6.5.1. VAR.S 函数(计算基于样本的方差)</a></li>
<li><a href="#orgbef414c">2.6.5.2. VARA 函数(计算基于样本的方差, 文本和逻辑值也参与计算)</a></li>
<li><a href="#org2ae817f">2.6.5.3. VAR.P 函数(基于样本计算总体的方差)</a></li>
<li><a href="#org74a4aa1">2.6.5.4. VARPA 函数(基于样本计算总体的方差,文本和逻辑值也参与计算)</a></li>
<li><a href="#orgadb4653">2.6.5.5. STDEV.S 函数(基于样本估算标准差)</a></li>
<li><a href="#org3ba8f61">2.6.5.6. STDEVA 函数(基于样本估算标准偏差,文本和逻辑值也参与计算)</a></li>
<li><a href="#org86c1644">2.6.5.7. STDEV.P 函数(基于样本估算总体的标准偏差)</a></li>
<li><a href="#orgba28d65">2.6.5.8. STDEVPA 函数(基于样本估算总体的标准偏差,文本和逻辑值也参与计算)</a></li>
<li><a href="#orgdbd1dcb">2.6.5.9. VAR.S 函数(计算基于样本的方差)</a></li>
<li><a href="#org2b275b9">2.6.5.10. VAR.S 函数(计算基于样本的方差)</a></li>
<li><a href="#orgafe0534">2.6.5.11. VAR.S 函数(计算基于样本的方差)</a></li>
<li><a href="#org07d5c07">2.6.5.12. VAR.S 函数(计算基于样本的方差)</a></li>
</ul>
</li>
<li><a href="#org05c3c41">2.6.6. 概率分布函数(44)</a></li>
<li><a href="#orgadb8ebd">2.6.7. 检验函数(4)</a></li>
<li><a href="#orgf5dd6c7">2.6.8. 回归分析函数(8)</a></li>
<li><a href="#org6baeb58">2.6.9. 相关系数分析(4)</a></li>
<li><a href="#org6d96535">2.6.10. 其他统计函数(7)</a></li>
</ul>
</li>
<li><a href="#orgb547154">2.7. 财务函数(55)</a></li>
<li><a href="#orgd335442">2.8. 查找和引用函数(18)</a></li>
<li><a href="#orgd097e60">2.9. 数据库函数(12)</a></li>
<li><a href="#orgbe92402">2.10. 工程函数(54)</a></li>
<li><a href="#org86c2b80">2.11. 加载项和自动化函数(4)</a></li>
<li><a href="#org02ec079">2.12. 多维数据集函数(7)</a></li>
<li><a href="#org7a84b05">2.13. 兼容性函数(38)</a></li>
<li><a href="#org62aa9d8">2.14. Web函数(3)</a></li>
<li><a href="#org90e5076">2.15. <span class="todo TODO">TODO</span> 名称的定义与使用</a></li>
</ul>
</li>
<li><a href="#orga3b5933">3. <span class="todo NEXT">NEXT</span> 和秋叶一起学 Excel (3rd)</a>
<ul>
<li><a href="#org5d7a0ce">3.1. <span class="done DONE">DONE</span> 快速认识 Excel</a>
<ul>
<li><a href="#org178628c">3.1.1. <span class="done DONE">DONE</span> Excel 到底有什么用</a>
<ul>
<li><a href="#orgd8efa0d">3.1.1.1. <span class="done DONE">DONE</span> 排版工具</a></li>
<li><a href="#orgf30c28d">3.1.1.2. <span class="done DONE">DONE</span> 表单工具</a></li>
<li><a href="#org55cf1be">3.1.1.3. <span class="done DONE">DONE</span> 统计工具</a></li>
<li><a href="#org040c341">3.1.1.4. <span class="done DONE">DONE</span> 汇报工具</a></li>
</ul>
</li>
<li><a href="#org214f869">3.1.2. <span class="done DONE">DONE</span> 方法不对,Excel 越用越累</a>
<ul>
<li><a href="#org52c9a51">3.1.2.1. <span class="done DONE">DONE</span> 排版打印类表格</a></li>
<li><a href="#orgbd93109">3.1.2.2. <span class="done DONE">DONE</span> 统计分析类表格</a></li>
</ul>
</li>
<li><a href="#org6ad52af">3.1.3. <span class="done DONE">DONE</span> 熟悉 Excel</a>
<ul>
<li><a href="#org50fb30d">3.1.3.1. <span class="done DONE">DONE</span> 打开 Excel</a></li>
<li><a href="#org3794e40">3.1.3.2. <span class="done DONE">DONE</span> Excel 的工作界面</a></li>
<li><a href="#orgc9ef4ad">3.1.3.3. <span class="done DONE">DONE</span> 上下文选项卡</a></li>
<li><a href="#orgb379767">3.1.3.4. <span class="done DONE">DONE</span> 工作簿与工作表</a></li>
<li><a href="#org88741a6">3.1.3.5. <span class="done DONE">DONE</span> 单元格</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orga32ebf4">3.2. <span class="done DONE">DONE</span> 准确,高效地录入数据</a>
<ul>
<li><a href="#org8fdc3b2">3.2.1. <span class="done DONE">DONE</span> 录入数据的诀窍</a>
<ul>
<li><a href="#orga7bdd0b">3.2.1.1. <span class="done DONE">DONE</span> 减少在鼠标和键盘间来回切换</a></li>
<li><a href="#orgaa40581">3.2.1.2. <span class="done DONE">DONE</span> 使用快捷键一键录入数据</a></li>
<li><a href="#org197298b">3.2.1.3. <span class="done DONE">DONE</span> 批量录入相同数据</a></li>
<li><a href="#orgfde533b">3.2.1.4. <span class="done DONE">DONE</span> 在不相邻的行或列中批量录入数据</a></li>
</ul>
</li>
<li><a href="#org01a20b8">3.2.2. <span class="done DONE">DONE</span> 批量填充序号</a>
<ul>
<li><a href="#org06678e3">3.2.2.1. <span class="done DONE">DONE</span> 录入连续序号</a></li>
<li><a href="#org7d1c9b7">3.2.2.2. <span class="done DONE">DONE</span> 使用自定义序列录入文本序号</a></li>
<li><a href="#org391603e">3.2.2.3. <span class="done DONE">DONE</span> 录入数字格式的数据</a></li>
<li><a href="#org611439f">3.2.2.4. <span class="done DONE">DONE</span> 录入日期格式的数据</a></li>
<li><a href="#orgac1bfb9">3.2.2.5. <span class="done DONE">DONE</span> 录入文本格式的数据</a></li>
</ul>
</li>
<li><a href="#org889c1a7">3.2.3. <span class="done DONE">DONE</span> 填写选项,就用下拉表</a></li>
<li><a href="#org37b6d22">3.2.4. <span class="done DONE">DONE</span> 善用工具,批量导入外部数据</a>
<ul>
<li><a href="#orga5e04c7">3.2.4.1. <span class="done DONE">DONE</span> 将图片和PDF文件中的数据导入Excel</a></li>
<li><a href="#orge206ca2">3.2.4.2. <span class="done DONE">DONE</span> 将网页数据导入Excel</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org92e66cd">3.3. <span class="done DONE">DONE</span> 表格的排版与打印技巧</a>
<ul>
<li><a href="#org0148512">3.3.1. <span class="done DONE">DONE</span> 表格高效浏览技巧</a>
<ul>
<li><a href="#orgcc9439b">3.3.1.1. <span class="done DONE">DONE</span> 冻结窗格</a></li>
<li><a href="#org909562d">3.3.1.2. <span class="done DONE">DONE</span> Ctrl+方向键</a></li>
<li><a href="#org8777002">3.3.1.3. <span class="done DONE">DONE</span> 定位单元格</a></li>
<li><a href="#orgfdc407a">3.3.1.4. <span class="done DONE">DONE</span> 快速隐藏数据</a></li>
<li><a href="#org27388cf">3.3.1.5. <span class="done DONE">DONE</span> 切换工作表</a></li>
</ul>
</li>
<li><a href="#orgcc698ac">3.3.2. <span class="done DONE">DONE</span> 表格的打印技巧</a>
<ul>
<li><a href="#orgf5a3964">3.3.2.1. <span class="done DONE">DONE</span> 解决打印不全的问题</a></li>
<li><a href="#org16ffd20">3.3.2.2. <span class="done DONE">DONE</span> 重复打印表头</a></li>
<li><a href="#orgb12f36e">3.3.2.3. <span class="done DONE">DONE</span> 设置页眉与页脚</a></li>
<li><a href="#org7fdf390">3.3.2.4. <span class="done DONE">DONE</span> 调整纸张方向</a></li>
</ul>
</li>
<li><a href="#org73b1351">3.3.3. <span class="done DONE">DONE</span> 表格的加密保护技巧</a>
<ul>
<li><a href="#org3ba2fbb">3.3.3.1. <span class="done DONE">DONE</span> 保护工作表</a></li>
<li><a href="#orgee5aa55">3.3.3.2. <span class="done DONE">DONE</span> 保护工作簿</a></li>
<li><a href="#org22ef192">3.3.3.3. <span class="done DONE">DONE</span> 限制编辑区域</a></li>
<li><a href="#org25bdad3">3.3.3.4. <span class="done DONE">DONE</span> 保护文件</a></li>
</ul>
</li>
<li><a href="#org2270445">3.3.4. <span class="done DONE">DONE</span> 高效批量打印信函证书</a></li>
</ul>
</li>
<li><a href="#org899691a">3.4. <span class="done DONE">DONE</span> 批量整理数据的妙招</a>
<ul>
<li><a href="#org0526e5c">3.4.1. <span class="done DONE">DONE</span> 效率底下的真相: 数据不规范</a>
<ul>
<li><a href="#org8982abd">3.4.1.1. <span class="done DONE">DONE</span> 数据结构不规范</a></li>
<li><a href="#orgc8a0cff">3.4.1.2. <span class="done DONE">DONE</span> 数据格式不规范</a></li>
</ul>
</li>
<li><a href="#orgad74b09">3.4.2. <span class="done DONE">DONE</span> 妙招1:分列和提取</a>
<ul>
<li><a href="#org6b8e49d">3.4.2.1. <span class="done DONE">DONE</span> 数据分列</a></li>
<li><a href="#orgcb97660">3.4.2.2. <span class="done DONE">DONE</span> 快速智能填充</a></li>
</ul>
</li>
<li><a href="#org8b43cbb">3.4.3. <span class="done DONE">DONE</span> 妙招2:查找和替换</a>
<ul>
<li><a href="#orgf1bbfbe">3.4.3.1. <span class="done DONE">DONE</span> 常规的查找和替换</a></li>
<li><a href="#org3602b0d">3.4.3.2. <span class="done DONE">DONE</span> 单元格匹配</a></li>
<li><a href="#orgdf565c2">3.4.3.3. <span class="done DONE">DONE</span> 匹配指定格式</a></li>
<li><a href="#org04cdda9">3.4.3.4. <span class="done DONE">DONE</span> 使用通配符进行模糊匹配</a></li>
</ul>
</li>
<li><a href="#org482bc5c">3.4.4. <span class="done DONE">DONE</span> 妙招3:处理重复值</a>
<ul>
<li><a href="#orgcadac99">3.4.4.1. <span class="done DONE">DONE</span> 筛选重复值</a></li>
<li><a href="#orge3dda79">3.4.4.2. <span class="done DONE">DONE</span> 标记重复值</a></li>
<li><a href="#org8cf6077">3.4.4.3. <span class="done DONE">DONE</span> 删除重复值</a></li>
</ul>
</li>
<li><a href="#org20e60cf">3.4.5. <span class="done DONE">DONE</span> 妙招4:多表合并</a>
<ul>
<li><a href="#org60876ff">3.4.5.1. <span class="done DONE">DONE</span> 合并工作表</a></li>
<li><a href="#org04e6b12">3.4.5.2. <span class="done DONE">DONE</span> 合并工作簿</a></li>
</ul>
</li>
<li><a href="#orga4f554c">3.4.6. <span class="done DONE">DONE</span> 数据筛选技巧</a>
<ul>
<li><a href="#orgf204894">3.4.6.1. <span class="done DONE">DONE</span> 数据筛选基础</a></li>
<li><a href="#org5b0969d">3.4.6.2. <span class="done DONE">DONE</span> 多条件筛选</a></li>
</ul>
</li>
<li><a href="#orgc9155b8">3.4.7. <span class="done DONE">DONE</span> 数据排序</a>
<ul>
<li><a href="#org9242411">3.4.7.1. <span class="done DONE">DONE</span> 数据排序基础</a></li>
<li><a href="#org7cbf239">3.4.7.2. <span class="done DONE">DONE</span> 对混合文本排序</a></li>
<li><a href="#org711a6da">3.4.7.3. <span class="done DONE">DONE</span> 按指定次序排序</a></li>
<li><a href="#orgcb691fd">3.4.7.4. <span class="done DONE">DONE</span> 对存在合并单元格的数据排序</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org2a83e6f">3.5. <span class="done DONE">DONE</span> 数据分析必会函数公式</a>
<ul>
<li><a href="#org2d129c2">3.5.1. <span class="done DONE">DONE</span> 数据分析基础</a>
<ul>
<li><a href="#orgf77b20d">3.5.1.1. <span class="done DONE">DONE</span> 数据分析</a></li>
<li><a href="#org8afd69f">3.5.1.2. <span class="done DONE">DONE</span> 函数公式</a></li>
</ul>
</li>
<li><a href="#org9a408dd">3.5.2. <span class="done DONE">DONE</span> 分类求和计数</a>
<ul>
<li><a href="#org7c68d6a">3.5.2.1. <span class="done DONE">DONE</span> 计算每种产品的营业额</a></li>
<li><a href="#org851b565">3.5.2.2. <span class="done DONE">DONE</span> 如何对大于等于目标的数据求和</a></li>
<li><a href="#org17c88ed">3.5.2.3. <span class="done DONE">DONE</span> 如何对指定范围内的数据求和</a></li>
<li><a href="#orgc2321c8">3.5.2.4. <span class="done DONE">DONE</span> 如何按照产品和销售区域统计销售次数</a></li>
</ul>
</li>
<li><a href="#orgeb6912d">3.5.3. <span class="done DONE">DONE</span> 逻辑判断</a>
<ul>
<li><a href="#org2de3477">3.5.3.1. <span class="done DONE">DONE</span> 成绩大于等于80备注"合格",否则备注"不合格"</a></li>
<li><a href="#orgb15bf76">3.5.3.2. <span class="done DONE">DONE</span> 3门课程的分数都大于等于80备注"合格",否则备注"不合格"</a></li>
<li><a href="#org0fe59fa">3.5.3.3. <span class="done DONE">DONE</span> 根据不同的分数,添加对应的备注</a></li>
</ul>
</li>
<li><a href="#orgba141d6">3.5.4. <span class="done DONE">DONE</span> 数据整理</a>
<ul>
<li><a href="#orgd77cc18">3.5.4.1. <span class="done DONE">DONE</span> 如何判断项目是否完成</a></li>
<li><a href="#orgbb549f6">3.5.4.2. <span class="done DONE">DONE</span> 如何用 MID 函数提取出日期</a></li>
<li><a href="#orgd9ce4e3">3.5.4.3. <span class="done DONE">DONE</span> 如何用公式提取商品描述中的数据</a></li>
<li><a href="#org137b270">3.5.4.4. <span class="done DONE">DONE</span> 其他常用的数据整理函数</a></li>
</ul>
</li>
<li><a href="#orgdc4e04f">3.5.5. <span class="done DONE">DONE</span> 多表查询</a>
<ul>
<li><a href="#org612232f">3.5.5.1. <span class="done DONE">DONE</span> 如何使用VLOOKUP函数查找部门绩效</a></li>
<li><a href="#org525294b">3.5.5.2. <span class="done DONE">DONE</span> 如何根据销售数据计算对应的绩效等级</a></li>
<li><a href="#orgc0b200c">3.5.5.3. <span class="done DONE">DONE</span> 如何按照姓名查询每个月的销量</a></li>
<li><a href="#org3ff31de">3.5.5.4. <span class="done DONE">DONE</span> 如何匹配对应的补助金额</a></li>
</ul>
</li>
<li><a href="#org9b374c3">3.5.6. <span class="done DONE">DONE</span> 日期和时间的计算</a>
<ul>
<li><a href="#orgf127ad9">3.5.6.1. <span class="done DONE">DONE</span> 如何计算两个日期相差的天数</a></li>
<li><a href="#org403e78f">3.5.6.2. <span class="done DONE">DONE</span> 如何把出勤时长改成小时数</a></li>
<li><a href="#orgbf22ebc">3.5.6.3. <span class="done DONE">DONE</span> 如何计算员工入职到离职相差的月数</a></li>
<li><a href="#org79e53e7">3.5.6.4. <span class="done DONE">DONE</span> 如何根据日期提取年月日和周别</a></li>
</ul>
</li>
<li><a href="#orgd2078c3">3.5.7. <span class="done DONE">DONE</span> 函数公式的检查和校正</a>
<ul>
<li><a href="#org2435168">3.5.7.1. <span class="done DONE">DONE</span> 常见的错误</a></li>
<li><a href="#org78a41a3">3.5.7.2. <span class="done DONE">DONE</span> 排错工具和技巧</a></li>
<li><a href="#org2207226">3.5.7.3. <span class="done DONE">DONE</span> 记不住函数怎么办</a></li>
</ul>
</li>
<li><a href="#orgb0425a5">3.5.8. <span class="todo NEXT">NEXT</span> 数据分析必会功能:数据透视表</a>
<ul>
<li><a href="#org62102cd">3.5.8.1. <span class="done DONE">DONE</span> 数据透视表基础</a></li>
<li><a href="#org46faa0c">3.5.8.2. <span class="todo NEXT">NEXT</span> 分组统计,实现多维度数据分析</a></li>
<li><a href="#orgcec42e2">3.5.8.3. <span class="todo NEXT">NEXT</span> 布局美化,让分析报表更好看</a></li>
<li><a href="#orgffbd924">3.5.8.4. <span class="todo NEXT">NEXT</span> 统计数据,多种统计方式一键切换</a></li>
<li><a href="#org0a90768">3.5.8.5. <span class="todo NEXT">NEXT</span> 排序筛选,让数据分析更有条理</a></li>
<li><a href="#org5ffa80a">3.5.8.6. <span class="todo NEXT">NEXT</span> 自动统计,通过数据透视表搭建自动化报表</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgcdecef8">3.6. <span class="todo NEXT">NEXT</span> 尝试重现书中的表格</a></li>
<li><a href="#org42ad682">3.7. <span class="todo NEXT">NEXT</span> 这本书第五章提到的 Excel 常用函数说明的表格需要在配套资料中去学习,看看自己掌握了多少.</a></li>
</ul>
</li>
<li><a href="#org16bd4c4">4. <span class="todo TODO">TODO</span> 重要知识</a></li>
</ul>
</div>
</div>
<p>
Last modified:2024-01-31 17:57:20 kamisama
</p>

<div id="outline-container-org9ceff93" class="outline-2">
<h2 id="org9ceff93"><span class="section-number-2">1.</span> <span class="todo TODO">TODO</span> Excel 教科书(吉田拳 日)</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orgd2f4b24" class="outline-3">
<h3 id="orgd2f4b24"><span class="section-number-3">1.1.</span> Excel 必须掌握的7个要点</h3>
<div class="outline-text-3" id="text-1-1">
</div>
<div id="outline-container-org6ace0c7" class="outline-4">
<h4 id="org6ace0c7"><span class="section-number-4">1.1.1.</span> 常规操作瞬间完成</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
知识量不足会导致时间和资金的浪费,比如如果不知道函数和各种Excel功能的使用,则每天/
月都会花费大量时间来统计各种数据, 使用函数或模板可以让重复的数据统计工作自动完成,而
所需只需要完成表格的设计时间,却省下了无数次重复劳动的时间.
</p>
</div>
</div>
<div id="outline-container-orged570f1" class="outline-4">
<h4 id="orged570f1"><span class="section-number-4">1.1.2.</span> 提升Excel技能的3个必需项</h4>
<div class="outline-text-4" id="text-1-1-2">
<dl class="org-dl">
<dt>67个函数</dt><dd>excel 总计400 多个函数,就单个职业来说,一般30-50个就足够了,按一般情
况来讲,掌握67个函数就足够应对了.</dd>

<dt>Excel 必需了解的9个功能</dt><dd><ul class="org-ul">
<li>条件格式</li>

<li>数据验证</li>

<li>数据筛选</li>

<li>数据排序</li>

<li>数据查找和替换</li>

<li>数据透视表</li>

<li>自动输入(快速输入和快速填充 CTRL+ENTER/D/R, 以及鼠标拖拽)</li>

<li>保护工作表</li>

<li>定位条件</li>
</ul></dd>

<dt>组合使用函数和功能</dt><dd>掌握全部的 Excel 函数和功能没有任何意义,如何将其进行组合,并
组织其结构,减少重复的劳动才是有趣且重要的.</dd>
</dl>
</div>
</div>
<div id="outline-container-org75646fe" class="outline-4">
<h4 id="org75646fe"><span class="section-number-4">1.1.3.</span> 数据只有4种类型</h4>
<div class="outline-text-4" id="text-1-1-3">
<p>
从使用 Excel 软件的角度来看,单元格内的数据大致可分为4种类型.
这是从单元格里存放的数据来看的,而不是从计算机科学角度看的,所以日期/时间与数值类
型区分开来了.
</p>
<ol class="org-ol">
<li>数值: 如0,1,2,3,4这样的数据</li>
<li>文本: 除了数值数据之外的汉字,数字以及其他符号</li>
<li>序列(日期/时间): 显示为时间或日期的数据,其本质是一种受到特殊处理的数值类型数据.</li>
<li>公式/函数:以 "=" 开头的数据</li>
</ol>
</div>
</div>
<div id="outline-container-org6378d18" class="outline-4">
<h4 id="org6378d18"><span class="section-number-4">1.1.4.</span> 有效利用快捷键</h4>
<div class="outline-text-4" id="text-1-1-4">
<p>
使用鼠标时每项操作都需要逐个点击,但是快捷键将许多功能组合到一起,或是将特定功能绑
定到特定快捷键,使用时无需多次点击鼠标,只需按下相应快捷键便可以使用特定功能了,极
大节约了时间.
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 1:</span> 常用快捷键</caption>

<colgroup>
<col  class="org-center" />

<col  class="org-center" />
</colgroup>
<tbody>
<tr>
<td class="org-center">快捷键</td>
<td class="org-center">用途</td>
</tr>

<tr>
<td class="org-center">CTRL + 1</td>
<td class="org-center">设置单元格格式</td>
</tr>

<tr>
<td class="org-center">CTRL + S</td>
<td class="org-center">保存</td>
</tr>

<tr>
<td class="org-center">CTRL + Z</td>
<td class="org-center">撤销</td>
</tr>

<tr>
<td class="org-center">CTRL + F</td>
<td class="org-center">查找</td>
</tr>

<tr>
<td class="org-center">CTRL + H</td>
<td class="org-center">替换</td>
</tr>

<tr>
<td class="org-center">CTRL + ENTER</td>
<td class="org-center">快速输入</td>
</tr>

<tr>
<td class="org-center">CTRL + D</td>
<td class="org-center">快速复制上一个单元格内容</td>
</tr>

<tr>
<td class="org-center">CTRL + R</td>
<td class="org-center">快速复制左边单元格的内容</td>
</tr>

<tr>
<td class="org-center">F4</td>
<td class="org-center">调整公式的绝对引用</td>
</tr>

<tr>
<td class="org-center">CTRL + F2</td>
<td class="org-center">打印预览</td>
</tr>

<tr>
<td class="org-center">SHIFT + F11</td>
<td class="org-center">添加工作表</td>
</tr>

<tr>
<td class="org-center">ALT + =</td>
<td class="org-center">自动求和(快速使用SUM 函数)</td>
</tr>

<tr>
<td class="org-center">ALT + ENTER</td>
<td class="org-center">单元格里输入换行符</td>
</tr>

<tr>
<td class="org-center">CTRL + SPACE</td>
<td class="org-center">选中整列</td>
</tr>

<tr>
<td class="org-center">SHIFT + SPACE</td>
<td class="org-center">选中整行</td>
</tr>

<tr>
<td class="org-center">CTRL + -</td>
<td class="org-center">删除单元格,行,列</td>
</tr>

<tr>
<td class="org-center">SHIFT + CTRL + +</td>
<td class="org-center">插入单元格,行,列</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgfd30212" class="outline-4">
<h4 id="orgfd30212"><span class="section-number-4">1.1.5.</span> 保存制作好的数据</h4>
<div class="outline-text-4" id="text-1-1-5">
<p>
电脑上编辑文档最重要的就是保存数据,因为一旦有断电或电脑故障,没有保存的数据就可能
会丢失.
</p>

<p>
<b>自动保存</b> &#x2013; 最小化损失
</p>

<p>
文档编辑软件一般都会有自动保存功能,可设置间隔多长时间自动保存编辑的文档.
</p>

<p>
Excel 里的自动保存功能位于 [文件] -&gt; [选项] -&gt; [保存] -&gt; [工作簿保存] -&gt; "保存自
动回复信息" ,保存间隔可设置为1分钟,这样每隔1分钟,Excel 软件就会自动保存编辑过的
数据,就算电脑死机了,也只会丢失这1分钟内编辑的数据,损失不大.
</p>

<p>
<b>撤销操作</b> &#x2013; 撤销错误的操作
</p>

<p>
CTRL + Z 的按键组合是撤销上一步操作的快捷键,许多文档编辑软件都有这个快捷键
</p>

<p>
<b>ESC</b> &#x2013; 退出操作
输入内容时想要暂停操作,可以按 ESC 键,就会退出输入了,因为如果按 ENTER 键就会将未
完成的内容输入到单元格,还需要按 DELETE 键删除该内容.
另外,打开了不想打开的窗口,除了用鼠标点击×图标外,还可以用 ESC 快速关闭窗口.
</p>
</div>
</div>
<div id="outline-container-orgd2fb65e" class="outline-4">
<h4 id="orgd2fb65e"><span class="section-number-4">1.1.6.</span> 解除复杂功能,操作更简便</h4>
<div class="outline-text-4" id="text-1-1-6">
<p>
Excel 有许多高级/复杂功能,在不清楚其使用方法时会造成很多困扰,比如自动修正,首字母
大写,URL 数据自动转为超级链接等等.
</p>
<ul class="org-ul">
<li>取消修正文字: Excel 会将 hsi 自动修正为 his ,因为它认为你的拼写错误了,这在有时
候很有用,有时却很烦人,所以想要取消,可以在 [文件]-&gt;[选项]-&gt;[Excel的选项]-&gt;[校
对]-&gt;[自动更正选项] 里面取消[键入时自动替换]的勾选.</li>
<li>取消超级链接: [自动更正选项] 里取消勾选 [Internet 及网络路径替换为超链接] ,之
后Excel 就不会将输入的网址和URL 数据自动改为超链接形式了.</li>
<li>取消将数字变成日期形式: 在 Excel 单元格里输入 1-1, 1/4 这样格式的数据时,会自动
变成日期形式,如果想要正确输入,就需要在数据前面加上一个单引号: <code>'1-1</code> , <code>'1/4</code>,
或是在[设置单元格格式]里将要输入的数据形式设置为[文本],然后再输入数据.</li>
<li>工作表序号全部变成了数字: 在[Excel 的选项]里的[公式]选项卡[使用公式]里设置
[R1C1引用样式]会导致工作表的序号全部变成数字,因此当发现工作表序号全部变成数字
时可以检查这个选项.</li>
<li>消除单元格的错误提示: 单元格里的数据或公式出现问题时,单元格左上角会有带颜色的
三角形图标出现,表示单元格可能有错误,这个"错误" 有时就是我们的数据需要的样式,这
时就不需要 Excel 的自动纠错,这个功能其实很有用,但如果不想看到错误提示的标志,可
以在 [公式]里选中[错误检查],然后取消勾选[允许后台错误检查].</li>
<li>取消输入时记忆输入: 在连续输入整列数据时,如果输入了和上一个单元格相同的数据,那
么单元格会将下面的内容自动替换为相同文本,如果不需要这样的功能,可以在
[Excel的选项]里点击[高级],取消勾选[为单元格值启用记忆式键入].</li>
<li>避免"粘贴选项" 频繁出现 : 复制粘贴时会自动出现[粘贴选项],如果不经常使用这个功
能或觉得麻烦,可以在[Excel 的选项]-&gt;[高级]里点击[剪切,赋值,粘贴],取消勾选
[粘贴内容时显示粘贴选项内容]</li>
<li>工作表标签无故消失: 有时会出现工作表的标签完全不显示的情况,这时要检查
[Excel的选项]-&gt; [高级] -&gt; [此工作簿的显示选项] 勾选[显示工作表标签].</li>
<li>出现异常的3个原因: 用方向键移动单元格选中,选中的单元格没动,画面却在动;用键盘输
入文字,却变成了数字;想要改写已经输入的文字,却改写了后面的文字.这三种异常分别是
由于按下了"滚动锁定","数码锁定"和"插入键"导致的,它们分别对应键盘上的
[Scroll Lock] , [Number Lock] 和 [Insert]. 只要再分别按下这些按键,就可以解除对
应的异常了.</li>
</ul>


<blockquote>
<p>
除了这些设置之外, [Excel的选项] 里还有各种设定.在出现问题时可以在里面查看相关设
置.
</p>
</blockquote>
</div>
</div>
<div id="outline-container-orge0d3637" class="outline-4">
<h4 id="orge0d3637"><span class="section-number-4">1.1.7.</span> 共享 Excel 文件时的注意点</h4>
<div class="outline-text-4" id="text-1-1-7">
<p>
制作好的 Excel 通常会以附件形式发送给同事,顾客或客户,因此,为了能让对方顺利打开
Excel 文件,我们发送文件时也许要做好准备.
</p>
<blockquote>
<p>
Excel 有多个版本, Excel 各个版本支持的数据文件也有所不同,因此存在兼容性问题,这就
会导致一台电脑上的 Excel 数据文件在另一台电脑上可能会打不开.
</p>
</blockquote>
</div>

<div id="outline-container-org3ce9afe" class="outline-5">
<h5 id="org3ce9afe"><span class="section-number-5">1.1.7.1.</span> 文件的保存形式</h5>
<div class="outline-text-5" id="text-1-1-7-1">
<p>
Excel 文件有几种保存形式.
</p>

<p>
Excel 2007 以后的版本默认以 ".xlsx" 为扩展名.因此 2007
之前的版本 Excel 2003 就无法打开 ".xlsx" 扩展名的文件. 尽管现在最新的 Excel 都到
了2019 和 365 了,但是仍然有企业在使用 Excel 2003,所以如果对方的软件为 2003 版本
的,就需要把文件转为 ".xls" ,在保存文件时将文件的保存形式设置为 "Excel 97-2003 文
件"就可以把文件保存为 ".xls" 了.
</p>

<p>
".xlsx" 扩展名的文件不能保存宏. Excel 的"宏"功能可以自动处理数据,理解为在 Excel
里的编程(应该就是集成的 VB 程序),直接保存的 ".xlsx" 文件不能保存宏,且会导致做好
的"宏"丢失,我们需要将它保存为 ".xls" 文件.
</p>

<p>
".xls" 文件不能处理超过 65536 行的数据. ".xls" 文件有大小限制,最多只能保存 65536
行的数据,因此超过该大小的数据需要用 ".xlsx" 文件,而如果又需要保存宏,则应该保存文
件为 ".xlsm" 类型(Excel 启用宏的工作表),这样就既可以处理超过 65536 行数据,也可以
保存宏了.
</p>
</div>
</div>

<div id="outline-container-orge58339d" class="outline-5">
<h5 id="orge58339d"><span class="section-number-5">1.1.7.2.</span> 保留1个新建工作簿的初期工作</h5>
<div class="outline-text-5" id="text-1-1-7-2">
<p>
Excel 2013 版本之后,新建的 Excel 文件最初的工作表为1个,在 Excel 2013 之前,新建的
Excel 文件最初的工作表为3个. 如果使用 Excel 2013 之前的版本,在编辑了数据文件到一
个表中之后,将文件发送给对方,对方会疑惑怎么文件中会有三个表,并去逐一检查,却发现剩
下两个都是空白的&#x2026;尽管看起来没什么大事,但毕竟不是很完美,这也是需要注意的细节,这
个细节可以在 [文件]-&gt;[选项]-&gt;[常规]-&gt;[新建工作簿时]里点击[包含的工作表数]里设置
为1,这样就会在新建文件时只默认一个工作表了.
</p>

<p>
另外,有人说工作时工作表的数量很容易就超过三个了,那让它在一开始就是3个不行嘛?但如
果最后少于三个,岂不是还要特意去删除?而且就我的发现,删除必须要用鼠标点击,对于想要
尽可能少的操作鼠标的人来说就很麻烦了,还不如开始只有一个,需要时使用 <code>Shift F11</code>
快捷键来新增工作表.
</p>
</div>
</div>

<div id="outline-container-org3a73417" class="outline-5">
<h5 id="org3a73417"><span class="section-number-5">1.1.7.3.</span> 确认"设置打印区域"</h5>
<div class="outline-text-5" id="text-1-1-7-3">
<p>
在发送文件之前,最好先确认一下打印区域,因为即使只有一张表,但打印区域可能会导致实
际打引出来的多于一张纸,比如,一个比较大的表格,想要完整打印在一张纸上,需要横向打印
在一张 A4 纸上,可以在 [页面布局]-&gt;[纸张方向]-&gt;[横向] 里设置然后在
[视图]-&gt; [分页预览] 里可以看到有线条表示打印时的分页,我们用鼠标拖动线条,可以将打
印页面调整为1张页面打印.
</p>

<p>
如果不确认上面的打印区域,自己只是偷了一下懒,但可能会给别人带来麻烦,也可能为自己
增加不必要的工作,所以一定要提前设置好打印的页面.
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org165dc06" class="outline-3">
<h3 id="org165dc06"><span class="section-number-3">1.2.</span> 如何在 Excel 中输入函数</h3>
<div class="outline-text-3" id="text-1-2">
</div>
<div id="outline-container-org9f5c242" class="outline-4">
<h4 id="org9f5c242"><span class="section-number-4">1.2.1.</span> 输入公式的操作步骤</h4>
<div class="outline-text-4" id="text-1-2-1">
<p>
输入公式虽然简单,但不使用正确的方法还是会有效率上的缺失的.
</p>

<ol class="org-ol">
<li>切换半角模式: 公式必须以半角模式输入,全角的字符是不会被认为是公式处理的.</li>
<li>从 "=" 开始输入: 等号开头才会被识别成公式.</li>
<li>编辑公式: 用鼠标/光标选中要处理的单元格,或是直接键入要计算的单元格的引用,来输
入公式.</li>
<li>按回车键: 按下回车才能确认公式的输入,以及单元格的公式会计算出结果作为返回值显
示在单元格的数据里.</li>
</ol>


<p>
例如,A1 单元格中的数据为数值类型的1, 然后在某个单元格中输入 <code>=A1+1</code> 按回车后,该
单元格中会自动显示公式的计算结果 2. 这个操作里 <code>=A1+1</code> 就是公式, 显示的 2 就是返
回值.
</p>
</div>
<div id="outline-container-orga99bba6" class="outline-5">
<h5 id="orga99bba6"><span class="section-number-5">1.2.1.1.</span> 巧用函数,简化输入过程</h5>
<div class="outline-text-5" id="text-1-2-1-1">
<p>
提到公式,就不得不提函数,函数是可以在公式里使用的特殊功能,它就像是在 Excel 里专门
处理数据的编程语言,只不过没有编程语言的语法等概念,它就只有一种用法,就是调用函数,
比如 SUM(arg1, agr2, &#x2026;) 函数就用来将参数里的所有数据求和,等价于
<code>arg1+arg2+...</code> 如果只有两个或三个数据需要求和,可以手动相加,但数量一旦多起来了,
必定要使用函数,不然求一千条数据之和总不能一个个写吧.
</p>

<p>
类似的处理数值或加工文本的函数还有很多,比如乘法 PRODUCT(A1:A5) 计算
A1,A2,A3,A4,A5 这5个单元格里的数据的乘积, SUM(A1:A5) 则是计算 A1 到 A5 的和.
</p>

<p>
由于EXCEL 中函数非常之多,所以没有必要全部记住,找出自己需要掌握的函数,并且熟练运
用才是最要紧的.
</p>

<blockquote>
<p>
另外,在我自己练习以及上网搜索的过程中,发现很多函数都有功能上的重叠,比如 SUMIF 和
SUMIFS 都是对符合条件的区域求和,前者只限制为一个条件,后者可以有多个条件,那么
SUMIFS 的功能完全可以替代 SUMIF ,这样掌握了 SUMIFS 就没有必要掌握 SUMIF 了.
</p>

<p>
遇到不会或忘记了用法的函数,可以使用 EXCEL 自带的帮助来查看函数的说明文档.只要在
单元格公式里输入函数名,就会弹出一个显示函数可选参数的窗口,点击该窗口就可以看到相
应函数的说明文档了.
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org4e7d5c5" class="outline-5">
<h5 id="org4e7d5c5"><span class="section-number-5">1.2.1.2.</span> 输入函数的5个步骤</h5>
<div class="outline-text-5" id="text-1-2-1-2">
<ol class="org-ol">
<li>半角等号: 函数只在公式里起作用,因此第一步就是要输入半角的等号,表示这是一个公
式类型的数据.</li>
<li>输入正确函数名: 在输入函数过程中会出现候选函数名单,可以用鼠标点击或键盘键入完
整的函数名或是使用 <code>TAB</code> 键选中函数,除了键入之外的两种方法都会自动键入一个左
括号,自己键入则需要自己输入左括号.</li>
<li>输入参数: 输入参数时一般会有提示,按照提示输入正确完整的参数.</li>
<li>输入右括号.</li>
<li>确认格式完整, 函数的结构即函数的格式,函数格式必须完整正确:
<code>=funcName(arg1,arg2,...)</code></li>
</ol>
</div>
</div>
<div id="outline-container-org44c6627" class="outline-5">
<h5 id="org44c6627"><span class="section-number-5">1.2.1.3.</span> 如何快速选择单元格范围</h5>
<div class="outline-text-5" id="text-1-2-1-3">
<ul class="org-ul">
<li>选择单个单元格: 使用光标点击目标单元格或使用键盘的方向键选择单元格.</li>
<li>选择多个单元格的范围:
<ul class="org-ul">
<li>点击起始单元格,用鼠标拖拽到终止单元格,就可以选中整个矩形区域范围.</li>
<li>选中起始单元格,按下 <code>Shift</code> 键和方向键,可以扩大单元格的选择范围.</li>
</ul></li>
<li>选择数据连续的单元格范围: 在选择多个单元格范围的操作基础上,加上 <code>Ctrl</code> 键就能
快速选中连续的有数据的单元格范围.</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgd45416e" class="outline-4">
<h4 id="orgd45416e"><span class="section-number-4">1.2.2.</span> 熟练使用"引用",快速计算</h4>
<div class="outline-text-4" id="text-1-2-2">
</div>
<div id="outline-container-orgad449f4" class="outline-5">
<h5 id="orgad449f4"><span class="section-number-5">1.2.2.1.</span> 活用单元格中的原始数据</h5>
<div class="outline-text-5" id="text-1-2-2-1">
<p>
Excel 的引用功能可以让我们不需要输入完整数据就可以使用单元格中的数据.
</p>

<p>
Excel 将表格按行和列进行索引,行数用数字表示,列数用大写字母表示,格式为列数在前,行
数在后,例如 A1, 表示第一列的第一行.
</p>

<p>
这种索引就叫做 "引用单元格", 可以理解为 "使用此单元格的数值", 选中公式所在的单元
格,按下 <code>F2</code> ,公式里引用的所有单元格都会被有色线框圈起.
</p>

<blockquote>
<p>
从属和引用单元格区分: Excel 公式里有个功能可以将公式里引用的单元格以箭头标识:
[追踪引用单元格] 以及 [追踪从属单元格],来表示从属关系,所谓引用和从属关系简单理解
就是谁使用了谁, 在 A1 单元格的公式里使用了 B1 这个单元格引用,那么就说 A1 的引用
单元格里有 B1(A1 引用了 B1), 而 B1 是被引用的对象,所以说 B1 是 A1 的从属单元格,
我的理解就是被引用的是发起引用的单元格的从属,追踪从属就是看该单元格被哪些其他单
元格引用了,那么反之,追踪引用就是看这个单元格里的公式引用了哪些单元格.
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org3810e3d" class="outline-5">
<h5 id="org3810e3d"><span class="section-number-5">1.2.2.2.</span> 必须掌握的运算符</h5>
<div class="outline-text-5" id="text-1-2-2-2">
<ul class="org-ul">
<li>四则运算符: "+", "-", "*", "/" 分别代表四则运算加减乘除,在公式中使用它们进行算术
运算.</li>
<li>文本连接符: "&amp;" 可以连接文本.</li>
<li>比较运算符: "&gt;" 大于, "&lt;"小于 , "&gt;=" 大于等于, "&lt;=" 小于等于, "=" 等于, "&lt;&gt;"
不等于.</li>
<li>引用运算符: <code>:</code> 冒号作为区域运算符,生成一个对冒号两边的两个单元格之间的所有单
元格的引用, <code>,</code> 逗号作为联合运算符,将逗号两边的引用合并为一个引用, " " 空格作
为交集运算符,返回空格两边引用区域所共有的单元格的引用.</li>
</ul>

<blockquote>
<p>
包含数字数据的文本值,如 "1","2" 这样的值,也可以用四则运算符进行四则运算,四则运算
符会自动把它们都转为数值类型然后进行计算,但不要用 "a" 这样的文本值参与四则运算,
这回导致返回一个错误值.
</p>

<p>
文本连接符也可以连接数值类型数据,并且会自动将连接的数据转为文本类型后进行连接,如
公式值 <code>="text" &amp; 123</code> 的结果是文本值 <code>text123</code> .
</p>

<p>
比较运算符可以比较文本,数值,规则是 文本值&gt;数值,即任意的文本值都大于任意的数值.
</p>

<p>
引用运算符是使用函数时需要理解的运算符, <code>A1:C1</code> 就是生成一个表示 A1 到 C1 这个区
域所有单元格的引用,它等价于 <code>A1,B1,C1</code>, 需要注意的是联合运算符逗号与函数里分隔参
数的逗号,只有当逗号两边都是单元格引用时才可以视为该逗号是联合运算符,不然它就是参
数分隔符.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org66c71ff" class="outline-5">
<h5 id="org66c71ff"><span class="section-number-5">1.2.2.3.</span> 复制带公式单元格时的陷阱</h5>
<div class="outline-text-5" id="text-1-2-2-3">
<p>
复制单元格就是之前提到的快捷键操作(Ctrl-D 或 Ctrl-R), 在使用它们复制带公式的单元
格时,会出现莫名的错误,因为复制单元格的操作会保持单元格中公式的相对位置,比如:
<code>=B1/B11</code> 这个除法公式,在使用 <code>Ctrl-D</code> 复制到下一个单元格时就会把单元格中的引用
整体向下移动一格,即: <code>=B2/B12</code>, 这种会变动的单元格引用叫做"相对引用".想要引用在
复制过程中保持不变就要看下面的 "绝对引用" 部分.
</p>

<blockquote>
<p>
相对引用的单元格引用适合需要变化的计算,如果需要不变的,例如,求数据在总数中的占比,
总数是需要保持不变的,那就需要绝对引用了.
</p>
</blockquote>
</div>
</div>
<div id="outline-container-orge79bc09" class="outline-5">
<h5 id="orge79bc09"><span class="section-number-5">1.2.2.4.</span> 利用 "F4" 和 "$" 高效运用 "绝对引用"</h5>
<div class="outline-text-5" id="text-1-2-2-4">
<p>
绝对引用就是让单元格引用在操作过程中保持不变,而这个"绝对"可以分为"部分"绝对和"全
部"绝对,因为引用是由行和列构成的,所以只让行或列保持不变的是"部分"绝对,而行列全部
不变的就是"全部"绝对.而不变的标识就是 <code>$</code> 美元符号,该符号放在行/列数前面就表示该
引用的行/列固定不变,例如:
</p>
<pre class="example" id="org96eb635">
$A$1 固定行和列
A$1 固定行
$A1 固定列
A1 行列都不固定,是相对引用
</pre>

<p>
一个切换单元格引用"相对"/"绝对"状态的快捷键就是 <code>F4</code> ,在光标线位于一个引用中时,
多次按下 <code>F4</code> 就可以在上面例子的四种形式引用中循环切换.
</p>
</div>
</div>
<div id="outline-container-orgdcc5414" class="outline-5">
<h5 id="orgdcc5414"><span class="section-number-5">1.2.2.5.</span> 无需记住错误值的种类和意义</h5>
<div class="outline-text-5" id="text-1-2-2-5">
<p>
在输入公式时经常会看到 "#DIV/0!", "#NAME?" , "#N/A" 这一类以 <code>#</code> 开头的值,它们就
是"错误值",是因为输入的公式有误,比如公式里的除数为0就会产生 "#DIV/0!" 的错误值.
</p>

<p>
错误值种类有很多,但不需要特意记住它们的含义,只要能判断下面三个就够了:
</p>
<ul class="org-ul">
<li><code>#N/A</code> : (VLOOKUP函数)的检索值不存在</li>
<li><code>#DIV/0!</code> : 被除数为0</li>
<li><code>#REF!</code> : 引用单元格已经被删除</li>
</ul>


<blockquote>
<p>
关于错误值处理的问题,重要是掌握不显示错误值的方法.参阅 <a href="#org4c8ed17">1.4.8</a>.
</p>
</blockquote>
</div>
</div>
</div>
</div>
<div id="outline-container-orge75daa2" class="outline-3">
<h3 id="orge75daa2"><span class="section-number-3">1.3.</span> 需要事先掌握的6个函数</h3>
<div class="outline-text-3" id="text-1-3">
</div>
<div id="outline-container-org2678b7e" class="outline-4">
<h4 id="org2678b7e"><span class="section-number-4">1.3.1.</span> 根据条件改变答案&#x2013;IF 函数</h4>
<div class="outline-text-4" id="text-1-3-1">
</div>
<div id="outline-container-org6e5bf62" class="outline-5">
<h5 id="org6e5bf62"><span class="section-number-5">1.3.1.1.</span> IF 函数的基础知识</h5>
<div class="outline-text-5" id="text-1-3-1-1">
<p>
IF 函数的格式:
</p>

<p>
<code>=IF(条件表达式,条件为真时执行的语句,条件为假时执行的语句)</code>
</p>

<p>
这个函数的理解为: 如果 "条件表达式" 的结果为真,则执行 "条件为真时执行的语句", 否
则执行 "条件为假时执行的语句".
</p>

<p>
例如:公式 <code>=IF(B2&gt;80,"A","B")</code> ,如果 B2 大于80,则公式的返回值为文本值 <code>A</code>, 否则
是文本值 <code>B</code>.
</p>
</div>
</div>
<div id="outline-container-org92b8c9e" class="outline-5">
<h5 id="org92b8c9e"><span class="section-number-5">1.3.1.2.</span> 如何判断复数条件</h5>
<div class="outline-text-5" id="text-1-3-1-2">
<p>
在判定复数条件时,可以让多个 IF 函数嵌套在一个公式里.比如,"B2 单元格的值大于等于
80为A, 大于等于50 为B, 49以下为 C", 就可以表达为下列公式:
</p>
<pre class="example" id="org93306bd">
=IF(B2&gt;=80,"A",IF(B2&gt;=50,"B","C"))
</pre>
<p>
这个公式初学者看起来可能很复杂,但其实它只是在重复 IF 函数的执行逻辑:
如果条件表达式 (B2&gt;=80) 为真,则返回第二个参数 (<code>A</code>), 否则,执行第三个参数的语句
(IF(B2&gt;=50,&#x2026;)).
</p>

<p>
这种 IF 函数里嵌套IF 的做法,叫做"多重条件函数", 在 Excel 2007 以后的版本里,最多
可以有 64 个 IF 函数嵌套在一起. 但是,嵌套的太多,会让自己都难以理解自己编写的公式.
</p>
</div>
</div>
</div>

<div id="outline-container-orgcb75d9b" class="outline-4">
<h4 id="orgcb75d9b"><span class="section-number-4">1.3.2.</span> 本月销售额&#x2013;SUM 函数</h4>
<div class="outline-text-4" id="text-1-3-2">
</div>
<div id="outline-container-orgcd0b024" class="outline-5">
<h5 id="orgcd0b024"><span class="section-number-5">1.3.2.1.</span> SUM 函数的基础</h5>
<div class="outline-text-5" id="text-1-3-2-1">
<p>
SUM 函数的格式:
</p>

<p>
<code>=SUM(Number1,Number2,...)</code>
</p>

<p>
它对函数内所有参数进行求和,它本质上就是进行加法运算,但是又和四则运算符 "<del>" 有所
不同, "</del>" 会尝试将其连接的所有类型数据转换为数值类型然后相加,例如,"1",A1 这种,其
中,单元格引用的数据如果也是可以转换为数值的文本值,那 "+" 也会进行转换, 但是 SUM
函数在这点有所不同,如果参数是 "1" 这种,SUM 会将其转换为数值,并参与求和计算,而如
果参数是一个引用,例如 A1 而A1 里存放的是文本值,它就直接将其视为0,而不管A1 里的文
本值是不是能转换为数值.
</p>

<p>
假设 A1 存放的数据为 <code>'23</code> 即一个文本类型的 <code>23</code> ,那么 <code>=SUM(A1,1)</code> 的返回值为1,
而 <code>=A1+1</code> 的返回值会是 24.
</p>

<blockquote>
<p>
另外,LibreOffice 里的 SUM 函数并不是和 Excel 的 SUM 一样, LibreOffice 的 SUM 不
能将 <code>"1"</code> 这种文本类型的字面值作为参数.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org53ab4f1" class="outline-5">
<h5 id="org53ab4f1"><span class="section-number-5">1.3.2.2.</span> 计算连续单元格范围内的总和&#x2013;ΣSUM</h5>
<div class="outline-text-5" id="text-1-3-2-2">
<p>
ΣSUM 函数是 SUM 函数的一种,它能自动输入 SUM 函数和计算范围.可以在[开始]选项卡的
[编辑]部分里找到 Σ点击就可以使用 ΣSUM 了; 也可以使用快捷键 <code>Alt-=</code>. 该函数会自动
将选中单元格之上的所有连续单元格作为 SUM 函数的参数来进行求和并返回求和结果.
</p>
</div>
</div>

<div id="outline-container-org878ef4f" class="outline-5">
<h5 id="org878ef4f"><span class="section-number-5">1.3.2.3.</span> 如何求多个分开的单元格的总和</h5>
<div class="outline-text-5" id="text-1-3-2-3">
<p>
按住 Ctrl 键的同时使用鼠标点击单元格就可以逐个选中分开的单元格,那么在输入 SUM 函
数时也可以用这种 Ctrl 加上鼠标点选的方式对分开的单元格求和,每点选一个单元格,SUM
函数就会自动生成一个该单元格引用的参数,选择完毕后,输入右括号,回车确认就可以了.
</p>

<p>
另外,也可以直接用键盘键入单元格的引用.
</p>
</div>
</div>

<div id="outline-container-orgc4774d8" class="outline-5">
<h5 id="orgc4774d8"><span class="section-number-5">1.3.2.4.</span> 提高乘法运算,字符串混合输入的效率</h5>
<div class="outline-text-5" id="text-1-3-2-4">
<p>
四则运算符号的乘法符号 <code>*</code> 一次只能连接两个引用,想要多个引用相乘需要使用多个 <code>*</code>
号,但是和 <code>+</code> 有对应的 SUM 函数一样, <code>*</code> 也有对应的函数,就是 PRODUCT 函数:
</p>

<p>
<code>=PRODUCT(A1:E1)</code> 会计算 A1 到 E1 这个区域的所有单元格的乘积. 等价于:
<code>=A1*B1*C1*D1*E1</code>
</p>

<p>
除此之外,字符串连接符 "&amp;" 也有对应的函数: CONCATENATE 函数.
</p>

<p>
<code>=CONCATENATE(A1:E1)</code> 等价于 <code>=A1&amp;B1&amp;C1&amp;D1&amp;E1</code>
</p>

<p>
另外呢,由于除法不大可能会需要大量连续数据进行除法,所以 Excel 没有专用的除法函数,
使用除法运算符就够了,而且也可以使用 PRODUCT(A1,1/B1) 这种形式来表示 A1/B1 的除法.
同样也没有减法函数,但可以用 SUM(A1,-A2) 来表示 A1-A2 的减法.
</p>
</div>
</div>
</div>
<div id="outline-container-orgabcea78" class="outline-4">
<h4 id="orgabcea78"><span class="section-number-4">1.3.3.</span> 计算客户名单的人数&#x2013;COUNTA 函数</h4>
<div class="outline-text-4" id="text-1-3-3">
<p>
COUNTA 函数用来统计非空单元格的个数:
</p>

<p>
<code>=COUNTA(arg1,arg2,...)</code>
</p>

<p>
它会统计参数里非空单元格的个数,即只要单元格内有数据,就会计入统计结果.
</p>
</div>
<div id="outline-container-org4181be2" class="outline-5">
<h5 id="org4181be2"><span class="section-number-5">1.3.3.1.</span> 与 COUNT 函数的区别</h5>
<div class="outline-text-5" id="text-1-3-3-1">
<p>
一个与 COUNTA 非常相似的函数就是 COUNT 函数, COUNT 只会统计单元格为数值的个数.
即, COUNTA 的参数里只要有数据,不管是文本值,错误值,数值,只要有值就纳入统计范围,
而 COUNT 只统计数据为数值的单元格个数.
</p>
</div>
</div>
</div>

<div id="outline-container-orgce99daf" class="outline-4">
<h4 id="orgce99daf"><span class="section-number-4">1.3.4.</span> 按照负责人分别计算销售情况&#x2013;SUMIF 函数</h4>
<div class="outline-text-4" id="text-1-3-4">
</div>
<div id="outline-container-orgc7939b0" class="outline-5">
<h5 id="orgc7939b0"><span class="section-number-5">1.3.4.1.</span> SUMIF 函数的基础</h5>
<div class="outline-text-5" id="text-1-3-4-1">
<p>
<code>=SUMIF(判断区域, 判断条件[,求和区域])</code>
</p>

<p>
SUMIF 有三个参数,其中第三个是可选的,如果第三个省略,那么第一个参数就默认作为第三
个参数.
</p>

<p>
翻译过来就是, SUMIF 对 [判断区域] 里的所有单元格应用 [判断条件] 如果满足条件,则
将 [求和区域] 中对应的单元格纳入求和范围,不满足则不纳入求和范围,而如果[求和区域]
这个参数省略了,那么 [判断区域] 就自动作为求和区域,即如果[判断区域] 的某个单元格
满足了条件,就将该单元格纳入求和范围.
</p>
</div>
</div>

<div id="outline-container-org750c186" class="outline-5">
<h5 id="org750c186"><span class="section-number-5">1.3.4.2.</span> 计算每个人的销售情况</h5>
<div class="outline-text-5" id="text-1-3-4-2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">A</td>
<td class="org-right">B</td>
<td class="org-left">C</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">负责人</td>
<td class="org-right">销售额</td>
<td class="org-left">商品代码</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">吉田</td>
<td class="org-right">9800</td>
<td class="org-left">A002</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">三缸</td>
<td class="org-right">8400</td>
<td class="org-left">A002</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-left">佐藤</td>
<td class="org-right">120</td>
<td class="org-left">A003</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left">吉田</td>
<td class="org-right">2700</td>
<td class="org-left">C001</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-right">6</td>
<td class="org-left">安达</td>
<td class="org-right">3600</td>
<td class="org-left">C002</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-right">&#x2026;</td>
<td class="org-left">&#x2026;</td>
<td class="org-right">&#x2026;</td>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#x2026;</td>
</tr>
</tbody>
</table>


<p>
现在我们要在下面的表格中统计每个人的销售情况:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">G</td>
<td class="org-left">H</td>
<td class="org-left">I</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">负责人</td>
<td class="org-left">销售额</td>
<td class="org-left">占比</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">吉田</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">三缸</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-left">佐藤</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left">安达</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">6</td>
<td class="org-left">合计</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
在H2 单元格,我们可以使用公式 <code>=SUMIF(A:A, G2, B:B)</code> ,使用快速复制(Ctrl-D)就可以
将剩下的公式全都填充完毕,填充完毕后将得出的数字进行比较,才更有意义,因此我们可以
用之前说的 "绝对引用" 来求销售额占比,在 I2 单元格使用公式 <code>=H2/$H$6</code> 然后快速复
制,就可以得出所有负责人的销售额占比了.
</p>
</div>
</div>
</div>

<div id="outline-container-org00b2081" class="outline-4">
<h4 id="org00b2081"><span class="section-number-4">1.3.5.</span> 参加名单中,有多少人出席&#x2013;COUNTIF 函数</h4>
<div class="outline-text-4" id="text-1-3-5">
</div>
<div id="outline-container-orgcbac5d6" class="outline-5">
<h5 id="orgcbac5d6"><span class="section-number-5">1.3.5.1.</span> COUNTIF 函数的基础</h5>
<div class="outline-text-5" id="text-1-3-5-1">
<p>
<code>=COUNTIF(统计范围, 判断条件)</code> :
在统计范围中的单元格符合判断条件的就纳入统计范围,否则不计数.
</p>

<p>
例如:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">A</td>
<td class="org-left">B</td>
<td class="org-left">C</td>
<td class="org-left">D</td>
<td class="org-left">E</td>
</tr>

<tr>
<td class="org-left">参加者</td>
<td class="org-left">是否参加</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">△</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">吉田</td>
<td class="org-left">△</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">○</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">山岗</td>
<td class="org-left">○</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">╳</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">佐藤</td>
<td class="org-left">╳</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">松田</td>
<td class="org-left">△</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
<p>
在 E1 单元格输入公式 <code>=COUNTIF(B:B, D1)</code> 就是统计 B 列中单元格数据与 D1 相同的单
元格个数. B 列中有两个三角形,所以公式的返回值为 2,用鼠标拖拽或 Ctrl+D 可将剩下的
E2,E3 里自动输入公式,它们的结果都会是 1,因为圆形和叉都只出现了一次.
</p>
</div>
</div>
<div id="outline-container-orgf165ed4" class="outline-5">
<h5 id="orgf165ed4"><span class="section-number-5">1.3.5.2.</span> 计算每名销售人员的销售数量</h5>
<div class="outline-text-5" id="text-1-3-5-2">
<p>
在一个表格中,一条记录表示一个商品由谁卖出:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">A</td>
<td class="org-left">B</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-left">操作人员</td>
<td class="org-left">商品代码</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-left">张三</td>
<td class="org-left">A0001</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#x2026;</td>
</tr>
</tbody>
</table>

<p>
那么和上面判断出席人数一样,我们可以统计出每个人售出了多少件商品.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">E</td>
<td class="org-left">F</td>
</tr>

<tr>
<td class="org-left">人员</td>
<td class="org-left">售出商品总数</td>
</tr>

<tr>
<td class="org-left">张三</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">李四</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
在单元格 F2 中填入 <code>=COUNTIF(A:A, E2)</code> 就可以统计出所有由张三卖出的商品记录条数.同
理 <code>=COUNTIF(A:A, E3)</code> 可以统计出所有由李四卖出的商品记录条数.
</p>

<blockquote>
<p>
通过 COUNTIF 函数,我们还可以检查数据是否重复,确认指定数据是否存在,检查单元格中是
否包含指定文本等. 通常的使用思路就是只要统计出的结果大于1,就是出现重复/数据存在
等等.
</p>

<p>
想要验证某条数据是否重复而不仅仅检查单个单元格的数据是否重复,还可以使用 COUNTIFS
函数, 它可以看作是多个 COUNTIF 的组合,只有所有的条件满足了才会进行统计, COUNTIFS
的参数是成对出现的,第一个参数是判断范围,第二个是判断条件,第三个是判断范围,第四个
是判断条件&#x2026;
</p>

<p>
举个例子,判断 A1 到 C3 这三行记录里是否有一条记录与第二条记录(A2:C2)相同:
<code>=COUNTIFS(A1:A3,A2,B1:B3,B2,C1:C3,C2)</code>
</p>
</blockquote>
</div>
</div>
</div>
<div id="outline-container-org76b947e" class="outline-4">
<h4 id="org76b947e"><span class="section-number-4">1.3.6.</span> 输入商品名,自动显示价格&#x2013;VLOOKUP 函数</h4>
<div class="outline-text-4" id="text-1-3-6">
</div>
<div id="outline-container-orged4a578" class="outline-5">
<h5 id="orged4a578"><span class="section-number-5">1.3.6.1.</span> VLOOKUP 函数的基础</h5>
<div class="outline-text-5" id="text-1-3-6-1">
<p>
<code>=VLOOKUP(要查找的值, 函数作用区域, 需要的值在函数作用区域中的列数,[查找方式])</code>
</p>

<p>
<code>=VLOOKUP(lookup_value, table_array, col_index_num,[range_lookup])</code>
</p>

<p>
VLOOKUP 是按列查找(V 表示 vertical) 还有与之对应的 HLOOKUP 表示按行查找,以及按行
或列查找的 LOOKUP(不推荐使用了,因为有了改进的版本 VLOOKUP 和 HLOOKUP).
第一个参数是需要查找的值, 第二个参数是函数查找值和返回值的区域,该区域的第一列必
须是要查找的值的所在列,该区域也必须包含返回值所在的列,第三个参数是返回值所在的列
位于第二个参数区域里的列数,列数从1开始,第四个参数是查找方式,是一个可选的逻辑值,
可为 TRUE 或 FALSE, TRUE 是省略是的默认值,它假定表的第一列(要查找的值的所在列)是
按数字或字母从小到大排序好的,然后直接搜索最近的值(近似查找,如果没找到匹配的值,就
搜索与它最相近的值,所以才要求第一列排序好,这个最近不是说数值差值最小,而是按照从
小到大排序,应该在查找值之上的值), FALSE 则表示在第一列中精确查找. 
</p>

<blockquote>
<p>
对近似查找的运行逻辑猜想: 近似查找需要(假设)查找列已经按从小到大排序好了,这可能
因为它就是按照大小来查找的,这样就不用每次都查找整个列的数据了,在查找到比查找值大
的数据时还没有找到完全匹配的,就表示下面所有都不可能有完全匹配的了,它就会返回一个
查找列中比查找值小的最近的值. 例如近似查找 10, 数据里只有 1,3,11, 返回的是3 而不
是11,如果是按差值最小的"最近",那应该返回11,但实际返回的是3.所以上面的猜想有一定
的道理.
</p>
</blockquote>

<blockquote>
<p>
精确查找和近似查找的区别:
</p>

<p>
精确查找必须是单元格里的数据完全匹配时才认为是找到了结果,近似查找在找不到和查找
值一样的数据时,会转而查找与查找值最近的值.
</p>

<p>
近似查找在对由中文开头的值进行查找时是没有找不到时查找最相近的值的效果的,它只对
数字和字母开头的数据有效,想要查找中文内容,推荐使用精确查找和通配符(正则)相结合.
</p>

<p>
例如:单元格 A2 中的数据是 <code>张三丰</code> 使用近似查找来查找值 "张三"
(<code>=VLOOKUP("张三", A1:A10,1,TRUE)</code>),就不会找到A2 单元格,只会返回 <code>#N/A</code> 的错误值
(参见 <a href="#orgdcc5414">1.2.2.5</a>), 近似查找查找全中文内容,就需要输入完整的值,这
里的话就是 <code>=VLOOKUP("张三丰", A1:A10,1,TRUE)</code> (近似查找里是无法识别通配符的),使
用精确查找就可以使用通配符来实现模糊查找: <code>=VLOOKUP("张*",A1:A10,1,FALSE)</code> 则会
查找第一个数据以 "张" 开头的单元格,张三丰就在查找范围内.
</p>

<p>
只有中文在两种查找之间会有难懂的地方,对数字和英文就很好理解了,精确查找仍然是一样
要完全匹配或是与通配符一起实现模糊查找,近似查找就是想找数字 10 ,但查找列里没有,
只有3,7,11, 那公式就会返回7. 在 "A你", "B我", "C他" 中近似查找 "C", 结果会返回
"B我" 
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org123cf07" class="outline-5">
<h5 id="org123cf07"><span class="section-number-5">1.3.6.2.</span> 用 "整列指定"</h5>
<div class="outline-text-5" id="text-1-3-6-2">
<p>
前面我们都用两个单元格引用加上区域运算符表示单元格区域,这样用很精确,如
<code>$F$1:$G$10</code> 但如果后续要在单元格区域的基础上新增数据,那么我们函数里对应的单元格
区域也需要修改,这样会很麻烦.
</p>

<p>
所以我们有一种指定整行或整列范围的单元格应用形式: <code>行号:行号</code> 或 <code>列号:列号</code> 这
样就可以指定整行或整列的范围,后续在该行/列里增加了数据也不需要去修改公式了.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgce80568" class="outline-3">
<h3 id="orgce80568"><span class="section-number-3">1.4.</span> 通过应用与组合,提升函数威力</h3>
<div class="outline-text-3" id="text-1-4">
<p>
即使掌握了所有的 Excel 函数,对实际生产力也没有多大帮助,重要的是要知道"如何组合使
用单个或多个函数".
</p>

<p>
比起掌握某种特定用法的技巧,学会如何 "构思" 才是更重要的.
</p>

<p>
我认为学习函数的路径就是掌握一般常用的函数用法,然后在具体需求实例中学习特定的使
用技巧,最后再根据这些使用技巧自己总结出如何利用函数特性来组合函数.
</p>

<blockquote>
<p>
到这里已经学了基础的函数用法了,这章开始作者就开始讲解实际的应用场景,根据这些案例
我们可以学到如何组合函数是最好的,学不到的话,记住特定的组合用法也能有很大帮助.
</p>
</blockquote>
</div>
<div id="outline-container-org7ee0b42" class="outline-4">
<h4 id="org7ee0b42"><span class="section-number-4">1.4.1.</span> 判断单元格中是否包含特定的字符串</h4>
<div class="outline-text-4" id="text-1-4-1">
</div>
<div id="outline-container-orgedf631b" class="outline-5">
<h5 id="orgedf631b"><span class="section-number-5">1.4.1.1.</span> 就算特定地址区域的客户人数</h5>
<div class="outline-text-5" id="text-1-4-1-1">
<p>
"想要从客户数据中筛选出太阳系地球村的客户人数"
</p>

<p>
想要实现上面的需求,有两个步骤就行,第一个是判断地址是否含有 "太阳系地球村" 这几个
字,第二个就是将包含"太阳系地球村"的单元格计数.
</p>

<p>
根据上面的思路,我们会发现与前面学的 COUNTIF 函数的逻辑非常相似,判断条件只有一个,
满足判断条件的就计数,反之就不计数,因此我们可以直接用该函数: 假设地址数据都在 C
列 <code>=COUNTIF(C:C,"*太阳系地球村*")</code> 这样就可以统计出地址里含有 "太阳系地球村" 的
单元格个数了.
</p>

<p>
也有不理解 COUNTIF 逻辑,只记得前面用 COUNTIF 判断过是否符合某个条件的例子的,他们
可能会想先用 COUNTIF 函数确定是否含有"太阳系地球村",含有的结果为1,不含的就结果为
0,那么就新建一列数据来存放对每个地址的单元格进行判断的结果,最后用 SUM 函数相加也
可以得出一样的结果.
</p>

<blockquote>
<p>
实际上书里这部分只讲了用 COUNTIF 和 SUM 的例子,没有只使用 COUNTIF 的例子,我是因
为在其他书里学习过 COUNTIF 函数,也在 Excel 的帮助里查看过它的文档,所以才知道
COUNTIF 的使用逻辑和用法,才会只用 COUNTIF 的用法的.如果其他函数也都能像 COUNTIF
这样运用,那我应该能说自己熟练使用 Excel 了吧.
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org7ca057e" class="outline-5">
<h5 id="org7ca057e"><span class="section-number-5">1.4.1.2.</span> 如何搜索更多的特定区域</h5>
<div class="outline-text-5" id="text-1-4-1-2">
<p>
上面查找了 "太阳系地球村" 的客户人数,那如果需要查找 "火星村", "月亮村" 之类的地
址怎么办呢?
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#x2026;</td>
<td class="org-left">地址</td>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">太阳系火星村</td>
<td class="org-left">太阳系地球村</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#x2026;</td>
</tr>
</tbody>
</table>

<p>
这里就需要一定的辅助了,因为我们不知道到底有多少的"村"要去统计,所以不可能像之前一
样直接把 "某某村" 写死在公式里,那我们就可以借助单元格引用来替代要查找的值,这样,
一个公式就可以对多个查询使用了. 
</p>

<p>
前面讲过文本连接符 "&amp;" ,它可以将文本进行连接,这里我们就可以利用它将通配符和单元
格引用连接起来: <code>"*" &amp; E1 &amp; "*"</code> 就把单元格 E1 的值与两个通配符 "<b>" 连接起来了,
假设 E1 就是 "太阳系火星村" ,那么 ="</b>" &amp; E1 &amp; "<b>"= 在公式里就等价于
="*太阳系火星村</b>"<code>,同样的把 E1 换成 F1 就等价与 ="*太阳系地球村*"</code> 了.
</p>

<blockquote>
<p>
利用单元格引用而不把数据写死的一个好处就是,可以利用鼠标拖拽或 Ctrl+D 或 Ctrl+R
的快捷键来快速复制公式,且公式里的单元格引用会根据位置自动变化.
</p>
</blockquote>

<p>
比如上面的表格,接着刚才的假设,E1 是 "太阳系火星村",地址一列是 B 列 将
<code>=COUNTIF(B:B,"*"&amp; E1 &amp;"*")</code> 填入 E2, 然后选中E2 以及右边所有需要统计的单元格,按
Ctrl+R 就可以快速将所有的公式输入到单元格里了.
</p>

<blockquote>
<p>
另外,用 IF 函数无法处理上面的操作,因为只使用 IF 函数的条件判断只能用比较运算符,
而比较运算符里并不能使用通配符,而且使用 IF 函数只能一次判断一个数据,所以不能一步
到位,只能先判断,后求和统计;而如果要用通配符,则需要用 SEARCH 函数(FIND 函数不支持
通配符)
</p>
</blockquote>
</div>
</div>
</div>

<div id="outline-container-orgcdf7389" class="outline-4">
<h4 id="orgcdf7389"><span class="section-number-4">1.4.2.</span> 消除重复数据的方法</h4>
<div class="outline-text-4" id="text-1-4-2">
</div>
<div id="outline-container-orgf729496" class="outline-5">
<h5 id="orgf729496"><span class="section-number-5">1.4.2.1.</span> 如何判断是否有重复</h5>
<div class="outline-text-5" id="text-1-4-2-1">
<p>
前面的笔记里就提到过,使用 COUNTIF 可以判断是否有重复数据,统计结果大于1,就说明有
重复.
</p>

<p>
假设 A 列为每条数据的 ID 列,且ID 值可以唯一确定一条记录,那么,对 A 列中每个值进行
统计判断,就可以知道每个值是否有重复了.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">A</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-left">ID</td>
<td class="org-left">ID 是否重复</td>
</tr>

<tr>
<td class="org-left">A-194</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">A160</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
在上面表格的 B2 单元格中,可以填入: <code>=COUNTIF(A:A,A2)</code> 来查看 A 列中与 A2 的值相
同的单元格有几个,若没有重复的,那结果就返回1,反之就会大于1,表示有重复数据.
</p>

<blockquote>
<p>
这里有一个小技巧,就是如果要输入的单元格很多,需要翻页才能选中,那我们之前讲的用键
盘选中连续单元格的技巧就不能使用了,因为它需要非空白的连续单元格,而用鼠标加 Shift
键选中也需要翻页,所以我们可以将鼠标光标放置到 B2 单元格的右下角,会发现鼠标光标变
成了十字形,此时双击鼠标左键,就会发现公式会复制到 A 列数据对应的 B 列的最后一行.
</p>

<p>
像我这种能不动鼠标就不动鼠标的也想出来了一个不用鼠标的方法,因为 B 列数据是按照 A
列来的,所以数量上一定是一样的,我们可以用 Ctrl + 方向键(↓) 来选中 A 列连续数据的
最后一个单元格,然后按方向键右键(→) 选中 B 列对应的单元格,然后 Ctrl + Shift + 方
向键(↑)选中连续的空白单元格,直到有数据的 B2 单元格,然后按 Ctrl + D 自动将 B2 的
数据向下复制到所有选中单元格(D 表示 Down 向下复制, R 就表示 Right 像右复制)
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orgd0b4879" class="outline-5">
<h5 id="orgd0b4879"><span class="section-number-5">1.4.2.2.</span> 选中并删除重复的单元格</h5>
<div class="outline-text-5" id="text-1-4-2-2">
<p>
前面只是知道了有哪些单元格重复,我们要将这些重复数据删除才能解决问题.但是前面的公
式 <code>=COUNTIF(A:A,A2)</code> 也有点问题,就是只要该单元格有重复,那就会得出大于1的结果,例
如有两个单元格与 A2 值相同,那结果会返回 3,且其余两个单元格对应 B 列的结果也是 3,
我们虽然找出来了,但无法将重复的删到只剩下一个值,因为无法将它们三个单元格区分.
</p>

<p>
所以我们需要修改一下公式 : <code>=COUNTIF($A$2:A2,A2)</code> 这样,每次计算的都是从 A2 到要
判断的单元格,保证了重复值中的第一个值计算出的结果会是1,而其他的重复值计算结果会
大于1,这样就区分开来了,例如 A2, 计算它时,只在 A2 到 A2 的范围,也就是 A2 单元格里
查找 A2 的值,当然会匹配,而且只有一个值,所以结果为 1,假设 A3 和 A2 值相同,计算 A3
时,查找范围是 A2 到 A3, 有两个值与 A3 的值相同(A3 和 A2) 所以统计结果会是 2, 剩
下一个与 A2 值相同的也是一样,不过计算结果就会是 3 了, 这样就把重复的值用大于 1
的值区分开来了,我们下面只需要选中 B 列值大于1 的单元格,然后删除该单元格对应的记
录就可以了.
</p>

<blockquote>
<p>
虽然 2007 之后的 Excel 版本里都添加了 "删除重复项" 的按钮,但实际使用过程中发生过
删除了没有重复的数据的实例. 上面是作者说的, 实际我在使用该功能的时候也遇到过没有
重复的数据都给删除了的情况,当时是一个练习的文档,删除的是第一行数据,练习过程中发
现不对才最后找到是删除重复项搞的事,可能是因为语言原因,也可能是因为选中的区域有部
分重复了,但是没选中的地方却没有重复,因此错误删除了数据,当然这就是操作问题了,按我
对程序的理解,只要该功能的实现逻辑及其代码没有问题,那一般都是没有掌握它的用法然后
瞎操作导致的误删数据,我之前遇到的应该也是,因为当时我刚刚开始学 Excel.
</p>
</blockquote>
</div>
</div>
</div>

<div id="outline-container-orgad52cd4" class="outline-4">
<h4 id="orgad52cd4"><span class="section-number-4">1.4.3.</span> 输入连续的数字</h4>
<div class="outline-text-4" id="text-1-4-3">
<p>
在 Excel 中输入 1，2，3&#x2026; 这种连续的数字，有好几种方法。
<b>**</b>
</p>
</div>
</div>

<div id="outline-container-org7ef11b5" class="outline-4">
<h4 id="org7ef11b5"><span class="section-number-4">1.4.4.</span> 沿行方向输入大量 VLOOKUP 函数的方法</h4>
</div>

<div id="outline-container-org22f10ad" class="outline-4">
<h4 id="org22f10ad"><span class="section-number-4">1.4.5.</span> 如何用 VLOOKUP 函数应对检索范围中竖列顺序的变动情况</h4>
</div>

<div id="outline-container-org383ca78" class="outline-4">
<h4 id="org383ca78"><span class="section-number-4">1.4.6.</span> 在有多个相同检索值的工作表中使用 VLOOKUP 函数的技巧</h4>
</div>

<div id="outline-container-orgc942557" class="outline-4">
<h4 id="orgc942557"><span class="section-number-4">1.4.7.</span> 是否能用 VLOOKUP 函数获得检索列左侧的数值?</h4>
</div>

<div id="outline-container-org4c8ed17" class="outline-4">
<h4 id="org4c8ed17"><span class="section-number-4">1.4.8.</span> 不显示错误值的技巧</h4>
</div>

<div id="outline-container-orgd35d390" class="outline-4">
<h4 id="orgd35d390"><span class="section-number-4">1.4.9.</span> 用 SUMIF 函数统计多个条件的方法</h4>
</div>
</div>

<div id="outline-container-orge1d7c1c" class="outline-3">
<h3 id="orge1d7c1c"><span class="section-number-3">1.5.</span> Excel 中的日期与时间设置</h3>
</div>
</div>

<div id="outline-container-orgdb7ebc8" class="outline-2">
<h2 id="orgdb7ebc8"><span class="section-number-2">2.</span> <span class="todo TODO">TODO</span> Excel函数与公事速查手册(第二版)</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orgb04334e" class="outline-3">
<h3 id="orgb04334e"><span class="section-number-3">2.1.</span> 逻辑函数(8)</h3>
<div class="outline-text-3" id="text-2-1">
</div>
<div id="outline-container-orgef39e2a" class="outline-4">
<h4 id="orgef39e2a"><span class="section-number-4">2.1.1.</span> AND 函数(检验是否都满足条件)</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
\[
AND(logical1, [logical2], \cdots)
\]
</p>

<p>
logical1,logical2,&ctdot; 表示测试表达式,最多可以有30个表达式.
</p>

<p>
只有当 logical1,logical2, &ctdot; 所有这些表达式的值全为真时, AND 函数才返回
TRUE, 否则,就返回 FALSE.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org9aaf04c">
=AND(B2&gt;60,C2&gt;60,D2&gt;60)      只有当B2,C2,D2 这三个单元格中所有值大于60 时才返回 TURE.
=AND(B2="合格",C2="合格",D2="合格",)    只有当 B2,C2,D2 全部为 合格 时才返回 TRUE.
</pre>
</div>
</div>

<div id="outline-container-orgef04207" class="outline-4">
<h4 id="orgef04207"><span class="section-number-4">2.1.2.</span> OR 函数(检验是否有一个满足条件)</h4>
<div class="outline-text-4" id="text-2-1-2">
<p>
\[
OR(logical1, [logical2], \cdots)
\]
</p>

<p>
logical1, logical2, &ctdot; 表示测试表达式,最多可以有 255 个表达式.
</p>

<p>
只有当所有表达式的值全为假时, OR 函数才返回 FALSE, 否则, 只要有一个表达式为真,就
返回 TRUE.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org33a6df5">
=OR(C2&gt;30000, D2&gt;5)   只要C2&gt;30000 或 D2&gt;5 这两个表达式有一个为真,就返回 TRUE.
=OR(AND(B2&gt;=80, C2&gt;=80), D2&gt;=85) OR 和 AND 函数的组合使用,AND 表达式为真或 C2&gt;=80 为真就返回TRUE, 其中,AND 表达式为真需要 B2&gt;=80 与 C2&gt;=80 这两个表达式全为真.
</pre>
</div>
</div>

<div id="outline-container-org4f34aa1" class="outline-4">
<h4 id="org4f34aa1"><span class="section-number-4">2.1.3.</span> NOT 函数(对参数取反)</h4>
<div class="outline-text-4" id="text-2-1-3">
<p>
\[
NOT(logical)
\]
</p>

<p>
logical 为一个计算结果可以为 TRUE 或 FALSE 的表达式.
</p>

<p>
返回与表达式相反的真值,即,若 logical 为真,则返回 FALSE, 若 logical 为假,则返回 TRUE.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org237920d">
=NOT(1&gt;2)   1&gt;2 表达式的结果为假,所以NOT 函数返回 TRUE.
</pre>
</div>
</div>

<div id="outline-container-orgd92f6a7" class="outline-4">
<h4 id="orgd92f6a7"><span class="section-number-4">2.1.4.</span> IF 函数(根据条件判断真假)</h4>
<div class="outline-text-4" id="text-2-1-4">
<p>
\[
IF(logical_test, [value_if_true], [value_if_false])
\]
</p>

<ul class="org-ul">
<li>logical<sub>test</sub> 为计算结果可以为 TRUE 或 FALSE 的表达式(一般叫做逻辑判断表达式),</li>
<li>value<sub>if</sub><sub>true</sub> 为 logical<sub>test</sub> 计算结果为真时 IF 函数的返回值,可选,省略时默认返
回TRUE.</li>
<li>value<sub>if</sub><sub>false</sub> 为 logical<sub>test</sub> 计算结果为假时 IF 函数的返回值,可选,省略时默认
返回 FALSE.</li>
<li>IF 函数最多可以嵌套 7 层.</li>
</ul>


<p>
使用示例:
</p>
<pre class="example" id="org78a6483">
=IF(B2&gt;18,"成年","未成年")   如果 B2 中的值大于18 则返回 "成年", 否则返回 "未成年".
=IF(B2&lt;=50000,B2*0.03,IF(B2&lt;=80000,B2*0.05, B2*0.08))  根据业绩计算奖金,小于50000,3% 奖金,大于50000,小于80000,5%,大于80000,8%.
=IF(AND(B2&gt;=60,C2&gt;=60,D2&gt;=60), "合格", "不合格")   AND 函数的表达式计算结果为真,返回合格,否则返回不合格.
</pre>
<p>
一个使用数组的示例:
</p>
<pre class="example" id="orgc51b1a9">
=SUM(IF(A2:A9={"A组", "C组"}, C2:C9))    编辑公式后按 Ctrl+Shift+Enter 即可计算出 A2:A9 中属于 A组和 C组对应的列C 中的值.

这是使用数组的公式,IF 函数中,在 A2:A9 区域依次判断是否为 "A组" 或 "C组",如果是,则返回 TRUE, 然后返回为 TRUE 的单元格对应在 C2:C9 区域的单元格值,若判断结果为 FALSE,
则IF函数返回 FALSE,
</pre>
</div>
</div>

<div id="outline-container-org9634fc4" class="outline-4">
<h4 id="org9634fc4"><span class="section-number-4">2.1.5.</span> TRUE 函数</h4>
<div class="outline-text-4" id="text-2-1-5">
<p>
\[ TRUE() \]
</p>

<p>
TRUE 函数没有参数,仅用于返回一个逻辑值 TRUE.
</p>

<p>
TRUE 函数可以直接在单元格或公式中使用,一般配合其他函数使用.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org72fc5be">
这个函数一时还真想不到示例,因为一般表示真值直接用 TRUE 和 FALSE 也是一样的.

从后面函数那里回想到这里, TRUE 和 FALSE 值是特殊的数值类型,分别表示1和0,
那就可以有一个使用示例了:
=1+TRUE() 结果为2
=1+TRUE 结果也为2
</pre>
</div>
</div>

<div id="outline-container-org194ef7a" class="outline-4">
<h4 id="org194ef7a"><span class="section-number-4">2.1.6.</span> FALSE 函数</h4>
<div class="outline-text-4" id="text-2-1-6">
<p>
\[ FALSE() \]
</p>

<p>
和 TRUE 函数一样,没有参数,仅用于返回一个逻辑值 FALSE.
</p>

<p>
用法也和 TRUE 函数类似.
</p>
</div>
</div>

<div id="outline-container-org0242124" class="outline-4">
<h4 id="org0242124"><span class="section-number-4">2.1.7.</span> IFNA 函数</h4>
<div class="outline-text-4" id="text-2-1-7">
<p>
\[ IFNA(value, value_if_na) \]
</p>

<ul class="org-ul">
<li>value: 表示用于检查错误值 "#N/A" 的表达式,若计算结果不为错误值,则返回表达式的
计算结果.</li>
<li>value<sub>if</sub><sub>na</sub>: 当 value 表达式的计算结果为错误值 "#N/A" 时要返回的值.</li>
</ul>


<p>
当 value 表达式计算结果为错误值 "#N/A" 时,返回 value<sub>if</sub><sub>na</sub>, 否则返回 value 表达
式的计算结果.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orga7e6a09">
=IFNA(VLOOKUP(A13,A1:C10,3,FALSE), "未找到结果,请检查查找对象")
VLOOKUP 公式在 A1:C10 范围内查找 A13 的值,找到则返回 A1:C10 范围内对应的第三列的内容,
未找到则会返回错误值 "#N/A", IFNA 函数就会返回 value_if_na 的值.
</pre>
</div>
</div>

<div id="outline-container-org7b63cf1" class="outline-4">
<h4 id="org7b63cf1"><span class="section-number-4">2.1.8.</span> IFERROR 函数</h4>
<div class="outline-text-4" id="text-2-1-8">
<p>
\[ IFERROR(value, value_if_error) \]
</p>

<p>
用法和 IFNA 类似,不同之处在于它用来检查错误值.
</p>

<blockquote>
<p>
这里要注意的是,错误值有很多中, IFNA 是专门检查 #N/A 这一种的函数,而 IFERROR 是检
查多种类型的错误,例如, #N/A,#VALUE!,#REF!,#DIV/0!,#NUM!,#NAME? 和 #NULL!
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org7a2fa83">
=IFERROR(3/0,"计算数据源有错误")
由于 3/0 这个表达式中0作为了分母,所以该表达式的计算结果会返回 #DIV/0 的错误值,
IFERROR 函数返回 "计算数据源有错误", 如果第一个参数的表达式计算结果没有错误,例如
=IFERROR(3/1,"计算数据源有错误")
那么 IFERROR 函数就会直接返回表达式 3/1 的计算结果 3.
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdbfb732" class="outline-3">
<h3 id="orgdbfb732"><span class="section-number-3">2.2.</span> 数学和三角函数(59)</h3>
<div class="outline-text-3" id="text-2-2">
</div>
<div id="outline-container-org52dcd7d" class="outline-4">
<h4 id="org52dcd7d"><span class="section-number-4">2.2.1.</span> 求和函数</h4>
<div class="outline-text-4" id="text-2-2-1">
</div>
<div id="outline-container-orgdb3619d" class="outline-5">
<h5 id="orgdb3619d"><span class="section-number-5">2.2.1.1.</span> SUM 函数(求和运算)</h5>
<div class="outline-text-5" id="text-2-2-1-1">
<p>
\[ SUM(number1,[number2], \cdots) \]
</p>

<ul class="org-ul">
<li>number1,number2, \(cdots\) : 想要进行求和的参数,最多可有 255 个参数. 每个参数都
是计算结果为数值的表达式.</li>
</ul>


<blockquote>
<p>
SUM 函数的参数可以是以下几种类型:
</p>
<ul class="org-ul">
<li>数字字面值,如直接使用数字: <code>=SUM(1,2)</code> 结果为3.</li>
<li>可以通过 VALUE() 函数转为数字字面值的字符字面值,如 <code>=SUM(1,"1")</code>, 结果为2.</li>
<li>数据为数值类型的单元格引用,例如,A1 单元格的数据为数值1, <code>=SUM(1,A1)</code> 结果为2.</li>
<li>数据为字符类型的单元格引用,虽然这种类型可以作为参数,但与可转为数值字面值的字符
字面值不同,只要单元格中数据为字符类型,SUM 都会将这个单元格引用的参数视为0,例如
A1 单元格的数据为字符字面值 "1",但 <code>=SUM(A1,1)</code> 结果为1, 这一点和第二点是比较
特殊的.</li>
</ul>


<p>
其他类型的数据,放到SUM 的参数中会导致 SUM 返回错误值, 例如不能通过 VALUE() 函数
转为数值字面值的字符字面值,如 "a", 会导致 SUM 返回 #VALUE!.
</p>

<p>
一般都不会使用字面值来作为 SUM 的参数,毕竟函数就是为了批量快速处理数据,手动添加
字面值意义不大,需要求和的通常也是数值数据,只要注意当发现计算结果不对时,可能是因
为单元格的数据类型不正确导致的.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org2ebc627">
=SUM(B2:D8) 对 B2:D8 单元格区域的所有数据进行求和计算.
=SUM(B2:B9, table1!B2:B9) 对当前表格中的 B2:B9 区域以及 table1 表格中的 B2:B9 区域
中的所有数据进行求和.
</pre>
</div>
</div>

<div id="outline-container-org2140a5c" class="outline-5">
<h5 id="org2140a5c"><span class="section-number-5">2.2.1.2.</span> SUMIF 函数(按照指定条件求和)</h5>
<div class="outline-text-5" id="text-2-2-1-2">
<p>
\[ SUMIF(range, criteria, [sum_range])\]
</p>

<ul class="org-ul">
<li>range: 条件判断应用的单元格区域.</li>
<li>criteria: 用于确定对哪些单元格求和的条件.</li>
<li>sum<sub>range</sub>: 根据条件判断结果要进行计算的对应单元格区域.如果该参数被省略,则使用
range 参数的单元格中符合条件的单元格进行求和.</li>
</ul>


<blockquote>
<p>
求和区域单元格数据的要求与 SUM 函数的要求类似.
单元格必需是数字,名称,数组或数字的引用. 空值和文本值会被忽略(也就是当作0处理).
判断区域单元格数据的要求与求和区域一致,因为它在求和参数省略时会被当作求和区域.
</p>

<p>
判断条件可以是任意有效表达式,其中,如果是文本或逻辑表达式,如 "abc", "销售部",
"&gt;1", "=a", "=abc", "=销售部", "=1", 则必需用双引号,其他的如数值,单元格引用或有
返回值的函数,例如, 1, A2, SUM(1,2) 等不带双引号.
</p>
</blockquote>

<p>
SUMIF 函数对区域中符合指定条件的值求和.就是先进行条件判断,然后只对满足条件的数据
进行求和.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org400c7d3">
=SUMIF(B2:B8, "财务部", C2:C8)
从 B2:B8 中选出值为"财务部"的对应 C2:C8 的单元格进行求和.
=SUMIF($C$2:C$11, F2, $D$2:$D$11)
在C2:C11 这个固定区域里选择值等于 F2 的对应 D2:D11 固定区域的单元格求和.
=SUMIF(A2:A12, "&lt;=18-10-15", C2:C11)
从 A2:A12 中选择出小于等于 18年10月15日的日期对应的 C2:C11 单元格进行求和.
</pre>
</div>
</div>

<div id="outline-container-orgd1a2a38" class="outline-5">
<h5 id="orgd1a2a38"><span class="section-number-5">2.2.1.3.</span> SUMIFS 函数(对满足多重条件的单元格求和)</h5>
<div class="outline-text-5" id="text-2-2-1-3">
<p>
\[ SUMIFS(sum_range, criteria_range1, criteria1, [criteria_range2,
criteria2], \cdots) \]
</p>

<ul class="org-ul">
<li>sum<sub>range</sub> : 求和区域.区域内单元格数据要求和 SUM 参数要求一致.</li>
<li>criteria<sub>range1</sub> , criteria1 : 条件判断的区域和判断的条件.判断区域和判断条件和
SUMIF 的判断区域和判断条件用法一致.</li>
<li>$[criteria<sub>range2</sub>, criteria2], &ctdot; $: 其他的条件区域和条件对,最多有 127 对.</li>
</ul>

<p>
SUMIF 函数对区域中满足多个条件的单元格求和. 就是依次判断给定的多个条件,然后只对
满足条件的数据进行求和.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org50bb316">
=SUMIFS(D1:D10, B1:B10, "男", C1:C10, "&gt;18")
B 列为性别,C 列为年龄, D 列为分数, 这个公式会选择大于18岁的男性的所有分数进行求和.
</pre>
</div>
</div>

<div id="outline-container-org5be83e7" class="outline-5">
<h5 id="org5be83e7"><span class="section-number-5">2.2.1.4.</span> SUMPRODUCT 函数(将数组间对应的元素相乘,并返回乘积之和)</h5>
<div class="outline-text-5" id="text-2-2-1-4">
<p>
\[ SUMPRODUCT(array1, [array2], \cdots)\]
</p>

<ul class="org-ul">
<li>array1: 一维数组,需要相乘并求和的第一个数组参数.</li>
<li>\(array2, \cdots\): 其他一维数组,最多有总共 255 个数组.</li>
</ul>


<p>
SUMPRODUCT 是在给定的几组数组中,将数组中对应的元素相乘,并返回乘积之和.
</p>

<blockquote>
<p>
虽然 SUMPRODUCT 用法有数组,有乘法,加法,但跟数学中的数组乘法加法有区别,这里是表示
对各个数组中每个元素执行同样的操作.理解这个函数的用法这一点很重要.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org6965436">
=SUMPRODUCT(A2:A4,B2:B4,C2:C4)
实际执行的运算是 A2*B2*C2+A3*B3*C3+A4*B4*C4
</pre>

<p>
<b>SUMPRODUCT 的高级用法</b>
SUMPRODUCT 最基本的用法就是上面的数学函数,效果为相乘后求和.
而 SUMPRODUCT 最重要的功能是可以按条件计数以及按条件求和.
</p>

<p>
也就是说 SUMPRODUCT 可以代替 SUMIF 和 SUMIFS 函数进行按条件求和,也可以代替
COUNTIF 和 COUNTIFS 进行计数.
</p>

<blockquote>
<p>
SUMPRODUCT 和 SUMIFS 可以达到相同的统计目的,但SUMIFS 在2010 之前是没有出现的,而
且 SUMIFS 只能对单元格区域进行求和,但 SUMPRODUCT 可以以公式的返回值为参数,这点
SUMPRODUCT 更加灵活.
</p>
</blockquote>

<p>
这种高级用法只需讲基础用法中用来分隔数组的逗号修改为四则运算符号,而数组可以是表
达式的返回值.
</p>

<p>
\[ SUMPRODUCT((条件1表达式)*(条件2表达式)*\cdots) \]
</p>

<blockquote>
<p>
这里的表达式是可以返回数组的表达式,例如 A2:A4="张三" 实际上是对 A2:A4 中所有元素
进行逻辑判断,等于 "张三" 的返回 TRUE, 否则返回 FALSE, 在 Excel 数值计算中, TRUE
等价于 1, FALSE 等价于0, 若只有 A3 为张三,那么这个表达式返回的结果为 [0 1 0] 这
样一个数组;
这里的乘号可以替换为其他四则运算符号.
</p>

<p>
所以,这个高级用法的理解就是,根据四则运算符号对每个数组中每个元素进行相应运算.这
种高级用法可以说是将 SUMPRODUCT 变成了一个对数组的快捷运算的函数.
</p>

<p>
在没有使用逻辑表达式时加减乘除直接按四则运算理解,在用了逻辑表达式时,例如
A1:A100&lt;0 则可以理解为离散数学与或非(除法一般不会应用与逻辑表达式),所以可以用作
条件判断.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="orgf9906dd">
=SUMPRODUCT((A1:A100="内部")*(C1:C100&gt;0)*(D1:D100))
A1:A100="内部" 返回的是 (0,1,0,0,...) 的数组, C1:C100&gt;0 返回的也是 (1, 0, 1, ...) 的数组
D1:D100 就是 D1:D100 的原数组, 这样就进行了多条件判断的求和操作.

=SUMPRODUCT((A1:A100="销售部")*(C1:C100="女"))
统计出销售部中女性人数. 这样可以完成 COUNTIFS 的功能.

=SUMPRODUCT((C2:C100&gt;=DATE(2006,9,1))*(C2:C100&lt;=DATE(2007,9,1))*(D2:D100="女"))
统计2006年9月1日到 2007年9月1日出生的女性人数.
</pre>
</div>
</div>

<div id="outline-container-org5ed985e" class="outline-5">
<h5 id="org5ed985e"><span class="section-number-5">2.2.1.5.</span> SUBTOTAL 函数 (返回分类汇总的值)</h5>
<div class="outline-text-5" id="text-2-2-1-5">
<p>
\[ SUBTOTAL(function_num, ref1, [ref2], \cdots) \]
</p>

<ul class="org-ul">
<li>function<sub>num</sub>: 统计函数的编号, 1-11 为包含隐藏值的函数, 101-111 为忽略隐藏值的
函数.编号对应的函数在下面表格中.</li>
<li>ref1: 表示要进行分类汇总的第一个区域</li>
<li>\(ref2,\cdots\): 表示要进行分类汇总的其他区域,最多 254 个区域.</li>
</ul>


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 2:</span> 编号/函数表</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right">function<sub>num</sub>(包含隐藏值)</td>
<td class="org-right">function<sub>num</sub>(忽略隐藏值)</td>
<td class="org-left">函数</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">101</td>
<td class="org-left">AVERAGE</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">102</td>
<td class="org-left">COUNT</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">103</td>
<td class="org-left">COUNTA</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-right">104</td>
<td class="org-left">MAX</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-right">105</td>
<td class="org-left">MIN</td>
</tr>

<tr>
<td class="org-right">6</td>
<td class="org-right">106</td>
<td class="org-left">PRODUCT</td>
</tr>

<tr>
<td class="org-right">7</td>
<td class="org-right">107</td>
<td class="org-left">STDEV</td>
</tr>

<tr>
<td class="org-right">8</td>
<td class="org-right">108</td>
<td class="org-left">STDEVP</td>
</tr>

<tr>
<td class="org-right">9</td>
<td class="org-right">109</td>
<td class="org-left">SUM</td>
</tr>

<tr>
<td class="org-right">10</td>
<td class="org-right">110</td>
<td class="org-left">VAR</td>
</tr>

<tr>
<td class="org-right">11</td>
<td class="org-right">111</td>
<td class="org-left">VARP</td>
</tr>
</tbody>
</table>


<blockquote>
<p>
SUBTOTAL 实际上是只对可见的数据进行处理,1-11 和 101-111 的区别是手动隐藏(隐藏行
命令)和筛选/分类汇总方式隐藏数据的区别,对于手动隐藏的数据, subtotal() 使用1-11
对应的函数与普通函数一样,即不管是否被手动隐藏都会纳入计算范围,而 101-111 是不管
通过隐藏命令还是筛选/分类汇总命令,只要是看不见的数据,就不会纳入计算范围.
</p>
</blockquote>
</div>
</div>
</div>

<div id="outline-container-org9d85f8e" class="outline-4">
<h4 id="org9d85f8e"><span class="section-number-4">2.2.2.</span> 数学函数</h4>
<div class="outline-text-4" id="text-2-2-2">
</div>
<div id="outline-container-orgd8ea862" class="outline-5">
<h5 id="orgd8ea862"><span class="section-number-5">2.2.2.1.</span> ABS 函数(求绝对值)</h5>
<div class="outline-text-5" id="text-2-2-2-1">
<p>
\[ ABS(number) \]
</p>

<ul class="org-ul">
<li>number: 返回需要计算绝对值的数值的表达式.</li>
</ul>


<p>
ABS 函数返回数值的绝对值,绝对值没有符号.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgf0352a0">
=ABS(A1-C2)
返回 A1-C2 计算结果的绝对值.

=IF(C2&gt;B2, "提高", "下降") &amp; ABS(C2-B2) &amp; "元"
比较销售额是下降还是升高了.
</pre>
</div>
</div>

<div id="outline-container-orgfe98c62" class="outline-5">
<h5 id="orgfe98c62"><span class="section-number-5">2.2.2.2.</span> MOD 函数(求两个数值相除后的余数)</h5>
<div class="outline-text-5" id="text-2-2-2-2">
<p>
\[ MOD(number, divisor) \]
</p>

<ul class="org-ul">
<li>number: 被除数.</li>
<li>divisor: 除数.</li>
</ul>


<p>
MOD 函数用于返回两数相除的余数,结果的正负号与除数相同.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgc209fe0">
=SUMPRODUCT((MOD(ROW(2:13), 2)) * (C2:C13))
汇总统计奇数行. MOD(ROW(2:13), 2) 返回的是一个奇数行为1,
偶数为0的数组,2-13行即(0,1,0,1...)
=SUMPRODUCT((MOD(ROW(2:13)+1, 2)) * (C2:C13))
汇总统计偶数行. 2-13行 MOD(ROW(2:13)+1, 2) 返回 (1,0,1,0,...) 的数组.
</pre>
</div>
</div>

<div id="outline-container-org94360a6" class="outline-5">
<h5 id="org94360a6"><span class="section-number-5">2.2.2.3.</span> SUMSQ 函数</h5>
<div class="outline-text-5" id="text-2-2-2-3">
<p>
\[ SUMSQ(number1, [number2], \cdots)\]
</p>

<ul class="org-ul">
<li>\(number1,number2,\cdots\): 用于计算平方和的参数,最多255 个,最少1个.</li>
</ul>


<p>
SUMSQ 函数用于返回参数的平方和.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org2ecbcab">
=SUMSQ(A2,B2)
=SUMSQ(A1:C5)
</pre>
</div>
</div>

<div id="outline-container-orga5f15a2" class="outline-5">
<h5 id="orga5f15a2"><span class="section-number-5">2.2.2.4.</span> SUMXMY2 函数</h5>
<div class="outline-text-5" id="text-2-2-2-4">
<p>
\[ SUMXMY2(array_x, array_y) \]
</p>

<ul class="org-ul">
<li>array<sub>x</sub>: 第一个数组或数值区域.</li>
<li>array<sub>y</sub>: 第二个数组或数值区域.</li>
</ul>


<p>
SUMXMY2 函数用于返回两个数组中对应数值之差的平方和.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org7264227">
=SUMXMY2(A2:A5, B2:B5)
等价于 =(A2-B2)^2+(A3-B3)^2+(A4-B4)^2+(A5-B5)^2
</pre>

<blockquote>
<p>
XMY2 就是 \(\sum (X-Y)^2\) 数值差的平方和
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org2c0ee63" class="outline-5">
<h5 id="org2c0ee63"><span class="section-number-5">2.2.2.5.</span> SUMX2MY2 函数</h5>
<div class="outline-text-5" id="text-2-2-2-5">
<p>
\[ SUMX2MY2(array_x, array_y) \]
</p>

<ul class="org-ul">
<li>array<sub>x</sub>: 第一个数组或数值区域.</li>
<li>array<sub>y</sub>: 第二个数组或数值区域.</li>
</ul>


<p>
SUMX2MY2 函数用于返回两个数组中对应数值的平方和之差.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgf9430f8">
=SUMX2MY2(A2:A5, B2:B5)
等价于 =(A2^2+A3^2+A4^2+A5^2)-(B2^2+B3^2+B4^2+B5^2)
</pre>

<blockquote>
<p>
X2MY2 就是 \(\sum X^2 -\sum Y^2\) 第一个数组所有数值的平方和减去第二个数组所有数值的平方和.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org117aa22" class="outline-5">
<h5 id="org117aa22"><span class="section-number-5">2.2.2.6.</span> SUMX2PY2 函数</h5>
<div class="outline-text-5" id="text-2-2-2-6">
<p>
\[ SUMX2PY2(array_x, array_y) \]
</p>

<ul class="org-ul">
<li>array<sub>x</sub>: 第一个数组或数值区域.</li>
<li>array<sub>y</sub>: 第二个数组或数值区域.</li>
</ul>


<p>
SUMX2PY2 函数用于返回两个数组中对应数值的平方和之和, 平方和之和在统计计算中经常
使用.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgdf3047a">
=SUMX2PY2(A2:A5, B2:B5)
等价于 =(A2^2+A3^2+A4^2+A5^2)+(B2^2+B3^2+B4^2+B5^2)
</pre>

<blockquote>
<p>
X2PY2 就是 \(\sum X^2 + \sum Y^2\) 两个数组中对应数值的平方和之和.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org368765a" class="outline-5">
<h5 id="org368765a"><span class="section-number-5">2.2.2.7.</span> PRODUCRT 函数</h5>
<div class="outline-text-5" id="text-2-2-2-7">
<p>
\[ PRODUCRT(number1, [number2], \cdots) \]
</p>

<ul class="org-ul">
<li>number1: 表示要相乘的第一个数字或区域(工作表上的两个或多个单元格,可以相邻或不
相邻)</li>
<li>\(number2, \cdots\): 要相乘的其他数字或单元格,总共最多有 255 个参数.</li>
</ul>


<p>
PRODUCRT 函数可以计算参数中所有数字的乘积.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org2ad82d9">
=PRODUCT(A2, B2, C2)
等价于 =A2*B2*C2
=PRODUCT(A2, A2)
等价于 =A2*A2
</pre>
</div>
</div>

<div id="outline-container-org39217cc" class="outline-5">
<h5 id="org39217cc"><span class="section-number-5">2.2.2.8.</span> MULTINOMIAL 函数</h5>
<div class="outline-text-5" id="text-2-2-2-8">
<p>
\[ MULTINOMIAL(number1, [number2], \cdots) \]
</p>

<ul class="org-ul">
<li>number1 : 必选,用于计算的第一个参数.</li>
<li>\(number2,\cdots\): 可选,用于计算的其他参数,总共最多 255 个参数.</li>
</ul>


<p>
返回所有参数和的阶乘与各个参数阶乘乘积的比值.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgaa8c297">
=MULTINOMIAL(1, 5)
</pre>
<p>
计算的是 \(\frac{(1+5)!}{1! \times 5!} = \frac{6!}{5!} = 6\)
</p>

<p>
=MULTINOMIAL(5,1,3)
</p>

<p>
计算的是 \(\frac{(5+1+3)!}{5! \times 1! \times 3!} = \frac{9!}{5! \times 3!}= 504\)
</p>
</div>
</div>

<div id="outline-container-orgf143d7f" class="outline-5">
<h5 id="orgf143d7f"><span class="section-number-5">2.2.2.9.</span> MDETERM 函数</h5>
<div class="outline-text-5" id="text-2-2-2-9">
<p>
\[ MDETERM(array) \]
</p>

<ul class="org-ul">
<li>array: 一个行数和列数相等的数值数组.</li>
</ul>


<p>
计算矩阵行列式的值.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgf3f6893">
=MDETERM(A2:D5)
计算 A2:D5 这个矩形的行列式值.
</pre>

<blockquote>
<p>
矩阵 Matrix 行列式 determinant
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org4a2c10a" class="outline-5">
<h5 id="org4a2c10a"><span class="section-number-5">2.2.2.10.</span> MINVERSE 函数</h5>
<div class="outline-text-5" id="text-2-2-2-10">
<p>
\[ MINVERSE(array) \]
</p>

<ul class="org-ul">
<li>array: 行数和列数相等的数值数组.</li>
</ul>


<p>
用于返回数组中矩阵的逆矩阵.
</p>
<blockquote>
<p>
Matrix 数组, inverse 反转的
</p>
</blockquote>

<blockquote>
<p>
矩阵(数组)计算需要使用特殊的组合快捷键 Ctrl+Shift+Enter 而不是普通的 Enter 来计
算公式.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="orgf6fd613">
=MINVERSE(A2:C4)
输入公式后按 Ctrl+Shift+Enter 可计算出矩阵对应的逆矩阵.
</pre>
</div>
</div>

<div id="outline-container-org7d32158" class="outline-5">
<h5 id="org7d32158"><span class="section-number-5">2.2.2.11.</span> MMULT 函数</h5>
<div class="outline-text-5" id="text-2-2-2-11">
<p>
\[ MMULT(array1,array2) \]
</p>

<ul class="org-ul">
<li>array1, array2: 进行矩阵乘法运算的两个数组.</li>
</ul>


<p>
MMULT 函数用于返回两个数组的矩阵乘积.
</p>
<blockquote>
<p>
Matrix Multiply 矩阵乘法,这个矩阵乘法符合数学的矩阵乘法规律.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org3075e78">
=MMULT(A2:B4, D2:F3)
A2:B4 为 $3 \times 2$ D2:F3 为 $2 \times 3$ 按 Ctrl+Shift+Enter 就可以计算出矩阵的乘积.
</pre>
</div>
</div>

<div id="outline-container-org3d2b02e" class="outline-5">
<h5 id="org3d2b02e"><span class="section-number-5">2.2.2.12.</span> GCD 函数</h5>
<div class="outline-text-5" id="text-2-2-2-12">
<p>
\[ GCD(number1, [number2], \cdots)\]
</p>

<ul class="org-ul">
<li>\(number1,number2,\cdots\): 第一个参数是必需的,后续数值是可选的. 数值的个数总共
最大为 255 个.如果任意一个数值为非整数, 则截尾取整.</li>
</ul>


<p>
GCD 函数用于返回两个或多个整数的最大公约数, 最大公约数是能同时整数 number1 和
number2 的最大整数.
</p>
<blockquote>
<p>
Great Common Divisor
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="orgb7cc733">
=GCD(33,88,55,66)
33,88,55,66 的最大公约数为 11.
</pre>
</div>
</div>

<div id="outline-container-org9668e76" class="outline-5">
<h5 id="org9668e76"><span class="section-number-5">2.2.2.13.</span> LCM</h5>
<div class="outline-text-5" id="text-2-2-2-13">
<p>
\[ LCM(number1, [number2], \cdots) \]
</p>

<ul class="org-ul">
<li>\(number1, number2, \cdots\) : 最多可有 255 个参数,如果参数值不是整数,则截尾取整.</li>
</ul>


<p>
LCM 函数用于求两个或多个整数的最小公倍数. 最小公倍数是所有参数的最小整数倍数.
LCM 函数可以将分母不同的分数相加.(这个功能找不到用例,搞不懂)
</p>

<blockquote>
<p>
Lowest Common Multiple 最小公倍数.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org377bf3a">
=LCM(5,7,6)
5,6,7 的最小公倍数为 210.
</pre>
<p>
说明中 LCM 函数可以将分母不同的分数相加应该指得是计算分数时得出公共分母的操作,这
是从 Excel 帮助文档中的翻译内容,可能与实际有差别.
</p>
</div>
</div>

<div id="outline-container-org710a62e" class="outline-5">
<h5 id="org710a62e"><span class="section-number-5">2.2.2.14.</span> QUOTIENT 函数(返回商的整数部分)</h5>
<div class="outline-text-5" id="text-2-2-2-14">
<p>
\[ QUOTIENT(numerator, denominator)\]
</p>

<ul class="org-ul">
<li>numberator: 被除数.</li>
<li>denominator: 除数.</li>
</ul>


<p>
QUOTIENT 函数返回商的整数部分,该函数会舍掉商的小数部分.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org8dcb049">
=QUOTIENT(5,2)
返回 5/2=2.5 的整数部分 2
</pre>
</div>
</div>

<div id="outline-container-org7c7ecf1" class="outline-5">
<h5 id="org7c7ecf1"><span class="section-number-5">2.2.2.15.</span> RAND 函数(返回大于或等于0 小于1 的随机数)</h5>
<div class="outline-text-5" id="text-2-2-2-15">
<p>
\[ RAND() \]
</p>

<p>
RAND() 函数没有参数,和 TRUE() ,FALSE() 函数一样.
</p>


<p>
使用示例:
</p>
<pre class="example" id="orge96e903">
=ROUND(RAND()*99+1, 0)
随机生成 1-100 的整数.
=INT(RAND()*10)
随机生成1-9 的整数.
</pre>

<blockquote>
<p>
ROUND 函数按照指定位数进行四舍五入;INT 函数将参数向下取整为最接近的整数;
F9 可以重新计算公式,所以按 F9 可以重新生成随机数.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org1c4864a" class="outline-5">
<h5 id="org1c4864a"><span class="section-number-5">2.2.2.16.</span> RANDBETWEEN 函数(返回指定数值之间的随机数)</h5>
<div class="outline-text-5" id="text-2-2-2-16">
<p>
\[ RANDBETWEEN(bottom, top) \]
</p>

<ul class="org-ul">
<li>bottom: 函数返回的最小整数.</li>
<li>top: 函数返回的最大整数.</li>
</ul>


<p>
用于返回两个数之间(不含最大和最小数)的一个随机整数,每次计算时都会返回一个新的随
机数.
</p>
<blockquote>
<p>
这等于是上面 RAND 函数用法的组合用法,例如 ROUND(RAND()*99+1,0) 随机生成1-100 的
整数.但也有不同, RAND 函数包含最小指,不包含最大值, RANDTWEEN 函数则包含最大值与
最小值.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org0ed8b77">
=RANDBETWEEN(100,1000)
用于返回三位随机数(101-999).
</pre>
</div>
</div>

<div id="outline-container-orgfc3ed6e" class="outline-5">
<h5 id="orgfc3ed6e"><span class="section-number-5">2.2.2.17.</span> SQRT 函数(返回参数的平方根)</h5>
<div class="outline-text-5" id="text-2-2-2-17">
<p>
\[ SQRT(number) \]
</p>

<ul class="org-ul">
<li>number : 计算平方根的数</li>
</ul>


<p>
使用示例:
</p>
<pre class="example" id="org1efda89">
=SQRT(144)
返回 144 的平方根 12
</pre>
</div>
</div>

<div id="outline-container-orgb9f4af2" class="outline-5">
<h5 id="orgb9f4af2"><span class="section-number-5">2.2.2.18.</span> SQRTPI 函数</h5>
<div class="outline-text-5" id="text-2-2-2-18">
<p>
\[ SQRTPI(number) \]
</p>

<ul class="org-ul">
<li>number: 用来与 \(\pi\) 相乘的正实数.</li>
</ul>


<p>
SQRTPI 函数用于返回指定正数值与 \(\pi\) 的乘积的平方根.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org40f70d6">
=SQRTPI(4)
返回 4乘π 的平方根.
</pre>
</div>
</div>

<div id="outline-container-org526cee5" class="outline-5">
<h5 id="org526cee5"><span class="section-number-5">2.2.2.19.</span> RADIANS 函数(将角度转为弧度)</h5>
<div class="outline-text-5" id="text-2-2-2-19">
<p>
\[ RADIANS(angle) \]
</p>

<ul class="org-ul">
<li>angle: 角度值.</li>
</ul>


<p>
RADIANS 函数用于将角度转换为弧度.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orga490ac0">
=RANDIANS(180)
返回 180 度的弧度值 π 的数值 $3.141592654$
=RANDIANS(90)
返回二分之一 π 的值 1.57...
</pre>
</div>
</div>

<div id="outline-container-org99c408e" class="outline-5">
<h5 id="org99c408e"><span class="section-number-5">2.2.2.20.</span> SIGN 函数</h5>
<div class="outline-text-5" id="text-2-2-2-20">
<p>
\[ SIGN(number) \]
</p>

<ul class="org-ul">
<li>number: 计算结果为数字的表达式.</li>
</ul>


<p>
SIGN 函数用于返回数字,计算结果或列中指的符号, 正数返回1,数字为零返回0,负数返回 -1.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org7c1ac60">
=SIGN(0)
结果为 0
=SIGN(-5)
结果为 -1
=SIGN(5)
结果为 1
</pre>
</div>
</div>

<div id="outline-container-orgb0dd24d" class="outline-5">
<h5 id="orgb0dd24d"><span class="section-number-5">2.2.2.21.</span> ROMAN 函数</h5>
<div class="outline-text-5" id="text-2-2-2-21">
<p>
\[ ROMAN(number, [form]) \]
</p>

<ul class="org-ul">
<li>number: 阿拉伯数字.</li>
<li>form: 指定罗马数字类型.罗马数字样式表在下面.</li>
</ul>


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 3:</span> form 与罗马数字类型</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right">form</td>
<td class="org-left">类型</td>
</tr>

<tr>
<td class="org-right">0或省略</td>
<td class="org-left">经典</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">更简化</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">比1更简化</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">比2更简化</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-left">最简化</td>
</tr>

<tr>
<td class="org-right">TRUE</td>
<td class="org-left">经典</td>
</tr>

<tr>
<td class="org-right">FALSE</td>
<td class="org-left">最简化</td>
</tr>
</tbody>
</table>

<p>
ROAMN 用于将阿拉伯数字转换为 <b>文本式</b> 的罗马数字.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgf81198c">
=ROMAN(599,2)
结果为 DIC
=ROMAN(599,0)
结果为 DXCIX
</pre>
</div>
</div>
</div>
<div id="outline-container-org7f5b3e8" class="outline-4">
<h4 id="org7f5b3e8"><span class="section-number-4">2.2.3.</span> 数据舍入函数</h4>
<div class="outline-text-4" id="text-2-2-3">
</div>
<div id="outline-container-org606c84b" class="outline-5">
<h5 id="org606c84b"><span class="section-number-5">2.2.3.1.</span> INT 函数(不考虑四舍五入直接对数字取整)</h5>
<div class="outline-text-5" id="text-2-2-3-1">
<p>
\[ INT(number) \]
</p>

<ul class="org-ul">
<li>number: 需要进行向下取整的实数.</li>
</ul>


<p>
INT 函数将数字向下舍入到最近的整数.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgbe5ab74">
=INT(SUM(E2:E8)/7)
计算出平均值并向下取整.
</pre>
</div>
</div>

<div id="outline-container-org07b055e" class="outline-5">
<h5 id="org07b055e"><span class="section-number-5">2.2.3.2.</span> ROUND 函数(对数据进行四舍五入)</h5>
<div class="outline-text-5" id="text-2-2-3-2">
<p>
\[ ROUND(number, num_digits) \]
</p>

<ul class="org-ul">
<li>number: 需要四舍五入的数字.</li>
<li>num<sub>digits</sub>: 表示四舍五入的位数.</li>
</ul>


<p>
ROUND 函数将数字四舍五入为指定的位数.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org4646a33">
=ROUND(10.249, 0)
将 10.249 按0位小数四舍五入,结果为 10
=ROUND(10.249, 2)
按2位小数四舍五入,结果为 10.25
</pre>
</div>
</div>

<div id="outline-container-org7594553" class="outline-5">
<h5 id="org7594553"><span class="section-number-5">2.2.3.3.</span> ROUNDUP 函数(向上舍入)</h5>
<div class="outline-text-5" id="text-2-2-3-3">
<p>
\[ ROUNDUP(number, num_digits) \]
</p>

<ul class="org-ul">
<li>number: 需要舍入的数字.</li>
<li>num<sub>digits</sub>: 表示舍入的位数.</li>
</ul>


<p>
ROUNDUP 函数是远离零值,向上舍入数字.(向绝对值增加的方向)
</p>
<blockquote>
<p>
ROUNDUP 和 ROUNDDOWN 在正数时与数学中的向上向下舍入一致,但对于负数是按绝对值增加
和减少的规则舍入.例如,对 -1.1 向上取舍, 用 roundup(-1.1,0) 结果为 -2, 按数学的
ceil(-1.1) 取舍则为-1; 对记忆来说,Excel 的向上/下取舍函数更容易记忆,只需要按绝对
值增加/减少的方向取舍就行了.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="orgf345200">
=ROUNDUP(20.246,0)
向上舍入到最接近的整数即 21
=ROUNDUP(20.246,2)
向上舍入到指定的小数, 即 20.25
=ROUNDUP(-20.246,1)
向上舍入到指定的小数, 即 -20.3
</pre>
</div>
</div>

<div id="outline-container-org0ded9d7" class="outline-5">
<h5 id="org0ded9d7"><span class="section-number-5">2.2.3.4.</span> ROUNDDOWN 函数(向下舍入)</h5>
<div class="outline-text-5" id="text-2-2-3-4">
<p>
\[ ROUNDDOWN(number, num_digits) \]
</p>

<ul class="org-ul">
<li>number: 需要舍入的数字.</li>
<li>num<sub>digits</sub>: 表示舍入的位数.</li>
</ul>


<p>
ROUNDDOWN 函数向下舍入数字(向绝对值减小的方向).
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgb8d0659">
=ROUNDDOWN(20.246,0)
结果为 20
=ROUNDDOWN(20.246,1)
结果为 20.2
=ROUNDDOWN(-20.246,1)
结果为 -20.2
</pre>
</div>
</div>

<div id="outline-container-orgb5ce8e4" class="outline-5">
<h5 id="orgb5ce8e4"><span class="section-number-5">2.2.3.5.</span> CEILING 函数(向上取舍到最接近指定数字的某个值的倍数值)</h5>
<div class="outline-text-5" id="text-2-2-3-5">
<p>
\[ CEILING(number, significance) \]
</p>

<ul class="org-ul">
<li>number : 需要舍入的值.</li>
<li>significance: 要舍入到的倍数.</li>
</ul>


<p>
将参数值向上舍入(绝对值增大的方向)为最接近指定数值的倍数.
</p>

<blockquote>
<p>
number 为负数时,若 significance 为正数,则与数学的向上舍入一致.
</p>

<p>
EXCEL 的CEILING ,FLOOR 等函数不是真正意义上数学中的向上/下舍入,只有在正数时表现
一致.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org845a82f">
=CEILING(5, 2)
向上将 5 舍入为最接近 2 的倍数的数值,2 的倍数为 2, 4, 6, 因为是向上,所以舍入到 6.
=CEILIING(5, 3)
5 向上舍入到 6.
=CEILIING(5.4, 3)
5.4 向上舍入到 6.
=CEILIING(-6.8, 2)
-6.8为负数,2 为整数,则向靠近零的方向舍入 -8, -6, -4, 舍入到 -6.
</pre>

<blockquote>
<p>
根据 Excel 版本不同, CEILING 函数用法相同的还有 CEILING.PRECISE 和 CEILING.MATH
这三个函数都可以达到相同的计算结果.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org6f055cb" class="outline-5">
<h5 id="org6f055cb"><span class="section-number-5">2.2.3.6.</span> FLOOR 函数(向下舍入到最接近指定数字的某个值的倍数值)</h5>
<div class="outline-text-5" id="text-2-2-3-6">
<p>
\[ FLOOR(number, significance) \]
</p>

<ul class="org-ul">
<li>number : 需要舍入的值.</li>
<li>significance: 要舍入到的倍数.</li>
</ul>


<p>
FLOOR 函数将数值向下舍入(向0的方向)到最接近指定数值的倍数.
</p>

<blockquote>
<p>
floor 和 rounddown 都向下舍入,但二者不同.
rounddown 对数据按指定位数舍入,不考虑四舍五入,直接截取小数位.
floor 时将输入舍入到绝对值减小的最接近 significance 的倍数.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org5350fc0">
=FLOOR(5,2)
舍入到 4
=FLOOR(5.4, 1)
舍入到 5
=FLOOR(-2.5, 1)
舍入到-3,和 CEILING 一样,number 为负数, significance 为整数时表现与数学的向下舍入一致.
</pre>
</div>
</div>

<div id="outline-container-orgd7835c1" class="outline-5">
<h5 id="orgd7835c1"><span class="section-number-5">2.2.3.7.</span> MROUND 函数(按指定倍数舍入)</h5>
<div class="outline-text-5" id="text-2-2-3-7">
<p>
\[ MROUND(number, multiple) \]
</p>

<ul class="org-ul">
<li>number : 需要舍入的值.</li>
<li>multiple: 需要将数值 number 舍入到的倍数.</li>
</ul>


<p>
MROUND 返回参数按指定倍数舍入后的数值.
</p>

<blockquote>
<p>
除了纯数学运算,一般数学应用的计算都只有在不足半数取消,多余半数算数的情况下使用.
例如, 计算货物需要装车多少,最后不足半车就不发车,多余半车则发一车.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="orgc3def79">
=MROUDN(10,3)
返回 10 最接近 3 的倍数的值, 3,6,9,12 最接近为 9 即返回9
=MROUDN(13.25,3)
返回 13.25 最接近 3 的倍数的值, 3,6,9,12,15 最接近为 12 即返回12
</pre>
</div>
</div>

<div id="outline-container-orgf2aede1" class="outline-5">
<h5 id="orgf2aede1"><span class="section-number-5">2.2.3.8.</span> EVEN 函数</h5>
<div class="outline-text-5" id="text-2-2-3-8">
<p>
\[ EVEN(number) \]
</p>

<ul class="org-ul">
<li>number: 必需, 表示需要舍入的值</li>
</ul>


<p>
EVEN 函数返回沿着绝对值增大方向取整的最接近的偶数.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org31ed79d">
=EVEN(-2)
-2 最接近的偶数 -2
=EVEN(-3)
-3 最接近的偶数(绝对值增大的方向) -4
=EVEN(3)
返回 4
</pre>
</div>
</div>

<div id="outline-container-orgaf3d3c5" class="outline-5">
<h5 id="orgaf3d3c5"><span class="section-number-5">2.2.3.9.</span> ODD 函数</h5>
<div class="outline-text-5" id="text-2-2-3-9">
<p>
\[ ODD(number) \]
</p>

<ul class="org-ul">
<li>number: 必需, 表示需要舍入的值</li>
</ul>


<p>
ODD 函数返回沿着绝对值增大方向取整的最接近的奇数.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orge4a6542">
=ODD(-2)
-2 最接近的奇数 -3
=ODD(-3)
-3 最接近的奇数(绝对值增大的方向) -3
=ODD(2)
返回 3
</pre>
</div>
</div>

<div id="outline-container-org2463198" class="outline-5">
<h5 id="org2463198"><span class="section-number-5">2.2.3.10.</span> TRUNC 函数(不考虑四舍五入直接对数字进行截断)</h5>
<div class="outline-text-5" id="text-2-2-3-10">
<p>
\[ TRUNC(number, [num_digits]) \]
</p>

<ul class="org-ul">
<li>number: 需要截尾取整的数字.</li>
<li>num<sub>digits</sub>: 可选,用于指定精度的数字. num<sub>digits</sub> 默认/省略时为0</li>
</ul>


<p>
TRUNC 函数用于将数字的小数部分截取,返回整数
</p>

<p>
使用示例:
</p>
<pre class="example" id="org3154b47">
=TRUNC(1.999)
结果为 1
=TRUNC(1.999, 1)
结果为 1.9
</pre>

<blockquote>
<p>
TRUNC 函数与 INT 函数类似,都是截断取整在对正数取整时,两个函数表现一致,
对负数取整时, TRUNC 仍然直接截取小数部分,而 INT 是去掉小数后加 -1, 因为 INT 是要
舍入的,而 TRUNC 是直接截断.
</p>
</blockquote>
</div>
</div>
</div>

<div id="outline-container-orgd0ff640" class="outline-4">
<h4 id="orgd0ff640"><span class="section-number-4">2.2.4.</span> 三角函数</h4>
<div class="outline-text-4" id="text-2-2-4">
<p>
三角函数的使用与数学中的三角函数使用方法一致,使用示例也一致,并不需要很大功夫理解,只
有函数命名以及少数几个函数需要记忆.
</p>
</div>
<div id="outline-container-orgc464977" class="outline-5">
<h5 id="orgc464977"><span class="section-number-5">2.2.4.1.</span> COS 函数</h5>
<div class="outline-text-5" id="text-2-2-4-1">
<p>
\[ COS(number) \]
</p>

<ul class="org-ul">
<li>number: 表示要求余弦的角度,以弧度表示.如果角度数据是以角度表示的,可以将角度乘
以 PI()/180 或使用 RADIANS 函数转为弧度值.</li>
</ul>


<p>
COS 函数返回给定角度的余弦值.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org325dcf4">
=COS(RADIANS(60))
60度角的余弦值为 0.5
=COS(RADIANS(120))
120度角的余弦值为 -0.5
</pre>
</div>
</div>

<div id="outline-container-org8f953cf" class="outline-5">
<h5 id="org8f953cf"><span class="section-number-5">2.2.4.2.</span> ACOS 函数</h5>
<div class="outline-text-5" id="text-2-2-4-2">
<p>
\[ ACOS(number) \]
</p>

<ul class="org-ul">
<li>number: 表示余弦值,介于 -1 到 1.</li>
</ul>


<p>
返回数字的反余弦值. 反余弦值为角度,余弦值为数字,返回的值用弧度表示. 结果范围是 0-π
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgc6e29cd">
=ACOS(1)
余弦值1的反余弦值为0
=ACOS(-1)
余弦值-1 的反余弦值为 π,即 3.1415....
</pre>
</div>
</div>

<div id="outline-container-orgd205797" class="outline-5">
<h5 id="orgd205797"><span class="section-number-5">2.2.4.3.</span> COSH 函数</h5>
<div class="outline-text-5" id="text-2-2-4-3">
<p>
\[ COSH(number) \]
</p>

<ul class="org-ul">
<li>number: 表示要求的双曲余弦的任意实数</li>
</ul>


<p>
COSH 函数返回数字的双曲余弦值.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org83bb4cf">
=COSH(0)
0 的双曲余弦值为 1
</pre>
</div>
</div>

<div id="outline-container-org939c2c3" class="outline-5">
<h5 id="org939c2c3"><span class="section-number-5">2.2.4.4.</span> ACOSH 函数</h5>
<div class="outline-text-5" id="text-2-2-4-4">
<p>
\[ ACOSH(number) \]
</p>

<ul class="org-ul">
<li>number: 表示大于或等于1的任意实数.</li>
</ul>


<p>
ACOSH 函数返回参数的反双曲余弦值,参数必需大于或等于1,反双曲余弦值的双曲余弦即为
元参数,因此 \(ACOSH(COSH(number))\) 等于 number
</p>

<p>
使用示例:
</p>
<pre class="example" id="orga8f06dc">
=ACOSH(1)
1 的反双曲余弦值为 0
</pre>
</div>
</div>

<div id="outline-container-org702fc71" class="outline-5">
<h5 id="org702fc71"><span class="section-number-5">2.2.4.5.</span> SIN 函数</h5>
<div class="outline-text-5" id="text-2-2-4-5">
<p>
\[ SIN(number) \]
</p>

<ul class="org-ul">
<li>number: 表示要求正弦的角度,以弧度表示.如果角度数据是以角度表示的,可以将角度乘
以 PI()/180 或使用 RADIANS 函数转为弧度值.</li>
</ul>


<p>
SIN 函数返回给定角度的正弦值.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org27558ef">
=SIN(RADIANS(30))
30度角的正弦值为 0.5
</pre>
</div>
</div>

<div id="outline-container-orga78396a" class="outline-5">
<h5 id="orga78396a"><span class="section-number-5">2.2.4.6.</span> ASIN 函数</h5>
<div class="outline-text-5" id="text-2-2-4-6">
<p>
\[ ASIN(number) \]
</p>

<ul class="org-ul">
<li>number: 表示所需角度的正弦值,范围是 -1~1.</li>
</ul>


<p>
ASIN 函数返回参数的反正弦值.返回的角度值用弧度表示.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgf4a8fe1">
=ASIN(0.5)
30度角的正弦值为 0.5 ,因此返回 30*π/180 的值 0.52359...
</pre>
</div>
</div>

<div id="outline-container-org5f532b5" class="outline-5">
<h5 id="org5f532b5"><span class="section-number-5">2.2.4.7.</span> SINH 函数</h5>
<div class="outline-text-5" id="text-2-2-4-7">
<p>
\[ SINH(number) \]
</p>

<ul class="org-ul">
<li>number: 表示要求的双曲正弦的任意实数</li>
</ul>


<p>
SINH 函数用于返回某一个数字的双曲正弦值.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgb1bc46f">
=SINH(0)
0的双曲正弦值为0
</pre>
</div>
</div>

<div id="outline-container-org2e626e3" class="outline-5">
<h5 id="org2e626e3"><span class="section-number-5">2.2.4.8.</span> ASINH 函数</h5>
<div class="outline-text-5" id="text-2-2-4-8">
<p>
\[ ASINH(number) \]
</p>

<ul class="org-ul">
<li>number: 任意实数.</li>
</ul>


<p>
ASINH 函数返回参数的反双曲正弦值. ASINH(SINH(number)) 等于 number.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgd058459">
=ASINH(1)
1 的反双曲正弦值为 0.88137...
</pre>
</div>
</div>

<div id="outline-container-org0b8dd71" class="outline-5">
<h5 id="org0b8dd71"><span class="section-number-5">2.2.4.9.</span> TAN 函数</h5>
<div class="outline-text-5" id="text-2-2-4-9">
<p>
\[ TAN(number) \]
</p>

<ul class="org-ul">
<li>number: 要求的正切的角度,以弧度表示. 如果参数的单位是角度,可以乘 PI()/180 或
RADIANS 函数转为弧度.</li>
</ul>


<p>
TAN 函数用于返回给定角度的正切值.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org9c3843c">
=TAN(RADIANS(45))
45度角的正切值为 1.
</pre>
</div>
</div>


<div id="outline-container-org7f60c5c" class="outline-5">
<h5 id="org7f60c5c"><span class="section-number-5">2.2.4.10.</span> ATAN 函数</h5>
<div class="outline-text-5" id="text-2-2-4-10">
<p>
\[ ATAN(number) \]
</p>

<ul class="org-ul">
<li>number: 所求角度的正切值.</li>
</ul>


<p>
ATAN 函数用于返回反正切值. 反正切值为角度,参数为正切值,返回的角度用弧度表示.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orge947852">
=ATAN(-1)
-45 度角的反正切值为 -1 ,所以ATAN(-1) 返回 -45度角的弧度值.
</pre>
</div>
</div>

<div id="outline-container-org01715b4" class="outline-5">
<h5 id="org01715b4"><span class="section-number-5">2.2.4.11.</span> ATAN2 函数</h5>
<div class="outline-text-5" id="text-2-2-4-11">
<p>
\[ ATAN2(x_num, y_num) \]
</p>

<ul class="org-ul">
<li>x<sub>num</sub>: 点的 x 座标</li>
<li>y<sub>num</sub>: 点的 y 座标</li>
</ul>


<p>
ATAN2 函数用于返回给定的 x 以及 y 坐标的反正切值.
</p>
<blockquote>
<p>
就是返回原点与(x,y)点的直线与 X 轴的夹角.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org7ee2a64">
=ATAN2(1,1)
原点(0,0) 到点(1,1) 的直线与 x 轴夹角为 45 度,返回的是 45 度角的弧度值.
</pre>
</div>
</div>

<div id="outline-container-org56c490c" class="outline-5">
<h5 id="org56c490c"><span class="section-number-5">2.2.4.12.</span> TANH 函数</h5>
<div class="outline-text-5" id="text-2-2-4-12">
<p>
\[ TANH(number) \]
</p>

<ul class="org-ul">
<li>number: 任意实数.</li>
</ul>


<p>
TANH 函数用于返回某一函数的双曲正切值.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgae67052">
=TANH(0)
0 的双曲正切值为0
</pre>
</div>
</div>


<div id="outline-container-org3a7c72a" class="outline-5">
<h5 id="org3a7c72a"><span class="section-number-5">2.2.4.13.</span> ATANH 函数</h5>
<div class="outline-text-5" id="text-2-2-4-13">
<p>
\[ ATANH(number) \]
</p>

<ul class="org-ul">
<li>number: -1~1 的任意实数.</li>
</ul>

<p>
ATANH 函数返回参数的反双曲正切值.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgd0d6896">
=ATANH(0)
0度角的反双曲正切值为0 返回值为 0度角的弧度值0.
</pre>
</div>
</div>

<div id="outline-container-org1138c92" class="outline-5">
<h5 id="org1138c92"><span class="section-number-5">2.2.4.14.</span> DEGREES 函数</h5>
<div class="outline-text-5" id="text-2-2-4-14">
<p>
\[ DEGREES(angle) \]
</p>

<ul class="org-ul">
<li>angle: 以弧度表示的角度值.</li>
</ul>


<p>
DEGREES 用于将弧度转换为角度.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org535a4b4">
=DEGREES(ACOS(-1))
180 度角的余弦值为 -1 因此 ACOS 返回 180 角的弧度值, DEGREES 将该弧度值转为角度值180.
</pre>
</div>
</div>

<div id="outline-container-org7041ec2" class="outline-5">
<h5 id="org7041ec2"><span class="section-number-5">2.2.4.15.</span> PI 函数</h5>
<div class="outline-text-5" id="text-2-2-4-15">
<p>
\[ PI() \]
</p>

<blockquote>
<p>
PI 函数没有参数,和 FALSE, TRUE, RAND 等参数一样.
</p>
</blockquote>

<p>
PI 函数用于返回数学常量 π, 精确到小数后 14 位.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org43dd114">
=45*PI()/180
将 45 度角转为弧度值.
</pre>
</div>
</div>
</div>

<div id="outline-container-org5c493f4" class="outline-4">
<h4 id="org5c493f4"><span class="section-number-4">2.2.5.</span> 对数,幂和阶乘函数</h4>
<div class="outline-text-4" id="text-2-2-5">
</div>
<div id="outline-container-orgf3e88fc" class="outline-5">
<h5 id="orgf3e88fc"><span class="section-number-5">2.2.5.1.</span> EXP 函数</h5>
<div class="outline-text-5" id="text-2-2-5-1">
<p>
\[ EXP(number) \]
</p>

<ul class="org-ul">
<li>number: 应用于底数 e 的指数.</li>
</ul>


<p>
EXP 函数用于返回 e 的 number 次幂. 常数 e 是自然对数的底数.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgd08a7d5">
=EXP(0)
e 的 0 次幂为 1
</pre>
</div>
</div>

<div id="outline-container-org7b336a2" class="outline-5">
<h5 id="org7b336a2"><span class="section-number-5">2.2.5.2.</span> POWER 函数</h5>
<div class="outline-text-5" id="text-2-2-5-2">
<p>
\[ POWER(number, power) \]
</p>

<ul class="org-ul">
<li>number: 底数,可以为任意实数.</li>
<li>power: 指数,底数按指数次幂乘方</li>
</ul>

<p>
POWER 函数用于返回给定数字的乘幂.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org1e69ec3">
=POWER(0.5, 2)
0.5 的平方,结果为 0.25
=POWER(4, 0.5)
4 的 0.5 次方,结果为 2
</pre>
</div>
</div>

<div id="outline-container-orgbdadbea" class="outline-5">
<h5 id="orgbdadbea"><span class="section-number-5">2.2.5.3.</span> LN 函数</h5>
<div class="outline-text-5" id="text-2-2-5-3">
<p>
\[ LN(number) \]
</p>

<ul class="org-ul">
<li>number: 想要计算其自然对数的正实数.</li>
</ul>


<p>
LN 函数返回一个数的自然对数,自然对数以常数 e 为底.
</p>
<blockquote>
<p>
LN(1) 就是 \(\ln_e^1\)
</p>
</blockquote>
<p>
使用示例:
</p>
<pre class="example" id="orga220357">
=LN(1)
e 的 0 次方为 1,所以结果为 0
</pre>
</div>
</div>

<div id="outline-container-org112eb70" class="outline-5">
<h5 id="org112eb70"><span class="section-number-5">2.2.5.4.</span> LOG 函数</h5>
<div class="outline-text-5" id="text-2-2-5-4">
<p>
\[ LOG(number, [base]) \]
</p>

<ul class="org-ul">
<li>number: 要计算其对数的正实数.</li>
<li>base: 对数的底数,省略底数则默认值为 10.</li>
</ul>


<p>
LOG 函数按指定的底数返回数的对数.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org1d2ea5d">
=LOG(2,2)
2 的 1 次幂为 2, 所以返回结果为 1
=LOG(1, EXP(1))
等价于 =LN(1) 返回结果 0
</pre>
</div>
</div>

<div id="outline-container-orgef808ec" class="outline-5">
<h5 id="orgef808ec"><span class="section-number-5">2.2.5.5.</span> LOG10 函数</h5>
<div class="outline-text-5" id="text-2-2-5-5">
<p>
\[ LOG10(number) \]
</p>

<ul class="org-ul">
<li>number: 要计算其常用对数的正实数,即真数.</li>
</ul>


<p>
LOG10 函数用于返回以 10 为底的对数.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org133a07c">
=LOG10(100)
10 的 2 次幂为 100 所以返回结果值为 2
=LOG10(10)
结果值为 1
</pre>
</div>
</div>

<div id="outline-container-orgacb0e3f" class="outline-5">
<h5 id="orgacb0e3f"><span class="section-number-5">2.2.5.6.</span> SERIESSUM 函数</h5>
<div class="outline-text-5" id="text-2-2-5-6">
<p>
\[ SERIESSUM(x, n, m, coefficients) \]
</p>

<ul class="org-ul">
<li>x: 幂级数的输入值.</li>
<li>n: x 的首项乘幂.</li>
<li>m: 级数中每一项的乘幂 n 的步长增加值.</li>
<li>coefficients: 一系列与 x 各级乘幂相乘的系数. coefficients 值的数目决定了幂级数
的项数.例如, coefficients 有 3 各值,则幂级数有 3 项.</li>
</ul>


<p>
SERIESSUM 函数返回基于公式的幂级数的和.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orge428e3e">
=SERIESSUM(1,1,0.5,{1,0.5,3})
</pre>
<p>
\(1*1^1 + 0.5*1^1.5 + 3*1^2 = 1+0.5+3 = 4.5\)
</p>
</div>
</div>

<div id="outline-container-org1bf4513" class="outline-5">
<h5 id="org1bf4513"><span class="section-number-5">2.2.5.7.</span> FACT 函数</h5>
<div class="outline-text-5" id="text-2-2-5-7">
<p>
\[ FACT(number) \]
</p>

<ul class="org-ul">
<li>number: 要计算其阶乘的非负数. 如果 number 不是整数,则截尾取整.</li>
</ul>


<p>
FACT 函数用于返回数字的阶乘.
</p>

<p>
\[ n! = 1 \times 2 \times 3 \cdots n\]
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgfa516ea">
=FACT(5)
1*2*3*4*5=120
</pre>
</div>
</div>

<div id="outline-container-orgb87197d" class="outline-5">
<h5 id="orgb87197d"><span class="section-number-5">2.2.5.8.</span> FACTDOUBLE 函数</h5>
<div class="outline-text-5" id="text-2-2-5-8">
<p>
\[ FACTDOUBLE(number) \]
</p>

<ul class="org-ul">
<li>number: 要计算其双倍阶乘的数值.</li>
</ul>


<p>
FACTDOUBLE 函数用于返回数字的双倍阶乘.
如果 number 为偶数则
\[ n!! = n(n-2)(n-4)\cdots(4)(2)\]
如果 number 为奇数则
\[ n!! = n(n-2)(n-4)\cdots(3)(1)\]
</p>

<p>
使用示例:
</p>
<pre class="example" id="org60a20c9">
=FACTDOUBLE(3)
3!!=3*1=3
=FACTDOUBLE(1.5)
1.5 非整数,直接截断为 1, 1!!=1
</pre>

<blockquote>
<p>
如果 FACTDOUBLE 参数为非数值类型, 返回错误值 "#VALUE!" ,如果参数为负数,则返回错
误值 "#NUM!"
</p>
</blockquote>
</div>
</div>
</div>
</div>

<div id="outline-container-orge534f32" class="outline-3">
<h3 id="orge534f32"><span class="section-number-3">2.3.</span> 文本函数(27)</h3>
<div class="outline-text-3" id="text-2-3">
</div>
<div id="outline-container-orgba5273b" class="outline-4">
<h4 id="orgba5273b"><span class="section-number-4">2.3.1.</span> 文本查找,提取</h4>
<div class="outline-text-4" id="text-2-3-1">
</div>
<div id="outline-container-orga3f9e41" class="outline-5">
<h5 id="orga3f9e41"><span class="section-number-5">2.3.1.1.</span> MID 函数(从任意位置提取指定数目的字符)</h5>
<div class="outline-text-5" id="text-2-3-1-1">
<p>
\[ MID(text,start_num,num_chars) \]
</p>

<ul class="org-ul">
<li>text: 要提取字符的文本字符串.</li>
<li>start<sub>num</sub>: 要提取的第一个字符的位置, text 中第一个字符为 1,依次类推.</li>
<li>num<sub>chars</sub>: 指定希望 MID 从文本中返回字符的个数.</li>
</ul>


<p>
MID 函数用于返回文本字符串中从指定位置开始的特定数目的字符.
</p>

<blockquote>
<p>
理解为从 text 中 start<sub>num</sub> 位置开始提取 num<sub>chars</sub> 个字符.
</p>
</blockquote>
<p>
使用示例:
</p>
<pre class="example" id="orgd0e70d1">
=VALUE(MID("LPE-W12-2.2cm", 9, 3))
MID 提取 2.2cm 中的 2.2 文本值, VALUE 将 "2.2" 转换成数值 2.2
=MID(A2,17,1)
假设 A2 为身份证号,提取第17位值, 该位表示性别,奇数为男,偶数为女
=IF(MOD(VALUE(A2,17,1),2)=1, "男", "女")
提取出的身份证第17位为奇数,则返回男,否则返回女.
</pre>
</div>
</div>

<div id="outline-container-orgbcd0186" class="outline-5">
<h5 id="orgbcd0186"><span class="section-number-5">2.3.1.2.</span> LEFT 函数(按指定字符数从最左侧提取字符串)</h5>
<div class="outline-text-5" id="text-2-3-1-2">
<p>
\[ LEFT(text, [num_chars]) \]
</p>

<ul class="org-ul">
<li>text: 包含要提取的字符串的文本字符串.</li>
<li>num<sub>chars</sub>: 要提取的字符数量.</li>
</ul>


<p>
LEFT 函数用于从文本左侧开始提取指定个数的字符.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orga817af5">
=LEFT("湖北-景泰广业",2)
从左侧提取字符串的前两个字符,这里返回 "湖北"
=IF(LEFT(A2,3)="打印机", C2+200，C2+100)
假设 A 列数据为"打印机H530","传真机HL40" 等数据,
C 列为售价,上面的公式会把打印机售价调高200,其他机器调高100
</pre>

<blockquote>
<p>
与 LEFT 类似的还有 LEFTB 函数,只不过 LEFTB 是以字节数计算的.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org3c0fedb" class="outline-5">
<h5 id="org3c0fedb"><span class="section-number-5">2.3.1.3.</span> RIGHT 函数(按指定字符数从最右侧提取字符串)</h5>
<div class="outline-text-5" id="text-2-3-1-3">
<p>
\[ RIGHT(text, [num_chars]) \]
</p>

<ul class="org-ul">
<li>text: 包含要提取的字符串的文本字符串.</li>
<li>num<sub>chars</sub>: 要提取的字符数量.</li>
</ul>


<p>
RIGHT 函数用于从文本右侧开始提取指定个数的字符.
</p>

<p>
使用示例:
</p>

<pre class="example" id="org4fd07c5">
=RIGHT("紫檀(印度)",4)
从最右侧开始提取 4 各字符,即 (印度)
</pre>

<blockquote>
<p>

</p>

<p>
与 RIGHT 类似的还有 RIGHTB 函数,只不过 RIGHTB 是以字节数计算的.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org5518f0c" class="outline-5">
<h5 id="org5518f0c"><span class="section-number-5">2.3.1.4.</span> SEARCH 函数(查找字符串的起始位置)</h5>
<div class="outline-text-5" id="text-2-3-1-4">
<p>
\[ SEARCH(find_text, within_test, [start_num]) \]
</p>

<ul class="org-ul">
<li>find<sub>text</sub> : 要查找的文本.</li>
<li>within<sub>text</sub>: 要在其中搜索 find<sub>text</sub> 的文本.</li>
<li>start<sub>num</sub>: 从 within<sub>text</sub> 中开始搜索的字符编号.</li>
</ul>


<p>
SEARCH 函数在第二个参数 within<sub>text</sub> 中从 start<sub>num</sub> 开始查找 find<sub>text</sub> 字符串,然
后返回 find<sub>text</sub> 字符串的第一个字符位于 within<sub>text</sub> 中的位置.
</p>

<blockquote>
<p>
SEARCH 函数支持通配符.且不区分大小写.
和 SEARCH 函数类似的是 FIND 函数,但 FIND 不支持通配符,且区分大小写.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="orgeb3b3ab">
=SEARCH("VO?", "12Voabc", 2)
从 "12Voabc" 的第二个字符开始查找以 VO 开头的三个字符组成的字符串,这里会找到 Voa,
因为 SEARCH 不区分大小写,然后返回其在 "12VOabc" 中的起始位置,即3,所以返回结果为3.
</pre>

<blockquote>
<p>
与 SEARCH 函数类似的还有 SEARCHB 函数,但 SEARCHB 是按照字节计算的,按字节计算对于
非中文的字符串而言与 SEARCH 没有区别,因为数字/字母在字符串中一个字符只占一个字节,但
是中文字符在字符串中一个字符占用两个字节.
以上面的例子为例:
=SEARCH("VO?", "12Voabc", 2) 结果为3
=SEARCHB("VO?", "12Voabc", 2) 结果也为3
=SEARCH("VO?", "你Voabc", 1) 结果为2
=SEARCHB("VO?", "你Voabc", 1) 结果为3,因为 "你"这一个字符占 2 各字节.
</p>
</blockquote>
</div>
</div>
</div>


<div id="outline-container-org624e497" class="outline-4">
<h4 id="org624e497"><span class="section-number-4">2.3.2.</span> 文本替换</h4>
<div class="outline-text-4" id="text-2-3-2">
</div>
<div id="outline-container-orgff942d2" class="outline-5">
<h5 id="orgff942d2"><span class="section-number-5">2.3.2.1.</span> REPLACE 函数(替换文本字符串的部分文本)</h5>
<div class="outline-text-5" id="text-2-3-2-1">
<p>
\[ REPLACE(old_text, start_num, num_chars, new_text) \]
</p>

<ul class="org-ul">
<li>old<sub>text</sub>: 要替换其部分字符的文本.</li>
<li>start<sub>num</sub>: 要用 new<sub>text</sub> 替换的字符位于 old<sub>text</sub> 中的位置.</li>
<li>num<sub>chars</sub>: 希望用 new<sub>text</sub> 替换 old<sub>text</sub> 中的字符的个数.</li>
<li>new<sub>text</sub>: 表示将用于替换 old<sub>text</sub> 中的文本.</li>
</ul>

<blockquote>
<p>
理解就是将 old<sub>text</sub> 中第 start<sub>num</sub> 个字符开始的 num<sub>chars</sub> 个字符用 new<sub>text</sub> 替换.
</p>
</blockquote>
<p>
REPLACE 使用其他文本字符串并根据所指定的字符数替换文本字符串中的部分文本.
</p>

<blockquote>
<p>
无论是什么语言, REPLACE 函数始终将每个字符按 1 计数,就是对于 replace 函数来说
"ab" 计数为 2, "一二" 的计数也为2,尽管中文字符占2各字节.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org0cb0840">
=REPLACE("12345678901", 8, 4, "****")
将 "12345678901" 第8个字符开始的4个字符用 "****" 替换.即将 "8901" 用 "****" 替换.
结果为 1234567****
=REPLACE("1300_780便携14寸",5,1,"*")
将 "1300_780便携14寸" 中的 "_" 替换成 "*"
</pre>
</div>
</div>

<div id="outline-container-orga5a75e3" class="outline-5">
<h5 id="orga5a75e3"><span class="section-number-5">2.3.2.2.</span> SUBSTITUTE 函数(用新文本替换旧文本)</h5>
<div class="outline-text-5" id="text-2-3-2-2">
<p>
\[ SUBSTITUTE(text, old_text, new_text, instance_num) \]
</p>

<ul class="org-ul">
<li>text: 需要替换其中文本的字符串或是含有文本的单元格引用.</li>
<li>old<sub>text</sub>: 要替换的旧文本.</li>
<li>new<sub>text</sub>: 用于替换 old<sub>text</sub> 的新文本.</li>
<li>instance<sub>num</sub>: 指定 new<sub>text</sub> 替换 old<sub>text</sub> 出现在 text 中的次数,如果指定了该参
数,则只替换符合条件的 old<sub>text</sub>, 没指定则替换所有 old<sub>text</sub>.</li>
</ul>


<p>
SUBSTITUTE 函数用于在文本字符串中用新文本替代旧文本.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgb75288e">
=SUBSTITUTE("不  得 无   故 矿工"," ","")
旧文本为空格字符串,新文本为空内容,这个公式作用为删除 text 中的空格.
=LEN("a,b,c,d")-LEN(SUBSTITUTE("a,b,c,d", ",", ""))
通过将字符串中的逗号删除,然后通过前后字符串的长度差来得出逗号在字符串中出现的个数.
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfa1a366" class="outline-4">
<h4 id="orgfa1a366"><span class="section-number-4">2.3.3.</span> 文本格式转换</h4>
<div class="outline-text-4" id="text-2-3-3">
</div>
<div id="outline-container-org59782c9" class="outline-5">
<h5 id="org59782c9"><span class="section-number-5">2.3.3.1.</span> ASC 函数(将全角字符转换为半角字符)</h5>
<div class="outline-text-5" id="text-2-3-3-1">
<p>
\[ ASC(text) \]
</p>

<ul class="org-ul">
<li>text : 文本或包含文本的单元格引用,如果数据中不包含任何全角字符,则不会有任何改
变.</li>
</ul>


<p>
ASC 函数将全角(双字节)字符转换成半角(单字节)字符
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgd1992cc">
=ASC("中文句号。")
"。" 是全角字符,"." 是半角字符,结果为 "中文句号." 仅仅转换了标点
</pre>
</div>
</div>

<div id="outline-container-org978becf" class="outline-5">
<h5 id="org978becf"><span class="section-number-5">2.3.3.2.</span> WIDECHAR 函数(将半角字符转换为全角字符)</h5>
<div class="outline-text-5" id="text-2-3-3-2">
<p>
\[ WIDECHAR(text) \]
</p>

<ul class="org-ul">
<li>text : 文本或包含文本的单元格引用,如果数据中不包含任何半角字符,则不会有任何改
变.</li>
</ul>


<p>
WIDECHAR 函数将半角(单字节)字符转换成全角(双字节)字符
</p>


<p>
使用示例:
</p>
<pre class="example" id="org6871d39">
=WIDECHAR("中文句号.")
"。" 是全角字符,"." 是半角字符,结果为 "中文句号。" 仅仅转换了标点
</pre>
</div>
</div>

<div id="outline-container-org9c87d39" class="outline-5">
<h5 id="org9c87d39"><span class="section-number-5">2.3.3.3.</span> LOWER 函数(将文本转为小写形式)</h5>
<div class="outline-text-5" id="text-2-3-3-3">
<p>
\[ LOWER(text) \]
</p>

<ul class="org-ul">
<li>text: 表示要转换成小写字母的文本, LOWER 函数不会改变文本中的非字母的字符.</li>
</ul>


<p>
LOWER 函数将一个文本字符串中的所有大写字母转换为小写字母.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org631dd9d">
=LOWER("Chinese:中文")
结果返回 chinese:中文
</pre>
</div>
</div>

<div id="outline-container-org25e71aa" class="outline-5">
<h5 id="org25e71aa"><span class="section-number-5">2.3.3.4.</span> UPPER 函数(将文本转为大写形式)</h5>
<div class="outline-text-5" id="text-2-3-3-4">
<p>
\[ UPPER(text) \]
</p>

<ul class="org-ul">
<li>text: 表示要转换成大写字母的文本, UPPER 函数不会改变文本中的非字母的字符.</li>
</ul>


<p>
UPPER 函数将一个文本字符串中的所有小写字母转换为大写字母.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgd503064">
=UPPER("Chinese:中文")
结果返回 CHINESE:中文
</pre>
</div>
</div>

<div id="outline-container-orgc7a977f" class="outline-5">
<h5 id="orgc7a977f"><span class="section-number-5">2.3.3.5.</span> PROPER(将文本字符串的首字母转为大写)</h5>
<div class="outline-text-5" id="text-2-3-3-5">
<p>
\[ PROPER(text) \]
</p>

<ul class="org-ul">
<li>text : 要将首字母大写的文本</li>
</ul>


<p>
PROPER  函数将文本字符串的首字母大写
</p>

<p>
使用示例:
</p>
<pre class="example" id="org8e0c858">
=PROPER("chinese")
返回 Chinese
</pre>
</div>
</div>

<div id="outline-container-orga0f95f8" class="outline-5">
<h5 id="orga0f95f8"><span class="section-number-5">2.3.3.6.</span> DOLLAR 函数(四舍五入数值,并添加千分位符和 $ 符号)</h5>
<div class="outline-text-5" id="text-2-3-3-6">
<p>
\[ DOLLAR(number, [decimals]) \]
</p>

<ul class="org-ul">
<li>number: 数值.</li>
<li>decimals: 十进制小数位数. 如果 decimals 为负数,则 number 在小数点左侧进行舍入,
如果省略 decimals, 则默认为 2.</li>
</ul>


<p>
DOLLAR 函数按照货币格式,将小数四舍五入到指定位数并转换成美元货币格式的文本,使用
的格式为 "(\(#,##0.00_);(\)#,##0.00)"
</p>

<blockquote>
<p>
根据 DOLLOR 函数的格式可以用 TEXT 函数实现相同功能,例如
TEXT(10000.123, "$#,##0.00")  与 DOLLOR(10000.123) 效果一样.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org36605e8">
=DOLLOR(4598)
返回文本值 "$4,598.00"
</pre>
</div>
</div>

<div id="outline-container-org68a6076" class="outline-5">
<h5 id="org68a6076"><span class="section-number-5">2.3.3.7.</span> RMB 函数(四舍五入数值,并添加千分位符号和¥符号)</h5>
<div class="outline-text-5" id="text-2-3-3-7">
<p>
\[ RMB(number, [decimals]) \]
</p>

<ul class="org-ul">
<li>number: 数值.</li>
<li>decimals: 十进制小数位数. 如果 decimals 为负数,则 number 在小数点左侧进行舍入,
如果省略 decimals, 则默认为 2.</li>
</ul>


<p>
RMB 函数按照货币格式将小数四舍五入到指定位数并转换成文本. 使用的格式为
"(¥#,##0.00_);(¥#,##0.00)"
</p>

<blockquote>
<p>
RMB 函数也可以根据其格式用相应的 TEXT 函数实现 TEXT(123,"¥#,##0.00")
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="orgc53c1c4">
=RMB(9000)
等价于 =TEXT(9000,"¥#,##0.00") 结果为 "¥9,000.00"
</pre>
</div>
</div>

<div id="outline-container-org65a3d33" class="outline-5">
<h5 id="org65a3d33"><span class="section-number-5">2.3.3.8.</span> BAHTTEXT 函数(将数字转为泰铢)</h5>
<div class="outline-text-5" id="text-2-3-3-8">
<p>
\[ BAHTTEXT(number) \]
</p>

<ul class="org-ul">
<li>number: 数值.</li>
</ul>


<p>
BAHTTEXT 函数将数字转换为泰语文本并添加后缀"泰铢"(泰语形式)
</p>

<p>
使用示例:
</p>
<pre class="example" id="org4a9e5d9">
=BAHTTEXT(1000)
我不懂泰语,直接把运行结果粘贴: "หนึ่งพันบาทถ้วน"
</pre>
</div>
</div>

<div id="outline-container-orgd51b152" class="outline-5">
<h5 id="orgd51b152"><span class="section-number-5">2.3.3.9.</span> FIXED 函数(将数字显示千分位符样式并转为文本)</h5>
<div class="outline-text-5" id="text-2-3-3-9">
<p>
\[ FIXED(number, decimals, no_commas) \]
</p>

<ul class="org-ul">
<li>number: 数值.</li>
<li>decimals: 十进制数的小数位数.</li>
<li>no<sub>commas</sub>: 一个逻辑值(TRUE/FALSE) 如果为 TRUE, 则禁止 FIXED 返回的文本中包含逗
号.</li>
</ul>


<p>
FIXED 函数将数字按照指定的小数位数进行舍入,利用句号和逗号,以小数格式对该数值进行
格式设置,以文本格式返回结果.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgec08d9a">
=FIXED(1000,2,1)
保留两位小数,不使用逗号那么转换的结果为 1000.00
=FIXED(1000,2)
保留两位小数,使用逗号那么转换的结果为 1,000.00
</pre>

<blockquote>
<p>
这里和作者书中的内容不一致,因为在我的 Excel 2016 里面,省略 no<sub>commas</sub> 则默认该值
为 FALSE, 结果会带上逗号, 但是作者书中也省略了,结果却没有逗号.可能是版本不同,也
可能是有错误,真实使用以实际为主.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org4d64d7b" class="outline-5">
<h5 id="org4d64d7b"><span class="section-number-5">2.3.3.10.</span> TEXT 函数(设置数字格式并将其转为文本)</h5>
<div class="outline-text-5" id="text-2-3-3-10">
<p>
\[ TEXT(value,format_text) \]
</p>

<ul class="org-ul">
<li>value: 数值.</li>
<li>format<sub>text</sub>: 字符串表示的数字格式. 通过 "设置单元格"-"数字"-"类别" 中的众多选
项可以查看各种数字格式的格式字符串样式.</li>
</ul>


<p>
TEXT 函数将数值转换乘按照指定格式表示的文本.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgf08d36f">
=TEXT(10000.123, "$#,##0.00")
等价于 =DOLLAR(10000.123)
=TEXT(9000,"¥#,##0.00")
等价于 =RMB(9000)
=TEXT(101,"000000")
将数值按固定位数显示,不足用0补齐,结果为 "000101"
</pre>

<blockquote>
<p>
格式字符串中, 0和#都表示占位符,不同的是0表示位数不足用0补齐,而 # 则是位数不够就
不用管了.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orgcaa4791" class="outline-5">
<h5 id="orgcaa4791"><span class="section-number-5">2.3.3.11.</span> VALUE 函数(将文本数字转换成数值)</h5>
<div class="outline-text-5" id="text-2-3-3-11">
<p>
\[ VALUE(text) \]
</p>

<ul class="org-ul">
<li>text: 文本值,文本内容需要是能转换乘数值的内容,如 "123" 否则,就会返回错误值
"#VALUE!" ,例如 VALUE("a").</li>
</ul>


<p>
VALUE 函数将代表数字的文本字符串转换成数值.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgdabae7a">
=VALUE("23450")
结果为 23450
</pre>
</div>
</div>

<div id="outline-container-org7bfcafc" class="outline-5">
<h5 id="org7bfcafc"><span class="section-number-5">2.3.3.12.</span> CHAR 函数</h5>
<div class="outline-text-5" id="text-2-3-3-12">
<p>
\[ CHAR(number) \]
</p>

<ul class="org-ul">
<li>number: 必需,表示1-255 用于指定所需字符的数字. 字符是计算机所用字符集中的字符.</li>
</ul>


<p>
CHAR 函数用于返回对应于数字代码的字符. CHAR 可以将其他类型的计算机文件中的代码转
换成字符.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org89d13d2">
=CHAR(100)
在我自己计算机上返回的是字母 "d",
</pre>
</div>
</div>

<div id="outline-container-org060e6b5" class="outline-5">
<h5 id="org060e6b5"><span class="section-number-5">2.3.3.13.</span> CODE 函数</h5>
<div class="outline-text-5" id="text-2-3-3-13">
<p>
\[ CODE(text) \]
</p>

<ul class="org-ul">
<li>text: 必需,表示需要得到其第一个字符代码的文本.</li>
</ul>


<p>
CODE 函数用于返回文本字符串中第一个字符的数字代码,返回的代码对应计算机当前使用的
字符集.
</p>
<blockquote>
<p>
CODE 函数和 CHAR 函数是相反的过程,一个根据字符得到数字代码,一个根据数字代码得到
字符.
</p>
</blockquote>
<p>
使用示例:
</p>
<pre class="example" id="org3d8ed73">
=CODE("d")
返回数字代码 100
</pre>
</div>
</div>

<div id="outline-container-org52c7bd0" class="outline-5">
<h5 id="org52c7bd0"><span class="section-number-5">2.3.3.14.</span> UNICHAR 函数</h5>
<div class="outline-text-5" id="text-2-3-3-14">
<p>
\[UNICHAR(number)\]
</p>

<ul class="org-ul">
<li>number: 必需, 表示代表字符的 Unicode 数字. 当 Unicode 数字为部分代理项且数据类
型无效时, UNICHAR 返回错误值 "#N/A" 当数字的数值超过允许范围或数字为0 时,
UNICHAR 返回错误值 "#VALUE!"</li>
</ul>


<p>
UNICHAR 函数用于返回给定数值对应的 Unicode 字符. 返回的 Unicode 字符可以是一个字
符串,如以 UTF-8 或 UTF-16 编码的字符串.
</p>

<blockquote>
<p>
CODE 和 CHAR 都是返回执行函数的计算机本机上面的字符与数字代码的对应结果,而
UNICHAR 则是返回一个统一标准的 Unicode 的数字代码与字符的对应结果.也就是说, CODE
和 CHAR 在不同计算机上得出的结果可能不同,但是 Unicode 的计算结果一定相同.
</p>

<p>
Unicode 还可以表示表情之类的特殊字符,这种字符是不被 EXCEL 支持的,所以是无效类型.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="orgbc1d132">
=UNICHAR(100)
返回 Unicode 字符集中 100 对应的字符,结果为 "d"
</pre>
</div>
</div>
</div>

<div id="outline-container-org49d591f" class="outline-4">
<h4 id="org49d591f"><span class="section-number-4">2.3.4.</span> 其他文本函数</h4>
<div class="outline-text-4" id="text-2-3-4">
</div>
<div id="outline-container-orgff0277f" class="outline-5">
<h5 id="orgff0277f"><span class="section-number-5">2.3.4.1.</span> CONCATENATE 函数(合并多个文本字符串)</h5>
<div class="outline-text-5" id="text-2-3-4-1">
<p>
*
*\[ CONCATENATE(text1,[text2],\codts) \]
</p>
<p>
*
*+ text1 : 要合并的第一个文本值.
*+ \(text2,\dots\) : 要合并的剩余文本值,总共最多为 255 项.
</p>
<p>
*
</p>
<p>
*
*CONCATENATE 函数可将最多 255 各文本字符串连接成一个文本字符串,连接项可以是文本,
*数值,单元格引用.
</p>
<p>
*
*#+begin<sub>quote</sub>
*CONCATENATE 函数会自动将其他类型数据转为文本类型,并进行合并,其作用和文本连接符号
*"&amp;" 的作用是一样的.
*#+end<sub>quote</sub>
</p>
<p>
*
*使用示例:
*#+begin<sub>example</sub>
*=CONCATENATE("销售","1组")
*等价于 ="销售"&amp;"1组" 结果为 "销售1组"
*#+end<sub>example</sub>
</p>
<p>
*
</p>
</div>
</div>
<div id="outline-container-org87c3d87" class="outline-5">
<h5 id="org87c3d87"><span class="section-number-5">2.3.4.2.</span> LEN 函数(返回文本字符串的字符数量)</h5>
<div class="outline-text-5" id="text-2-3-4-2">
<p>
*
*\[LEN(text)\]
</p>
<p>
*
*+ text: 需要查找长度的文本.
</p>
<p>
*
</p>
<p>
*
*LEN 函数用于返回文本字符串中字符的数量
</p>
<p>
*
*使用示例:
*#+begin<sub>example</sub>
*=IF(LEN("123123123123")=11,"","ERROR")
*检查字符是否是 11 位的.类似还可以检查身份证号码是否为 18位的.
*#+end<sub>example</sub>
</p>
<p>
*
</p>
</div>
</div>
<div id="outline-container-org37ffb4d" class="outline-5">
<h5 id="org37ffb4d"><span class="section-number-5">2.3.4.3.</span> EXACT 函数(比较两个字符串是否完全相同)</h5>
<div class="outline-text-5" id="text-2-3-4-3">
<p>
*
*\[EXACT(text1,text2)\]
</p>
<p>
*
*+ text1: 第一个文本字符串.
*+ text2: 第二个文本字符串.
</p>
<p>
*
</p>
<p>
*
*EXACT 函数用于比较两个字符串,如果完全相同,则返回 TRUE, 否则返回 FALSE. EXACT 区
*分大小写,但是忽略格式上的差异.
</p>
<p>
*
*#+begin<sub>quote</sub>
*对于非文本类型的参数,会自动转换成文本类型. 格式上的差异指得应该是显示上的差异,例
*如文本颜色,字体之类的.
</p>
<p>
*
*大概等价于 =text1=text2, 考虑到数据类型转化的问题,应该是等价于
*=TEXT(text1,format)=TEXT(text2,format) ,其中的 format 应该为固定格式.
*#+end<sub>quote</sub>
</p>
<p>
*
*使用示例:
*#+begin<sub>example</sub>
*=EXACT(1,1)
*返回 TRUE
*=EXACT(125,"125")
*返回 TRUE
*#+end<sub>example</sub>
</p>
<p>
*
</p>
</div>
</div>
<div id="outline-container-org43129ff" class="outline-5">
<h5 id="org43129ff"><span class="section-number-5">2.3.4.4.</span> REPT 函数(按照指定次数重复文本)</h5>
<div class="outline-text-5" id="text-2-3-4-4">
<p>
*
*\[ REPT(text, number_times) \]
</p>
<p>
*
*+ text: 要重复的文本.
*+ number<sub>times</sub>: 要重复的次数.
</p>
<p>
*
</p>
<p>
*
*REPT 函数返回文本按照给定的次数重复后的文本.
</p>
<p>
*
*使用示例:
*#+begin<sub>example</sub>
*=REPT("□",18)
*用于将方框重复 18 次,便于身份证号的填写.
*#+end<sub>example</sub>
</p>
<p>
*
</p>
</div>
</div>
<div id="outline-container-orgb480394" class="outline-5">
<h5 id="orgb480394"><span class="section-number-5">2.3.4.5.</span> TRIM 函数</h5>
<div class="outline-text-5" id="text-2-3-4-5">
<p>
*
*\[TRIM(text)\]
</p>
<p>
*
*+ text: 需要删除空格的文本.
</p>
<p>
*
</p>
<p>
*
*TRIM 函数用来删除字符串前后的空格,中间的空格也会删除,但是会保留一个空格作为连接/
*分隔用途.
</p>
<p>
*
*使用示例:
*#+begin<sub>example</sub>
*=TRIM("   123   123  1   ")
*文本前后的空格会都被删除,中间的空格会保留一个,所以结果是 "123 123 1"
*#+end<sub>example</sub>
</p>
<p>
*
</p>
</div>
</div>
<div id="outline-container-org0545eda" class="outline-5">
<h5 id="org0545eda"><span class="section-number-5">2.3.4.6.</span> CLEAN 函数(删除文本中不能打印的字符)</h5>
<div class="outline-text-5" id="text-2-3-4-6">
<p>
*
*\[CLEAN(text)\]
*+ text: 表示要删除非打印字符的任何工作表信息.
</p>
<p>
*
</p>
<p>
*
*CLEAN 函数用于删除文本中不能打印的字符. 对于从其他程序中输入的文本数据,可以使用
*CLEAN 函数删除其中含有的当前操作系统无法打印的字符.
</p>
<p>
*
*#+begin<sub>quote</sub>
*&lt;30天精学EXCEL&gt; 书中就有一个案例是这种的,从 ERP/数据库 软件中导入的数据有部分是
*EXCEL 无法显示的,所以表现为空格,但这个空格不是真的空格,是无法显示所以表现的和空
*格一样,当时的做法是复制该特殊字符,用数据分列的方式将其删除的.
*#+end<sub>quote</sub>
</p>
<p>
*
*使用示例:
*#+begin<sub>example</sub>
*=CLEAN("12
*123")
*会删除文本中的换行符号,得到结果 "12123"
*#+end<sub>example</sub>
</p>
<p>
*
</p>
</div>
</div>
<div id="outline-container-orgcf4ba3e" class="outline-5">
<h5 id="orgcf4ba3e"><span class="section-number-5">2.3.4.7.</span> T 函数</h5>
<div class="outline-text-5" id="text-2-3-4-7">
<p>
*
*\[ T(value) \]
</p>
<p>
*
*+ value: 有返回值的表达式.
</p>
<p>
*
</p>
<p>
*
*T 函数检测参数值是否为文本,如果是则原样返回,不是则返回空文本("").
</p>
<p>
*
*使用示例:
*#+begin<sub>example</sub>
*=IF(T(123)="","不是文本","是文本")
*如果 T(123) 等于空文本,则返回 "不是文本",否则返回 "是文本", 因为 123 不是文本数据,所以
*T(123) 返回空文本,所以整个表达式返回 "不是文本".
*#+end<sub>example</sub>
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org028c096" class="outline-3">
<h3 id="org028c096"><span class="section-number-3">2.4.</span> 信息函数(20)</h3>
<div class="outline-text-3" id="text-2-4">
</div>
<div id="outline-container-org3e64dd8" class="outline-4">
<h4 id="org3e64dd8"><span class="section-number-4">2.4.1.</span> 返回信息以及各类型的值</h4>
<div class="outline-text-4" id="text-2-4-1">
</div>
<div id="outline-container-org5fc6ecb" class="outline-5">
<h5 id="org5fc6ecb"><span class="section-number-5">2.4.1.1.</span> CELL 函数(返回有关单元格格式,位置或内容的信息)</h5>
<div class="outline-text-5" id="text-2-4-1-1">
<p>
\[ CELL(info_type, [reference]) \]
</p>

<ul class="org-ul">
<li>info<sub>type</sub>: 表示一个文本值,指定要返回的单元格信息类型.</li>
<li>reference: 表示需要其相关信息的单元格.</li>
</ul>


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 4:</span> info<sub>type</sub> 参数对应的信息类型</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">“address”</td>
<td class="org-left">引用中第一个单元格的引用，文本类型。</td>
</tr>

<tr>
<td class="org-left">“col”</td>
<td class="org-left">引用中单元格的列标。</td>
</tr>

<tr>
<td class="org-left">“color”</td>
<td class="org-left">如果单元格中的负值以不同颜色显示，则为值 1；否则，返回 0（零）。</td>
</tr>

<tr>
<td class="org-left">"contents"</td>
<td class="org-left">引用中左上角单元格的值：不是公式。</td>
</tr>

<tr>
<td class="org-left">"filename"</td>
<td class="org-left">包含引用的文件名（包括全部路径），文本类型。 如果包含目标引用的工作表尚未保存，则返回空文本 ("")。</td>
</tr>

<tr>
<td class="org-left">“format”</td>
<td class="org-left">对应于单元格数字格式的文本值。 下表显示了各种格式的文本值。 如果单元格为负值设置颜色格式，则返回文本值末尾的"-"。 如果单元格 () 正值或所有值的括号，则返回文本值末尾的" () "。</td>
</tr>

<tr>
<td class="org-left">“parentheses”</td>
<td class="org-left">如果单元格中为正值或所有单元格均加括号，则为值 1；否则返回 0。</td>
</tr>

<tr>
<td class="org-left">“prefix”</td>
<td class="org-left">与单元格中的“前置标签”相对应的文本值。 如果单元格文本左对齐，则返回单引号 (')；如果单元格文本右对齐，则返回双引号 (")；如果单元格文本居中，则返回插入字符 (^)；如果单元格文本两端对齐，则返回反斜线 (\)；如果是其他情况，则返回空文本 ("")。</td>
</tr>

<tr>
<td class="org-left">“protect”</td>
<td class="org-left">如果单元格没有锁定，则为值 0；如果单元格锁定，则返回 1。</td>
</tr>

<tr>
<td class="org-left">“row”</td>
<td class="org-left">引用中单元格的行号。</td>
</tr>

<tr>
<td class="org-left">“type”</td>
<td class="org-left">对应于单元格中数据类型的文本值。 如果单元格为空，则返回"b"表示空白;如果单元格包含文本常量，则返回"l"表示标签;如果单元格包含任何其他内容，则返回"v"作为值。</td>
</tr>

<tr>
<td class="org-left">“width”</td>
<td class="org-left">返回包含 2 个项的数组。 数组的第一项是单元格的列宽，四舍五入为整数。 列宽以默认字号的一个字符的宽度为单位。 数组的第二项是布尔值，如果列宽为默认值，则值为 TRUE;如果用户显式设置了宽度，则值为 FALSE。</td>
</tr>
</tbody>
</table>

<p>
当 info<sub>type</sub> 为 format ,且引用内容为内置数字格式的单元格时,函数 CELL 返回的文本
值:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">如果 Excel 的格式为</td>
<td class="org-left">CELL 函数返回值</td>
</tr>

<tr>
<td class="org-left">常规</td>
<td class="org-left">“G”</td>
</tr>

<tr>
<td class="org-left">0</td>
<td class="org-left">“F0”</td>
</tr>

<tr>
<td class="org-left">#,##0</td>
<td class="org-left">“,0”</td>
</tr>

<tr>
<td class="org-left">0.00</td>
<td class="org-left">“F2”</td>
</tr>

<tr>
<td class="org-left">#,##0.00</td>
<td class="org-left">“,2”</td>
</tr>

<tr>
<td class="org-left">\(#,##0_);(\)#,##0)</td>
<td class="org-left">“C0”</td>
</tr>

<tr>
<td class="org-left">\(#,##0_);[Red](\)#,##0)</td>
<td class="org-left">“C0-”</td>
</tr>

<tr>
<td class="org-left">\(#,##0.00_);(\)#,##0.00)</td>
<td class="org-left">“C2”</td>
</tr>

<tr>
<td class="org-left">\(#,##0.00_);[Red](\)#,##0.00)</td>
<td class="org-left">“C2-”</td>
</tr>

<tr>
<td class="org-left">0%</td>
<td class="org-left">“P0”</td>
</tr>

<tr>
<td class="org-left">0.00%</td>
<td class="org-left">“P2”</td>
</tr>

<tr>
<td class="org-left">0.00E+00</td>
<td class="org-left">“S2”</td>
</tr>

<tr>
<td class="org-left"># ?/? 或 # ??/??</td>
<td class="org-left">“G”</td>
</tr>

<tr>
<td class="org-left">yy-m-d 或 yy-m-d h:mm 或 dd-mm-yy</td>
<td class="org-left">“D4”</td>
</tr>

<tr>
<td class="org-left">d-mmm-yy 或 dd-mmm-yy</td>
<td class="org-left">“D1”</td>
</tr>

<tr>
<td class="org-left">d-mmm 或 dd-mmm</td>
<td class="org-left">“D2”</td>
</tr>

<tr>
<td class="org-left">mmm-yy</td>
<td class="org-left">“D3”</td>
</tr>

<tr>
<td class="org-left">mm/dd</td>
<td class="org-left">“D5”</td>
</tr>

<tr>
<td class="org-left">h:mm AM/PM</td>
<td class="org-left">“D7”</td>
</tr>

<tr>
<td class="org-left">h:mm:ss AM/PM</td>
<td class="org-left">“D6”</td>
</tr>

<tr>
<td class="org-left">h:mm</td>
<td class="org-left">“D9”</td>
</tr>

<tr>
<td class="org-left">h:mm:ss</td>
<td class="org-left">“D8”</td>
</tr>
</tbody>
</table>

<p>
使用示例:
</p>
<pre class="example" id="orgb3e16f1">
=CELL("filename")
返回工作簿的完整路径
=IF(CELL("width",A1)=15,"标准宽度","非标准宽度")
</pre>
</div>
</div>
<div id="outline-container-org979c7da" class="outline-5">
<h5 id="org979c7da"><span class="section-number-5">2.4.1.2.</span> TYPE 函数(返回单元格内的数值类型)</h5>
<div class="outline-text-5" id="text-2-4-1-2">
<p>
\[ TYPE(value) \]
</p>

<ul class="org-ul">
<li>value: ,任意 Excel 支持的值.</li>
</ul>


<p>
TYPE 函数用于返回数值的类型.返回的是数据类型的数字代号
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 5:</span> 数据类型对应的数值代号</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">value 类型</td>
<td class="org-right">类型数值代号</td>
</tr>

<tr>
<td class="org-left">数值</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-left">文本</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-left">逻辑值</td>
<td class="org-right">4</td>
</tr>

<tr>
<td class="org-left">误差值(错误值)</td>
<td class="org-right">16</td>
</tr>

<tr>
<td class="org-left">数组</td>
<td class="org-right">64</td>
</tr>
</tbody>
</table>

<p>
使用示例:
</p>
<pre class="example" id="org361fd89">
=TYPE(1)
返回代号1
=TYPE("ab")
返回代号2
</pre>
</div>
</div>

<div id="outline-container-orge75dba0" class="outline-5">
<h5 id="orge75dba0"><span class="section-number-5">2.4.1.3.</span> N 函数(将数据转换成数值并返回)</h5>
<div class="outline-text-5" id="text-2-4-1-3">
<p>
\[ N(value) \]
</p>

<ul class="org-ul">
<li>value: 可以是任意 Excel 支持的值.</li>
</ul>

<p>
N 函数用于返回转换为数值后的值
</p>

<blockquote>
<p>
N 函数主要用途是将不是数值形式的(数)值转换成数值形式,例如逻辑值 TRUE 和 FALSE 就
是特殊的数值,日期/时间也是特殊的数值.
</p>

<p>
而文本值会被转换成数值 0.这一点与 VALUE 函数不一样, VALUE 会将数字形式的文本值转
换成对应数字.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="orgeac0d79">
=N("")
转换文本值,返回数值 0.
=N("无")
转换文本值,返回数值 0.
=N(B2)
B2 为日期 2023/7/22 转为对应数值 45129
</pre>
</div>
</div>

<div id="outline-container-org68d6fd5" class="outline-5">
<h5 id="org68d6fd5"><span class="section-number-5">2.4.1.4.</span> NA 函数(返回错误值 #N/A)</h5>
<div class="outline-text-5" id="text-2-4-1-4">
<p>
\[ NA() \]
</p>

<p>
NA 函数没有参数,只要用公式 =NA() 就返回错误值 "#N/A", "#N/A" 表示没有有效值.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgd19becb">
=NA()
结果为 #N/A
</pre>
</div>
</div>

<div id="outline-container-orgb2006c6" class="outline-5">
<h5 id="orgb2006c6"><span class="section-number-5">2.4.1.5.</span> INFO 函数(返回当前操作环境的信息)</h5>
<div class="outline-text-5" id="text-2-4-1-5">
<p>
\[ INFO(type_text) \]
</p>

<ul class="org-ul">
<li>type<sub>text</sub> : 表示用于指定要返回的信息类型的文本.</li>
</ul>


<p>
INFO 函数用于返回有关当前操作环境的信息
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 6:</span> type<sub>text</sub> 信息类型对应的信息</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">type<sub>text</sub></td>
<td class="org-left">信息</td>
</tr>

<tr>
<td class="org-left">"directory"</td>
<td class="org-left">当前目录或文件夹的路径</td>
</tr>

<tr>
<td class="org-left">"numfile"</td>
<td class="org-left">打开的工作簿中活动工作表的数目</td>
</tr>

<tr>
<td class="org-left">"origin"</td>
<td class="org-left">以当前位置为基准,返回窗口中可见的左上角单元格的绝对单元格引用,如 "$A:$A$84"</td>
</tr>

<tr>
<td class="org-left">"osversion"</td>
<td class="org-left">当前操作系统的版本号,(文本值)</td>
</tr>

<tr>
<td class="org-left">"recalc"</td>
<td class="org-left">当前的重新计算模式,返回 "手动" 或 "自动"</td>
</tr>

<tr>
<td class="org-left">"release"</td>
<td class="org-left">Excel 的版本号(文本值)</td>
</tr>

<tr>
<td class="org-left">"system"</td>
<td class="org-left">返回操作系统的名称,mac 表示 Macintosh 操作系统, pcdos 表示 windows 操作系统</td>
</tr>
</tbody>
</table>


<p>
使用示例:
</p>
<pre class="example" id="org685d046">
=INFO("system")
我使用的是 windows10 所以返回 "pcdos"
=INFO("release")
我使用的是 2016, 返回的是 "16.0"
</pre>
</div>
</div>

<div id="outline-container-org0af5fd6" class="outline-5">
<h5 id="org0af5fd6"><span class="section-number-5">2.4.1.6.</span> ERROR.TYPE 函数(返回错误值对应的数字)</h5>
<div class="outline-text-5" id="text-2-4-1-6">
<p>
\[ ERROR.TYPE(error_val) \]
</p>

<ul class="org-ul">
<li>error<sub>val</sub>: 表示要查找其标号的一个错误值.</li>
</ul>


<p>
ERROR.TYPE 函数用于返回对应于 EXCEL 某一错误值的标号,如果没有错误则返回 #N/A
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 7:</span> 错误值与ERROR.TYPE 返回值</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">error<sub>val</sub></td>
<td class="org-right">ERROR.TYPE 返回值</td>
</tr>

<tr>
<td class="org-left">#NULL!</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-left">#DIV/0!</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-left">#VALUE!</td>
<td class="org-right">3</td>
</tr>

<tr>
<td class="org-left">#REF!</td>
<td class="org-right">4</td>
</tr>

<tr>
<td class="org-left">#NAME?</td>
<td class="org-right">5</td>
</tr>

<tr>
<td class="org-left">#NUM!</td>
<td class="org-right">6</td>
</tr>

<tr>
<td class="org-left">#N/A</td>
<td class="org-right">7</td>
</tr>

<tr>
<td class="org-left">#GETTING<sub>DATA</sub></td>
<td class="org-right">8</td>
</tr>

<tr>
<td class="org-left">其他值</td>
<td class="org-right">#N/A</td>
</tr>
</tbody>
</table>


<p>
使用示例:
</p>
<pre class="example" id="orgb10a7d5">
=ERROR.TYPE(2/0)
2/0 0做了分母,所以会返回 #DIV/0! 错误值,那么对应的 ERROR.TYPE 就会返回2.
</pre>
</div>
</div>
</div>

<div id="outline-container-orgba64607" class="outline-4">
<h4 id="orgba64607"><span class="section-number-4">2.4.2.</span> 各种 IS 函数</h4>
<div class="outline-text-4" id="text-2-4-2">
<p>
IS 函数可以和其他函数结合来帮助组成复杂语句,例如 FIND 函数在找到目标字符时返回目
标字符在查找字符串中的起始位置,但如果没有找到会返回 #VALUE! 错误值,我们可以用
ISNUMBER 来进行判断,如果返回的是数字,则接受数据进行其他操作,如果不是也就是返回了
错误值,那就不进行相应操作.
</p>
</div>

<div id="outline-container-orgc6e8117" class="outline-5">
<h5 id="orgc6e8117"><span class="section-number-5">2.4.2.1.</span> ISBLANK 函数(检测单元格是否为空)</h5>
<div class="outline-text-5" id="text-2-4-2-1">
<p>
\[ ISBLANK(value) \]
</p>

<ul class="org-ul">
<li>value: 要检验的值,可以是单元格的引用,也可以是任意值的名称引用,也可以直接是任意
值.</li>
</ul>


<p>
ISBLANK 函数用于判断指定单元格是否为空值.
</p>
<blockquote>
<p>
虽然也可以直接对值判断,但只要有值,就必定不是空值,空值在这里说的是没有任何数据,而
即使是空字符串,也算是有值,只不过这个字符串没有内容,而空值的意思是什么都没有,
</p>

<p>
所以这个函数有意义的用法只是用来判断单元格是否为空.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org14f991b">
=IF(ISBLANK(B2),"缺考","")
可以用来检测学生是否缺考(没有分数就是缺考了)
=SUMPRODUCT(ISBLANK(B2:B14)*1)
可以用来统计空单元格个数. 因为 SUMPRODUCT 可以直接进行"向量运算",所以直接使用,
SUM 函数不能直接进行 "向量运算",需要加上 Ctrl+Shift+Enter:
=SUM(ISBLANK(B2:B14)*1)  然后按 Ctrl+Shift+Enter 可以得到和上面公式一样的效果.
</pre>
</div>
</div>

<div id="outline-container-org195aff3" class="outline-5">
<h5 id="org195aff3"><span class="section-number-5">2.4.2.2.</span> ISNUMBER 函数(检测参数是否为数值)</h5>
<div class="outline-text-5" id="text-2-4-2-2">
<p>
\[ ISNUMBER(value) \]
</p>

<ul class="org-ul">
<li>value: 要检测的值.</li>
</ul>


<p>
ISNUMBER 函数用于判断参数是否为数值.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org2e30035">
=ISNUMBER(B2)
可以用来判断数据是否为数值类型数据,用来判断数据有效性.
可以用来判断数据是否为数值类型数据,用来判断数据有效性.
=ISNUMBER(B2:B4) 按 Ctrl+Shift+Enter
可以得到一个 3 个值的数组,通过鼠标点击向下填充可以获得完整数组数据.
</pre>
</div>
</div>

<div id="outline-container-org91679e7" class="outline-5">
<h5 id="org91679e7"><span class="section-number-5">2.4.2.3.</span> ISTEXT 函数(检测参数是否为文本)</h5>
<div class="outline-text-5" id="text-2-4-2-3">
<p>
\[ ISTEXT(value) \]
</p>

<ul class="org-ul">
<li>value: 要检测的值.</li>
</ul>


<p>
ISTEXT 函数用于判断指定参数是否为文本
</p>

<p>
使用示例:
</p>
<pre class="example" id="org10b32fe">
=SUMPRODUCT(ISTEXT(B2:B12)*1)
如果缺考人员的成绩用 "缺考" 等类似文本填充,则可以用这种方式来统计缺考人数(未缺考的成绩为数值类型)
</pre>
</div>
</div>

<div id="outline-container-org0cd86e7" class="outline-5">
<h5 id="org0cd86e7"><span class="section-number-5">2.4.2.4.</span> ISNONTEXT 函数(检测参数是否为非文本,结果与 ISTEXT 相反)</h5>
<div class="outline-text-5" id="text-2-4-2-4">
<p>
\[ ISTEXT(value) \]
</p>

<ul class="org-ul">
<li>value: 要检测的值.</li>
</ul>


<p>
ISNONTEXT 函数是用于判断参数是否为 "非文本",即一切非文本类型的数据都会返回 TRUE,
刚好和 ISTEXT 是相反的.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgc947934">
=SUMPRODUCT(ISNONTEXT(B2:B12)*1)
和 ISTEXT 一样的例子,不过这次就是判断实际参加考核的人数.
</pre>
</div>
</div>

<div id="outline-container-orgf8584f7" class="outline-5">
<h5 id="orgf8584f7"><span class="section-number-5">2.4.2.5.</span> ISEVEN 函数(判断数字是否为偶数)</h5>
<div class="outline-text-5" id="text-2-4-2-5">
<p>
\[ ISEVEN(number) \]
</p>

<ul class="org-ul">
<li>number: 要判断的数值,也可以是文本形式的数字数据.</li>
</ul>


<p>
ISEVEN 函数用于判断参数是否为偶数.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org3653072">
=ISEVEN(2)
2 是偶数,返回 TRUE
</pre>
</div>
</div>

<div id="outline-container-org5d51e97" class="outline-5">
<h5 id="org5d51e97"><span class="section-number-5">2.4.2.6.</span> ISODD 函数(判断数字是否为奇数)</h5>
<div class="outline-text-5" id="text-2-4-2-6">
<p>
\[ ISODD(number) \]
</p>

<ul class="org-ul">
<li>number: 要判断的数值,也可以是文本形式的数字数据.</li>
</ul>


<p>
ISODD 函数用于判断参数是否为奇数.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org170acb6">
=ISODD(MID(B2,17,1))
判断 B2 的第17位字符是否为奇数. 这是前面用过的判断身份证第17 位是否为奇数/偶数的例子
</pre>
</div>
</div>

<div id="outline-container-orga28bcba" class="outline-5">
<h5 id="orga28bcba"><span class="section-number-5">2.4.2.7.</span> ISLOGICAL 函数(检测给定参数是否为逻辑值)</h5>
<div class="outline-text-5" id="text-2-4-2-7">
<p>
\[ ISLOGICAL(value) \]
</p>

<ul class="org-ul">
<li>value: 要判断的值.</li>
</ul>


<p>
ISLOGICAL 函数用来检验参数是否为逻辑值.
</p>

<blockquote>
<p>
虽然计算机领域一般都认为 1 表示 TRUE,0 表示 FALSE, 但只有运行数学运算时才这样使
用.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org4f34427">
=ISLOGICAL(1)
虽然数学运算时 TRUE 当作数值1,但数值1 不是逻辑值 TRUE. 所以返回结果 FALSE.
=ISLOGICAL(1=2)
1=2 是一个表达式,计算结果为逻辑值 FALSE, 因此 ISLOGICAL 的判断结果为 TRUE.
</pre>
</div>
</div>

<div id="outline-container-org060e944" class="outline-5">
<h5 id="org060e944"><span class="section-number-5">2.4.2.8.</span> ISERROR 函数(检测参数是否为错误值)</h5>
<div class="outline-text-5" id="text-2-4-2-8">
<p>
\[ ISERROR(value) \]
</p>

<ul class="org-ul">
<li>value: 要检验的值.</li>
</ul>


<p>
ISERROR 函数用于判断参数是否为错误值.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org5600fb1">
=SUM(IF(ISERROR(C2:C10), 0, C2:C10))
这是一个数组公式,按 Ctrl+Shift+Enter 即可忽略错误值进行统计.
</pre>
</div>
</div>

<div id="outline-container-orgd187250" class="outline-5">
<h5 id="orgd187250"><span class="section-number-5">2.4.2.9.</span> ISNA 函数(检测参数是否为 #N/A 错误值)</h5>
<div class="outline-text-5" id="text-2-4-2-9">
<p>
\[ ISNA(value) \]
</p>

<ul class="org-ul">
<li>value: 要检验的值.</li>
</ul>


<p>
ISNA 函数用于判断数据是否为错误值 "#N/A"
</p>

<p>
使用示例:
</p>
<pre class="example" id="org8e17414">
=IF(ISNA(VLOOKUP("Windows",A2:C2,3,FALSE)), "未找到结果", VLOOKUP("Windows",A2:C2,3,FALSE))
这样可以避免 VLOOKUP 返回错误值.
</pre>
</div>
</div>

<div id="outline-container-org28baff7" class="outline-5">
<h5 id="org28baff7"><span class="section-number-5">2.4.2.10.</span> ISERR 函数(检测参数是否为 #N/A 之外的错误值)</h5>
<div class="outline-text-5" id="text-2-4-2-10">
<p>
\[ ISERR(value) \]
</p>

<ul class="org-ul">
<li>value: 要检验的值.</li>
</ul>


<p>
ISERR 函数用来判断参数是否为 #N/A 之外的错误值.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org2f0ab46">
=ISERR(NA())
NA() 函数返回错误值 #N/A, 所以 ISERR 结果为 FALSE.
=ISERR(VALUE("a"))
字符 "a" 不能转为数值,因此会返回错误值 #VALUE!, 所以 ISERR 结果为 TRUE.
</pre>
</div>
</div>

<div id="outline-container-org9690aa1" class="outline-5">
<h5 id="org9690aa1"><span class="section-number-5">2.4.2.11.</span> ISREF 函数(检测参数是否为引用)</h5>
<div class="outline-text-5" id="text-2-4-2-11">
<p>
\[ ISREF(value) \]
</p>

<ul class="org-ul">
<li>value: 要检验的值.</li>
</ul>


<p>
ISREF 函数用来检查数据是否为引用.
</p>
<blockquote>
<p>
只有真的单元格引用才是引用,只要使用了公式/计算的表达式全部为值
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org68281da">
=ISREF(A2)
A2 是引用结果为 TRUE.
=ISREF(A2*1)
A2*1 是表达式了,表达式求值为 1乘A2 中数据的计算结果值. 所以结果为 FALSE.
</pre>
</div>
</div>

<div id="outline-container-org5b3c590" class="outline-5">
<h5 id="org5b3c590"><span class="section-number-5">2.4.2.12.</span> ISFORMULA 函数(检测单元格内容是否为公式)</h5>
<div class="outline-text-5" id="text-2-4-2-12">
<p>
\[ ISFORMULA(REF) \]
</p>

<ul class="org-ul">
<li>REF: 引用,表示要检测的单元格的引用.</li>
</ul>


<p>
ISFORMULA 函数检测单元格中的内容是否为公式.
</p>

<blockquote>
<p>
我自己理解的 Excel 中的值分为两种, 公式值和字面值,字面值就是直接输入到单元格中的
值,如 1,"你好" 等, 而公式值是公式的计算结果,如 =1, ="你好", 虽然在表格中看到的1
和 "你好" 没有不同,但是它们的生成方式是不一样的.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org74e01af">
=ISFOMULA(A2)
检测 A2 单元格内容是否为公式.
</pre>
</div>
</div>

<div id="outline-container-org4aae7fb" class="outline-5">
<h5 id="org4aae7fb"><span class="section-number-5">2.4.2.13.</span> SHEET 函数(返回工作表编号)</h5>
<div class="outline-text-5" id="text-2-4-2-13">
<p>
\[ SHEET(value) \]
</p>

<ul class="org-ul">
<li>value: 工作表或引用的名称,如果省略,则返回该函数位于的工作表的编号.</li>
</ul>


<p>
SHEET 函数返回工作表编号.
</p>

<blockquote>
<p>
工作表编号指的是工作表是第几个工作表.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org1fe1f38" class="outline-5">
<h5 id="org1fe1f38"><span class="section-number-5">2.4.2.14.</span> SHEETS 函数(工作簿中工作表数量)</h5>
<div class="outline-text-5" id="text-2-4-2-14">
<p>
\[ SHEETS(REF) \]
</p>

<ul class="org-ul">
<li>REF: 引用,指向工作簿, 如果省略,则返回当前工作簿的所有工作表数量.</li>
</ul>


<p>
SHEETS 函数用于返回引用的工作簿中的工作表数量.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org690c33f">
=SHEETS()
返回当前工作簿的工作表数目.
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orga5e43a0" class="outline-3">
<h3 id="orga5e43a0"><span class="section-number-3">2.5.</span> 日期和时间函数(23)</h3>
<div class="outline-text-3" id="text-2-5">
</div>
<div id="outline-container-org1f64490" class="outline-4">
<h4 id="org1f64490"><span class="section-number-4">2.5.1.</span> 返回日期和时间</h4>
<div class="outline-text-4" id="text-2-5-1">
</div>
<div id="outline-container-orga116103" class="outline-5">
<h5 id="orga116103"><span class="section-number-5">2.5.1.1.</span> NOW 函数(返回当前日期与时间)</h5>
<div class="outline-text-5" id="text-2-5-1-1">
<p>
\[ NOW() \]
</p>

<p>
NOW() 函数表示返回当前的日期和时间.
</p>

<blockquote>
<p>
Excel 中的时间和日期是特殊的数值,整数部分表示日期,小数部分表示时间. 0.5 表示中午
12:00; 整数部分表示从1900年1月0日到今天的天数.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org893a7ad">
=TEXT(B1-NOW(), "h:mm:ss")
假设 B1 是一个未来的日期, 这个公式可以计算到 B1 这个日期还有多长时间.
</pre>
</div>
</div>

<div id="outline-container-orge8c9371" class="outline-5">
<h5 id="orge8c9371"><span class="section-number-5">2.5.1.2.</span> TODAY 函数(返回当前日期)</h5>
<div class="outline-text-5" id="text-2-5-1-2">
<p>
\[ TODAY() \]
</p>

<p>
TODAY() 函数表示返回当前的日期.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org9f6c5e1">
=TEXT(TODAY()-B1, "0")
B1 是一个今天之前的日期, 计算今天到 B1 这个日期的天数.
=IF((TODAY()-B1)&gt;60, "到期","未到期")
借阅时间超过 60 天就到期了.
</pre>
</div>
</div>

<div id="outline-container-org4538eb1" class="outline-5">
<h5 id="org4538eb1"><span class="section-number-5">2.5.1.3.</span> DATE 函数(构建一个标准日期)</h5>
<div class="outline-text-5" id="text-2-5-1-3">
<p>
\[ DATE(year, month, day) \]
</p>

<ul class="org-ul">
<li>year: 1到4为数字的年份值.</li>
<li>month: -12到12 的月份值, 负数为倒数第几个月.</li>
<li>day: -31到31 的天数, 负数为倒数第几天.</li>
</ul>


<p>
DATE 函数用于返回特定日期的序列号.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgdd0395c">
=DATE(MID("20181004",1,4),MID("20181004",5,2),MID("20181004",7,2))
将 "20181004" 转换成日期.
</pre>
</div>
</div>

<div id="outline-container-org2a76b25" class="outline-5">
<h5 id="org2a76b25"><span class="section-number-5">2.5.1.4.</span> TIME 函数(构建标准时间)</h5>
<div class="outline-text-5" id="text-2-5-1-4">
<p>
\[ TIME(hour, minute, second) \]
</p>

<ul class="org-ul">
<li>hour: 小时数, 0-32767</li>
<li>minute: 分钟数, 0-32767</li>
<li>second: 秒数, 0-32767</li>
</ul>


<p>
TIME 函数表示返回某个特定时间的小数值.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgde37f3e">
=0.5 + TIME(3, 30, 0)
0.5 表示中午12点,加上3个半小时,就是下午3点半.
</pre>
</div>
</div>

<div id="outline-container-orgc3e6336" class="outline-5">
<h5 id="orgc3e6336"><span class="section-number-5">2.5.1.5.</span> YEAR 函数(返回日期对应的年份)</h5>
<div class="outline-text-5" id="text-2-5-1-5">
<p>
\[ YEAR(serial_number) \]
</p>

<ul class="org-ul">
<li>serial<sub>number</sub>: 表示一个日期值.</li>
</ul>


<p>
YEAR 函数用于返回某个日期对应的年份,结果为 1900 - 9999 之间的整数.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org742fb36">
=YEAR(TODAY()) - YEAR(DATE(1998,11,20))
计算1998年11月20 日出生的人今天多少岁了.
</pre>
</div>
</div>

<div id="outline-container-org5614be1" class="outline-5">
<h5 id="org5614be1"><span class="section-number-5">2.5.1.6.</span> MONTH 函数(返回日期中的月份)</h5>
<div class="outline-text-5" id="text-2-5-1-6">
<p>
\[ MONTH(serial_number) \]
</p>

<ul class="org-ul">
<li>serial<sub>number</sub>: 表示一个日期值.</li>
</ul>


<p>
MONTH 函数能够返回日期中的月份.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org87c7a47">
=IF(MONTH(DATE(1998,11,20)=MONTH(TODAY())), "本月", "")
计算某个月份是否为本月.
</pre>
</div>
</div>

<div id="outline-container-orgb78ef2f" class="outline-5">
<h5 id="orgb78ef2f"><span class="section-number-5">2.5.1.7.</span> DAY 函数(返回日期中的天数)</h5>
<div class="outline-text-5" id="text-2-5-1-7">
<p>
\[ DAY(serial_number) \]
</p>

<ul class="org-ul">
<li>serial<sub>number</sub>: 表示一个日期值.</li>
</ul>


<p>
DAY 函数能够返回日期中的天数.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orge99d077">
=IF(AND(MONTH(DATE(1998,11,20)=MONTH(TODAY())), DAY(DATE(1998,11,20))=DAY(TODAY())), "今天生日", "")
结合上面 MONTH 函数的示例,判断当前是不是某人的生日.
</pre>
</div>
</div>

<div id="outline-container-orgbce40ed" class="outline-5">
<h5 id="orgbce40ed"><span class="section-number-5">2.5.1.8.</span> WEEKDAY 函数(返回日期对应的星期数)</h5>
<div class="outline-text-5" id="text-2-5-1-8">
<p>
\[ WEEKDAY(serial_number, [return_type]) \]
</p>

<ul class="org-ul">
<li>serial<sub>number</sub>: 表示一个日期值.</li>
<li>return<sub>type</sub>: 可选参数,用于确定返回值类型的数字.</li>
</ul>


<p>
WEEKDAY 函数能够返回日期对应的星期数,值为1-7 的整数.
</p>
<blockquote>
<p>
return<sub>type</sub> 为 1或省略, 则返回 1-7 代表星期天到星期六; 为 2,则 1-7 代表星期一到
星期天; 为 3 则返回 0-6 代表星期一到星期天.
</p>
</blockquote>

<p>
使用示例:
</p>

<pre class="example" id="org696ef76">
=IF(OR(WEEKDAY(A2,2)=6, WEEKDAY(A2,2)=6), "周末加班", "平常加班")
判断 A2 这天加班是周末加班还是平常加班.
</pre>
</div>
</div>

<div id="outline-container-orgcd04140" class="outline-5">
<h5 id="orgcd04140"><span class="section-number-5">2.5.1.9.</span> WEEKNUM 函数(返回日期对应一年中的第几周)</h5>
<div class="outline-text-5" id="text-2-5-1-9">
<p>
\[ WEEKNUM(serial_number, [return_type]) \]
</p>

<ul class="org-ul">
<li>serial<sub>number</sub>: 表示一个日期值.</li>
<li>return<sub>type</sub>: 可选参数,用于确定返回值类型的数字.</li>
</ul>


<blockquote>
<p>
这个函数有两种机制:
</p>
<ul class="org-ul">
<li>包含1月1日的周为第一周.</li>
<li>包含该年第一个星期四的周为第一周</li>
</ul>

<p>
决定这种机制的是 return<sub>type</sub> 的值,只有当 return<sub>type</sub> 为 21 时,表示将星期一作为一
周的第一天,且使用第二种机制,其他的 return<sub>type</sub> 都是使用第一种机制.
</p>

<p>
return<sub>type</sub> 默认值为 1,表示星期日作为一周的第一天, 2 表示星期一作为一周的第一天.剩
下的可以查看该函数的帮助文档,因为其他的一般用不到.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org2795ea7">
="第" &amp; WEEKNUM(DATE(2023, 10, 1), 2) &amp; "周"
以星期一为一周的第一天,查看2023年的10月1号是当年的第几周.
</pre>
</div>
</div>

<div id="outline-container-org88d4893" class="outline-5">
<h5 id="org88d4893"><span class="section-number-5">2.5.1.10.</span> EOMONTH 函数(返回某日期到指定月数之前/后的最后一天的日期)</h5>
<div class="outline-text-5" id="text-2-5-1-10">
<p>
\[ EOMONTH(start_date, months) \]
</p>

<ul class="org-ul">
<li>start<sub>date</sub>: 表示一个开始的日期.</li>
<li>months: 表示月数,正值为未来的月数,负值为过去的月数.</li>
</ul>


<p>
EOMONTH 用于返回指定日期到某个月份最后一天的日期.
</p>
<blockquote>
<p>
通俗理解, EOMONTH 返回的是 start<sub>date</sub> 之前/后的 months 个月的最后一天的日期,例如,
10月1日前一个月的最后一天的日期,就是 9月30号 =EOMONTH(DATE(2023,10,1),-1) 结果为 2023/09/30
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org9891b7d">
=EOMONTH(TODAY(),0) - TODAY()
今天到本月最后一天还有多少天.
</pre>
</div>
</div>

<div id="outline-container-org4a5b1b8" class="outline-5">
<h5 id="org4a5b1b8"><span class="section-number-5">2.5.1.11.</span> HOUR 函数(返回时间中的小时数)</h5>
<div class="outline-text-5" id="text-2-5-1-11">
<p>
\[HOUR(serial_number)\]
</p>

<ul class="org-ul">
<li>serial<sub>number</sub>: 表示一个时间值.</li>
</ul>


<blockquote>
<p>
日期值其实是有小数的，不过小数为0, 但时间值则没有整数部分,只有小数部分,所以
HOUR(TODAY()) 返回的是0。
</p>
</blockquote>

<p>
HOUR 函数用于返回时间值中的小时数.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgf28c9a1">
=HOUR(NOW())
返回当前时间在一天当中的第几个小时.
</pre>
</div>
</div>

<div id="outline-container-orgd8dab7c" class="outline-5">
<h5 id="orgd8dab7c"><span class="section-number-5">2.5.1.12.</span> MINUTE 函数(返回时间中的分钟数)</h5>
<div class="outline-text-5" id="text-2-5-1-12">
<p>
\[MINUTE(serial_number)\]
</p>

<ul class="org-ul">
<li>serial<sub>number</sub>: 表示一个时间值.</li>
</ul>


<p>
MINUTE 函数用于返回时间值中的分钟数.
</p>
<blockquote>
<p>
MINUTE 和 HOUR 返回的都是时间中的小时和分钟数,例如 1:30 小时数就是1, 分钟数就是
</p>
<ol class="org-ol">
<li>要计算某段时间长短,需要提取开始时间和结束时间的小时和分钟数来计算.</li>
</ol>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="orgaa2fc1e">
=MINUTE(NOW())
返回当前时间的分钟数.
=HOUR(C2)*60 + MINUTE(C2) - HOUR(B2)*60 - MINUTE(B2)
计算 B2 到 C2 这个时间段有多少分钟(B2, 和 C2 是同一天.)
</pre>
</div>
</div>

<div id="outline-container-org2f5221b" class="outline-5">
<h5 id="org2f5221b"><span class="section-number-5">2.5.1.13.</span> SECOND 函数(返回时间中的秒数)</h5>
<div class="outline-text-5" id="text-2-5-1-13">
<p>
\[SECOND(serial_number)\]
</p>

<ul class="org-ul">
<li>serial<sub>number</sub>: 表示一个时间值.</li>
</ul>


<p>
SECOND 函数用于返回时间值中的秒数.
</p>

<blockquote>
<p>
SECOND , MINUTE, HOUR 的用法都是类似的.
</p>
</blockquote>
<p>
使用示例:
</p>
<pre class="example" id="org6a53cfe">
=HOUR(C2-B2)*60*60 + MINUTE(C2-B2)*60 + SECOND(C2-B2)
计算从 B2 到 C2 时间段有多少秒.
</pre>
</div>
</div>
</div>


<div id="outline-container-org8864298" class="outline-4">
<h4 id="org8864298"><span class="section-number-4">2.5.2.</span> 日期计算</h4>
<div class="outline-text-4" id="text-2-5-2">
</div>
<div id="outline-container-org909c161" class="outline-5">
<h5 id="org909c161"><span class="section-number-5">2.5.2.1.</span> DATEDIF 函数(计算两个日期之间的年数,月数和天数)</h5>
<div class="outline-text-5" id="text-2-5-2-1">
<p>
\[ DATEDIF(date1, date2, code) \]
</p>

<ul class="org-ul">
<li>date1: 起始日期.</li>
<li>date2: 结束日期.</li>
<li>code: 返回值的代码</li>
</ul>


<p>
DATEDIF 函数返回两个日期之间的差(DIFFERENCE)
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 8:</span> code 参数与返回值</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">code</td>
<td class="org-left">DATEDIF 返回值</td>
</tr>

<tr>
<td class="org-left">"y"</td>
<td class="org-left">返回日期的年数</td>
</tr>

<tr>
<td class="org-left">"m"</td>
<td class="org-left">返回日期的月数</td>
</tr>

<tr>
<td class="org-left">"d"</td>
<td class="org-left">返回日期的天数</td>
</tr>

<tr>
<td class="org-left">"ym"</td>
<td class="org-left">忽略年数和天数,返回月数</td>
</tr>

<tr>
<td class="org-left">"yd"</td>
<td class="org-left">忽略年数和月数,返回天数</td>
</tr>

<tr>
<td class="org-left">"md"</td>
<td class="org-left">忽略月数和年数,返回天数</td>
</tr>
</tbody>
</table>

<blockquote>
<p>
官方文档并不推荐使用 "md" code ,因为会导致结果出现无效的值.
事实上这个函数都好像不推荐使用了.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="orge8ecb0f">
=DATEDIF(C2,TODAY(), "m")
返回日期 C2 与今天的月份差
</pre>
</div>
</div>

<div id="outline-container-org737cc46" class="outline-5">
<h5 id="org737cc46"><span class="section-number-5">2.5.2.2.</span> DAYS360 函数(按照一年 360 天的算法计算两个日期之间的天数差)</h5>
<div class="outline-text-5" id="text-2-5-2-2">
<p>
\[DAYS360(start_date, end_date, [method])\]
</p>

<ul class="org-ul">
<li>start<sub>date</sub>: 起始日期.</li>
<li>end<sub>date</sub>: 结束日期.</li>
<li>method: 逻辑值,指定计算中采用欧洲方法还是美国方法.</li>
</ul>


<p>
DAYS360 函数按照一年 360 天计算两个日期之间相差的天数.一些会计计算中会用到.
</p>
<blockquote>
<p>
与 DAYS360 的区别在于 DAYS360 无论当月是 31 天还是 28 天都全按照 30 天计算. 而
DATEIF 函数则是按照实际天数计算的. 另外,计算天数差是 "算尾不算头" ,即起始日当天
不算1天,终止日算作1天.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org0e92a36">
DAYS360(TODAY(),C2+D2)
C2 表示借款日期, D2 表示还款账期.
</pre>
</div>
</div>

<div id="outline-container-org1fd9fee" class="outline-5">
<h5 id="org1fd9fee"><span class="section-number-5">2.5.2.3.</span> EDATE 函数(计算间隔指定月数后的日期)</h5>
<div class="outline-text-5" id="text-2-5-2-3">
<p>
\[ EDATE(start_date, months) \]
</p>

<ul class="org-ul">
<li>start<sub>date</sub>: 起始日期.</li>
<li>months: 间隔月份,负数表示向过去的方向间隔的日期,正数表示向未来的方向间隔的日期.</li>
</ul>


<p>
EDATE 函数返回 start<sub>date</sub> 间隔了 months 个月之后的日期.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgfeb90f8">
=EDATE(B2,12)
可用来计算保质期,B2 为生产日期, 12个月的保质期.
</pre>
</div>
</div>

<div id="outline-container-orgd41803a" class="outline-5">
<h5 id="orgd41803a"><span class="section-number-5">2.5.2.4.</span> WORKDAY 函数(获取间隔若干工作日后的日期)</h5>
<div class="outline-text-5" id="text-2-5-2-4">
<p>
\[WORKDAY(start_date, days, [holidays])\]
</p>

<ul class="org-ul">
<li>start<sub>date</sub>: 起始日期.</li>
<li>days: start<sub>date</sub> 之后/前不包含周末以及假日的天数.</li>
<li>holidays: 可选,一个可选列表,其中包含需要从日历中排除的一个或多个日期.是指定除
了周末之外的不计算在内的日期.</li>
</ul>


<p>
WORKDAY 函数返回 start<sub>date</sub> 之后/前与该日期间隔了 days 个工作日的某一个日期.
工作日指周末和假日以及holidays 之外的日子.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org14bafbe">
=WORKDAY(B2,13,$F$2:$F$4)
B2 为开始休假的日期, $F$2:$F$4 为假期,可以计算从开始休假到13天假期结束的日期,
13天假期是不包括周末和节假日在内的.
</pre>
</div>
</div>

<div id="outline-container-org4a2b21f" class="outline-5">
<h5 id="org4a2b21f"><span class="section-number-5">2.5.2.5.</span> WORKDAY.INTL 函数</h5>
<div class="outline-text-5" id="text-2-5-2-5">
<p>
\[ WORKDAY.INTL(start_date, days, [weekend], [holidays]) \]
</p>

<ul class="org-ul">
<li>start<sub>date</sub>: 起始日期.</li>
<li>days: 工作日天数.</li>
<li>weekend: 可选,一周中属于周末和不作为工作日的日子,是一个指定周末日的字符串.</li>
<li>holidays: 可选, 要从工作日中排除的日期.</li>
</ul>


<p>
WORKDAY.INTL 函数用于返回 start<sub>date</sub> 前/后 days 个工作日的日期,但可以自定义周末
参数,周末参数用来确定周末有几天以及是哪几天.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org8bedf13">
=WORKDAY.INTL(TODAY(), 3 ,"0000001")
从今天开始休假,假期3天, 每周的周末只有星期天.
</pre>
</div>
</div>

<div id="outline-container-org2133fc6" class="outline-5">
<h5 id="org2133fc6"><span class="section-number-5">2.5.2.6.</span> YEARFRAC 函数(从开始到结束经过的天数占全年总天数的比例)</h5>
<div class="outline-text-5" id="text-2-5-2-6">
<p>
\[ YEARFRAC(start_date, end_date, [basis]) \]
</p>

<ul class="org-ul">
<li>start<sub>date</sub>: 开始日期.</li>
<li>end<sub>date</sub>: 结束日期.</li>
<li>basis: 可选,使用的计数基准类型.</li>
</ul>

<p>
YEARFRAC 函数返回开始日期到结束日期的天数占全年天数的百分比.
</p>
<blockquote>
<p>
basis 默认是按照一年 360 天,每月 30 天计算的. 数值为1 则表示按照一年的实际天数计
算, 数值为3, 则按照一年 365 天,每月按实际天数计算.其他的类型在需要时查阅文档即可.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org02cebec">
=YEARFRAC(B2,TODAY(),3)
计算 B2 到今天的天数,然后除以 365 即可得到百分比.
</pre>
</div>
</div>

<div id="outline-container-org34c094e" class="outline-5">
<h5 id="org34c094e"><span class="section-number-5">2.5.2.7.</span> NETWORKDAYS 函数(计算两个日期之间的工作日数量)</h5>
<div class="outline-text-5" id="text-2-5-2-7">
<p>
\[NETWORKDAYS(start_date, end_date, [holidays])\]
</p>

<ul class="org-ul">
<li>start<sub>date</sub>: 起始日期.</li>
<li>end<sub>date</sub>: 结束日期.</li>
<li>holidays: 可选,一个可选列表,其中包含需要从日历中排除的一个或多个日期.是指定除
了周末之外的不计算在内的日期.</li>
</ul>

<p>
NETWORKDAYS 函数返回开始日期到结束日期之间的完整工作日数值.
</p>

<blockquote>
<p>
可以用来计算特殊时间段的工作天数.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="orgc2b3145">
=NETWORKDAYS(B2,C2,$F$2)
计算 B2 到 C2 之间除了 F2 外的工作日.
</pre>
</div>
</div>

<div id="outline-container-orge76743e" class="outline-5">
<h5 id="orge76743e"><span class="section-number-5">2.5.2.8.</span> NETWORKDAYS.INTL 函数</h5>
<div class="outline-text-5" id="text-2-5-2-8">
<p>
\[ WORKDAY.INTL(start_date, end_date , [weekend], [holidays]) \]
</p>


<ul class="org-ul">
<li>start<sub>date</sub>: 起始日期.</li>
<li>end<sub>date</sub>: 结束日期.</li>
<li>weekend: 可选,一周中属于周末和不作为工作日的日子,是一个指定周末日的字符串.</li>
<li>holidays: 可选, 要从工作日中排除的日期.</li>
</ul>


<p>
NETWORKDAYS.INTL 函数返回两个日期之间的所有工作日数量. 可以指定哪天是周末,以及有
多少天是周末.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org303407f">
=WORKDAY.INTL(B2,C2,"0000000")
在全年午休的作息中 B2 到 C2 间多少工作日.
</pre>
</div>
</div>
</div>


<div id="outline-container-orgef32495" class="outline-4">
<h4 id="orgef32495"><span class="section-number-4">2.5.3.</span> 文本日期/时间的转换</h4>
<div class="outline-text-4" id="text-2-5-3">
</div>
<div id="outline-container-orge33c464" class="outline-5">
<h5 id="orge33c464"><span class="section-number-5">2.5.3.1.</span> DATEVALUE 函数(将日期字符串转换成可以计算的数值/序列号)</h5>
<div class="outline-text-5" id="text-2-5-3-1">
<p>
\[DATEVALUE(date_text)\]
</p>

<ul class="org-ul">
<li>date<sub>text</sub>: 表示 Excel 日期格式的日期的文本.</li>
</ul>


<p>
DATEVALUE 函数将储存为文本类型的日期转换成 Excel 识别的日期的序列号.
</p>
<blockquote>
<p>
一般从其他软件导入的日期数据是文本类型的,可以通过这个函数转为 Excel 的日期/序列
号类型.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="orgd553589">
=DATEVALUE("2018-12-31")
=DATEVALUE("2018/12/31")
</pre>
</div>
</div>

<div id="outline-container-orgf5f7efb" class="outline-5">
<h5 id="orgf5f7efb"><span class="section-number-5">2.5.3.2.</span> TIEMVALUE 函数(将时间字符串转换成可计算的小数值)</h5>
<div class="outline-text-5" id="text-2-5-3-2">
<p>
\[TIMEVALUE(time_text)\]
</p>

<ul class="org-ul">
<li>time<sub>text</sub>: Excel 支持的时间格式的字符串.</li>
</ul>


<p>
TIMEVALUE 函数用于返回由文本字符串所表示的小数值.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org62a57f0">
=TIMEVALUE("12:30")
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org0ff3da9" class="outline-3">
<h3 id="org0ff3da9"><span class="section-number-3">2.6.</span> 统计函数(102)</h3>
<div class="outline-text-3" id="text-2-6">
</div>
<div id="outline-container-orga256755" class="outline-4">
<h4 id="orga256755"><span class="section-number-4">2.6.1.</span> 平均值计算函数(7)</h4>
<div class="outline-text-4" id="text-2-6-1">
</div>
<div id="outline-container-orga18a481" class="outline-5">
<h5 id="orga18a481"><span class="section-number-5">2.6.1.1.</span> AVERAGE 函数(求平均值)</h5>
<div class="outline-text-5" id="text-2-6-1-1">
<p>
\[ AVERAGE(number1, number2, \cdots) \]
</p>

<ul class="org-ul">
<li>\(number1,\cdots\): 要计算平均值的1-255 个参数.</li>
</ul>


<p>
AVERAGE 函数用于计算所有参数的算术平均值:
\[ \frac{\sum_{number1}^{numberN}}{N} \]
</p>

<p>
使用示例:
</p>
<pre class="example" id="org06a5669">
=AVERAGE(A2:A14)
</pre>
</div>
</div>

<div id="outline-container-org17b0e75" class="outline-5">
<h5 id="org17b0e75"><span class="section-number-5">2.6.1.2.</span> AVERAGEA 函数(求包括文本和逻辑值的平均值)</h5>
<div class="outline-text-5" id="text-2-6-1-2">
<p>
\[ AVERAGEA(value1, value2, \cdots) \]
</p>

<ul class="org-ul">
<li>\(value1, value2, \cdots\) : 需要计算的1-30 个数据.</li>
</ul>


<p>
AVERAGEA 函数返回给定参数(包括文本和逻辑值)的平均值.
</p>
<blockquote>
<p>
AVERAGE 对于非数值类型的参数是不纳入统计范围的,AVERAGEA 则会将文本和逻辑值纳入统
计范围,逻辑值 TRUE 视为1 FALSE 视为0, 文本值的处理逻辑与 SUM 函数一样,可转换成数
值的字符字面值转换为数值后计算,只要是文本值的单元格引用一律视为0,不可转为数值的
字符字面值会导致返回错误值.
</p>
</blockquote>
<p>
使用示例:
</p>
<pre class="example" id="org278380d">
=AVERAGEA(1,"1")
结果为1.
=AVERAGEA(1,A1)
A1 为文本类型的数据 "1" 结果为0.5, 因为文本数据的单元格引用直接视为 0.
</pre>
</div>
</div>

<div id="outline-container-org00b7a10" class="outline-5">
<h5 id="org00b7a10"><span class="section-number-5">2.6.1.3.</span> AVERAGEIF 函数(按条件求平均值)</h5>
<div class="outline-text-5" id="text-2-6-1-3">
<p>
\[ AVERAGEIF(range, criteria, average\_range) \]
</p>

<ul class="org-ul">
<li>range: 条件应用的区域,average<sub>range</sub> 省略的情况下, 也是要计算平均值的范围.</li>
<li>criteria: 判断条件.</li>
<li>average<sub>range</sub>: 要计算平均值的实际单元格,如果省略则默认使用 range 为计算平均值
的范围.</li>
</ul>


<p>
AVERAGEIF 函数可以计算 range 区域内满足 criteria 条件的所有单元格或是与 range 区
域中满足 criteria 条件的单元格对应的所有 average<sub>range</sub> 区域中的单元格的算术平均值.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org2cfc17c">
=AVERAGEIF($A$2:$A$14, "=一班", $C$2:$C$14 )
将 A2:A14 中值为 "一班" 的单元格在 C2:C14 中对应的单元格里的数据计算得出算术平均值.
=AVERAGEIF(C2:C14,"&gt;60")
计算C2:C14 中及格的分数的算术平均值.
</pre>
</div>
</div>

<div id="outline-container-orgfd8b109" class="outline-5">
<h5 id="orgfd8b109"><span class="section-number-5">2.6.1.4.</span> AVERAGEIFS 函数(按多个条件求平均值)</h5>
<div class="outline-text-5" id="text-2-6-1-4">
<p>
\[ AVERAGEIFS(average\_range, criteria\_range1, criteria1, criteria\_range2,
criteria2, \cdots) \]
</p>

<ul class="org-ul">
<li>average<sub>range</sub>: 要求平均值的区域范围.</li>
<li>criteria<sub>range1</sub>, &#x2026;: 条件应用的区域以及对应的判断条件.</li>
</ul>


<p>
AVERAGEIFS 函数用于返回满足多重条件的所有单元格的算术平均值.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgeb44eb3">
=AVERAGEIFS(D2:D14, B2:B14, "女", C2:C14, "一车间")
计算一车间女职员的平均工资.
</pre>
</div>
</div>

<div id="outline-container-orga1165ea" class="outline-5">
<h5 id="orga1165ea"><span class="section-number-5">2.6.1.5.</span> GEOMEAN 函数(返回几何平均值)</h5>
<div class="outline-text-5" id="text-2-6-1-5">
<p>
\[ GEOMEAN(number1,number2,\cdots) \]
</p>

<ul class="org-ul">
<li>number1, number2, &#x2026; : 需要计算平均值的1-30 个参数.</li>
</ul>


<p>
GEOMEAN 函数用来返回正数数组或数据区域的几何平均值.
</p>

<blockquote>
<p>
几何平均值:
\[ GEOMEAN = \sqrt[N]{number1 \times number2 \times number3 \times \cdots \times numberN}\]
几何平均值表示的是数据的稳定性,例如 1 和 100 的几何平均值为 10, 50 和 50 的几何
平均值为 50 虽然值相差1,但几何平均值相差了 40 ,从这个结果上可以看出几何平均值越
大,数据越稳定.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org59ef1f5">
=GEOMEAN(1,4,16)
1,4,16相乘再开三次方,得4
=GEOMEAN(5,5,5)
5,5,5 相乘再开三次方,得5
虽然 1+4+16=21 大于 5+5+5=15, 但 5,5,5 的组合数据更稳定.
</pre>
</div>
</div>

<div id="outline-container-org852ba4c" class="outline-5">
<h5 id="org852ba4c"><span class="section-number-5">2.6.1.6.</span> HARMEAN 函数(返回数据集的调和平均值)</h5>
<div class="outline-text-5" id="text-2-6-1-6">
<p>
\[ HARMEAN(numner1,number2,\cdots) \]
</p>

<ul class="org-ul">
<li>number1, &#x2026;: 需要计算平均值的1-30 个参数</li>
</ul>


<p>
HARMEAN 函数用于返回数据集合的调和平均值(调和平均值与倒数的算术平均值互为倒数)
</p>
<blockquote>
<p>
调和平均值是将所有数值取倒数后求算术平均值然后对算术平均值求倒数得到的:
\[HARMEAN = \frac{N}{\frac{1}{number1} + \frac{1}{number2} +\cdots + \frac{1}{numberN}}\]
调和平均值要求所有数据都要大于0, 调和平均值容易收到极小值的影响.
调和平均值一般用在求取平均速率时用到.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org6851469">
求5名学生1小时内的平均解题数.
=HARMEAN(B2:B6)
B2:B6 是每个学生的解题数.
</pre>
</div>
</div>

<div id="outline-container-org88c31af" class="outline-5">
<h5 id="org88c31af"><span class="section-number-5">2.6.1.7.</span> TRIMMEAN 函数(截头尾返回数据集的平均值)</h5>
<div class="outline-text-5" id="text-2-6-1-7">
<p>
\[ TRIMMEAN(array, percent) \]
</p>

<ul class="org-ul">
<li>array: 要求取平均值的区域.</li>
<li>percent: 表示要截取的数据的比例, 当 percent = 0.2 时, 10 个数据中去除两个数
据,20个数据中去除 4 个.</li>
</ul>


<p>
TRIMMEAN 函数用于从数据集的头部和尾部去掉一定百分比的数据点后,再求数据集的算术平
均值.
</p>
<blockquote>
<p>
该函数会将截取的点数向下舍入到最近的 2 的倍数,例如 10 个数据,percent 为 0.1 则向
下舍入为 0, 一个都不删除, 30 个数据, percent 为 0.1 则向下舍入为 2, 因为要对称的
删除最大和最小的数据.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org7cb0609">
=TRIMMEAN({1,2,3,4},0.25)
4*0.25 = 1 向下舍入到 2 的倍数 0, 所以一个都不删除,然后计算算术平均值, 10/4=2.5
=TRIMMEAN({1,2,2,4},0.75)
4*0.75 = 3, 向下舍入到 2, 删除最小的1 和最大的4, 计算算术平均值 4/2=2
</pre>
</div>
</div>
</div>


<div id="outline-container-org568cd70" class="outline-4">
<h4 id="org568cd70"><span class="section-number-4">2.6.2.</span> 数目统计函数(5)</h4>
<div class="outline-text-4" id="text-2-6-2">
</div>
<div id="outline-container-org48f2959" class="outline-5">
<h5 id="org48f2959"><span class="section-number-5">2.6.2.1.</span> COUNT 函数(统计含有数值的单元格个数)</h5>
<div class="outline-text-5" id="text-2-6-2-1">
<p>
\[ COUNT(value1, value2, \cdots) \]
</p>

<ul class="org-ul">
<li>value1, &#x2026; : 要统计的1-255 个参数,只有数值类型数据会被统计.</li>
</ul>

<p>
COUNT 函数用于统计参数中数值类型的参数个数.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org759c3c9">
=COUNT(1,2,3,"1")
"1" 为文本类型,不纳入统计范围,结果为 3
</pre>
</div>
</div>

<div id="outline-container-org70461b5" class="outline-5">
<h5 id="org70461b5"><span class="section-number-5">2.6.2.2.</span> COUNTA 函数(统计非空单元格的个数)</h5>
<div class="outline-text-5" id="text-2-6-2-2">
<p>
\[ COUNTA(value1, value2, \cdots) \]
</p>

<ul class="org-ul">
<li>value1, &#x2026; : 要统计的 1-255 个参数, 只要是非空单元格就会纳入统计范围.</li>
</ul>

<p>
COUNTA 用于统计非空单元格的个数.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org98eec9d">
=COUNTA("")
"" 即使是空字符串也是有值,只不过这个字符串值的内容为空,所以结果为1.
=COUNTA("",,)
结果为3
=COUNTA("",,B2)
B2 为空单元格,结果为2. 查看这个例子和上面一个例子的执行过程,发现如果参数空置,则
该函数将该位置的参数视为0,如果参数为空字符串 "",则视为一个错误值#VALUE!(错误值也是值)
</pre>
</div>
</div>
<div id="outline-container-org90958a4" class="outline-5">
<h5 id="org90958a4"><span class="section-number-5">2.6.2.3.</span> COUNTIF 函数(统计满足条件的单元格个数)</h5>
<div class="outline-text-5" id="text-2-6-2-3">
<p>
\[ COUNTIF(range, criteria) \]
</p>

<ul class="org-ul">
<li>range : 需要统计的单元格区域.</li>
<li>criteria: 判断条件.</li>
</ul>


<p>
COUNTIF 函数用于统计区域内满足给定条件的单元格个数.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org23c669d">
=COUNTIF(A2:A12, "&gt;=18")
统计 A2:A12 中大于等于18 的单元格个数.
注意, EXCEL 中文本类型数据永远大于数值类型数据.
</pre>
</div>
</div>

<div id="outline-container-org15112d7" class="outline-5">
<h5 id="org15112d7"><span class="section-number-5">2.6.2.4.</span> COUNTIFS 函数(统计同时满足多个条件的单元格个数)</h5>
<div class="outline-text-5" id="text-2-6-2-4">
<p>
\[ COUNTIFS(range1, criteria1, range2, criteria2, \cdots) \]
</p>

<ul class="org-ul">
<li>range1, range2, &#x2026; : 要判断的区域,区域的规模必需一致.</li>
<li>criteria1, criteria2, &#x2026;: 判断条件.</li>
</ul>


<p>
COUNTIFS 函数用于统计同时满足多个条件的单元格个数.
</p>
<blockquote>
<p>
这里理解应该是同时满足多个条件的数据条数.一条数据由多个单元格组成,多个条件就是判
断的一条数据中的多个单元格是否满足对应条件.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="orgab5a600">
COUNTIFS(C2:C12,"女", D2:D12, "第一车间")
统计第一车间的女性人数.
</pre>
</div>
</div>
<div id="outline-container-orgb83caba" class="outline-5">
<h5 id="orgb83caba"><span class="section-number-5">2.6.2.5.</span> COUNTBLANK 函数(统计空单元格个数)</h5>
<div class="outline-text-5" id="text-2-6-2-5">
<p>
\[ COUNTBLANK(range) \]
</p>

<ul class="org-ul">
<li>range : 需要统计空单元格的区域.</li>
</ul>


<p>
COUNTBLANK 函数用于统计区域内的空单元格个数.
</p>
<blockquote>
<p>
COUNTBLANK 与 COUNTA 的作用刚好相反,一个统计非空单元格,一个统计空单元格; COUNTA
可以接收单元格区域之外的参数, COUNTBLANK 只能接收单元格区域作为参数.
</p>
</blockquote>
<p>
使用示例:
</p>
<pre class="example" id="org63e68fc">
=COUNTBLANK(D2:D12) &amp; "人"
D 列为成绩列,缺考没有分数,所以可以用来统计缺考人数.
</pre>
</div>
</div>
</div>

<div id="outline-container-org7318a59" class="outline-4">
<h4 id="org7318a59"><span class="section-number-4">2.6.3.</span> 最大值与最小值函数(6)</h4>
<div class="outline-text-4" id="text-2-6-3">
</div>
<div id="outline-container-org8ac89c8" class="outline-5">
<h5 id="org8ac89c8"><span class="section-number-5">2.6.3.1.</span> MAX 函数(返回数值集的最大值)</h5>
<div class="outline-text-5" id="text-2-6-3-1">
<p>
\[ MAX(number1, number2, \cdots) \]
</p>

<ul class="org-ul">
<li>number1,number2, &#x2026; : 用于查找最大值的一组 1-255 个数据.</li>
</ul>


<p>
MAX 函数用于返回数据集中的最大数值.
</p>
<blockquote>
<p>
对于非数值类型的数据(引用或字面值) ,MAX 参数的处理规则和 SUM 参数类似,不同的是
SUM 将文本值的单元格引用视为0, MAX 则直接忽略, 但原则都是让它们不影响计算结果.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org9eaa257">
=MAX(1,2,"3")
最大值为3
=MAX(1,2,A2)
A2 的内容为文本值 "3",但对于非数值类型的单元格引用,会和 SUM 函数一样直接
忽视, 所以最大值为2
</pre>
</div>
</div>

<div id="outline-container-orgcb98ad3" class="outline-5">
<h5 id="orgcb98ad3"><span class="section-number-5">2.6.3.2.</span> MIN 函数(返回数值集的最小值)</h5>
<div class="outline-text-5" id="text-2-6-3-2">
<p>
\[ MIN(number1, number2, \cdots) \]
</p>

<ul class="org-ul">
<li>number1,number2, &#x2026; : 用于查找最小值的一组 1-255 个数据.</li>
</ul>

<p>
MAX 函数用于返回数据集中的最小数值.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orga4dfe93">
=MIN(IF(C2:C12&lt;&gt;0,C2:C12))
这是一个数组公式,需要按 Ctrl+Shift+Enter 得出结果, 主要是为了让 IF 函数
返回一个数组结果. 这个公式是忽略 0 值找出最小值.
</pre>
</div>
</div>
<div id="outline-container-orga6c3a22" class="outline-5">
<h5 id="orga6c3a22"><span class="section-number-5">2.6.3.3.</span> MAXA 函数(返回数据集(包括文本,逻辑值)的最大值)</h5>
<div class="outline-text-5" id="text-2-6-3-3">
<p>
\[ MAXA(value1, value2, \cdots) \]
</p>

<ul class="org-ul">
<li>value1, &#x2026;: 要查找最大值的1-255 个参数.</li>
</ul>

<p>
MAXA 函数用于查找参数中的最大值,与 MAX 不同的是 MAXA 不会忽略逻辑值,以及逻辑值的
引用, 文本值 和 MAX 函数的处理也不同, MAXA 对文本值的处理就和 SUM 一致了, 字面值
当作数值, "1" 会当作数值1 统计, 文本值的引用当作0, B2 为 "100", =MAXA(B2,-1) 结
果为0.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org34a6307">
=MAXA(1,"2")
结果为 2
=MAXA(1,B3)
B3 为 "2", 结果为 1
=MAXA(TRUE,"0")
=MAXA(B2,"0")
B2 为逻辑值 TRUE, 结果为1
</pre>
</div>
</div>

<div id="outline-container-org9880997" class="outline-5">
<h5 id="org9880997"><span class="section-number-5">2.6.3.4.</span> MINA 函数(返回数据集(包括逻辑值和文本)的最小值)</h5>
<div class="outline-text-5" id="text-2-6-3-4">
<p>
\[ MINA(value1, value2, \cdots) \]
</p>

<ul class="org-ul">
<li>value1, &#x2026;: 要查找最小值的1-255 个参数.</li>
</ul>


<p>
MINA 函数用法和 MAXA 函数类似,只不过是查找最小值.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgd4169a0">
=MINA(B2,1)
B2 为文本类型数据 "111111" ,但 MINA 视文本值的引用为0,因此返回结果 0.
</pre>
</div>
</div>
<div id="outline-container-org8725961" class="outline-5">
<h5 id="org8725961"><span class="section-number-5">2.6.3.5.</span> LARGE 函数(返回数据集的某个最大值)</h5>
<div class="outline-text-5" id="text-2-6-3-5">
<p>
\[ LARGE(array, k) \]
</p>

<ul class="org-ul">
<li>array: 需要查找的区域.</li>
<li>k: 要查找的最大值的排名.如 k 为2,则返回数组中第二大的值.</li>
</ul>

<p>
LARGE 函数用于返回 array 中第 k 大的值.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgf8fc569">
=LARGE({1,2,3,4,5}, 2)
1,2,3,4,5 中第二大的值为 4
</pre>
</div>
</div>
<div id="outline-container-org246faad" class="outline-5">
<h5 id="org246faad"><span class="section-number-5">2.6.3.6.</span> SMALL 函数(返回数据集的某个最小值)</h5>
<div class="outline-text-5" id="text-2-6-3-6">
<p>
\[ SMALL(array, k) \]
</p>

<ul class="org-ul">
<li>array: 需要查找的区域.</li>
<li>k: 要查找的最小值的排名.如 k 为2,则返回数组中第二小的值.</li>
</ul>

<p>
SMALL 函数用于返回 array 中第 k 小的值.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org5e9f9f7">
=SMALL({1,2,3,4,5}, 4)
1,2,3,4,5 中第4 小的值为 4
=SMALL({1,2,3,4,5}, {1,2})
这是一个数组公式, 按 Ctrl+Shift+Enter, 然后填充单元格可以得到第一和第二小的值 1 和 2
=AVERAGE(SMALL(B2:B12), {1,2,3,4,5})
从 B2:B12 中选出分数最低的 5 个分数,然后计算平均分.
</pre>
</div>
</div>
</div>


<div id="outline-container-orge84396f" class="outline-4">
<h4 id="orge84396f"><span class="section-number-4">2.6.4.</span> 排位统计函数(5)</h4>
<div class="outline-text-4" id="text-2-6-4">
<blockquote>
<p>
rank,quartile,percentile,percentrank 都是最早版本的函数,与 EXCEL 2007 以及更早的
excel 版本兼容.它们在新版本中被替换为了一个或多个精确度更高的函数.
</p>
</blockquote>
</div>
<div id="outline-container-orgc985a6a" class="outline-5">
<h5 id="orgc985a6a"><span class="section-number-5">2.6.4.1.</span> RANK.EQ 函数(返回数据的排位,相同值返回最高排序)</h5>
<div class="outline-text-5" id="text-2-6-4-1">
<p>
\[ RANK.EQ(number,ref,[order]) \]
</p>

<ul class="org-ul">
<li>number: 要查找排位的数.</li>
<li>ref: 数字数组.</li>
<li>order: 排位方式,0 表示降序, 1 表示升序. 省略则默认为降序排序.</li>
</ul>


<p>
RANK.EQ 函数用于返回 number 在 ref 这组数据中的排序位置, 其中, ref 这组数据必需
包含 number 否则会返回 #N/A 错误. 多个相同的 number 值则返回 number 的最高排序.
</p>


<p>
使用示例:
</p>
<pre class="example" id="orge7cbdae">
=RANK.EQ(D2,D2:D14)
假设D 列为成绩列,这个公式可以返回每个人的成绩排名第几.
</pre>
</div>
</div>
<div id="outline-container-org45393ca" class="outline-5">
<h5 id="org45393ca"><span class="section-number-5">2.6.4.2.</span> RANK.AVG 函数(返回数据的排位,相同值返回排序的平均值)</h5>
<div class="outline-text-5" id="text-2-6-4-2">
<p>
\[ RANK.AVG(number,ref,[order]) \]
</p>

<ul class="org-ul">
<li>number: 要查找排位的数.</li>
<li>ref: 数字数组.</li>
<li>order: 排位方式,0 表示降序, 1 表示升序. 省略则默认为降序排序.</li>
</ul>


<p>
RANK.AVG 函数与 RANK.EQ 的基本功能没有区别,只有当出现相同排序,即 ref 中有多个
number 值时有所不同, RANK.AVG 会返回排名的均值,而 RANK.EQ 会返回最高的排名,例
如,1,在 1,1,3 中有两个, RANK.EQ 对1 的排序是 2 和 3, 返回最高排序2, RANK.AVG 则
返回 (2+3)/2= 2.5
</p>


<p>
使用示例:
</p>
<pre class="example" id="org6b30abc">
=RANK.AVG(2,B2:B5)
B2:B5 为 1,2,2,3 ,2 在其中排名第2,3位,rank.avg 返回 2.5, rank.eq 返回 2.
</pre>
</div>
</div>

<div id="outline-container-orgf4c0fa5" class="outline-5">
<h5 id="orgf4c0fa5"><span class="section-number-5">2.6.4.3.</span> QUARTILE.INC, QUARTILE.EXC 函数</h5>
<div class="outline-text-5" id="text-2-6-4-3">
<p>
\[ QUARTILE.INC(array, quart) \]
</p>

<ul class="org-ul">
<li>array: 表示要求得四分位数值的区域.</li>
<li>quart: 决定返回哪一个四分位值.</li>
</ul>


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 9:</span> quart 可选值</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">quart</td>
<td class="org-left">含义</td>
</tr>

<tr>
<td class="org-left">"0"</td>
<td class="org-left">最小值</td>
</tr>

<tr>
<td class="org-left">"1"</td>
<td class="org-left">第一个四分位值(25%处的值)</td>
</tr>

<tr>
<td class="org-left">"2"</td>
<td class="org-left">第二个四分位值(50%处的值)</td>
</tr>

<tr>
<td class="org-left">"3"</td>
<td class="org-left">第三个四分位值(75%处的值)</td>
</tr>

<tr>
<td class="org-left">"4"</td>
<td class="org-left">最大值</td>
</tr>
</tbody>
</table>

<p>
QUARTILE.INC 函数用于根据0-1 的百分点值(含0和1)返回数据集的四分位值.
QUARTILE.EXC 函数用于根据0-1 的百分点值(不含0和1) 返回数据集的四分位值.
</p>

<blockquote>
<p>
QUARTILE 函数在 EXCEL 2010 之后分成了两个版本, QUARTILE.INC (include) 可以返回最
大最小值, 和 QUARTILE.EXC (exclude) 不含最大值最小值.
因此需要获取最小/大值,就使用 INC 版本,不然就可以使用 EXC 版本,在我看来只用记忆
QUARTILE.INC 就可以了.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="org22088c6">
=QUARTILE.INC({1,3,4},0)
返回最小值 1, 这种用法其实完全可以替代最大/小值函数.
</pre>
</div>
</div>

<div id="outline-container-org039cb77" class="outline-5">
<h5 id="org039cb77"><span class="section-number-5">2.6.4.4.</span> PERCENTILE.INC, PERCENTILE.EXC 函数</h5>
<div class="outline-text-5" id="text-2-6-4-4">
<p>
\[ PERCENTILE.INC(array,k) \]
</p>

<ul class="org-ul">
<li>array: 表示要获取百分比位值的区域.</li>
<li>k: 0-1 的百分点值,包含0和1.</li>
</ul>


<blockquote>
<p>
如果 k 不是 1/(n-1) 的倍数,则使用插值法确定第 k 个百分点的值. 例如, 1,2,3,4 取
k=0.5 ,不是 1/3 的倍数,则使用插值法确定 k 个百分比的值. 插值法以多个离散点为基础,为
了取得一个原数据集没有的,但近似符合原数据规律的值.
</p>
</blockquote>
<p>
PERCENTILE.INC 函数用于返回区域中数值的第 k 个百分点的值, k 为0-1 的百分点,包含0
和1.
PERCENTILE.EXC 函数用于返回区域中数值的第 k 个百分点的值, k 为0-1 的百分点,不含0
和1
</p>


<p>
使用示例:
</p>
<pre class="example" id="org6555e32">
=PERCENTILE.INC({1,3,4},1)
返回位于 100% 的值,也就是最大的值
=PERCENTILE.INC({1,2,3},0.25)
0.25 不是 1/2 的倍数,因此使用插值法取得的近似值作为返回值. 如果是线性插值法,这个 (1,1),(2,2),(3,3) 的
数据集很容易得出是一条 y=x 的直线上的点,因此取百分比就是 0.25 了.
</pre>
</div>
</div>
<div id="outline-container-orgb06d25d" class="outline-5">
<h5 id="orgb06d25d"><span class="section-number-5">2.6.4.5.</span> PERCENTRANK.INC, PERCENTRANK.EXC 函数</h5>
<div class="outline-text-5" id="text-2-6-4-5">
<p>
\[ PERCENTRANK.INC(array, x, [significance]) \]
</p>

<ul class="org-ul">
<li>array: 要定位相对位置的区域.</li>
<li>x: 要在 array 中找到排位的值.</li>
<li>significance: 返回的百分数值的有效位数.默认为保留3为小数</li>
</ul>


<p>
PERCENTRANK.INC 函数用于返回特定数值 x 在 array 区域中的百分比排名,包含0和1.
PERCENTRANK.EXC 函数用于返回特定数值 x 在 array 区域中的百分比排名,不含0和1.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgbce7454">
=PERCENTRANK.INC({1,2,3}, 3)
3 位于 1,2,3 中的 100% ,也就是最大处.
=PERCENTRANK.EXC({1,2,3}, 3)
因为不含 100% 和 0, 所以3 位于 1,2,3 中的 75% 处.
</pre>
</div>
</div>
</div>

<div id="outline-container-org13509fd" class="outline-4">
<h4 id="org13509fd"><span class="section-number-4">2.6.5.</span> 方差,协方差与偏差函数(12)</h4>
<div class="outline-text-4" id="text-2-6-5">
<blockquote>
<p>
方差:
\[ \sigma^2 = \frac{\sum_{i=1}^{N}(x_i-\overline{x})^2}{N}, N 为样本个数\]
总体方差:
对整个总体数据运用方差算法计算的结果.
样本方差:
对样本数据运用&#x2026;.
</p>

<p>
.S 函数都是基于样本计算样本的方差,标准差等
.P 函数都是基于样本估算总体的方差,标准差等.
A 函数是将文本和逻辑值纳入计算范围计算方差,标准差等.
</p>
</blockquote>
</div>

<div id="outline-container-orgd1f008e" class="outline-5">
<h5 id="orgd1f008e"><span class="section-number-5">2.6.5.1.</span> VAR.S 函数(计算基于样本的方差)</h5>
<div class="outline-text-5" id="text-2-6-5-1">
<p>
\[ VAR.S(number1, [number2], \cdots) \]
</p>

<ul class="org-ul">
<li>number1, &#x2026; : 样本总体的1-255 个参数.</li>
</ul>


<p>
VARS.S 函数用于估算基于样本的方差(忽略逻辑值和文本值), 方差越小,表示数据越稳定,
就是数据间的差别越小.
</p>
<blockquote>
<p>
方差越大,算术平均值越不能表示数据的一般水平.
</p>
</blockquote>

<p>
使用示例:
</p>
<pre class="example" id="orgc39a755">
=VAR.S(A2:A12)
A2:A12 为某个产品的质量指数,计算处的方差越小,表示这批产品的品控越好.
</pre>
</div>
</div>

<div id="outline-container-orgbef414c" class="outline-5">
<h5 id="orgbef414c"><span class="section-number-5">2.6.5.2.</span> VARA 函数(计算基于样本的方差, 文本和逻辑值也参与计算)</h5>
<div class="outline-text-5" id="text-2-6-5-2">
<p>
\[ VARA(number1, [number2], \cdots) \]
</p>

<ul class="org-ul">
<li>number1,&#x2026; : 样本总体的1-255 个参数.</li>
</ul>


<p>
VARA 函数用于估算给定样本的方差,与 VAR.S 的区别在于文本值和逻辑值也参与计算, 文
本值和 FALSE 视为0, TRUE 视为 1.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org115d364">
=VARA(A2:A12)
</pre>
</div>
</div>

<div id="outline-container-org2ae817f" class="outline-5">
<h5 id="org2ae817f"><span class="section-number-5">2.6.5.3.</span> VAR.P 函数(基于样本计算总体的方差)</h5>
<div class="outline-text-5" id="text-2-6-5-3">
<p>
\[ VAR.P(number1,[number2], \cdots) \]
</p>

<ul class="org-ul">
<li>number1, number2,&#x2026; : 样本的1-255 个参数.</li>
</ul>


<p>
VAR.P 函数基于 number1 到 numbern 这 n 个样本来估算总体的方差.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgaaccd88">
=VAR.P(A2:A12)
这个结果会与 VAR.S 不同,因为一个是估算以样本为总体的方差(VAR.S), 一个是基于样本,
估算总体的方差(VAR.P)
</pre>
</div>
</div>

<div id="outline-container-org74a4aa1" class="outline-5">
<h5 id="org74a4aa1"><span class="section-number-5">2.6.5.4.</span> VARPA 函数(基于样本计算总体的方差,文本和逻辑值也参与计算)</h5>
<div class="outline-text-5" id="text-2-6-5-4">
<p>
\[ VARPA(value1, value2, \cdots) \]
</p>

<ul class="org-ul">
<li>value1, &#x2026; : 样本的 1-255 个参数.</li>
</ul>


<p>
VARPA 函数基于 value1 到 value n 这 n 个样本来估算总体方差, 文本值和 FALSE 视为
0, TRUE 视为 1.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org89adf31">
=VARPA(A2:A15)
</pre>
</div>
</div>

<div id="outline-container-orgadb4653" class="outline-5">
<h5 id="orgadb4653"><span class="section-number-5">2.6.5.5.</span> STDEV.S 函数(基于样本估算标准差)</h5>
<div class="outline-text-5" id="text-2-6-5-5">
<p>
\[ STDEV.S(number1, [number2], \cdots) \]
</p>

<ul class="org-ul">
<li>number1, &#x2026; : 样本的 1-255 个参数.</li>
</ul>


<p>
STDEV.S 函数基于样本估算标准偏差(忽略逻辑和文本值).
标准偏差反映数值相对于平均值的离散程度.
</p>

<p>
使用示例:
</p>
<pre class="example" id="org4d809ef">
=STDEV.S(A2:A15)
</pre>
</div>
</div>

<div id="outline-container-org3ba8f61" class="outline-5">
<h5 id="org3ba8f61"><span class="section-number-5">2.6.5.6.</span> STDEVA 函数(基于样本估算标准偏差,文本和逻辑值也参与计算)</h5>
<div class="outline-text-5" id="text-2-6-5-6">
<p>
\[ STDEVA(value1, value2, ...) \]
</p>

<ul class="org-ul">
<li>value1, &#x2026; : 样本的 1-255 个参数.</li>
</ul>


<p>
STDEVA 函数基于样本估计标准偏差(文本和 FALSE 视为0,TRUE 视为1).
</p>
<blockquote>
<p>
包含文本或逻辑值的标准偏差一般用于样本包含 "无效数据" 的情况下估算样本的标准偏差.
</p>
</blockquote>
<p>
使用示例:
</p>
<pre class="example" id="org50e4285">
=STDEVA(A2:A15)
</pre>
</div>
</div>
<div id="outline-container-org86c1644" class="outline-5">
<h5 id="org86c1644"><span class="section-number-5">2.6.5.7.</span> STDEV.P 函数(基于样本估算总体的标准偏差)</h5>
<div class="outline-text-5" id="text-2-6-5-7">
<p>
\[ STDEV.P(number1, [number2], \cdots) \]
</p>

<ul class="org-ul">
<li>number1, &#x2026; : 样本的1-255 个参数.</li>
</ul>


<p>
STDEV.P 函数用于根据样本估算总体的标准偏差.
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgd5cbcb5">
=STDEV.P(A2:A12)
</pre>
</div>
</div>
<div id="outline-container-orgba28d65" class="outline-5">
<h5 id="orgba28d65"><span class="section-number-5">2.6.5.8.</span> STDEVPA 函数(基于样本估算总体的标准偏差,文本和逻辑值也参与计算)</h5>
<div class="outline-text-5" id="text-2-6-5-8">
<p>
\[ STDEVPA(value1, value2, \cdots) \]
</p>

<ul class="org-ul">
<li>_ :</li>
</ul>


<p>
VARS.S 函数用于
</p>

<p>
使用示例:
</p>
<pre class="example" id="orgd9aeea8">

</pre>
</div>
</div>
<div id="outline-container-orgdbd1dcb" class="outline-5">
<h5 id="orgdbd1dcb"><span class="section-number-5">2.6.5.9.</span> VAR.S 函数(计算基于样本的方差)</h5>
<div class="outline-text-5" id="text-2-6-5-9">
<p>
\[ _ \]
</p>

<ul class="org-ul">
<li>_ :</li>
</ul>


<p>
VARS.S 函数用于
</p>

<p>
使用示例:
</p>
<pre class="example" id="org7da091d">

</pre>
</div>
</div>
<div id="outline-container-org2b275b9" class="outline-5">
<h5 id="org2b275b9"><span class="section-number-5">2.6.5.10.</span> VAR.S 函数(计算基于样本的方差)</h5>
<div class="outline-text-5" id="text-2-6-5-10">
<p>
\[ _ \]
</p>

<ul class="org-ul">
<li>_ :</li>
</ul>


<p>
VARS.S 函数用于
</p>

<p>
使用示例:
</p>
<pre class="example" id="orge46dbef">

</pre>
</div>
</div>
<div id="outline-container-orgafe0534" class="outline-5">
<h5 id="orgafe0534"><span class="section-number-5">2.6.5.11.</span> VAR.S 函数(计算基于样本的方差)</h5>
<div class="outline-text-5" id="text-2-6-5-11">
<p>
\[ _ \]
</p>

<ul class="org-ul">
<li>_ :</li>
</ul>


<p>
VARS.S 函数用于
</p>

<p>
使用示例:
</p>
<pre class="example" id="org7c4347a">

</pre>
</div>
</div>
<div id="outline-container-org07d5c07" class="outline-5">
<h5 id="org07d5c07"><span class="section-number-5">2.6.5.12.</span> VAR.S 函数(计算基于样本的方差)</h5>
<div class="outline-text-5" id="text-2-6-5-12">
<p>
\[ _ \]
</p>

<ul class="org-ul">
<li>_ :</li>
</ul>


<p>
VARS.S 函数用于
</p>

<p>
使用示例:
</p>
<pre class="example" id="org6a83d72">

</pre>
</div>
</div>
</div>

<div id="outline-container-org05c3c41" class="outline-4">
<h4 id="org05c3c41"><span class="section-number-4">2.6.6.</span> 概率分布函数(44)</h4>
</div>
<div id="outline-container-orgadb8ebd" class="outline-4">
<h4 id="orgadb8ebd"><span class="section-number-4">2.6.7.</span> 检验函数(4)</h4>
</div>
<div id="outline-container-orgf5dd6c7" class="outline-4">
<h4 id="orgf5dd6c7"><span class="section-number-4">2.6.8.</span> 回归分析函数(8)</h4>
</div>
<div id="outline-container-org6baeb58" class="outline-4">
<h4 id="org6baeb58"><span class="section-number-4">2.6.9.</span> 相关系数分析(4)</h4>
</div>
<div id="outline-container-org6d96535" class="outline-4">
<h4 id="org6d96535"><span class="section-number-4">2.6.10.</span> 其他统计函数(7)</h4>
</div>
</div>

<div id="outline-container-orgb547154" class="outline-3">
<h3 id="orgb547154"><span class="section-number-3">2.7.</span> 财务函数(55)</h3>
</div>

<div id="outline-container-orgd335442" class="outline-3">
<h3 id="orgd335442"><span class="section-number-3">2.8.</span> 查找和引用函数(18)</h3>
</div>

<div id="outline-container-orgd097e60" class="outline-3">
<h3 id="orgd097e60"><span class="section-number-3">2.9.</span> 数据库函数(12)</h3>
</div>

<div id="outline-container-orgbe92402" class="outline-3">
<h3 id="orgbe92402"><span class="section-number-3">2.10.</span> 工程函数(54)</h3>
</div>

<div id="outline-container-org86c2b80" class="outline-3">
<h3 id="org86c2b80"><span class="section-number-3">2.11.</span> 加载项和自动化函数(4)</h3>
</div>

<div id="outline-container-org02ec079" class="outline-3">
<h3 id="org02ec079"><span class="section-number-3">2.12.</span> 多维数据集函数(7)</h3>
</div>

<div id="outline-container-org7a84b05" class="outline-3">
<h3 id="org7a84b05"><span class="section-number-3">2.13.</span> 兼容性函数(38)</h3>
</div>

<div id="outline-container-org62aa9d8" class="outline-3">
<h3 id="org62aa9d8"><span class="section-number-3">2.14.</span> Web函数(3)</h3>
</div>

<div id="outline-container-org90e5076" class="outline-3">
<h3 id="org90e5076"><span class="section-number-3">2.15.</span> <span class="todo TODO">TODO</span> 名称的定义与使用</h3>
</div>
</div>

<div id="outline-container-orga3b5933" class="outline-2">
<h2 id="orga3b5933"><span class="section-number-2">3.</span> <span class="todo NEXT">NEXT</span> 和秋叶一起学 Excel (3rd)</h2>
<div class="outline-text-2" id="text-3">
<blockquote>
<p>
读这本书的时候已经有了一定的 Excel 基础功能用法以及各种函数的基础知识了,因此这本
书不记录细致的笔记,只记录重点.
</p>
</blockquote>
</div>

<div id="outline-container-org5d7a0ce" class="outline-3">
<h3 id="org5d7a0ce"><span class="section-number-3">3.1.</span> <span class="done DONE">DONE</span> 快速认识 Excel</h3>
<div class="outline-text-3" id="text-3-1">
</div>
<div id="outline-container-org178628c" class="outline-4">
<h4 id="org178628c"><span class="section-number-4">3.1.1.</span> <span class="done DONE">DONE</span> Excel 到底有什么用</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
按照直觉的一般认识, Excel 是一个记录数据,处理数据的软件.
</p>

<p>
从 Excel 软件自身来讲,它是一个由大量格子(单元格)组成的空白画布,这个画布最常用的
用途是储存数据信息,但就跟一张真实的格子纸一样,除了储存数据,其用途是由画布上的内
容决定的,各种与表格相关的用途都可以由它完成.
</p>
</div>

<div id="outline-container-orgd8efa0d" class="outline-5">
<h5 id="orgd8efa0d"><span class="section-number-5">3.1.1.1.</span> <span class="done DONE">DONE</span> 排版工具</h5>
<div class="outline-text-5" id="text-3-1-1-1">
<p>
Excel 的单元格可以设置边框颜色,填充颜色,多个单元格还可以合并,因此很适合对数据进
行排版和布局,例如舞台嘉宾的座次表,上学时老师调的座位表等类似的表格,在书中我甚至
还看到了Oxygen Not Included 里的房间布局图,因为缺氧是二维的游戏,房间只有上下左右,就
像搭一个平面的楼房一样,所以也很适合用 Excel 做布局图. 日历也是一天天的,因此也很
适合用 Excel 做计划表,月计划,周计划的表格都很方便.
</p>
</div>
</div>

<div id="outline-container-orgf30c28d" class="outline-5">
<h5 id="orgf30c28d"><span class="section-number-5">3.1.1.2.</span> <span class="done DONE">DONE</span> 表单工具</h5>
<div class="outline-text-5" id="text-3-1-1-2">
<p>
由于单元格是可调整的,因此非常适合用来做随处可见的表单. 我们填过的登记表,花名册等
等这类表格都很容易用 Excel 做出.
</p>
</div>
</div>

<div id="outline-container-org55cf1be" class="outline-5">
<h5 id="org55cf1be"><span class="section-number-5">3.1.1.3.</span> <span class="done DONE">DONE</span> 统计工具</h5>
<div class="outline-text-5" id="text-3-1-1-3">
<p>
Excel 能对表格中的数据进行排序和筛选,通常这是应用于储存数据的基础数据表的.除了已
有的可点击的功能,还有许多函数可以使用来对数据进行统计汇总.
</p>
</div>
</div>

<div id="outline-container-org040c341" class="outline-5">
<h5 id="org040c341"><span class="section-number-5">3.1.1.4.</span> <span class="done DONE">DONE</span> 汇报工具</h5>
<div class="outline-text-5" id="text-3-1-1-4">
<p>
上面的统计是处理基础的数据表,但做数据汇报时是无法使用具有大量数据的基础数据表的,
使用图表,条件格式,数据透视表,函数公式等功能,可以生成直观且美观甚至是可交互的动态
表格.
</p>
</div>
</div>
</div>















<div id="outline-container-org214f869" class="outline-4">
<h4 id="org214f869"><span class="section-number-4">3.1.2.</span> <span class="done DONE">DONE</span> 方法不对,Excel 越用越累</h4>
<div class="outline-text-4" id="text-3-1-2">
<p>
前面说了 Excel 可以用作排版,表单,统计,汇报. 这部分会介绍排版和统计:
</p>
<ul class="org-ul">
<li>排版打印类表格: 这类表格只用考虑美观和好看,但这类表格不能用于数据分析.</li>
<li>统计分析类表格: 这类表格一般都是基础数据表,不能有错误数据以及空白数据,是专门用
于数据分析的.</li>
</ul>
</div>


<div id="outline-container-org52c9a51" class="outline-5">
<h5 id="org52c9a51"><span class="section-number-5">3.1.2.1.</span> <span class="done DONE">DONE</span> 排版打印类表格</h5>
<div class="outline-text-5" id="text-3-1-2-1">
<p>
排版打印类表格的重点是对信息的梳理和排版: 信息分类, 表格排版和打印设置
</p>

<dl class="org-dl">
<dt>信息分类</dt><dd>如果表格的数据比较乱,那首先就要对信息进行分类整理,同类数据放置到一
起才能让数据有条理,更容易理解和阅读.</dd>
<dt>表格排版</dt><dd>基于平面设计中排版的 4 个原则(对比, 对齐, 重复, 亲密) 为信息设置样
式来突出重要信息:
<ul class="org-ul">
<li>对比: 使用加粗文字,填充颜色等来区分标题和正文.</li>
<li>对齐: 设置单元格中表格的对齐方式,例如数字右对齐,文字左对齐,让表格内容整洁.</li>
<li>重复: 同类单元格的样式要统一,并不断重复,这样表格才会看起来样式统一.</li>
<li>亲密: 不同信息模块可以使用合并单元格,插入空白(行或列) 的操作增强信息的亲密性.</li>
</ul></dd>
<dt>打印设置</dt><dd>排版后的表格看起来是 Excel 中的视觉样式,要打印在纸张上,需要结合纸
张的大小做细节的调整:
<ul class="org-ul">
<li>调整打印页面的尺寸.</li>
<li>设置分页位置.</li>
<li>页眉和页脚添加公司信息,页码信息,水印等等.</li>
</ul></dd>
</dl>
</div>
</div>


<div id="outline-container-orgbd93109" class="outline-5">
<h5 id="orgbd93109"><span class="section-number-5">3.1.2.2.</span> <span class="done DONE">DONE</span> 统计分析类表格</h5>
<div class="outline-text-5" id="text-3-1-2-2">
<p>
Excel 有强大的数据处理功能,也是它最常用的功能,通常我们都用它来分析数据并将分析结
果进行可视化呈现.
</p>

<p>
数据分析的流程:
</p>

<dl class="org-dl">
<dt>获取数据</dt><dd>数据源通常是从其他数据系统中导出的数据,例如打卡器中导出的打卡数据,
数据库软件中导出的业务数据等.</dd>
<dt>整理数据</dt><dd>数据源的数据通常是不符合 Excel 基础数据表规范的数据,会有错误值,空
值等,我们需要使用函数公式或 VBA 或 Power Query 以及其他工具来将数据 "清洗" 干
净.</dd>
<dt>统计分析</dt><dd>得到规范的基础数据表后,就可以开始统计分析了:
<ul class="org-ul">
<li>分析: 明确分析的需求,例如想要从数据中得出哪方面的结论,想要解决什么问题. 这一
步需要熟悉业务流程,要拆解问题,明确分析思路.</li>
<li>统计: 根据需求进行数据的统计,提炼和观点总结. 这一步需要熟练使用数据透视表,函
数公式以及数据统计方法.</li>
</ul></dd>
<dt>图表呈现</dt><dd>分析的结果是以数据形式储存在格子中的,例如总量,均值,方差等,直接从单
元格中读取数据进行比对是不利于阅读的,最好的方式就是做成图表形式,可以更直观观察
数据的特点,典型也是高级一点的用例就是动态图表的绘制和使用.</dd>
</dl>
</div>
</div>
</div>


<div id="outline-container-org6ad52af" class="outline-4">
<h4 id="org6ad52af"><span class="section-number-4">3.1.3.</span> <span class="done DONE">DONE</span> 熟悉 Excel</h4>
<div class="outline-text-4" id="text-3-1-3">
<p>
这部分讲解 Excel 各个区域的名称和大致功能.
</p>
</div>

<div id="outline-container-org50fb30d" class="outline-5">
<h5 id="org50fb30d"><span class="section-number-5">3.1.3.1.</span> <span class="done DONE">DONE</span> 打开 Excel</h5>
<div class="outline-text-5" id="text-3-1-3-1">
<p>
鼠标右键,新建 Excel 工作表,然后双击新建的工作表就可以打开 Excel . 也可以直接找到
计算机中 Excel 的程序图表,点击后可以打开 Excel.
</p>
</div>
</div>

<div id="outline-container-org3794e40" class="outline-5">
<h5 id="org3794e40"><span class="section-number-5">3.1.3.2.</span> <span class="done DONE">DONE</span> Excel 的工作界面</h5>
<div class="outline-text-5" id="text-3-1-3-2">
<dl class="org-dl">
<dt>菜单栏</dt><dd>Excel 的主要可点击功能都在这部分,不同的功能区域被叫做 "选项卡", 不同
的选项卡中都有着许多不同功能.</dd>
<dt>公式栏</dt><dd>帮助编写和修改函数公式的区域.</dd>
<dt>文档编辑区域</dt><dd>存放和处理数据的区域,也被叫做 "工作表", 就是我们看到的许许多多
个单元格组成的区域.</dd>
<dt>工作表标签</dt><dd>一个表格文件(工作簿)可以有多个不同的工作表,工作表标签区域可以通
过单击来选择不同的工作表.</dd>
<dt>状态栏</dt><dd>状态栏会显示简要的信息,帮助用户了解工作表的状态.</dd>
</dl>
</div>
</div>


<div id="outline-container-orgc9ef4ad" class="outline-5">
<h5 id="orgc9ef4ad"><span class="section-number-5">3.1.3.3.</span> <span class="done DONE">DONE</span> 上下文选项卡</h5>
<div class="outline-text-5" id="text-3-1-3-3">
<p>
Excel 中有种特殊的选项卡,平常是不会显示在菜单栏的,只有在选定特定对象后才会出现,
这种选项卡被称为 "上下文选项卡":
</p>
<ul class="org-ul">
<li>图片: 选择图片对象后,会出现 [图片格式] 选项卡.</li>
<li>形状: 选择形状对象后,会出现 [形状格式] 选项卡.</li>
<li>数据透视表: 选择数据透视表后,会出现 [数据透视表分析] 和 [设计] 选项卡.</li>
<li>图表: 选择图表后,会出现 [图表设计] 和 [格式] 选项卡.</li>
<li>超级表格: 选择超级表格后,会出现 [表设计] 选项卡.</li>
</ul>
</div>
</div>


<div id="outline-container-orgb379767" class="outline-5">
<h5 id="orgb379767"><span class="section-number-5">3.1.3.4.</span> <span class="done DONE">DONE</span> 工作簿与工作表</h5>
<div class="outline-text-5" id="text-3-1-3-4">
<p>
工作簿是一个 Excel 文件,工作表是工作簿中储存数据的表格.
</p>

<p>
一个工作簿可以包含多个工作表,一个工作表只属于一个工作簿.
</p>
</div>
</div>

<div id="outline-container-org88741a6" class="outline-5">
<h5 id="org88741a6"><span class="section-number-5">3.1.3.5.</span> <span class="done DONE">DONE</span> 单元格</h5>
<div class="outline-text-5" id="text-3-1-3-5">
<p>
单元格是 Excel 中储存,处理,计算数据的最小单位, 多个单元格构成一个工作表,多个(一
个)工作表构成一个工作簿.
</p>

<ul class="org-ul">
<li>单元格列号: 文档编辑区域顶部的字母表示单元格的列序号.</li>
<li>单元格行号: 文档编辑区域左侧的数字表示单元格的行序号.</li>
<li>单元格座标: 公式栏的名称框会实时显示当前选中的单元格的坐标.</li>
<li>单元格内容: 公式栏的编辑框中可以看到选中单元格保存的数据或函数公式.</li>
</ul>
</div>
</div>
</div>
</div>








<div id="outline-container-orga32ebf4" class="outline-3">
<h3 id="orga32ebf4"><span class="section-number-3">3.2.</span> <span class="done DONE">DONE</span> 准确,高效地录入数据</h3>
<div class="outline-text-3" id="text-3-2">
</div>
<div id="outline-container-org8fdc3b2" class="outline-4">
<h4 id="org8fdc3b2"><span class="section-number-4">3.2.1.</span> <span class="done DONE">DONE</span> 录入数据的诀窍</h4>
<div class="outline-text-4" id="text-3-2-1">
<p>
Excel 数据源主要有三种:
</p>
<ul class="org-ul">
<li>外部数据文件导入.</li>
<li>其他 Excel 表格文件中调入.</li>
<li>手动输入.</li>
</ul>


<p>
最简单的是手动输入,但费时费力.因此掌握高效录入数据的诀窍十分重要.
</p>
</div>

<div id="outline-container-orga7bdd0b" class="outline-5">
<h5 id="orga7bdd0b"><span class="section-number-5">3.2.1.1.</span> <span class="done DONE">DONE</span> 减少在鼠标和键盘间来回切换</h5>
<div class="outline-text-5" id="text-3-2-1-1">
<p>
[tab] 键会将当前选中单元格的右边一个单元格设置为选中的单元格, [enter] 键会将当前
选中单元格的下面一个单元格设置为选中的单元格.同时按下 [shift] 和 [tab] 或
[enter] 会以相反的方向设置活动单元格. 上下左右的方向键也是分别将当前选中单元格的
上下左右的一个单元格设置为活动单元格.
</p>

<p>
使用这些按键来选中单元格输入数据就不用切换手去操作鼠标了.
</p>
</div>
</div>

<div id="outline-container-orgaa40581" class="outline-5">
<h5 id="orgaa40581"><span class="section-number-5">3.2.1.2.</span> <span class="done DONE">DONE</span> 使用快捷键一键录入数据</h5>
<div class="outline-text-5" id="text-3-2-1-2">
<ul class="org-ul">
<li>[Ctrl+;] 可以快速录入当前日期.</li>

<li>[Ctrl+Shift+;] 可以快速输入当前时间.</li>

<li>[Alt+Enter] 可以在单元格中输入换行符.</li>
</ul>
</div>
</div>


<div id="outline-container-org197298b" class="outline-5">
<h5 id="org197298b"><span class="section-number-5">3.2.1.3.</span> <span class="done DONE">DONE</span> 批量录入相同数据</h5>
<div class="outline-text-5" id="text-3-2-1-3">
<p>
[Ctrl+Enter] 可以批量输入相同的数据. 这是一个快速复制的快捷键,用途是将已有的单元
格中的数据快速复制到所有选中的单元格中空白单元格中.
</p>

<p>
用法是先选中单元格区域,然后直接输入数据,输入完第一个数据后之间使用 [Ctrl+Enter]
快捷键,就可以将数据复制到选中区域内未输入数据的单元格中(公式的复制不是完全照抄的
复制).
</p>
</div>
</div>

<div id="outline-container-orgfde533b" class="outline-5">
<h5 id="orgfde533b"><span class="section-number-5">3.2.1.4.</span> <span class="done DONE">DONE</span> 在不相邻的行或列中批量录入数据</h5>
<div class="outline-text-5" id="text-3-2-1-4">
<p>
与快速复制相似的一个功能叫做快速填充,快捷键是 [Ctrl+D] 向下填充,[Ctrl+R] 是向右
填充,他们用于在已有数据的基础上批量录入数据(快速复制是在选中单元格中没有任意数据
时快速录入,稍有不同).先输入一行/列数据,然后选中这一行/列以及不相邻的要输入数据的
几行/列,按下[Ctrl+D] 或 [Ctrl+R], 就可以快速向空白单元格中填充数据.
</p>

<p>
注意,因为是向下/右填充,最后选中的那个单元格必须是有数据的那个单元格,才能向下/右
填充数据。
另外, 向下/右填充优于快速复制的一点是它可以以多个单元格数据为蓝本进行复制,而快速
复制只能以当前输入的单元格数据为蓝本.
</p>
</div>
</div>
</div>

<div id="outline-container-org01a20b8" class="outline-4">
<h4 id="org01a20b8"><span class="section-number-4">3.2.2.</span> <span class="done DONE">DONE</span> 批量填充序号</h4>
<div class="outline-text-4" id="text-3-2-2">
<p>
向表格中录入数据时,经常会需要输入每条数据的序号,编号,序列号等等.手动输入显然不太
现实,利用好 Excel 提供的自动填充功能,就能快速地批量填充序号.
</p>
</div>

<div id="outline-container-org06678e3" class="outline-5">
<h5 id="org06678e3"><span class="section-number-5">3.2.2.1.</span> <span class="done DONE">DONE</span> 录入连续序号</h5>
<div class="outline-text-5" id="text-3-2-2-1">
<p>
连续的阿拉伯数字作为序号是最常见的.输入连续的阿拉伯数字序号有三种方法:
</p>
<dl class="org-dl">
<dt>拖曳填充</dt><dd>选中单元格(区域)后,单元格(区域)右下角会出现一个小方块,这个方块叫做
填充柄,将鼠标移动到填充柄位置,鼠标会变成十字形状,单击鼠标,向下拖曳,就能快速根
据已有数据进行填充(已有数据是选中单元格/区域内的数据,例如选中区域只有数字1,那
么填充的数据全是数字1,如果已有数据是 1 2 ,也就是有两个单元格有数据,那么填充的
数据是 3, 4, &#x2026;)</dd>
<dt>双击填充</dt><dd>双击填充是一种特殊的拖曳填充,鼠标双击填充柄,就能自动将数据填充至最
后一行.</dd>
<dt>序列填充</dt><dd>如果序列有间隔以及数量的要求,则可以在 [开始]-[编辑]-[填充]-[序列]
中设置序列为等比序列,等差序列或日期序列等等.</dd>
</dl>


<p>
使用拖拽或双击填充后,会出现一个浮动的 [自动填充选项卡] 在这里可以设置自动填充的
方式,是直接复制,还是填充序列以及其他选项.
</p>
<blockquote>
<p>
自动填充功能还可以只对数据中可以作为序号的数据进行自动填充,例如 第1章, 1 是可以
作为序号的,因此可以填充为 第2章,第3章&#x2026;
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org7d1c9b7" class="outline-5">
<h5 id="org7d1c9b7"><span class="section-number-5">3.2.2.2.</span> <span class="done DONE">DONE</span> 使用自定义序列录入文本序号</h5>
<div class="outline-text-5" id="text-3-2-2-2">
<p>
如果需要录入非阿拉伯数字的序号,例如中文形式的 "第一章",这里就没有数字1 可以作为
序号了,因此上面的录入连续序号的方式无法生效.此时我们就需要自己定义填充序列了.
</p>

<p>
点击 [文件]-[选项]-[高级]-[常规]-[编辑自定义列表] 就可以输入想要录入的文本形式序
号了.例如输入 <code>第一章,第二章,第三章,第四章</code> ,这样对一个包含数据 <code>第一章</code> 的单元
格使用快速填充时,就会自动填充了,但是局限性就是只能自动填充为刚刚输入的列表,也就
是最多到第四章,想要更多,就只有在编辑自定义列表时输入更多,但好处也很明显,只用输入
一次,以后同样的填充就不需要输入了.
</p>

<p>
DONE 调整格式,不再重复操作
Excel 中用来储存 "数据" 的类型,只有两种,文本和数字(日期和时间是特殊的数字).
文本类型默认靠左对齐,数字类型默认靠右对齐.
数字类型可以进行数学运算,而文本类型不可以.以文本形式储存的数字被叫做 "假数字",他
们看起来是数字,但实际上是一个内容为数字的文本数据,因此这种 "假数字" 是靠左对齐的,并
且无法进行正确的数学运算.
</p>

<p>
通过设置单元格格式[Ctrl+1] 可以设置数字的格式,还可以自定义数字格式,其中自定义的
格式代码表如下:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">代码</td>
<td class="org-left">作用</td>
<td class="org-right">原始数据</td>
<td class="org-left">自定义格式</td>
<td class="org-right">应用格式后的数据样式</td>
</tr>

<tr>
<td class="org-left"><code>0</code></td>
<td class="org-left">数字占位,补0</td>
<td class="org-right">12</td>
<td class="org-left">000</td>
<td class="org-right">012</td>
</tr>

<tr>
<td class="org-left"><code>#</code></td>
<td class="org-left">数字占位,不补0</td>
<td class="org-right">12</td>
<td class="org-left">###</td>
<td class="org-right">12</td>
</tr>

<tr>
<td class="org-left"><code>.</code></td>
<td class="org-left">小数点</td>
<td class="org-right">12.3</td>
<td class="org-left">0.00</td>
<td class="org-right">12.30</td>
</tr>

<tr>
<td class="org-left"><code>,</code></td>
<td class="org-left">千位符</td>
<td class="org-right">1234456</td>
<td class="org-left">0,000</td>
<td class="org-right">1,234,456</td>
</tr>

<tr>
<td class="org-left"><code>?</code></td>
<td class="org-left">空格占位符</td>
<td class="org-right">12.3</td>
<td class="org-left">?.??</td>
<td class="org-right">12.3</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org391603e" class="outline-5">
<h5 id="org391603e"><span class="section-number-5">3.2.2.3.</span> <span class="done DONE">DONE</span> 录入数字格式的数据</h5>
<div class="outline-text-5" id="text-3-2-2-3">
<dl class="org-dl">
<dt>数字补0</dt><dd><p>
为了保证数字位数统一,很多编号都会有前导0,但是直接输入 00123,会得到
一个 123 的数字数据,这是因为 Excel 认为它是一个数字 123, 且默认会删除不必要的
0,因此我们得不到想要的 00123 的数据. 这时有两种办法可以得到想要的 00123:
</p>
<ul class="org-ul">
<li>使用文本形式的数字 : 将单元格格式的"数字"选项设置为文本类型,然后输入 00123,
这样输入以及使用快速填充得到的是文本类型的数字.</li>
<li>设置数字格式: 使用前面表格中的占位符,例如想要得到5位数字的编号,将数字的格式
自定义为 00000, 此时再输入数据,即使输入的是 123 , Excel 也会自动显示为 00123.</li>
</ul>
<p>
这两种方式一种输入的是文本数据,一种输入的是数值数据,一般推荐使用第二种,输入数
值数据,因为可能后续会用它做数据分析.
</p></dd>
<dt>手机号分段</dt><dd>为了让手机号以可读性更强的方式显示,我们可以为其设置自定义格式,例
如设置为 000-0000-0000 这样所有的手机号数据都会显示为 123-4567-8900 的形式了,
但他们本质上仍然是11位的数值数据.</dd>
</dl>
</div>
</div>


<div id="outline-container-org611439f" class="outline-5">
<h5 id="org611439f"><span class="section-number-5">3.2.2.4.</span> <span class="done DONE">DONE</span> 录入日期格式的数据</h5>
<div class="outline-text-5" id="text-3-2-2-4">
<p>
Excel 中的日期是特殊的数字,标准的日期格式用斜杠隔开: "year/month/day"
</p>
<dl class="org-dl">
<dt>录入不同格式的日期</dt><dd><p>
以标准格式输入日期时,若月份和日是个位数,则默认只会显示一
位数字,这样看起来数据参差不齐,我们可以像设置数字格式一样设置日期的格式. 格式代
码如下:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">格式代码</td>
<td class="org-left">作用</td>
<td class="org-left">原始数据</td>
<td class="org-left">单元格格式</td>
<td class="org-left">应用格式后的数据样式</td>
</tr>

<tr>
<td class="org-left">ymd</td>
<td class="org-left">日期占位符</td>
<td class="org-left">2021/2/9</td>
<td class="org-left">yyyy.mm.dd</td>
<td class="org-left">2021.02.09</td>
</tr>

<tr>
<td class="org-left">hms</td>
<td class="org-left">时间占位符</td>
<td class="org-left">17:54</td>
<td class="org-left">hh时mm分ss秒</td>
<td class="org-left">17时54分23秒</td>
</tr>

<tr>
<td class="org-left">aaa</td>
<td class="org-left">转义字符</td>
<td class="org-left">2021/2/9</td>
<td class="org-left">aaaa</td>
<td class="org-left">星期二</td>
</tr>

<tr>
<td class="org-left">hms</td>
<td class="org-left">时间占位符</td>
<td class="org-left">1900/1/1</td>
<td class="org-left">[hh]:mm:ss</td>
<td class="org-left">25:54:23</td>
</tr>

<tr>
<td class="org-left">hms</td>
<td class="org-left">时间占位符</td>
<td class="org-left">1900/1/1</td>
<td class="org-left">d hh:mm:ss</td>
<td class="org-left">1 01:54:23</td>
</tr>
</tbody>
</table>

<p>
这些格式代码里只有 aaa 有点特殊,而且在默认的自定义格式示例中是找不到的, aaa 表
示星期数,一到日, aaaa 表示星期一到星期日. 剩下的 ymd, hms 分别表示年月日,时分
秒. 但是在格式设置中有专门的时间和日期格式里可以选择相应的格式.
</p></dd>
</dl>
</div>
</div>




<div id="outline-container-orgac1bfb9" class="outline-5">
<h5 id="orgac1bfb9"><span class="section-number-5">3.2.2.5.</span> <span class="done DONE">DONE</span> 录入文本格式的数据</h5>
<div class="outline-text-5" id="text-3-2-2-5">
<p>
文本格式数据比数字数据的录入要简单一些,常见的需求是添加前缀或后缀,以及在原有文本
数据基础上添加一些其他符号.
</p>

<p>
我们可以使用文本占位符来设置文本格式:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">格式代码</td>
<td class="org-left">作用</td>
<td class="org-right">原始数据</td>
<td class="org-left">格式</td>
<td class="org-left">应用后的数据样式</td>
</tr>

<tr>
<td class="org-left"><code>@</code></td>
<td class="org-left">文本占位符</td>
<td class="org-right">秋叶</td>
<td class="org-left"><code>&lt;@&gt;</code></td>
<td class="org-left">&lt;秋叶&gt;</td>
</tr>

<tr>
<td class="org-left"><code>""</code></td>
<td class="org-left">引用文本</td>
<td class="org-right">12.3</td>
<td class="org-left"><code>0"个"</code></td>
<td class="org-left">12个</td>
</tr>

<tr>
<td class="org-left"><code>!</code></td>
<td class="org-left">转义字符</td>
<td class="org-right">1234456</td>
<td class="org-left"><code>0!.0</code></td>
<td class="org-left">123445.6</td>
</tr>
</tbody>
</table>

<blockquote>
<p>
这种设置格式而不是编辑原始数据的好处是在保证原始数据不被破坏的情况下显示额外的信
息. 例如书名是 <code>Excel 学习手册</code> 而我们想要将书名显示在书名号中,就可以用这种设置
格式的方法.
</p>
</blockquote>
</div>
</div>
</div>

<div id="outline-container-org889c1a7" class="outline-4">
<h4 id="org889c1a7"><span class="section-number-4">3.2.3.</span> <span class="done DONE">DONE</span> 填写选项,就用下拉表</h4>
<div class="outline-text-4" id="text-3-2-3">
<p>
为了保证录入表格中数据的有效性,我们可以使用 Excel 的数据验证功能. 数据验证功能主
要有三个用途: 选择填空,出错警告和预先提醒.
</p>
</div>

<ol class="org-ol">
<li><a id="org1f5b51d"></a><span class="done DONE">DONE</span> 选择填空最保险<br />
<div class="outline-text-6" id="text-3-2-3-0-1">
<p>
经常使用,且不会频繁变动的数据,可以设置成下拉列表,不仅可以提高输入效率,还能限定输
入的内容,确保内容不会出错.
</p>

<p>
下拉表是 [数据]-[数据工具]-[数据验证] 里的功能,将数据验证的验证条件设置为序列值,
选择正确的数据源,就能保证只输入数据源中的数据了.
</p>

<p>
数据源:
</p>
<ul class="org-ul">
<li>手动输入: 与前面的自定义排序用的列表一样,在数据源的编辑框中输入数据,以逗号隔开,就
可以手动设置数据源了.</li>
<li>动态更新: 将数据源设置为表格中某个区域,这样表格中该区域的数据更新(包括新增数
据,Excel 也会自动扩展数据源的区域范围),下拉表的数据也会更新.</li>
</ul>


<p>
删除数据验证只需要选中要删除的区域,在数据验证的对话框中点击[全部清除]按钮即可.
</p>
</div>
</li>

<li><a id="org47c895c"></a><span class="done DONE">DONE</span> 出错警告<br />
<div class="outline-text-6" id="text-3-2-3-0-2">
<p>
当输入的内容与数据验证中的数据源里的内容无法匹配(不一致)时,就会出现错误警告 "此
值与单元格定义的数据验证限制不匹配"这种提示对于不了解 Excel 的人来说可能不太直观.我
们可以在[数据验证] 对话框中点击 [出错警告] 选项,将错误信息的输入栏中输入更加明确
的错误信息,例如 "请在下拉列表中选择对应的值".
</p>
</div>
</li>

<li><a id="orgc3fa511"></a><span class="done DONE">DONE</span> 输入前自动提醒<br />
<div class="outline-text-6" id="text-3-2-3-0-3">
<p>
出错警告是在输入错误数据时才会显示的提示信息,而我们还可以采取预先提醒的方式告知
用户如何输入该区域的数据,就是使用数据验证的[输入信息],设置输入信息,可以在选中该
区域的单元格时就显示提示信息,例如, "请使用下拉列表选择数据" ,这样设置后,只要选中
了该区域的单元格,就会显示这样一条信息告知我们如何输入该列的数据.
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-org37b6d22" class="outline-4">
<h4 id="org37b6d22"><span class="section-number-4">3.2.4.</span> <span class="done DONE">DONE</span> 善用工具,批量导入外部数据</h4>
<div class="outline-text-4" id="text-3-2-4">
<p>
如果需要使用图片,pdf 文件,或是网页中的数据,怎么将他们导入 excel 做成表格呢?
</p>
</div>

<div id="outline-container-orga5e04c7" class="outline-5">
<h5 id="orga5e04c7"><span class="section-number-5">3.2.4.1.</span> <span class="done DONE">DONE</span> 将图片和PDF文件中的数据导入Excel</h5>
<div class="outline-text-5" id="text-3-2-4-1">
<p>
从图片中读取数据制成表格,可以使用 OCR 工具:
</p>
<ul class="org-ul">
<li>微信 OCR 小程序:
在微信小程序中搜索 OCR 找到适合的程序,例如 [夸克扫描王] ,然后选择 [图片转
Excel] 就可以得到转换后的 Excel 文件了.</li>
<li>ABBYY FineReader: 一款与微信 OCR 小程序类似的工具,这个软件的识别率很高. PDF 分
为两种,一种是由基础数据表格转换成的 PDF 可以通过复制粘贴将数据转移到 Excel, 另
一种是图片转换成的 PDF 文件,只能通过对数据进行扫描提取才能得到 Excel 数据文件.</li>
</ul>
</div>
</div>


<div id="outline-container-orge206ca2" class="outline-5">
<h5 id="orge206ca2"><span class="section-number-5">3.2.4.2.</span> <span class="done DONE">DONE</span> 将网页数据导入Excel</h5>
<div class="outline-text-5" id="text-3-2-4-2">
<p>
很多情况下,将网页数据导入 Excel 中,使用 [数据] 选项卡中的 [获取外部数据]-[自网站]
选项就可以了,在打开的对话框中输入网址,点击[连接],选择想要的表格后点击[加载]即可
将网页中的数据导入.
</p>

<p>
现在网络反扒技术都比较普遍了,因此许多网页可能需要设置一些编程相关的参数,甚至设置
了参数也不能直接用 Excel 读取,这时可以使用复制粘贴数据到 Excel 中再做进一步整理.如
果可以直接通过 Excel 导入的数据,只要网站数据更新了,点击 [数据]-[查询和连接]-[全
部刷新]就可以直接在表格中更新数据了.
</p>
</div>
</div>
</div>
</div>


<div id="outline-container-org92e66cd" class="outline-3">
<h3 id="org92e66cd"><span class="section-number-3">3.3.</span> <span class="done DONE">DONE</span> 表格的排版与打印技巧</h3>
<div class="outline-text-3" id="text-3-3">
<p>
这部分主要解决以下问题:
</p>
<ul class="org-ul">
<li class="on"><code>[X]</code> 表格数据量大,浏览不方便.</li>
<li class="off"><code>[&#xa0;]</code> 表格美化太麻烦,设置样式费时费力.</li>
<li class="on"><code>[X]</code> 打印预览与期望不符.</li>
<li class="on"><code>[X]</code> 不知道如何批量操作打印.</li>
<li class="on"><code>[X]</code> 发出去的表格被他人篡改,还可能泄漏公司机密.</li>
</ul>


<blockquote>
<p>
这部分好像没有讲到表格美化的内容,实际上基础地设置表格样式操作很简单,选中需要设置
的单元格区域,按 Ctrl+1 打开单元格格式对话框,选择相应的字体,填充,边框等设置即可.
</p>
</blockquote>
</div>



<div id="outline-container-org0148512" class="outline-4">
<h4 id="org0148512"><span class="section-number-4">3.3.1.</span> <span class="done DONE">DONE</span> 表格高效浏览技巧</h4>
<div class="outline-text-4" id="text-3-3-1">
<p>
表格数据量少时,用鼠标或键盘方向键就足够使用了,但数据量很大时,这就不够了,但只需要
掌握好技巧,不管多大数据量也能很高效地浏览数据.
</p>
</div>

<div id="outline-container-orgcc9439b" class="outline-5">
<h5 id="orgcc9439b"><span class="section-number-5">3.3.1.1.</span> <span class="done DONE">DONE</span> 冻结窗格</h5>
<div class="outline-text-5" id="text-3-3-1-1">
<p>
冻结窗格功能位于 [视图]-[窗口] 的功能区域,是以当前选中的单元格为基准,让该单元格
左侧的列和(或)上面的行在移动滚动条时保持不变. 通常用来观察表格数据的字段名和序列
号.比如,一个人信息搜集的表格中,字段有多个,数据也有很多条,浏览到后面的数据时很容
易就不知道看的是哪个人的数据以及某个单元格是属于哪个字段的了,但使用冻结窗格,将第
一列的姓名列以及第一行的字段行冻结,就能在浏览数据时仍然可以知道单元格所属的字段
和姓名.
</p>
</div>
</div>

<div id="outline-container-org909562d" class="outline-5">
<h5 id="org909562d"><span class="section-number-5">3.3.1.2.</span> <span class="done DONE">DONE</span> Ctrl+方向键</h5>
<div class="outline-text-5" id="text-3-3-1-2">
<p>
如果数据量非常大,可以使用 Ctrl+方向键快速移动到连续数据的最上下左右的位置处,如果
遇到不连续的地方,也就是数据缺失的地方,就会停止. 如果再加上 shift 键,也就是
Ctrl+Shift+方向键, 就可以快速选中连续的数据区域了.
</p>
</div>
</div>

<div id="outline-container-org8777002" class="outline-5">
<h5 id="org8777002"><span class="section-number-5">3.3.1.3.</span> <span class="done DONE">DONE</span> 定位单元格</h5>
<div class="outline-text-5" id="text-3-3-1-3">
<p>
Excel 的定位单元格功能(Ctrl+G 或 F5) 可以快速按照某些特征选中单元格,即使他们是不
连续的,而如果我们要手动选择,就必需按住 Ctrl 然后用鼠标一个个点击这些单元格.因此
使用定位单元格功能可以节省大量时间.
</p>

<p>
先选中想要定位单元格的区域,然后按 Ctrl+G 或 F5, 打开定位单元格对话框,点击定位条
件,就可以根据数据特征选中需要的单元格了,例如想要选中缺失数据的单元格,就将定位条
件设置为空值,就可以选中所有缺失数据的单元格了.
</p>
</div>
</div>

<div id="outline-container-orgfdc407a" class="outline-5">
<h5 id="orgfdc407a"><span class="section-number-5">3.3.1.4.</span> <span class="done DONE">DONE</span> 快速隐藏数据</h5>
<div class="outline-text-5" id="text-3-3-1-4">
<p>
当表格列数(字段)过多,或是表格横向跨度过宽时,可以使用 [数据]-[组合] 功能来将多个
列折叠隐藏.通常我们都会将不重要,不需要或信息类型相同的多余列进行折叠隐藏,这样就
可以将重要信息显示在一个屏幕里,不用左右拖动表格了. [数据]-[取消组合]-[清除分级显
示] 可以直接清除所有设置的组合折叠.
</p>
</div>
</div>

<div id="outline-container-org27388cf" class="outline-5">
<h5 id="org27388cf"><span class="section-number-5">3.3.1.5.</span> <span class="done DONE">DONE</span> 切换工作表</h5>
<div class="outline-text-5" id="text-3-3-1-5">
<p>
工作簿中表格较多时,可以鼠标右击工作表标签区域左侧的导航栏,这样就可以显示所有的工
作表,在这里可以快速切换到想要的工作表.
</p>
</div>
</div>
</div>

<div id="outline-container-orgcc698ac" class="outline-4">
<h4 id="orgcc698ac"><span class="section-number-4">3.3.2.</span> <span class="done DONE">DONE</span> 表格的打印技巧</h4>
<div class="outline-text-4" id="text-3-3-2">
</div>
<div id="outline-container-orgf5a3964" class="outline-5">
<h5 id="orgf5a3964"><span class="section-number-5">3.3.2.1.</span> <span class="done DONE">DONE</span> 解决打印不全的问题</h5>
<div class="outline-text-5" id="text-3-3-2-1">
<p>
在打印预览,会发现打印的内容无法显示在同一页纸上,这时我们可以使用 [视图]-[分页预
览] 的功能来通过拖曳分页线的方式快速调整分页边界,并缩放打印比例.
</p>
</div>
</div>

<div id="outline-container-org16ffd20" class="outline-5">
<h5 id="org16ffd20"><span class="section-number-5">3.3.2.2.</span> <span class="done DONE">DONE</span> 重复打印表头</h5>
<div class="outline-text-5" id="text-3-3-2-2">
<p>
当打印数据量过大的表格时,通常需要重复打印表头(也就是第一列的字段名),这样打印的每
一页才都会有标题(字段)数据,才能方便查看.例如,打印学校所有考生的成绩表,就需要每页
都有表头.
</p>

<p>
只需要在 [页面布局]-[打印标题]-[页面设置]中设置[顶端标题行],就设置好了在每一页重
复的内容,设置完毕后,每一页都会出现标题行.
</p>
</div>
</div>

<div id="outline-container-orgb12f36e" class="outline-5">
<h5 id="orgb12f36e"><span class="section-number-5">3.3.2.3.</span> <span class="done DONE">DONE</span> 设置页眉与页脚</h5>
<div class="outline-text-5" id="text-3-3-2-3">
<p>
打印表格时,设置表格的页眉与页脚可以显示页码.
</p>

<p>
在 [页面布局]-[页面设置]中打开[页面设置]对话框(右下角的箭头图标),选择[页眉/页脚]
选项,可以在页眉/页脚设置下拉框中看到各种页眉/页脚设置,也可以点击自定义进行更为详
细的设置,例如插入时间日期等等.
</p>
</div>
</div>

<div id="outline-container-org7fdf390" class="outline-5">
<h5 id="org7fdf390"><span class="section-number-5">3.3.2.4.</span> <span class="done DONE">DONE</span> 调整纸张方向</h5>
<div class="outline-text-5" id="text-3-3-2-4">
<p>
如果表格是横向设计的,那默认的纵向打印设置就得不到理想的打印效果了,我们只需要在
[页面布局]-[纸张方向] 中改变纸张方向就可以了. 在列数比较多时,也可以通过将纸张方
向设置为横向来让所有列都能显示在一张纸中.
</p>
</div>
</div>
</div>

<div id="outline-container-org73b1351" class="outline-4">
<h4 id="org73b1351"><span class="section-number-4">3.3.3.</span> <span class="done DONE">DONE</span> 表格的加密保护技巧</h4>
<div class="outline-text-4" id="text-3-3-3">
<p>
实际工作中,公司的表格可能涉及私密信息,不允许外人观看;一个表格可能需要发送给不同
的人进行编辑,如何保证他人不会修改表格结构以及其他人的数据呢?
</p>
</div>

<div id="outline-container-org3ba2fbb" class="outline-5">
<h5 id="org3ba2fbb"><span class="section-number-5">3.3.3.1.</span> <span class="done DONE">DONE</span> 保护工作表</h5>
<div class="outline-text-5" id="text-3-3-3-1">
<p>
最直接的保护表格的方法就是给工作表加上密码,在[审阅]-[保护工作表]中,可以设置密码,
在设置密码后,默认情况下,他人只能打开浏览表格数据,想要修改数据就必需输入密码.想要
消除密码保护,只需要点击同样位置的按钮[撤销工作表保护],输入密码即可.
</p>
</div>
</div>

<div id="outline-container-orgee5aa55" class="outline-5">
<h5 id="orgee5aa55"><span class="section-number-5">3.3.3.2.</span> <span class="done DONE">DONE</span> 保护工作簿</h5>
<div class="outline-text-5" id="text-3-3-3-2">
<p>
保护工作表限制他人修改单元格,但他人还是可以新建工作表以及修改其他未保护的工作表
的. 而保护工作簿则是限制他人修改工作簿结构的功能,也就是限制他人对工作簿做出更改,
他人尝试对工作簿中的工作表进行重命名,移动,隐藏等功能,都会被密码限制.保护工作簿的
设置与取消都与保护工作表类似.
</p>

<p>
需要注意的是,这两者是完全不相关的内容,只有同时设置了,才能同时限制他人修改工作簿
结构以及单元格内容.
</p>
</div>
</div>

<div id="outline-container-org22ef192" class="outline-5">
<h5 id="org22ef192"><span class="section-number-5">3.3.3.3.</span> <span class="done DONE">DONE</span> 限制编辑区域</h5>
<div class="outline-text-5" id="text-3-3-3-3">
<p>
当表格既要限制他人修改表格结构,又需要他人填充数据时,就需要用到限制编辑区域功能
了,Excel 其实是有一个专门的设置[允许编辑区域]的功能的,但这个功能用于一个大的公司
系统中,要求用户计算机都在一个权限系统之下,可以根据计算机的用户来设置编辑区域和编
辑权限,而一般的公司并没有这样的权限系统.因此不是很实用. 但我们可以通过设置部分保
护工作表来实现编辑区域的限制.
</p>

<p>
首先,所有的单元格都是默认锁定的,这在单元格设置的保护中可以看到 [锁定] 选项是被勾
选了的,而设置保护工作表时,可以注意到,勾选了一个 [保护工作表及锁定的单元格] 选项
的,意思是设置了密码后,我们就不能对这个工作表以及它里面被锁定的单元格进行更改了,
但是我们可以先对要编辑的区域解除锁定(将单元格格式中的锁定选项取消勾选),再设置保
护单元格,这样就可以将文件传递给他人填写数据,而不用担心他人把工作表结构弄乱了.
</p>
</div>
</div>

<div id="outline-container-org25bdad3" class="outline-5">
<h5 id="org25bdad3"><span class="section-number-5">3.3.3.4.</span> <span class="done DONE">DONE</span> 保护文件</h5>
<div class="outline-text-5" id="text-3-3-3-4">
<p>
保护工作包限制对工作表内容的修改,保护工作簿限制对工作簿文件结构的修改,但这两者都
没有限制他人打开工作簿文件查看数据,如果我们需要限制人员打开工作簿文件的权限,就可
以设置保护文件: [文件]-[信息]-[保护工作簿]-[用密码进行加密] 这样再次打开该工作簿
文件就需要输入密码才能打开查看了.
</p>

<p>
另外,如果要将文件另存为加密文件,可以在另存为选项的界面中选择[工具]-[常规选项]分
别设置打开权限密码和修改权限密码,也能对文件加密.
</p>
</div>
</div>
</div>

<div id="outline-container-org2270445" class="outline-4">
<h4 id="org2270445"><span class="section-number-4">3.3.4.</span> <span class="done DONE">DONE</span> 高效批量打印信函证书</h4>
<div class="outline-text-4" id="text-3-3-4">
<p>
如果需要打印多份同一类表单,可以使用 Excel 结合 Word 的邮件合并功能,批量打印.
</p>

<p>
例如批量制作证书或信函,先准备好需要的信息,例如人员的名称,日期,证书编号等信息制作
成一个 Excel 表格,然后在 Word 里进行操作,选择 [邮件]-[选择收件人]-[使用现有列表],打
开刚刚准备好的 Excel 表格,选择需要的工作表,勾选 [数据首行包含列标题] 点击确定,将
光标移动到指定位置,点击 [插入合并域]选择相应的字段名称插入,点击[邮件]-[完成并合
并]按钮,选择[编辑单个文档]-[合并到新文档]-[全部],就可以将 Excel 表格中的数据批量
设置到证书中相应的位置了.
</p>
</div>
</div>
</div>


<div id="outline-container-org899691a" class="outline-3">
<h3 id="org899691a"><span class="section-number-3">3.4.</span> <span class="done DONE">DONE</span> 批量整理数据的妙招</h3>
<div class="outline-text-3" id="text-3-4">
<p>
这部分解决以下问题:
</p>
<ul class="org-ul">
<li class="on"><code>[X]</code> 如何将数据快速拆分为多列</li>
<li class="on"><code>[X]</code> 如何剔除数据表中的重复项</li>
<li class="on"><code>[X]</code> 如何批量提取,合并,删除字符?</li>
<li class="on"><code>[X]</code> 如何将同类项目排列在一起?</li>
<li class="on"><code>[X]</code> 如何按照指定条件排序和筛选数据?</li>
<li class="off"><code>[&#xa0;]</code> 如何把行变成列?</li>
</ul>


<blockquote>
<p>
这个把行变成列书里确实没有提到,但如果是我认为的行变成列,那应该是转置的功能.就是
复制表格后,右键-[选择性粘贴]-[转置],就可以行变成列了.
</p>
</blockquote>
</div>

<div id="outline-container-org0526e5c" class="outline-4">
<h4 id="org0526e5c"><span class="section-number-4">3.4.1.</span> <span class="done DONE">DONE</span> 效率底下的真相: 数据不规范</h4>
<div class="outline-text-4" id="text-3-4-1">
<p>
很多对 Excel 学得不够深入的人可能觉得 Excel 中进行数据分析,统计和计算没有难度,甚
至认为掌握了数据透视表和智能数据源的使用就足够了,但在实际操作中,面对结构糟糕的数
据源和复杂的表格结构,可能会完全无从下手.
</p>
</div>

<div id="outline-container-org8982abd" class="outline-5">
<h5 id="org8982abd"><span class="section-number-5">3.4.1.1.</span> <span class="done DONE">DONE</span> 数据结构不规范</h5>
<div class="outline-text-5" id="text-3-4-1-1">
<p>
如果每个字段(列)都储存一个信息,那么在处理他们时是比较好处理的,例如姓名字段(列)里
只有姓名信息,如果需要对其排序或是进行其他操作都是很方便的,但现实中,数据源不可能
总是这么标准和规范,很可能是许多数据挤在一列中,比如前面从网页或其他地方导入数据,
由于各种原因,导入的数据很可能是挤在一列中,这时我们就无法简单的直接对其中的数据进
行处理了.
</p>
</div>
</div>

<div id="outline-container-orgc8a0cff" class="outline-5">
<h5 id="orgc8a0cff"><span class="section-number-5">3.4.1.2.</span> <span class="done DONE">DONE</span> 数据格式不规范</h5>
<div class="outline-text-5" id="text-3-4-1-2">
<p>
用作数据分析的数据,不能有空值,不能有多余值,一列只能有一种类型的数据,不应该有重复
项,不应该有多余的数据,不应该使用数据作为样式等等,只要数据的格式有些许不规范,特别
是只有些许不规范, Excel 可能就不会报错,让人以为没有问题,但最后进行数据分析却会报
错,甚至是没有报错,但得到错得离谱的结果.
</p>
</div>
</div>
</div>


<div id="outline-container-orgad74b09" class="outline-4">
<h4 id="orgad74b09"><span class="section-number-4">3.4.2.</span> <span class="done DONE">DONE</span> 妙招1:分列和提取</h4>
<div class="outline-text-4" id="text-3-4-2">
<p>
数据分列功能可以按照指定规则拆分和提取数据.
</p>
</div>
<div id="outline-container-org6b8e49d" class="outline-5">
<h5 id="org6b8e49d"><span class="section-number-5">3.4.2.1.</span> <span class="done DONE">DONE</span> 数据分列</h5>
<div class="outline-text-5" id="text-3-4-2-1">
<p>
这部分介绍数据分列([数据]-[分列])的基本使用:
</p>
<dl class="org-dl">
<dt>按分隔符拆分</dt><dd>如果挤在一起的数据是 "A,B,C,D" 这种形式,就可以将 "," 作为分隔
符把数据分成 |A|B|C|D| 四列.</dd>
<dt>按固定宽度拆分</dt><dd>如果数据没有统一的标记间隔,就无法使用分隔符,例如想要从身份证
号信息中提取出生日期的信息,就可以按照宽度拆分,宽度拆分可以设置拆分的宽度,并选
择想要导入的列.</dd>
<dt>转换数据格式</dt><dd>在分列的最后一步(第三步)中,是可以按照列设置数据格式的,因此分列
功能还可以用来转换数据的格式,例如将"假数字"转换成真数字,批量调整日期的显示样式
等.</dd>
</dl>
</div>
</div>

<div id="outline-container-orgcb97660" class="outline-5">
<h5 id="orgcb97660"><span class="section-number-5">3.4.2.2.</span> <span class="done DONE">DONE</span> 快速智能填充</h5>
<div class="outline-text-5" id="text-3-4-2-2">
<p>
分列功能需要数据有固定分隔符或宽度才能进行分割数据的工作. 如果数据更复杂一点,例
如 "Excel教学视频第三章第四节观看400次 10分钟" 的数据,要从中提取出播放次数,就
不能用分隔符或固定宽度了.
</p>

<p>
Excel 还有一个文本处理功能: 快速填充. 它能自动识别样本数据中的规律,并自动填充所
有剩下的数据,样本越多,识别越精确, 但数据结构比较简单时,一个样本就足够了.
</p>

<dl class="org-dl">
<dt>提取字符串</dt><dd>在样本数据右边的空单元格中输入想要提取的数据,按下 Ctrl+E 就可以
进行快速填充了. 例如 "第三章视频观看500次" 的右边单元格输入 500 ,按下 Ctrl+E
Excel 会自动在所有剩下的样本数据中提取出观看次数的数据并填充到空白单元格中.</dd>
<dt>合并文本</dt><dd>快速填充不仅可以基于样本数据提取字符串,还可以根据样本数据合并文本,
例如一列是数量 1,一列是单位 个,在第三列的单元格中输入 1个,然后选中该单元格,按
Ctrl+E 就会把第一列和第二列的数量和单位数据合并到一起了.</dd>
<dt>添加字符</dt><dd>第一列数据是 QQ 号, 第二列为 QQ 号加上后缀 "@qq.com" 就变成了QQ 邮
箱,只需要输入第一个数据,按 Ctrl+E 就可以将剩下的数据自动加上后缀了.</dd>
<dt>改变字母大小写</dt><dd>将一个样本数据的首字母大小写改变,按Ctrl+E 剩下的也会跟着变化.</dd>
</dl>
</div>
</div>
</div>


<div id="outline-container-org8b43cbb" class="outline-4">
<h4 id="org8b43cbb"><span class="section-number-4">3.4.3.</span> <span class="done DONE">DONE</span> 妙招2:查找和替换</h4>
<div class="outline-text-4" id="text-3-4-3">
<p>
查找和替换有很多用途:
</p>
<ul class="org-ul">
<li>从大量数据中找到特定数据进行修改.</li>
<li>核对特定文本.</li>
<li>批量删除多余的空格,文字和数字.</li>
<li>批量去掉不可见字符(空白字符).</li>
</ul>


<p>
Ctrl+H 或 Ctrl+F 可以打开 Excel 的查找和替换功能.
</p>
</div>

<div id="outline-container-orgf1bbfbe" class="outline-5">
<h5 id="orgf1bbfbe"><span class="section-number-5">3.4.3.1.</span> <span class="done DONE">DONE</span> 常规的查找和替换</h5>
<div class="outline-text-5" id="text-3-4-3-1">
<p>
以删除特定字符为例,例如删除价格信息中的单位: 元.
选中数据区域,Ctrl+H 打开[查找和替换]对话框,在查找内容的文本框中输入 元,在替换为
的文本框中不输入字符,点击全部替换,就可以将选中区域里所有的文本数据 元 删除了.
</p>
</div>
</div>

<div id="outline-container-org3602b0d" class="outline-5">
<h5 id="org3602b0d"><span class="section-number-5">3.4.3.2.</span> <span class="done DONE">DONE</span> 单元格匹配</h5>
<div class="outline-text-5" id="text-3-4-3-2">
<p>
常规的查找和替换是匹配单元格中的数据,也就是只要单元格中数据有与查找的数据匹配就
会执行操作,例如 "100元" 中的元就会与查找的元匹配,但如果我们想要删除价格为0的单元
格,使用常规的查找和替换,就会把 100 中的0也删除变成 1,此时我们就需要在[查找与替换]对
话框中选择 [选项] 并勾选新出现的 [单元格匹配] 复选框,这个选项意味着只有当单元格
的数据完全匹配时,才会执行操作,在这里,只有单元格数据为 0 时才会匹配了,此时 100 中
的 0 就不会匹配.
</p>
</div>
</div>

<div id="outline-container-orgdf565c2" class="outline-5">
<h5 id="orgdf565c2"><span class="section-number-5">3.4.3.3.</span> <span class="done DONE">DONE</span> 匹配指定格式</h5>
<div class="outline-text-5" id="text-3-4-3-3">
<p>
有些 Excel 表格中设置了单元格的不同样式, 查找和替换功能也可以根据这些样式来进行
查找替换,同样是点击 [选项] 在新出现的查找内容一行点击 [格式] 选择从单元格选择样
式,就可以选择需要查找的单元格样式了.
使用这种方式可以删除特定样式的数据,也可以选中特定样式的数据(在查找结果的列表中使
用 Ctrl+A 就可以选中所有查找到的单元格).
</p>
</div>
</div>

<div id="outline-container-org04cdda9" class="outline-5">
<h5 id="org04cdda9"><span class="section-number-5">3.4.3.4.</span> <span class="done DONE">DONE</span> 使用通配符进行模糊匹配</h5>
<div class="outline-text-5" id="text-3-4-3-4">
<p>
Excel 的查找和替换中只能使用通配符 <code>*</code> 和 <code>?</code> 进行模糊匹配, 星号表示匹配任意数量
的字符, 问号匹配任意一个字符. 要匹配负数可以使用 <code>-*</code>, 要匹配括号以及括号中的内
容可以使用 <code>(*</code> .
</p>
</div>
</div>
</div>


<div id="outline-container-org482bc5c" class="outline-4">
<h4 id="org482bc5c"><span class="section-number-4">3.4.4.</span> <span class="done DONE">DONE</span> 妙招3:处理重复值</h4>
<div class="outline-text-4" id="text-3-4-4">
<p>
获取数据源后,分析数据之前,我们需要清除掉重复的数据.
</p>

<p>
Excel 有很多处理重复值的功能: 数据透视表,条件格式,函数公式,数据验证,高级筛选,删
除重复值等.数据验证功能可以防止重复值的产生,数据透视表和函数公式可以统计重复值数
量,条件格式可以让重复值突出显示.最直接用于处理重复值的就是 "删除重复值" 的功能了.
</p>
</div>

<div id="outline-container-orgcadac99" class="outline-5">
<h5 id="orgcadac99"><span class="section-number-5">3.4.4.1.</span> <span class="done DONE">DONE</span> 筛选重复值</h5>
<div class="outline-text-5" id="text-3-4-4-1">
<p>
如果可以唯一标识某条数据的一个或多个单元格数据都重复了,就说明这些是重复的数据,进
行数据分析时只能保留其中一条数据.
</p>

<p>
例如,某个员工信息表中,员工工号,姓名,部门等完全相同(事实上一个员工的工号就足以判
断是否为同一个人了,但有的公司是没有工号的).那么表格中这些数据就是重复数据,需要删
除,但一个数据量很多的表中,我们是无法通过人眼去判断重复数据的,因此我们需要一个辅
助手段来筛选出这些重复值. 常用的就是 COUNTIF(range, criteria) 统计函数, range 是
统计范围, criteria 是统计条件, countif 会统计 range 内满足统计条件 criteria 的单
元格个数. COUNTIF($B$2:B2,B2) 会将第二列中的每个单元格与前面所有单元格进行比较,
如果只有一个相同,也就是它本身,那么统计结果为1,如果有重复,那么统计结果就会大于1,
通过这个公式,我们可以构造出一个辅助列,公式结果大于1 的行就是重复的数据行了.
</p>

<p>
得到辅助列后,我们可以使用筛选功能将公式结果大于1(重复数据)或等于1(不重复的数据)
的数据行筛选出来.
</p>
</div>
</div>

<div id="outline-container-orge3dda79" class="outline-5">
<h5 id="orge3dda79"><span class="section-number-5">3.4.4.2.</span> <span class="done DONE">DONE</span> 标记重复值</h5>
<div class="outline-text-5" id="text-3-4-4-2">
<p>
上面的方法对于掌握了函数用法的人来说十分便捷,但对新手来说不太友好,Excel 也有简单
的方法,就是条件格式,选中要筛选的数据列,例如工号一列,或者是能唯一确定一条数据的几
列,然后点击 [开始]-[样式]-[条件格式]-[突出显示单元格规则]-[重复值],就可以将重复
值快速标记为显眼的颜色了.
</p>
</div>
</div>

<div id="outline-container-org8cf6077" class="outline-5">
<h5 id="org8cf6077"><span class="section-number-5">3.4.4.3.</span> <span class="done DONE">DONE</span> 删除重复值</h5>
<div class="outline-text-5" id="text-3-4-4-3">
<p>
通过前面两步,我们可以筛选或标记出重复值,利用查找或筛选功能等方式我们可以删除找到
的重复值,但其实 Excel 也提供了简单的方法,就是 [数据]-[数据工具]-[删除重复值], 可
以选择作为重复依据的列,例如,可以唯一标识员工的工号列,或员工姓名,部门,组别等多列,
让 Excel 根据选择的列来判断数据是否重复并执行删除操作.
</p>
</div>
</div>
</div>


<div id="outline-container-org20e60cf" class="outline-4">
<h4 id="org20e60cf"><span class="section-number-4">3.4.5.</span> <span class="done DONE">DONE</span> 妙招4:多表合并</h4>
<div class="outline-text-4" id="text-3-4-5">
<p>
工作中,通常会将不同分类的数据存放到不同的工作表或工作簿中,例如从时间分,按月份存
放数据,或从产品类型分,按产品分类存放数据,这样数据更清晰,查找更方便.
</p>

<p>
但是当需要进行数据统计时,分开的数据会带来困扰,不管是引用多个表还是对多个表的数据
进行整理都是很困扰的问题. 这时如果能将这些数据合并到一起,就能批量化的整理和统计
了.
</p>
</div>
<div id="outline-container-org60876ff" class="outline-5">
<h5 id="org60876ff"><span class="section-number-5">3.4.5.1.</span> <span class="done DONE">DONE</span> 合并工作表</h5>
<div class="outline-text-5" id="text-3-4-5-1">
<p>
本书中使用的是 "易用宝" 插件进行的合并工作表.安装插件后只需要按照提示点击就可以
了.
</p>

<p>
我记录一下不用插件合并工作表的流程:
</p>
<ul class="org-ul">
<li>首先,需要确认工作簿内所有工作表的结构相同才能进行合并,不管手动还是插件都需要满
足这个条件.</li>
<li>新建一个工作表,复制需要合并的工作表的表头作为表头.</li>
<li>使用前面提到的快速选择的快捷键 Ctrl+Shift+方向键选中一个表的数据区域,复制到新
的工作表的空白数据区域. 对每个要合并的工作表执行此操作.</li>
</ul>


<p>
这个流程是可以用编程语言实现的,例如 python ,vba.
</p>
</div>
</div>

<div id="outline-container-org04e6b12" class="outline-5">
<h5 id="org04e6b12"><span class="section-number-5">3.4.5.2.</span> <span class="done DONE">DONE</span> 合并工作簿</h5>
<div class="outline-text-5" id="text-3-4-5-2">
<p>
合并工作簿一样也是用 "易用宝" 插件完成. 事实上这种批量合并工作簿或工作表,以及他
们的拆分的在 《用Python让Excel飞起来》 中有对应的 python 实现.
</p>

<p>
实际上也是将工作表数量以及工作表结构一致的工作簿中的工作表移动到一个工作簿中,这
种操作实际上手动也可以完成,只不过太过烦琐: 把所有需要合并的工作簿打开,对每一个需
要合并到新工作簿的工作表右键,选择 [移动或复制] 选项,把他们移动到新的工作簿或某一
个打开的工作簿中就可以了.
</p>
</div>
</div>
</div>


<div id="outline-container-orga4f554c" class="outline-4">
<h4 id="orga4f554c"><span class="section-number-4">3.4.6.</span> <span class="done DONE">DONE</span> 数据筛选技巧</h4>
<div class="outline-text-4" id="text-3-4-6">
<p>
为了从大量数据找到符合某个条件的数据,需要将其他不重要的数据暂时忽略,但又不能删除
他们,这就需要用到 [筛选] 功能,筛选功能位于 [数据]-[排序和筛选]-[筛选] ,其图表是
一个过滤器(漏斗).
</p>
</div>


<div id="outline-container-orgf204894" class="outline-5">
<h5 id="orgf204894"><span class="section-number-5">3.4.6.1.</span> <span class="done DONE">DONE</span> 数据筛选基础</h5>
<div class="outline-text-5" id="text-3-4-6-1">
<ul class="org-ul">
<li>开启或关闭筛选功能: [数据]-[排序和筛选] 以及 [开始]-[编辑]-[排序和筛选] 中都可
以找到筛选器的开关.
开启筛选功能后,每个字段单元格(表头)都会显示一个筛选器按钮.</li>
<li>筛选的类型: 打开筛选器只是开启了筛选模式,并未开始过滤数据.只有设置筛选条件后才
会过滤出符合要求的数据. 筛选支持的类型根据数据格式的不同有所不同,例如,数据中单
元格或字体设置了特殊样式,则可供筛选的类型就有按颜色筛选,否则该功能就是灰色的.</li>
</ul>
</div>
</div>


<div id="outline-container-org5b0969d" class="outline-5">
<h5 id="org5b0969d"><span class="section-number-5">3.4.6.2.</span> <span class="done DONE">DONE</span> 多条件筛选</h5>
<div class="outline-text-5" id="text-3-4-6-2">
<p>
如果需要筛选同时满足多个条件的数据,可以进行多条件筛选.
</p>

<p>
如果是针对多个字段的多个条件,只需要进行多次筛选就可以了.
</p>

<p>
但如果是某个字段中符合多个条件的数据,就需要使用自定义筛选,例如找出数量字段这一列
数量大于 100 或小于 20 的所有数据. 就可以在筛选按钮打开的界面中点击 [数字筛
选]-[自定义筛选]来设置大于100 或小于20的值. 我们会发现,自定义筛选最多只能设置两
个条件. 如果涉及到三个以上的多重条件筛选,就需要使用到高级筛选了.
</p>

<dl class="org-dl">
<dt><b>高级筛选</b></dt><dd><p>
高级筛选与普通筛选器的筛选不同,可以设置多个条件,因此条件的设置也
有区别,它是以一个表格作为条件的,因此使用它我们额外需要一个表格来作为条件表格,
逻辑或关系的条件放在不同行,逻辑与关系的条件放在同一行:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">项目评级</td>
<td class="org-left">签约数量</td>
<td class="org-left">需签约数量</td>
</tr>

<tr>
<td class="org-left">A</td>
<td class="org-left">&lt;20</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&gt;100</td>
</tr>
</tbody>
</table>
<p>
这个条件表格的意思是选出 "项目评级为 A 且签约数量小于 20" 或 "需要签约数量大于
100" 的数据行.
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">项目评级</td>
<td class="org-left">签约数量</td>
<td class="org-left">需签约数量</td>
</tr>

<tr>
<td class="org-left">A</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&lt;20</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&gt;100</td>
</tr>
</tbody>
</table>
<p>
这个条件表格的意思是选出 "项目评级为 A" 或 "签约数量小于 20" 或 "需要签约数量
大于 100" 的数据行.
筛选条件对数值的比较符号: &gt;;&lt;;&gt;=;&lt;=; <code>&lt;&gt;</code> (不等于) ; 对文本数据的比较只要包含
该文本即符合条件,例如 <code>万</code> 字会筛选出所有包含万的单元格; 支持通配符,例如 <code>Q*4</code>
会匹配以 Q 开头,以 4 结尾的文本.
</p>

<p>
使用高级筛选功能会自动关闭筛选器.
</p>

<p>
注意,条件表格的表头需要与筛选区域的表头对应.高级筛选在 [开始]选项卡中是没有的,
需要在 [数据] 选项卡中找到.
</p></dd>
</dl>
</div>
</div>
</div>


<div id="outline-container-orgc9155b8" class="outline-4">
<h4 id="orgc9155b8"><span class="section-number-4">3.4.7.</span> <span class="done DONE">DONE</span> 数据排序</h4>
<div class="outline-text-4" id="text-3-4-7">
<p>
数据排序将按照指定顺序将数据重新排列,是整理数据时最常用的手段,也是 Excel 使用频
率最高的功能之一.
</p>
</div>

<div id="outline-container-org9242411" class="outline-5">
<h5 id="org9242411"><span class="section-number-5">3.4.7.1.</span> <span class="done DONE">DONE</span> 数据排序基础</h5>
<div class="outline-text-5" id="text-3-4-7-1">
<p>
Excel 中的数据可以分为文本和数字,数字可以细分为时间,日期,整数等,数据类型不同,排
序的方式也不同.
</p>
<dl class="org-dl">
<dt>数字排序</dt><dd>按照数值大小.</dd>
<dt>日期排序</dt><dd>日期和时间本质上是一个记录从 1900年1月1日到某个日期过去了多少天(整
数部分)外加多少小时(小数部分)的数字.所以排序与数字一样根据数值大小.</dd>
<dt>文本排序</dt><dd>文本的排序是按照英文字母,中文拼音的字母表顺序排列的.如果有多个字符,则
从第一个字符开始比较,第一个字符相同,再向第二个字符比较,依此类推.</dd>
</dl>


<p>
由于排序方式是根据数据类型决定的,我们所称的 "假日期" 和 "假数字" 的排序结果就一
定不会正确,因为 "假日期/数字" 是文本类型,所以实际上是按照字母表顺序排序的比如 "
假数字" "1", "11" 和 "101" 的排序结果是 "1" "101" "11",字母表顺序中,也是 1234的
顺序,但按照文本的比较规则,是先比较第一位,全是1,再比较第二位的.
</p>
</div>
</div>

<div id="outline-container-org7cbf239" class="outline-5">
<h5 id="org7cbf239"><span class="section-number-5">3.4.7.2.</span> <span class="done DONE">DONE</span> 对混合文本排序</h5>
<div class="outline-text-5" id="text-3-4-7-2">
<p>
当数字和汉字混合在一起时,我们是无法正常排序的. 例如: "1月" "2月", &#x2026; "12月" .这
组数据按照升序排序,会得到 "10月", "11月", "12月"&#x2026;
</p>

<p>
解决方法就是将数字和汉字拆开然后排序.
</p>

<p>
结合前面的知识,可以想到,在表格数据紧邻的右侧输入对应月份,使用 Ctrl+E 快速填充,就
可以提取出数字格式的月份数据了.根据新得到的数据进行排序就可以得到月份正常排序的
排序结果了.
</p>

<blockquote>
<p>
这里求体现了数据规范以及数据样式的作用了,如果我们按照规范填充数据,月份一栏只使用
数字表示月份,然后设置样式将数据的显示设置为 "00月" 的样式,那么在显示上就可以得到
01月,02月&#x2026; 但实际上数字还是 1,2,&#x2026; 这样既能方便用户阅读,也不会破坏数据的规范
性.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org711a6da" class="outline-5">
<h5 id="org711a6da"><span class="section-number-5">3.4.7.3.</span> <span class="done DONE">DONE</span> 按指定次序排序</h5>
<div class="outline-text-5" id="text-3-4-7-3">
<p>
对于某些固定顺序的文本排序, Excel 的内置排序无法实现,例如中文序列的一二三四,按照
Excel 默认的字母表和拼音排序,二会是第一个,所以需要使用自定义排序的方式进行排序.
</p>

<dl class="org-dl">
<dt>添加自定义序列</dt><dd>在 <a href="#org7d1c9b7">使用自定义序列录入文本序号</a> 一节中,就使用过自定义序列,这个
序列列表不仅可以用于自动填充,也可以用于排序. 在 [数据]-[排序和筛选]-[排序] 对
话框的 [次序] 下拉列表中可以看到自定义序列的选项,点击后同样打开编辑与选择自定
义序列的对话框.</dd>
</dl>
</div>
</div>

<div id="outline-container-orgcb691fd" class="outline-5">
<h5 id="orgcb691fd"><span class="section-number-5">3.4.7.4.</span> <span class="done DONE">DONE</span> 对存在合并单元格的数据排序</h5>
<div class="outline-text-5" id="text-3-4-7-4">
<p>
需要进行数据分析操作的表格应该是基础数据表,基础数据表中是不允许有合并单元格的,但
现实中不可能保证需要处理的表格都是基础数据表.
</p>

<p>
对含有合并单元格的列排序,会得到一个 "所有单元格需大小相同" 的错误消息提示,因此我
们首先就需要取消这些合并单元格.
</p>

<p>
选中包含有合并单元格的列/行, Ctrl+1 打开样式设置,在[对齐]-[文本控制] 中取消 [合
并单元格] 的勾选,即可取消这些单元格合并,但这样会产生很多空白单元格,也是不符合基
础数据表的数据完整性的,可以使用定位条件 Ctrl+G 选择 [空值], 使用公式以及批量填充
快速将空值补充完整.
</p>
</div>
</div>
</div>
</div>


<div id="outline-container-org2a83e6f" class="outline-3">
<h3 id="org2a83e6f"><span class="section-number-3">3.5.</span> <span class="done DONE">DONE</span> 数据分析必会函数公式</h3>
<div class="outline-text-3" id="text-3-5">
<p>
Excel 函数公式可以依据已有的数据,按照特定规则计算从而生成新的数据. 使用函数公式,
可以让数据录入,计算,分析以及可视化变得更加简单.
</p>
</div>

<div id="outline-container-org2d129c2" class="outline-4">
<h4 id="org2d129c2"><span class="section-number-4">3.5.1.</span> <span class="done DONE">DONE</span> 数据分析基础</h4>
<div class="outline-text-4" id="text-3-5-1">
</div>
<div id="outline-container-orgf77b20d" class="outline-5">
<h5 id="orgf77b20d"><span class="section-number-5">3.5.1.1.</span> <span class="done DONE">DONE</span> 数据分析</h5>
<div class="outline-text-5" id="text-3-5-1-1">
<p>
数据分析流程:
</p>
<dl class="org-dl">
<dt>明确问题</dt><dd>明确要解决的问题或要实现的目标.</dd>
<dt>分析问题</dt><dd>分析问题发生的原因可能是什么.</dd>
<dt>提出对策</dt><dd>针对原因提出改善对策,验证对策是否有效.</dd>
<dt>执行对策</dt><dd>将对策标准化成具体的执行动作,落实执行,解决问题.</dd>
</dl>


<p>
数据分析不是一定要学习 python,sql, 统计学等等知识,它只是一个分析和解决问题的手段,无
论使用什么方式,目的都是解决问题.
</p>
</div>
</div>

<div id="outline-container-org8afd69f" class="outline-5">
<h5 id="org8afd69f"><span class="section-number-5">3.5.1.2.</span> <span class="done DONE">DONE</span> 函数公式</h5>
<div class="outline-text-5" id="text-3-5-1-2">
<p>
Excel 单元格的数据除了直接录入,还可以通过公式计算得到.
</p>

<dl class="org-dl">
<dt>公式</dt><dd>能够自动计算结果的算式.公式的使用前面几本书学过了这里就不再记录.</dd>
<dt>函数</dt><dd>Excel 内置的计算规则.使用起来与编程语言中的函数以及数学中的函数相似.</dd>
</dl>


<p>
函数公式的使用场景主要有 :
</p>
<ul class="org-ul">
<li>分类求和计数</li>
<li>逻辑判断</li>
<li>数据整理</li>
<li>多表查询</li>
<li>日期和时间计算</li>
<li>函数公式的检验和校正</li>
</ul>
</div>
</div>
</div>



<div id="outline-container-org9a408dd" class="outline-4">
<h4 id="org9a408dd"><span class="section-number-4">3.5.2.</span> <span class="done DONE">DONE</span> 分类求和计数</h4>
<div class="outline-text-4" id="text-3-5-2">
<p>
分类是数据分析的基本操作,按照不同数据维度对数据进行分类统计,是为了找出差异,发现
数据背后的问题.
</p>

<p>
Excel 函数公式中,可以使用 SUMIF, SUMIFS, COUNTIF,COUNTIFS 来实现不同分类的求和汇
总以及计数汇总.
</p>
</div>

<div id="outline-container-org7c68d6a" class="outline-5">
<h5 id="org7c68d6a"><span class="section-number-5">3.5.2.1.</span> <span class="done DONE">DONE</span> 计算每种产品的营业额</h5>
<div class="outline-text-5" id="text-3-5-2-1">
<p>
在一个有着多个产品销售数据的表格中,要计算出每种产品的营业额,首先,我们需要一个不
重复的产品名/编号列表,来作为营业额表的行字段. 可以复制销售表中产品名的一列,然后
利用删除重复值,将复制过来的这一列区域中的重复值删除,这样就可以得到所有产品的名称
列了.
</p>

<p>
然后需要计算每个产品的总营业额,这就是分类求和的问题了,使用
SUMIF(range,criteria,[sum<sub>range</sub>]) 函数就可以了,range 是条件判断范围, criteria 是
判断条件, 如果 sum<sub>range</sub> 省略,则将 range 作为求和范围, 否则就使用 sum<sub>range</sub> 作为
求和范围.
</p>

<p>
最后求每种产品营业额占所有产品营业额的百分比,利用刚刚求出来的每个产品营业额,使用
简单的除法和 sum 函数就可以得到结果.
</p>

<blockquote>
<p>
一个额外的收获,书中附带的练习表,显示出了公式答案,虽然我自己也做出来了,但发现不会
快速将公式显示在单元格里的操作,我用的是复制公式,然后逐个加上单引号 <code>'</code> 让它变成
文本数据来进行显示,但练习表中的公式单元格与我的不同,发现它用的是一个我没用过的函
数 FORMULATEXT() ,搜了下,没看完的 &lt;函数公式速查&gt; 里的 <a href="#orgd335442">查找和引用函数(18)</a> 章节有
这个函数,是引用单元格的公式数据,使用它就不用自己复制再修改了.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org851b565" class="outline-5">
<h5 id="org851b565"><span class="section-number-5">3.5.2.2.</span> <span class="done DONE">DONE</span> 如何对大于等于目标的数据求和</h5>
<div class="outline-text-5" id="text-3-5-2-2">
<p>
前面一个分类求和只有一个条件,就是产品名相等即可,但如果我们现在需要对大于等于某个
值的营业额求和,例如,要对营业额大于等于 100 的产品的总营业额. 也就是对营业额大于
等于 100 的值求和.那就需要用到 "&gt;=100" 这样的条件了.
</p>

<blockquote>
<p>
Excel 函数中条件如果直接是一个值,不管是数字还是字符串,例如 <code>1</code> 或 <code>"产品A"</code> 都是
默认做相等性判断,是一种省略的便捷写法,完整的写法应该是 <code>"=1"</code> 以及 <code>"=产品A"</code> ,
完整的条件是以双引号括起来的,比如一个稍微复杂一点的条件,大于等于某个单元格的值:
<code>"&gt;="&amp;A2</code> .
</p>
</blockquote>

<p>
仍然是上面的练习表将条件换成 "&gt;=100" 就可以了.函数公式使用的一些细节在前面几本书
里都学过了,这里就不再记录.
</p>
</div>
</div>

<div id="outline-container-org17c88ed" class="outline-5">
<h5 id="org17c88ed"><span class="section-number-5">3.5.2.3.</span> <span class="done DONE">DONE</span> 如何对指定范围内的数据求和</h5>
<div class="outline-text-5" id="text-3-5-2-3">
<p>
需求更进一步,要对营业额位于 100(含) 到 200(含) 的营业额进行求和. 数学中可以使用
100&lt;=X&lt;=200 这种写法,但是 Excel 中是无法识别这种写法的,只能和编程里一样,将它拆分
成为两个条件, X&gt;=100 以及 X&lt;=200. 按照多条件求和就需要用到
</p>

<p>
SUMIFS(sum<sub>range</sub>, criteria<sub>range1</sub>, criteria1, [criteria<sub>range2</sub>, criteria2], &#x2026;)
与 SUMIF 稍微有点差异, sum<sub>range</sub> 是求和区域, criteria<sub>range1</sub> 是第一个判断区
域,criteria1 是第一个判断条件.
</p>

<p>
这一小节的公式可以写成 <code>=SUMIFS($D$2:D$12,D$2:D$12,"&gt;=100",D$2:D$12,"&lt;=200")</code> .
</p>
</div>
</div>

<div id="outline-container-orgc2321c8" class="outline-5">
<h5 id="orgc2321c8"><span class="section-number-5">3.5.2.4.</span> <span class="done DONE">DONE</span> 如何按照产品和销售区域统计销售次数</h5>
<div class="outline-text-5" id="text-3-5-2-4">
<p>
需求进一步变化,现在需要根据产品以及销售区域,统计每个产品在每个区域的销售情况.
</p>

<p>
按照前面的方法,可以得到作为表头的产品名称列以及销售区域数据. 因为是统计次数,所以
使用 COUNT 这一类函数,又因为是多个条件,所以使用
<a href="#org15112d7">COUNTIFS 函数(统计同时满足多个条件的单元格个数)</a> 函数.
</p>

<blockquote>
<p>
有本书的笔记好像被误删了,这里再记一下, count 统计参数中数字单元格个数, counta 统
计参数中非空单元格个数,countif 统计符合条件的单元格个数, countifs 统计符合多个条
件的单元格个数.
</p>
</blockquote>
</div>
</div>
</div>



<div id="outline-container-orgeb6912d" class="outline-4">
<h4 id="orgeb6912d"><span class="section-number-4">3.5.3.</span> <span class="done DONE">DONE</span> 逻辑判断</h4>
<div class="outline-text-4" id="text-3-5-3">
<p>
上面的分类求和中的分类都很清晰,但现实中的数据更多都不会拥有这么清晰的分类特征,而
是需要自己进行分类. 比如成绩数据,每个人的分数都不一样,我们需要先把成绩分类成
A,B,C,D 或是不及格,及格,良好,优秀这种等级分类.
</p>

<p>
判断成绩是否合格,就是属于逻辑判断.
</p>
</div>

<div id="outline-container-org2de3477" class="outline-5">
<h5 id="org2de3477"><span class="section-number-5">3.5.3.1.</span> <span class="done DONE">DONE</span> 成绩大于等于80备注"合格",否则备注"不合格"</h5>
<div class="outline-text-5" id="text-3-5-3-1">
<p>
Excel 中逻辑判断的基础函数就是 <a href="#orgd92f6a7">IF 函数(根据条件判断真假)</a>. 这一节的练习,需要将大
于等于 80 分的成绩标注为 "合格",否则为"不合格".  <code>=IF(D2&gt;=80,"合格","不合格")</code>
这个没有多少难度,不用更多探讨.
</p>

<blockquote>
<p>
需要关注一下的是, 这个 IF 函数的第一个参数是逻辑值,不是条件,所以它可以直接使用
D2&gt;=80 这种表达式,而SUMIF,COUNTIF 这种函数参数中的是用于区域的条件,所以需要以字
符串形式.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orgb15bf76" class="outline-5">
<h5 id="orgb15bf76"><span class="section-number-5">3.5.3.2.</span> <span class="done DONE">DONE</span> 3门课程的分数都大于等于80备注"合格",否则备注"不合格"</h5>
<div class="outline-text-5" id="text-3-5-3-2">
<p>
当条件是复合条件时,就需要使用逻辑函数 <a href="#orgef39e2a">AND 函数(检验是否都满足条件)</a> 和
<a href="#orgef04207">OR 函数(检验是否有一个满足条件)</a> 来将条件进行组合了.
</p>

<p>
这一节要求将3门课程分数都大于等于80 的备注合格,3门都大于等于80,就是逻辑与,要使用
AND 函数: <code>=IF(AND(B2&gt;=80,C2&gt;=80,D2&gt;=80),"合格","不合格")</code> ,这个用法也很直接,不
需要多讲解, 在练习以及书中还提到了达到同样目的的不同公式,就像离散数学里,同一个逻
辑表达式可以有不同的写法,条件是全大于等于80才满足条件,就等价于只要有一个小于80就
不满足条件,可以用 OR 实现: <code>=IF(OR(B2&lt;80,C2&lt;80,D2&lt;80, "不合格", "合格"))</code>, 也可
以等价为,只要最小的一个大于等于80,就满足条件, 可以用 <a href="#orgcb98ad3">MIN 函数(返回数值集的最小值)</a>
实现: <code>=IF(MIN(B2:D2)&gt;=80, "合格", "不合格")</code> 或是只要最小的一个小于80,就不满足
条件: <code>=IF(MIN(B2:D2)&lt;80, "不合格", "合格")</code> ; 另外,还可以用上前面的统计函数
<a href="#org90958a4">COUNTIF 函数(统计满足条件的单元格个数)</a> 因为它也有判断功能,只要对值小于80 的单元
格统计结果大于0,就表示不满足要求: <code>=IF(COUNTIF(B2:D2,"&lt;80")&gt;0, "不合格", "合格")</code>
</p>
</div>
</div>

<div id="outline-container-org0fe59fa" class="outline-5">
<h5 id="org0fe59fa"><span class="section-number-5">3.5.3.3.</span> <span class="done DONE">DONE</span> 根据不同的分数,添加对应的备注</h5>
<div class="outline-text-5" id="text-3-5-3-3">
<p>
这一小节就复杂一点了,要求根据不同分数段,添加对应备注,例如 0-59 为不及格, 60-69
为及格, 70-89 为良好, 90-100 为优秀.
</p>

<p>
根据这个需求的逻辑,我们从小往大来对数据进行判断,如果数据小于60,则为不及格,如果数
据大于60,则判断它是否小于70,如果小于,则为及格,否则接着判断数据是否小于90,如果小
于,则为良好,否则就为优秀. 这个逻辑有效的前提是进行判断的数据能保证必定位于
0-100,这样我们才能由小到大进行判断.
</p>

<p>
另外一种更加直接的判断逻辑,就是直接使用3个判断(只有四种可能,前三个不满足,就只剩
最后一种等级了), 是否位于 0-59,是否位于 60-69,是否位于 70-89. 但这种数值区域的判
断前面我们做过,是需要拆分成两个条件的,例如 AND(B2&gt;0, B2&lt;59), 这样的逻辑很直接简
单,但是实现起来的公式 "看起来" 会比较复杂.
</p>

<p>
解决问题的逻辑清楚之后,就是实现了,实现上面的逻辑重点在于 IF 函数的嵌套使用, IF
的嵌套与我们说话的逻辑一样的,如果 A 满足,则&#x2026; 否则进行第二个 IF 判断,以此类推.
</p>
<blockquote>
<p>
一个不知道是否重要的知识, IF 函数最多能嵌套 7 层,那么当逻辑复杂到一定的程度,或者
说分类的类别多到一定程度时,使用 IF 是无法完成需求的, 这时我们可以将分类标准做成
表格,使用 VLOOKUP 来完成分类备注. 这种做法利用的是,当 VLOOPUP 的匹配类型为近似匹
配(range<sub>lookup</sub>=TRUE)时,如果找不到查找区域中与要查找的值精确匹配的值,就会在查找
区域选择一个小于该查找值的值作为匹配向,例如我们使用一个辅助列表:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right">分数</td>
<td class="org-left">等级</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-left">不及格</td>
</tr>

<tr>
<td class="org-right">60</td>
<td class="org-left">及格</td>
</tr>

<tr>
<td class="org-right">70</td>
<td class="org-left">良好</td>
</tr>

<tr>
<td class="org-right">90</td>
<td class="org-left">优秀</td>
</tr>
</tbody>
</table>
<p>
<code>=VLOOKUP(61,$F$2:$G$5,2,TRUE)</code> 查找 61,但找不到精确匹配的,就会选择比 61 小的值
60 作为匹配项,因此会选择查找区域的 60 对应的第二列的值,也就是及格. 这种方式用起
来比 IF 要方便一些,因为不用自己写公式,只要做好辅助列表就可以了.
</p>
</blockquote>
</div>
</div>
</div>



<div id="outline-container-orgba141d6" class="outline-4">
<h4 id="orgba141d6"><span class="section-number-4">3.5.4.</span> <span class="done DONE">DONE</span> 数据整理</h4>
<div class="outline-text-4" id="text-3-5-4">
<p>
前面的所有使用了函数的例子,都是以数据是规范数据为前提的,如果数据不规范,轻则公式
报错,重则生成错误数据影响分析.
</p>

<p>
书中给出的实际工作中的例子我觉得很典型:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">项目</td>
<td class="org-left">进度</td>
</tr>

<tr>
<td class="org-left">项目1</td>
<td class="org-left">完成2021/10/16</td>
</tr>

<tr>
<td class="org-left">项目2</td>
<td class="org-left">完成,负责人小张</td>
</tr>

<tr>
<td class="org-left">项目3</td>
<td class="org-left">跟进中</td>
</tr>

<tr>
<td class="org-left">项目4</td>
<td class="org-left">已经发货</td>
</tr>

<tr>
<td class="org-left">项目5</td>
<td class="org-left">通知供应商加库存</td>
</tr>

<tr>
<td class="org-left">项目6</td>
<td class="org-left">完成,所有子项目已经结案</td>
</tr>
</tbody>
</table>


<p>
这种数据就完全不能直接用来做分析了. 想要操作这些数据,首先就需要对这些数据进行整
理,让它们规范化.
</p>
</div>

<div id="outline-container-orgd77cc18" class="outline-5">
<h5 id="orgd77cc18"><span class="section-number-5">3.5.4.1.</span> <span class="done DONE">DONE</span> 如何判断项目是否完成</h5>
<div class="outline-text-5" id="text-3-5-4-1">
<p>
我第一个想法是使用智能填充功能,但发现智能填充并不能处理这种复杂且没有什么规律的
数据,无法提取出"完成"字符,但观察数据规律，可以发现已完成的项目进度中,完成两个字
都是在最前面的,因此可以使用文本函数 <a href="#orgbcd0186">LEFT 函数(按指定字符数从最左侧提取字符串)</a> 来
提取最左边的两个字符串,判断是否为 "完成", 如果是,则表示该项目完成了,否则,就没有
完成: <code>=IF(LEFT(B2,2)="完成", "完成","")</code> 如果提取到 "完成", 则标记为完成,否则,
不做标记.
</p>
</div>
</div>

<div id="outline-container-orgbb549f6" class="outline-5">
<h5 id="orgbb549f6"><span class="section-number-5">3.5.4.2.</span> <span class="done DONE">DONE</span> 如何用 MID 函数提取出日期</h5>
<div class="outline-text-5" id="text-3-5-4-2">
<p>
身份证号中有我们的出生日期.由于 Excel 的数字最大有效位限制,18 位的身份证号不能用
数字存储,只能以文本形式存储. 出生日期位于第7-14位, 使用
<a href="#orga3f9e41">MID 函数(从任意位置提取指定数目的字符)</a> 就可以提取出指定位置指定字符数量的字符串
了: <code>=MID(B2,7,8)</code> 意思是从第7位字符开始提取8个字符.计算年龄也可以用它,
<code>2023-MID(B2,7,4)</code> 可以直接计算出年龄,这里虽然提取出来的是4个字符的年份信息,但将
数据放在四则运算的表达式中, Excel 会自动尝试将文本数据转化为数值数据后再进行计算.
</p>
</div>
</div>

<div id="outline-container-orgd9ce4e3" class="outline-5">
<h5 id="orgd9ce4e3"><span class="section-number-5">3.5.4.3.</span> <span class="done DONE">DONE</span> 如何用公式提取商品描述中的数据</h5>
<div class="outline-text-5" id="text-3-5-4-3">
<p>
工作中每个人的 Excel 掌握情况不一致,表格的制作以及表格数据的填充很可能是不规范的,例
如书中的例子,将商品名以及商品的价格作为了一个 [商品描述/元] 的字段列,而如果按照
规范的表格制作以及数据填充, 商品描述应该是单独一列,商品价格也应该是单独一列.
</p>

<blockquote>
<p>
这个我在 Excel 学习群里遇见的群友和我讨论时我深有体会,他们的商品信息没有什么规范,很
多信息都参杂在一起,比如什么型号,颜色之类的根本不分开.导致需要处理数据时会非常麻
烦,只能手动去修改.
</p>
</blockquote>

<p>
以这样一个数据为例: "真好用深层肌肉按摩仪器 2680" 所有该列数据都是这种格式,商品
名加上一个空格在加上价格.
</p>

<p>
这个是很典型的不规范数据,基础数据表要求一列一种数据类型,要么是文本,要么是数字,所
以我们得将这两种信息分开成为两列.
</p>

<p>
前面我们学过分列, 根据数据特征,使用数据分列功能,以空格作为分隔符,也能很快将数据
分为两列.
</p>

<p>
但使用函数公式有时会更加灵活,所以函数公式的用法也需要掌握.
</p>
<blockquote>
<p>
事实上,Excel 提供的这些可以点击的功能,都是可以通过函数公式来实现的,毕竟Excel 就
是一个程序,而程序就是由许多函数组成的.Excel 将这些功能做成可以点击的按钮,是因为
这些功能使用频率非常高,或者是非常基础.
</p>
</blockquote>

<p>
由于商品名称长短不一,直接使用 left 或 mid 显然不能完成要求,我们可以根据分列功能
的逻辑,找到作为分隔符的空格,然后根据空格将数据分隔开.
</p>

<p>
FIND(find<sub>text</sub>, within<sub>text</sub>, [start<sub>num</sub>]) 可以在 within<sub>text</sub> 中找到 find<sub>text</sub> 的
位置. 使用 <code>=find(" ", "真好用深层肌肉按摩仪器 2680")</code> 就可以找到空格位于数据中
的位置,公式的计算结果为 12,表示空格位于字符串的第12 个字符. 有了空格位置这个信息,我
们就可以提取数据了, 提取价格:
<code>=RIGHT("真好用深层肌肉按摩仪器 2680", LEN("真好用深层肌肉按摩仪器 2680")-find("
", "真好用深层肌肉按摩仪器 2680"))</code>  RIGHT 和 LEFT 类似,只不过从最右边开始提取字
符, LEN(&#x2026;) 是获取文本的长度,文本长度(16)减去文本从开始到空格的长度(12)就是要提
取的字符数量(4),也就是我们要的价格 2680, 这样得到的数据其实仍然是文本数据,我们可
以使用文本格式转换函数 <a href="#orgcaa4791">VALUE 函数(将文本数字转换成数值)</a>,将得到的数据直接转换成数
值类型,为了方便,假设数据位于单元格 A2: <code>=VALUE(RIGHT(A2,LEN(A2)-FIND(" ", A2)))</code>
这样就可以直接得到一个数值类型的 2680 了; 商品名称的信息也是同样的思路:
<code>=LEFT(A2,FIND(" ",A2)-1)</code> .
</p>
</div>
</div>

<div id="outline-container-org137b270" class="outline-5">
<h5 id="org137b270"><span class="section-number-5">3.5.4.4.</span> <span class="done DONE">DONE</span> 其他常用的数据整理函数</h5>
<div class="outline-text-5" id="text-3-5-4-4">
<p>
除了提取文本外,文本的合并,查找与替换,清楚空格等等也是整理数据常用的操作.
</p>

<dl class="org-dl">
<dt>文本合并</dt><dd>文本的合并有三种实现:
<ul class="org-ul">
<li><code>&amp;</code> : 文本连接符(会将非文本数据转换成文本类型后连接).</li>
<li>CONCAT() 函数: CONCAT 函数将所有参数转换成文本类型后进行连接.</li>
<li>TEXTJOIN() 函数: TEXTJOIN(分隔符,是否忽略空白,数据参数&#x2026;) 函数会将所有数据
参数以指定的分隔符进行连接.</li>
</ul></dd>
<dt>文本的查找和替换</dt><dd>使用函数 <a href="#orga5a75e3">SUBSTITUTE 函数(用新文本替换旧文本)</a> 可以完成特定
文本的替换. 例如: <code>=SUBSTITUTE(A2, " ", ",")</code> 就可以将 A2 中的空格替换成逗号.</dd>
<dt>清除空白</dt><dd><a href="#org0545eda">CLEAN 函数(删除文本中不能打印的字符)</a> 用于清除非打印字符(它们无法打
印,因此以空白形式出现); <a href="#orgb480394">TRIM 函数</a> 函数清除多余的空格(开头和结尾的空格,中间连续
的空格会保留为一个空格.)</dd>
</dl>
</div>
</div>
</div>


<div id="outline-container-orgdc4e04f" class="outline-4">
<h4 id="orgdc4e04f"><span class="section-number-4">3.5.5.</span> <span class="done DONE">DONE</span> 多表查询</h4>
<div class="outline-text-4" id="text-3-5-5">
<p>
实际工作中的表格不会只有一个,大量数据分布在不同工作表中,在统计,分析,核对时很不方
便,这时就需要使用 <b>多表查询</b> 来将需要的数据提取到当前表格.
</p>

<p>
将匹配的对应数据提取到当前表格这个过程中最常用的是 VLOOKUP 函数(不是 value look
up, 是 vertical look up, 因此还有一个函数是 HLOOKUP, horizontal look up)
</p>
</div>

<div id="outline-container-org612232f" class="outline-5">
<h5 id="org612232f"><span class="section-number-5">3.5.5.1.</span> <span class="done DONE">DONE</span> 如何使用VLOOKUP函数查找部门绩效</h5>
<div class="outline-text-5" id="text-3-5-5-1">
<p>
根据如果数据是根据规范制表的,那么一个工作表只会储存一个表格的信息, 为了方便练习,
给出的练习工作表中是将两个数据表放在同一个工作表里的.
</p>

<p>
需求,员工的奖金需要根据其所在部门的绩效等级进行计算,而员工信息表中默认是没有部门
绩效数据的.
</p>

<p>
因此,我们需要根据员工所在部门得出其对应部门绩效,才能用来计算奖金.
</p>

<p>
<a href="#orged4a578">VLOOKUP 函数的基础</a>
</p>

<p>
假设 A2 是部门名, F2 是要匹配的对应部门绩效, H,I 列是部门绩效表, H 列是部门字段,
I 列是绩效字段, 根据这些信心,可以得到获取对应部门绩效的函数公式:
<code>=VLOOKUP(A2,H2:I6,2,FALSE)</code>
</p>

<p>
A2 是要查找的数据, H2:I6 是在哪个区域查找以及取值, 2 表示在查找区域的第2列取值,
FALSE 表示进行精确匹配(只有完全匹配才会进行取值)
</p>
</div>
</div>

<div id="outline-container-org525294b" class="outline-5">
<h5 id="org525294b"><span class="section-number-5">3.5.5.2.</span> <span class="done DONE">DONE</span> 如何根据销售数据计算对应的绩效等级</h5>
<div class="outline-text-5" id="text-3-5-5-2">
<p>
讲解 IF 函数用例的时候我就补充过笔记,当分类等级比较多时, IF 函数会很复杂, 以及当
分类等级太多时, IF 限制最多 7 层就不够用了,因此可以使用 VLOOKUP 进行分类.
</p>

<p>
这里就是使用 VLOOKUP 来根据销售数据计算出绩效等级(也就是分类)的用例.
用法我是已经会了,但有细节需要补充,就是作为条件表的辅助表格的建立.
</p>

<p>
一般给出的条件是形如 "八万以下", "8万到12万" ,"60分-70分" 这种形式,而销售额或成
绩等都是数值形式的数据,是无法使用 VLOOKUP 进行查询的,因为要利用 VLOOKUP 模糊查询
的特性,所以辅助列(表)的构建就要注意, 以 "八万以下" 为例, 构建辅助列的数据,
VLOOKUP 模糊查询的特性是当找不到完全匹配的值时,会选择比要查找的值小的辅助表的最
大数据,因此,只要数据是小于 80000 的,都属于同一级别绩效,根据 VLOOKUP 的特性,想要
将小于 80000 的数据归纳为 "八万以下" 的等级,我们需要将辅助列的数据设置为 0,80000
,假设查找 50000 的值,就会选择小于 50000 的 0 这一等级. 所以,针对 "0-8万" 为等级
D,"8-12万" 为等级 C,"12-15万" 为等级 B "大于15万"为A 这样的条件,我们构建的辅助表是:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right">辅助列</td>
<td class="org-left">等级</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-left">D</td>
</tr>

<tr>
<td class="org-right">80000</td>
<td class="org-left">C</td>
</tr>

<tr>
<td class="org-right">120000</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-right">150000</td>
<td class="org-left">A</td>
</tr>
</tbody>
</table>

<p>
构建辅助列后,根据该辅助列可以使用公式 : <code>=VLOOKUP(D2,G2:H5,2,TRUE)</code> D2 是销售数
据, G2:H5 就是我们构建的辅助表数据也是函数中的查找区域, 2 表示选择查找区域中的第
二列对应的数据,也就是等级列, TRUE 表示使用模糊匹配,也就是找不到完全匹配的值时,选
择比查找值小的最大数据作为匹配项.
</p>

<blockquote>
<p>
使用 VLOOKUP 需要注意:
</p>
<ul class="org-ul">
<li>模糊匹配只能用于数字,这个"模糊"与通配符的模糊匹配是不同的意思.</li>
<li>查找列必须是数字.</li>
<li>查找列的数字必需从小到大排序.</li>
<li>模糊匹配匹配到的是小于查找值的最大值.</li>
</ul>
</blockquote>
</div>
</div>

<div id="outline-container-orgc0b200c" class="outline-5">
<h5 id="orgc0b200c"><span class="section-number-5">3.5.5.3.</span> <span class="done DONE">DONE</span> 如何按照姓名查询每个月的销量</h5>
<div class="outline-text-5" id="text-3-5-5-3">
<p>
这个需求我还没见过,对照练习表看了下,感觉是在一个大的表格中截取部分数据:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">A</td>
<td class="org-right">B</td>
<td class="org-right">C</td>
<td class="org-right">D</td>
<td class="org-right">E</td>
</tr>

<tr>
<td class="org-right">销售员</td>
<td class="org-right">1月</td>
<td class="org-right">2月</td>
<td class="org-right">3月</td>
<td class="org-right">4月</td>
</tr>

<tr>
<td class="org-right">10001</td>
<td class="org-right">150</td>
<td class="org-right">150</td>
<td class="org-right">90</td>
<td class="org-right">100</td>
</tr>

<tr>
<td class="org-right">10002</td>
<td class="org-right">30</td>
<td class="org-right">100</td>
<td class="org-right">100</td>
<td class="org-right">260</td>
</tr>

<tr>
<td class="org-right">10003</td>
<td class="org-right">300</td>
<td class="org-right">10</td>
<td class="org-right">260</td>
<td class="org-right">150</td>
</tr>

<tr>
<td class="org-right">&#x2026;</td>
<td class="org-right">&#x2026;</td>
<td class="org-right">&#x2026;</td>
<td class="org-right">&#x2026;</td>
<td class="org-right">&#x2026;</td>
</tr>
</tbody>
</table>

<p>
需要在这个大的表格中获取销售员 10023 和 10025 每个月份的销售数据
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right">G</td>
<td class="org-left">H</td>
<td class="org-left">I</td>
<td class="org-left">J</td>
<td class="org-left">K</td>
</tr>

<tr>
<td class="org-right">销售员</td>
<td class="org-left">1月</td>
<td class="org-left">2月</td>
<td class="org-left">3月</td>
<td class="org-left">4月</td>
</tr>

<tr>
<td class="org-right">10023</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">10025</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
虽然这两个表的结构相同,只要找到对应的数据行就可以将数据复制到需求的表中了,但因为
大的数据表中数据很多,我们不可能每次都手动去查找销售员编号,然后复制,一个两个可能
不会费多大事情,但数量超过3个我都觉得手动操作太麻烦了.
</p>

<p>
因此可以使用函数公式.因为两个表的结构是相同的,所以对应每个月的销售数据只需要找到
销售员,然后获取每个月的销售数据即可,这与 VLOOKUP 找到匹配项,然后在相应列取值的运
行流程一致,因此很适合用 VLOOKUP 实现.
<code>=VLOOKUP(G2,A:E,2,FALSE)</code> 这个函数公式就可以获取 10023 的1月份销售数据了. 因为
要使用快速填充等功能来将公式应用到其他单元格,因此单元格的引用方式需要更改:
<code>=VLOOKUP($G2,$A:$E,2,FALSE)</code> , 公式需要向下和向右填充到其他数据列/行,因此 G2 应
该改成 $G2 让向下填充时行号可以变化,对应销售员编号,而向右填充时列号G 不变; 同样
道理, $A:$E 直接固定整个查询区域. 确定取值列的 2 如果向右填充,则需要改成
3,4,&#x2026; 手动该是不便捷的,可以利用函数生成这样的值,例如 COLUMN 函数,获取引用的列
号, COLUMN(B1) 就是第二列,返回 2,因此将 2 改成 COLUMN(B1) 或 COLUMN(B:B) 都行,这
样向右填充时,会自动变成 COLUMN(C1) 或 COLUMN(C:C) 这样就生成了 2,3,4&#x2026; 的值了.
最终的函数公式: <code>=VLOOKUP($G2,$A:$E,COLUMN(B:B),FALSE)</code> ,将这个单元格的公式向右
填充到一行,然后将这一行向下填充到整个剩余表格就可以获取需要的数据了.
</p>
</div>
</div>

<div id="outline-container-org3ff31de" class="outline-5">
<h5 id="org3ff31de"><span class="section-number-5">3.5.5.4.</span> <span class="done DONE">DONE</span> 如何匹配对应的补助金额</h5>
<div class="outline-text-5" id="text-3-5-5-4">
<p>
这一节的需求我也没有练习过,我认为是用一个二维的分类条件表给数据进行分类.
需求: 出差补助根据员工级别不同,出差的城市级别不同发放,现在要根据发放标准给出差明
细表计算补助金额.
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">A</td>
<td class="org-right">B</td>
<td class="org-right">C</td>
<td class="org-right">D</td>
</tr>

<tr>
<td class="org-left">级别</td>
<td class="org-right">一线城市</td>
<td class="org-right">二线城市</td>
<td class="org-right">地级市</td>
</tr>

<tr>
<td class="org-left">员工</td>
<td class="org-right">700</td>
<td class="org-right">600</td>
<td class="org-right">500</td>
</tr>

<tr>
<td class="org-left">主管</td>
<td class="org-right">900</td>
<td class="org-right">800</td>
<td class="org-right">700</td>
</tr>

<tr>
<td class="org-left">经理</td>
<td class="org-right">1100</td>
<td class="org-right">1000</td>
<td class="org-right">900</td>
</tr>

<tr>
<td class="org-left">总经理</td>
<td class="org-right">1300</td>
<td class="org-right">1200</td>
<td class="org-right">1100</td>
</tr>
</tbody>
</table>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">G</td>
<td class="org-left">H</td>
<td class="org-left">I</td>
<td class="org-left">J</td>
</tr>

<tr>
<td class="org-left">姓名</td>
<td class="org-left">级别</td>
<td class="org-left">城市类别</td>
<td class="org-left">补助/元</td>
</tr>

<tr>
<td class="org-left">施夏梅</td>
<td class="org-left">员工</td>
<td class="org-left">一线城市</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">曹勤</td>
<td class="org-left">主管</td>
<td class="org-left">二线城市</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">褚美娟</td>
<td class="org-left">员工</td>
<td class="org-left">地级市</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">吕艳红</td>
<td class="org-left">主管</td>
<td class="org-left">一线城市</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">赵朱婷</td>
<td class="org-left">经理</td>
<td class="org-left">二线城市</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
这里的分类条件就是一个二维的了,需要先确定员工级别,再确定城市级别,才能找到正确的
值,最简单的逻辑,使用 IF 条件好似可以,但不用细想就知道,要用 IF 将所有条件的判断写
出来,就算不考虑 IF 的嵌套层数限制,光写出来就够复杂的了,而且还不容易修改调试.
</p>

<p>
可以将问题分解开,先不考虑第二维度的条件,只考虑第一维度的条件,例如,根据员工级别查
找 "施夏梅" 的补助,城市类别这一条件我们手动填写: <code>=VLOOKUP(H2,A:D,2,FALSE)</code>
"施夏梅" 的级别是 H2, 城市类别对应一线城市,也就是查找区域的第二列. 这样我们可以
得到正确的补助金额 700. 解决完员工级别这一条件,再来看手动填写的城市类别这一条件,
可以发现一线城市字段列对应查找区域的第二列,如果可以根据城市类别确定取值列,就不用
手动填写了,恰好有一个函数能根据值返回位置
MATCH(lookup<sub>value</sub>, lookup<sub>array</sub>, match<sub>type</sub>) , MATCH 函数返回 lookup<sub>array</sub> 中
lookup<sub>value</sub> 的相对位置,这个相对,意思是位于 lookup<sub>array</sub> 中的第几列第几行,而不是
位于整个表格中的行列号.
</p>

<p>
在这个需求中,我们可以使用 MATCH("一线城市", $A$2:$D$2, 0)  (match<sub>type</sub> 0 表示精
确匹配), 来得到一线城市在 VLOOKUP 的查找区域对应的列号 2,因此完整的函数公式:
<code>=LOOKUP(H2,$A:$D, MATCH(I2,$A$2:$D$2, 0), FALSE)</code> 这个公式就可以向下填充到其他
单元格了.
</p>
</div>
</div>
</div>



<div id="outline-container-org9b374c3" class="outline-4">
<h4 id="org9b374c3"><span class="section-number-4">3.5.6.</span> <span class="done DONE">DONE</span> 日期和时间的计算</h4>
<div class="outline-text-4" id="text-3-5-6">
<p>
日期和时间是常见的数据,他们可以作为数据分析的分类维度,也可以参与计算.
</p>

<blockquote>
<p>
日期和时间一个基础知识,Excel 中的日期和时间是记录从 1900年1月1日到其之后的某个日
期过去的天数以及多出的小时数,比如 1900年1月2日这个日期: <code>1900/1/2</code> 对应的数字就
是1.00 ,而数字1.5 对应的就是 <code>1900/1/2 12:00</code> 这个日期和时间.
</p>

<p>
整数部分表示的就是距离 1900年1月1日过去了多少天, 小数部分就是当天过去了多少小时
多少分钟.
</p>
</blockquote>
</div>

<div id="outline-container-orgf127ad9" class="outline-5">
<h5 id="orgf127ad9"><span class="section-number-5">3.5.6.1.</span> <span class="done DONE">DONE</span> 如何计算两个日期相差的天数</h5>
<div class="outline-text-5" id="text-3-5-6-1">
<p>
前面说过,日期就是拥有特殊显示样式的数字,因此他们是可以像数字一样加减的.
</p>

<p>
计算天数,只需要将日期将减就可以了,例如:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">A</td>
<td class="org-left">B</td>
<td class="org-left">C</td>
<td class="org-left">D</td>
</tr>

<tr>
<td class="org-left">工号</td>
<td class="org-left">入职日期</td>
<td class="org-left">离职日期</td>
<td class="org-left">出勤天数</td>
</tr>

<tr>
<td class="org-left">10001</td>
<td class="org-left">2017/9/21</td>
<td class="org-left">2017/10/5</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
这个出勤天数可以用公式 <code>C2-B2</code> 就可以得到. 一般下面都还有其他人的数据,因为只需要
向下填充,所以公式也不用做额外修改.
</p>

<blockquote>
<p>
日期,只有整数部分,小数部分则为0(说成没有小数部分也是可以的,但因为数值是可以设置
小数点的,只能说它为0),而时间则是一个整数部分为0 的小数, 但 1.5 这种数值,既有小数
部分,又有整数部分,当它设置样式为时间或日期时就不能只看作其是小数或整数,计算结果
可能会出现误差,但是 Excel 快捷键输入时间(Ctrl+Shift+;)和日期(Ctrl+;) 输入的都是
小数或整数,不会出现 1.5 这种,出现了必定是人为手动输入的数据,那么对于手动输入的时
间日期数据的处理就需要注意一点了.
</p>
</blockquote>
</div>
</div>


<div id="outline-container-org403e78f" class="outline-5">
<h5 id="org403e78f"><span class="section-number-5">3.5.6.2.</span> <span class="done DONE">DONE</span> 如何把出勤时长改成小时数</h5>
<div class="outline-text-5" id="text-3-5-6-2">
<p>
时间也是数字,小数部分的数字,表示该时间位于当天 24 小时的占比, 0.5 就表示一天过去
了一半,也就是 12:00. 如果发现时间信息中有秒的信息,那么要么是从其他数据源导入的数
据,要么是手动设置过的数据.
</p>

<p>
出勤时长一般都是当天的时间,因此也只需要用时间相减就可以得到时间差了.这个时间差也
是一段时间位于 24 小时中的占比,而时间的运算结果 Excel 也会显示为时间,因此,想要将
其转换成真正的小时数,例如 1.5 小时,表示1个小时30分钟,而显示为时间 1:30 在 Excel
中则是数值 0.06, 因此想得到真正的小时数,需要将 Excel 的时间数乘以 24.
假设开始时间 E2 的数据为 7:45:00 结束时间 F2 为 18:54:00 其出勤时间的小时数可以
用公式 <code>=(F2-E2)*24</code> 得到,结果为 11.2 小时. 因为这个公式用到了时间数据计算,
Excel 可能会默认将其显示为时间格式,因此我们还需要将单元格格式设置为常规或数值,并
将小数点设置为1位.
</p>

<p>
另外,既然是数字,那么就一定是可以比较的,基于此,还可以用员工的打卡时间判读是否迟到.
</p>

<p>
<code>=IF((A2-"8:00")&gt;0,"迟到","没迟到")</code> . 最开始我大致扫了一眼这部分的内容,看到一个
公式 <code>=IF(A2&gt;"8:00","迟到", "没迟到")</code> 以为是可以用的公式,还想着说这是没有学过的
知识点:"逻辑表达式可以直接比较时间值", 结果实际操作发现不可以,仔细阅读后才发现,
是作者让我们自己判断是否哪种公式是正确的, 根据四则运算会尝试转换为数值的特性,使
用减法进行运算的公式肯定是对的,但直接使用大于符号进行比较的就得不到正确结果.
</p>
<blockquote>
<p>
Excel 中数值类型永远小于文本类型,而小于号的不会进行数值转换,因此实际上判断的是
A2 中的数值与 "8:00" 这个文本的大小,结果永远都是数值小于文本的,例如 <code>=1&lt;"-1"</code> 的
公式值为 TRUE.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orgbf22ebc" class="outline-5">
<h5 id="orgbf22ebc"><span class="section-number-5">3.5.6.3.</span> <span class="done DONE">DONE</span> 如何计算员工入职到离职相差的月数</h5>
<div class="outline-text-5" id="text-3-5-6-3">
<p>
计算入职的天数,直接将入职和离职日期相减就可以了.但如果要求计算入职的月份呢?
</p>

<p>
分析一下,可以根据天数算月份,但每个月天数不一样,不好计算,如果假设每个月都是30天,
如果入职到离职期间时间比较长,那误差就会很大,甚至大到几个月的误差,因此这种方式不
可取.
</p>

<p>
Excel 有专门计算日期的函数 <a href="#org909c161">DATEDIF 函数(计算两个日期之间的年数,月数和天数)</a>
DATEDIF(开始日期,结束日期,日期差类型), 第三个参数表示计算什么类型的日期差,例如
"Y" 表示相差年数, "M" 表示相差月数, "D" 表示相差天数.还有 "YM","MD" 和 "YD" 表示
忽略第一个字母单位,计算第二个字母单位的日期差,例如 "YM" 表示忽略年份,计算月份,
<code>=DATEDIF("1999/1/29","2020/11/29","YM")</code> 表示忽略年份,计算月份,即计算从1月29 到
11月29 中间隔了多少月,结果为10.
</p>

<blockquote>
<p>
这个函数已经不推荐使用了,在Excel 键入这个函数都没有输入提示.但还是可以使用它并查
看它的帮助信息.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org79e53e7" class="outline-5">
<h5 id="org79e53e7"><span class="section-number-5">3.5.6.4.</span> <span class="done DONE">DONE</span> 如何根据日期提取年月日和周别</h5>
<div class="outline-text-5" id="text-3-5-6-4">
<p>
在 <a href="#org1f64490">返回日期和时间</a> 中有提取日期中特定信息的函数,YEAR() 提取年份,MONTH() 提取月份,
DAY() 提取日期, 需要主义的是 WEEKNUM() 函数,它用来计算日期对应的周别,也就是当年
的第几周,WEEKNUM(serial<sub>number,return</sub><sub>type</sub>) 中第二个参数对应选择每周从星期几开始.这
个参数会决定当年的第一周是哪那一周. WEEKDAY 中的参数也类似. 这些函数只是用来提取
信息,不直接参与数据分析,使用方法也很简单,因此不多做笔记.
</p>
</div>
</div>
</div>



<div id="outline-container-orgd2078c3" class="outline-4">
<h4 id="orgd2078c3"><span class="section-number-4">3.5.7.</span> <span class="done DONE">DONE</span> 函数公式的检查和校正</h4>
<div class="outline-text-4" id="text-3-5-7">
<p>
新手使用函数公式,出现错误时可能会无从下手,但有经验的人能够细心检查,调整,调试公式
来找出错误并修正,一步步得出正确答案.
</p>
</div>

<div id="outline-container-org2435168" class="outline-5">
<h5 id="org2435168"><span class="section-number-5">3.5.7.1.</span> <span class="done DONE">DONE</span> 常见的错误</h5>
<div class="outline-text-5" id="text-3-5-7-1">
<ul class="org-ul">
<li>函数拼写错误 : 最低级的错误,因为函数名拼写错了, Excel 无法识别该函数,所以会出
现 <code>#NAME?</code> 的错误.</li>
<li>数据输入错误 : 函数没有问题,但是数据不符合规范,也会导致函数公式的结果错误,例如
为了对其姓名数据,正确做法是设置数据的样式为[分散对齐],而不知道这一点的人可能会
用空格填充姓名来将数据对齐,这就会导致数据中存在错误的空格数据.了解基础数据表的
规范能有效避免这一点.</li>
<li>数据格式错误 : 数据的格式错误比较不容易被发现,尤其是新手以及设置了样式的数据.最
典型的就是文本类的数字,例如 "123" 这种以文本形式储存的数字,在 Excel 中会在左上
角显示一个三角形,提示其格式可能会有问题.而很多人看到显示的是数字,就按照数字类
型来使用这些数据,结果当然会出现错误.
格式错误前面的公式里就提到过,<a href="#org403e78f">如何把出勤时长改成小时数</a> 里提到的那两个判断迟到的
公式, A2&gt;"8:00" 中的 "8:00" 是会直接当作文本处理的,因此作为数值的时间数据与文
本比较一定是小于文本的, A2-"8:00" 使用了四则运算,则会将非数值数据转换成数值数
据后进行计算,所以会将 "8:00" 转换成对应数值后计算,因此这个公式才是正确的.</li>
<li>引用区域错误 : 使用函数公式经常会用到单元格(区域)的引用,如果引用了错误的区域,
或引用区域不符合函数要求,就会出错,熟悉函数要求以及主义使用引用时 Excel 给出的
提示区域就可避免这种错误.</li>
<li>单元格格式错误 : 输入完公式,发现公式不计算,那么最大可能就是单元格的格式被设置
为了 "文本",此时输入的公式不会当作公式处理,也就不会计算了,需要将单元格格式设置
为常规才行.对于已有数据的单元格修改格式,可以使用前面说过的分列操作.</li>
</ul>


<p>
常见的错误见下表:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">类型</td>
<td class="org-left">要点</td>
<td class="org-left">说明</td>
<td class="org-left">解决思路</td>
</tr>

<tr>
<td class="org-left">数据规范</td>
<td class="org-left">单元格格式</td>
<td class="org-left">要计算的公式显示为文本格式,不显示计算结果</td>
<td class="org-left">分列法;用数值1的单元格选择性粘贴选择乘法操作(对文本类型公式无效)</td>
</tr>

<tr>
<td class="org-left">数据规范</td>
<td class="org-left">数字格式</td>
<td class="org-left">编辑栏中的实际内容与显示不一致</td>
<td class="org-left">统一内容和数字格式</td>
</tr>

<tr>
<td class="org-left">数据规范</td>
<td class="org-left">数据错漏</td>
<td class="org-left">拼写错误,漏字,多字</td>
<td class="org-left">填补空缺,替换,修改,删除</td>
</tr>

<tr>
<td class="org-left">数据规范</td>
<td class="org-left">拼写不一致</td>
<td class="org-left">同一项内容有多种拼写方式</td>
<td class="org-left">统一数据:筛选,替换,批量填充等</td>
</tr>

<tr>
<td class="org-left">数据规范</td>
<td class="org-left">多余空格,空行</td>
<td class="org-left">存在多余的空格和不可见字符</td>
<td class="org-left">清楚空格与空行:替换,定位,排序,填充等</td>
</tr>

<tr>
<td class="org-left">数据规范</td>
<td class="org-left">假日期,假数字</td>
<td class="org-left">无法计算</td>
<td class="org-left">分列法;公式法</td>
</tr>

<tr>
<td class="org-left">公式书写规范</td>
<td class="org-left">名称错误</td>
<td class="org-left">名称字母顺序错误,多写,漏写字母</td>
<td class="org-left">逐个字符检查核对</td>
</tr>

<tr>
<td class="org-left">公式书写规范</td>
<td class="org-left">标点符号</td>
<td class="org-left">多余,遗漏标点,夹杂中文标点</td>
<td class="org-left">逐个符号,参数核对</td>
</tr>

<tr>
<td class="org-left">公式书写规范</td>
<td class="org-left">嵌套函数</td>
<td class="org-left">括号位置错误</td>
<td class="org-left">按括号颜色分辨嵌套层次</td>
</tr>

<tr>
<td class="org-left">参数规范</td>
<td class="org-left">遗漏</td>
<td class="org-left">缺少必要参数,遗漏分隔符</td>
<td class="org-left">查看函数帮助和提示进行修正</td>
</tr>

<tr>
<td class="org-left">参数规范</td>
<td class="org-left">过多</td>
<td class="org-left">多分隔符</td>
<td class="org-left">检查分隔符,删除多余符号</td>
</tr>

<tr>
<td class="org-left">参数规范</td>
<td class="org-left">不符合要求</td>
<td class="org-left">不符合函数本身对参数的要求.如 SUMIF 函数中的求和区域必需与条件区域大小相等</td>
<td class="org-left">查看函数帮助和提示进行修正</td>
</tr>

<tr>
<td class="org-left">数据引用规范</td>
<td class="org-left">引用方式</td>
<td class="org-left">固定引用和相对引用的使用不当,导致填充公式时引用范围的错误偏移</td>
<td class="org-left">编辑状态下检查引用区域;公式选项卡[显示公式]查看引用情况;F4 快捷键切换引用</td>
</tr>

<tr>
<td class="org-left">数据引用规范</td>
<td class="org-left">范围不完整</td>
<td class="org-left">遗漏了新增,修改的数据</td>
<td class="org-left">重新选择引用范围(拖拽引用框或修改公式参数)</td>
</tr>

<tr>
<td class="org-left">数据引用规范</td>
<td class="org-left">丢失</td>
<td class="org-left">数据源删除导致丢失数据</td>
<td class="org-left">同上</td>
</tr>

<tr>
<td class="org-left">数据引用规范</td>
<td class="org-left">偏移</td>
<td class="org-left">数据源移动导致引用范围偏移</td>
<td class="org-left">同上</td>
</tr>
</tbody>
</table>

<blockquote>
<p>
有一点需要注意,单元格样式中设置数据的类型,只对单元格中"将要"输入的数据生效,不对
已有的数据生效,因此,想要改变已有数据的数据类型,不能使用设置样式的方式,只能用分列
或公式或选择性粘贴的运算来实现.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org78a41a3" class="outline-5">
<h5 id="org78a41a3"><span class="section-number-5">3.5.7.2.</span> <span class="done DONE">DONE</span> 排错工具和技巧</h5>
<div class="outline-text-5" id="text-3-5-7-2">
<p>
Excel 中有排错工具,可以帮助我们快速定位问题.
[公式] 选项卡中有一系列公式审核工具,帮助我们精准定位问题.
</p>

<dl class="org-dl">
<dt>追踪工具</dt><dd>[追踪引用单元格] 可以查看该单元格中的公式引用了那些数据和区域, [追
踪从属单元格] 可以查看当前单元格被哪些单元格引用.[删除箭头]可以删除追踪工具生
成的所有箭头.</dd>
<dt>显示公式工具</dt><dd>[显示公式] 可以在表格中显示全部公式的"真身",还可以用彩色引用框
显示该公式所引用的数据和区域.</dd>
<dt>分解步骤,查看计算过程</dt><dd>在[公式求值]对话框中,可以逐步查看计算过程,发现错误的
具体位置,更加明确错误来自哪里.</dd>
<dt>公式如何屏蔽错误</dt><dd>有的公式本身没错,但计算逻辑可能会导致错误值(例如 #N/A) 的
生成. 如果不想显示这种错误,可以使用 IFERROR(value,value<sub>if</sub><sub>error</sub>) 来屏蔽这种错
误,该公式中,如果 value 这个公式计算出的值是一个错误值,就会返回 value<sub>if</sub><sub>error</sub>,
例如 <code>=IFERROR(VLOOKUP(F2,B:D,2,0), "")</code> 如果 VLOOKUP 函数返回错误值, IFERROR
就会返回 "" 也就是空白文本.</dd>
</dl>
</div>
</div>

<div id="outline-container-org2207226" class="outline-5">
<h5 id="org2207226"><span class="section-number-5">3.5.7.3.</span> <span class="done DONE">DONE</span> 记不住函数怎么办</h5>
<div class="outline-text-5" id="text-3-5-7-3">
<p>
常年使用 Excel 的人也未必能准确记住所有常用函数的语法和参数,能记住的是与自己工作
息息相关且使用频率很高的函数.
可能会出现:
</p>
<ul class="org-ul">
<li>不知道某个函数的参数具体怎么设置</li>
<li>不知道具体选择哪一个(些)函数.</li>
</ul>


<p>
Excel 有一些辅助功能,能减轻记忆负担.
</p>
<dl class="org-dl">
<dt>浮动提示框</dt><dd>在输入函数或参数的过程中, Excel 都会显示一个浮动的提示框来帮助你
选择函数和参数.</dd>
<dt>直达函数的帮助文件</dt><dd>知道使用哪个函数,但一时想不起具体的使用细节了,可以点击浮
动提示框中的函数名称,直达该函数的帮助文档.</dd>
<dt>利用关键词搜索相关函数</dt><dd>编辑栏中有个 [插入函数] 的按钮,就是[公式]-[插入函数]
图表的缩小版本,点击它可以打开选择函数的对话框,可以使用关键词搜索函数.但这里显
示的函数说明比较简短.</dd>
</dl>
</div>
</div>
</div>


<div id="outline-container-orgb0425a5" class="outline-4">
<h4 id="orgb0425a5"><span class="section-number-4">3.5.8.</span> <span class="todo NEXT">NEXT</span> 数据分析必会功能:数据透视表</h4>
<div class="outline-text-4" id="text-3-5-8">
<p>
前面的一个章节介绍了常见的统计分析,如数据分类,条件计数,求和,数据核对,查询等.但是
实践过程中,会发现使用函数公式有几个难点:
</p>
<ul class="org-ul">
<li>难度大. 函数多,规则多,学习难度大</li>
<li>易出错. 引用区域,格式,符号等,一不小心都会出错.</li>
<li>不好记. 使用函数需要掌握的知识点非常多.而且不好记.</li>
</ul>


<p>
另外,实际工作中,需求很容易经常变化,上午的需求到了下午可能就变了,使用函数的话可能
上午的工作就白费了.
</p>

<p>
因此,Excel 提供了一个既有和函数一样的强大计算能力,又很容易学习和使用的功能,能让
新手也能快速完成数据分析统计.
</p>
</div>

<div id="outline-container-org62102cd" class="outline-5">
<h5 id="org62102cd"><span class="section-number-5">3.5.8.1.</span> <span class="done DONE">DONE</span> 数据透视表基础</h5>
<div class="outline-text-5" id="text-3-5-8-1">
</div>
<ol class="org-ol">
<li><a id="org28b56e1"></a><span class="done DONE">DONE</span> 如何统计每个分部的销售总额与销售量<br />
<div class="outline-text-6" id="text-3-5-8-1-1">
<p>
在基础数据表中,有所有部门的销售数据,想要获取每个分部的销售总额和销售量:
</p>
<dl class="org-dl">
<dt>分类数据</dt><dd>首先要将数据分类,按每个分部进行分类,在前面我们使用删除重复值的方式
得到所有不重复的部门,在数据透视表中,直接将分类的字段拖动到数据透视表的行区域就
可以完成这一操作.</dd>
<dt>统计数据</dt><dd>数据统计也很简单,只需要将要统计的字段拖动到 [值] 区域就可以完成统
计.</dd>
</dl>


<p>
上面这些操作都是使用 [数据透视表字段] 面板中的功能完成的:
</p>
<dl class="org-dl">
<dt>字段列表</dt><dd>显示数据源中的字段.</dd>
<dt>行区域</dt><dd>行区域的字段可以快速提取字段中所有不重复的值,完成分类操作.</dd>
<dt>列区域</dt><dd>与行区域类似,只是字段内容排列方向不同.</dd>
<dt>值区域</dt><dd>会按照[行/列]区域中的分类统计数据. 默认的对值数据进行求和,文本数据进
行统计数量,具体的统计方法也是可以通过点击具体字段来修改的.</dd>
<dt>筛选区域</dt><dd>这个区域的字段会在数据透视表的顶部增加筛选选项.单击筛选选项按钮,可
以根据需求筛选数据,这里的筛选会让数据透视表的结果更新.</dd>
</dl>
</div>
</li>

<li><a id="orgc75ac81"></a><span class="done DONE">DONE</span> 如何按照分部统计不同销售员的销量与销售额<br />
<div class="outline-text-6" id="text-3-5-8-1-2">
<p>
这是数据分析中的分类非常多,甚至分类存在层级以及交叉的情况.
</p>

<p>
要显示不同部门的员工信息,以及员工的销量和销售额, 这里的分类就是员工和部门信息这
两种分类标准.
</p>

<p>
最简单的思路,这是一个二维的条件,那么我们将销售员字段放在行区域,部门字段放在列区
域,要统计的数值信息销量和销售额放在值区域就可以了
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">求和项:销售数量</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">求和项:销售金额/元</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">求和项:销售数量汇总</td>
<td class="org-right">求和项:销售金额/元汇总</td>
</tr>

<tr>
<td class="org-left">行标签</td>
<td class="org-left">北京分部</td>
<td class="org-right">上海分部</td>
<td class="org-right">深圳分部</td>
<td class="org-right">长沙分部</td>
<td class="org-left">北京分部</td>
<td class="org-right">上海分部</td>
<td class="org-right">深圳分部</td>
<td class="org-right">长沙分部</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-left">邓强</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">5083</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">135386</td>
<td class="org-right">5083</td>
<td class="org-right">135386</td>
</tr>

<tr>
<td class="org-left">高霞</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">8010</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">169736</td>
<td class="org-right">8010</td>
<td class="org-right">169736</td>
</tr>

<tr>
<td class="org-left">高晓丽</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">5324</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">140989</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">5324</td>
<td class="org-right">140989</td>
</tr>

<tr>
<td class="org-left">李富贵</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">7544</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">192986</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">7544</td>
<td class="org-right">192986</td>
</tr>

<tr>
<td class="org-left">李辉</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">6868</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">173710</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">6868</td>
<td class="org-right">173710</td>
</tr>

<tr>
<td class="org-left">刘有三</td>
<td class="org-left">5840</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">197129</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">5840</td>
<td class="org-right">197129</td>
</tr>

<tr>
<td class="org-left">王鹏宇</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">7053</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">188481</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">7053</td>
<td class="org-right">188481</td>
</tr>

<tr>
<td class="org-left">张丽丽</td>
<td class="org-left">6144</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">155449</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">6144</td>
<td class="org-right">155449</td>
</tr>

<tr>
<td class="org-left">总计</td>
<td class="org-left">11984</td>
<td class="org-right">14412</td>
<td class="org-right">12377</td>
<td class="org-right">13093</td>
<td class="org-left">352578</td>
<td class="org-right">366696</td>
<td class="org-right">329470</td>
<td class="org-right">305122</td>
<td class="org-right">51866</td>
<td class="org-right">1353866</td>
</tr>
</tbody>
</table>
<p>
最终得到一个如上的表格.
</p>

<p>
因为使用数据透视表的试错成本很低,所以可以尝试将字段拖动到不同区域查看不同效果.
</p>

<p>
销量和销售额放在值区域是不用改变的,但行和列区域的字段可以尝试更改,上面的表格可以
看到有空白单元格,可能不是很美观,所以可以将部门字段放到[筛选]区域,这样我们使用筛
选来查看特定分部的员工的销售量和销售金额.
可以得到类似这样一个表格.
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">销售部</td>
<td class="org-right">长沙分部</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-left">行标签</td>
<td class="org-right">求和项:销售数量</td>
<td class="org-right">求和项:销售金额/元</td>
</tr>

<tr>
<td class="org-left">邓强</td>
<td class="org-right">5083</td>
<td class="org-right">135386</td>
</tr>

<tr>
<td class="org-left">高霞</td>
<td class="org-right">8010</td>
<td class="org-right">169736</td>
</tr>

<tr>
<td class="org-left">总计</td>
<td class="org-right">13093</td>
<td class="org-right">305122</td>
</tr>
</tbody>
</table>
</div>
</li>

<li><a id="org7726760"></a><span class="done DONE">DONE</span> 使用数据透视表会遇到的常见问题以及解决办法<br />
<div class="outline-text-6" id="text-3-5-8-1-3">
<dl class="org-dl">
<dt>数据透视表创建以后,如何删除不想要的字段</dt><dd>将字段拖曳出该区域,或在字段列表中取
消勾选该字段就能将字段删除.</dd>
<dt>字段列表区域太小,字段显示不全,操作不方便</dt><dd>右上角有一个齿轮图标,点击它可以设
置[数据透视表字段]的布局. 或者拖曳字段列表区域的边界线,调整该区域大小.</dd>
<dt>选择数据透视表的单元格,但没有出现[数据透视表字段]的界面</dt><dd>首先,确认是选中了数
据透视表中的单元格,然后在[数据透视表分析]选项卡中点击[字段列表]的按钮,就能打开
该面板.</dd>
<dt>如何在现有工作表中创建数据透视表</dt><dd>在创建数据透视表时,除了选择数据区域外,还有
选择放置数据透视表的位置的选项,勾选 [现有工作表],然后输入一个空白单元格的引用
作为插入点.</dd>
</dl>
</div>
</li>
</ol>
</div>

<div id="outline-container-org46faa0c" class="outline-5">
<h5 id="org46faa0c"><span class="section-number-5">3.5.8.2.</span> <span class="todo NEXT">NEXT</span> 分组统计,实现多维度数据分析</h5>
<div class="outline-text-5" id="text-3-5-8-2">
<p>
将字段拖动到行/列区域,可以实现分类,但有些数据只是列出字段的内容,而不能算作分类,
例如日期数据,它太多了,作为分类不现实. 这时就要使用分组统计,来进行多维度的数据分
析,这些对于数据透视表来说,也不难实现.
</p>
</div>

<ol class="org-ol">
<li><a id="orge0d309a"></a><span class="todo NEXT">NEXT</span> 如何按照极度统计销售金额<br />
<div class="outline-text-6" id="text-3-5-8-2-1">
<p>
以销售明细表为例,如何统计每个季度的销售金额?
</p>
</div>
</li>
</ol>
</div>


<div id="outline-container-orgcec42e2" class="outline-5">
<h5 id="orgcec42e2"><span class="section-number-5">3.5.8.3.</span> <span class="todo NEXT">NEXT</span> 布局美化,让分析报表更好看</h5>
</div>

<div id="outline-container-orgffbd924" class="outline-5">
<h5 id="orgffbd924"><span class="section-number-5">3.5.8.4.</span> <span class="todo NEXT">NEXT</span> 统计数据,多种统计方式一键切换</h5>
</div>

<div id="outline-container-org0a90768" class="outline-5">
<h5 id="org0a90768"><span class="section-number-5">3.5.8.5.</span> <span class="todo NEXT">NEXT</span> 排序筛选,让数据分析更有条理</h5>
</div>

<div id="outline-container-org5ffa80a" class="outline-5">
<h5 id="org5ffa80a"><span class="section-number-5">3.5.8.6.</span> <span class="todo NEXT">NEXT</span> 自动统计,通过数据透视表搭建自动化报表</h5>
</div>
</div>
</div>


<div id="outline-container-orgcdecef8" class="outline-3">
<h3 id="orgcdecef8"><span class="section-number-3">3.6.</span> <span class="todo NEXT">NEXT</span> 尝试重现书中的表格</h3>
</div>

<div id="outline-container-org42ad682" class="outline-3">
<h3 id="org42ad682"><span class="section-number-3">3.7.</span> <span class="todo NEXT">NEXT</span> 这本书第五章提到的 Excel 常用函数说明的表格需要在配套资料中去学习,看看自己掌握了多少.</h3>
</div>
</div>

<div id="outline-container-org16bd4c4" class="outline-2">
<h2 id="org16bd4c4"><span class="section-number-2">4.</span> <span class="todo TODO">TODO</span> 重要知识</h2>
<div class="outline-text-2" id="text-4">
<p>
这本书里有很多使用了数组运算的地方,在阅读时尽量都记录了书签,最后准备对区域运算,
数组运算这些很多书没有详细讲,但又总在使用,只能看用法去理解的内容做一些额外学习.
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: kamisama</p>
<p class="date">Created: 2024-02-16 Fri 14:29</p>
</div>
</body>
</html>