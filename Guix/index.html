<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-02-20 Mon 10:54 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Guix Notes</title>
<meta name="generator" content="Org mode" />
</head>
<body>
<div id="content">
<h1 class="title">Guix Notes</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgdbefc5e">1. 虚拟机运行Guix</a>
<ul>
<li><a href="#org17a1ea1">1.1. 下载安装包</a></li>
<li><a href="#orge6366af">1.2. QEMU 里安装 Guix</a>
<ul>
<li><a href="#org6358e33">1.2.1. 创建一个磁盘镜像,用来运行 Guix</a></li>
<li><a href="#orgcbea403">1.2.2. 使用下载的安装镜像引导启动,进行系统安装</a>
<ul>
<li><a href="#orgfbc5cdf">1.2.2.1. 系统安装</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org2d4fd94">1.3. 安装好后运行Guix</a></li>
<li><a href="#org6eabd6e">1.4. 使用官方提供的 QEMU 镜像运行 Guix</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgdbefc5e" class="outline-2">
<h2 id="orgdbefc5e"><span class="section-number-2">1</span> 虚拟机运行Guix</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org17a1ea1" class="outline-3">
<h3 id="org17a1ea1"><span class="section-number-3">1.1</span> 下载安装包</h3>
<div class="outline-text-3" id="text-1-1">
<p>
下载地址:<a href="https://guix.gnu.org/zh-CN/download/">https://guix.gnu.org/zh-CN/download/</a>
完整的虚拟机安装包下载第一个 Guix 系统的 USB/DVD ISO 安装包
直接可以在 QEMU 里运行的下载第二个 QEMU 镜像
</p>
</div>
</div>

<div id="outline-container-orge6366af" class="outline-3">
<h3 id="orge6366af"><span class="section-number-3">1.2</span> QEMU 里安装 Guix</h3>
<div class="outline-text-3" id="text-1-2">
</div>
<div id="outline-container-org6358e33" class="outline-4">
<h4 id="org6358e33"><span class="section-number-4">1.2.1</span> 创建一个磁盘镜像,用来运行 Guix</h4>
<div class="outline-text-4" id="text-1-2-1">
<div class="org-src-container">
<pre class="src src-sh">qemu-img create -f qcow2 guix-system.img 50G
</pre>
</div>
<p>
该命令会创建一个实际大小不到 1MB 的文件,但会随着系统和软件的安装逐渐变大.
</p>
</div>
</div>

<div id="outline-container-orgcbea403" class="outline-4">
<h4 id="orgcbea403"><span class="section-number-4">1.2.2</span> 使用下载的安装镜像引导启动,进行系统安装</h4>
<div class="outline-text-4" id="text-1-2-2">
<div class="org-src-container">
<pre class="src src-sh">qemu-system-x86_64 -m 1024 -smp 1 -enable-kvm <span style="font-style: italic;">\</span>
  -nic user,<span style="font-weight: bold; font-style: italic;">model</span>=virtio-net-pci -boot <span style="font-weight: bold; font-style: italic;">menu</span>=on,<span style="font-weight: bold; font-style: italic;">order</span>=d <span style="font-style: italic;">\</span>
  -drive <span style="font-weight: bold; font-style: italic;">file</span>=guix-system.img <span style="font-style: italic;">\</span>
  -drive <span style="font-weight: bold; font-style: italic;">media</span>=cdrom,<span style="font-weight: bold; font-style: italic;">file</span>=guix-system-install-4a2f487.system.iso
</pre>
</div>
</div>

<div id="outline-container-orgfbc5cdf" class="outline-5">
<h5 id="orgfbc5cdf"><span class="section-number-5">1.2.2.1</span> 系统安装</h5>
<div class="outline-text-5" id="text-1-2-2-1">
<p>
熟悉 Linux 系统安装的都不会陌生,不熟悉的可以看看手册
手册:<a href="https://guix.gnu.org/zh-CN/manual/devel/zh-cn/html_node/Zhun-Bei-An-Zhuang-.html">https://guix.gnu.org/zh-CN/manual/devel/zh-cn/html_node/Zhun-Bei-An-Zhuang-.html</a>
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org2d4fd94" class="outline-3">
<h3 id="org2d4fd94"><span class="section-number-3">1.3</span> 安装好后运行Guix</h3>
<div class="outline-text-3" id="text-1-3">
<p>
安装完成后我们就将系统成功加载到 <a href="#org6358e33">创建一个磁盘镜像,用来运行 Guix</a> 这一步创建的磁盘
镜像里了,那么以后再启动就可以直接使用该镜像文件启动了:
command:
</p>
<div class="org-src-container">
<pre class="src src-sh">qemu-system-x86_64 <span style="font-style: italic;">\</span>
                                      -nic user,<span style="font-weight: bold; font-style: italic;">model</span>=virtio-net-pci <span style="font-style: italic;">\</span>
                                      -enable-kvm -m 2048 <span style="font-style: italic;">\</span>
                                      -device virtio-blk,<span style="font-weight: bold; font-style: italic;">drive</span>=myhd <span style="font-style: italic;">\</span>
                                      -drive <span style="font-weight: bold; font-style: italic;">if</span>=none,<span style="font-weight: bold; font-style: italic;">file</span>=$<span style="font-weight: bold; font-style: italic;">HOME</span>/guix-system.img,<span style="font-weight: bold; font-style: italic;">id</span>=myhd
</pre>
</div>
</div>
</div>

<div id="outline-container-org6eabd6e" class="outline-3">
<h3 id="org6eabd6e"><span class="section-number-3">1.4</span> 使用官方提供的 QEMU 镜像运行 Guix</h3>
<div class="outline-text-3" id="text-1-4">
<div class="org-src-container">
<pre class="src src-sh">qemu-system-x86_64 <span style="font-style: italic;">\</span>
   -nic user,<span style="font-weight: bold; font-style: italic;">model</span>=virtio-net-pci <span style="font-style: italic;">\</span>
   -enable-kvm -m 1024 <span style="font-style: italic;">\</span>
   -device virtio-blk,<span style="font-weight: bold; font-style: italic;">drive</span>=myhd <span style="font-style: italic;">\</span>
   -drive <span style="font-weight: bold; font-style: italic;">if</span>=none,<span style="font-weight: bold; font-style: italic;">file</span>=/path/to/qemu-image,<span style="font-weight: bold; font-style: italic;">id</span>=myhd
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2023-02-20 Mon 10:54</p>
</div>
</body>
</html>
